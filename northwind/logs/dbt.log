[0m14:40:01.430951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d29bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bd70>]}


============================== 14:40:01.433510 | 08298e21-5932-4a00-b841-a4b5b314f955 ==============================
[0m14:40:01.433510 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:40:01.433803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:40:01.434084 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/Users/nataliehuang/.dbt')}
[0m14:40:01.434236 [info ] [MainThread]: Creating dbt configuration folder at 
[0m14:40:21.686557 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m14:40:21.698038 [info ] [MainThread]: 
Your new dbt project "UnitF" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:40:21.698628 [info ] [MainThread]: Setting up your profile.
[0m14:43:01.230392 [info ] [MainThread]: Profile UnitF written to /Users/nataliehuang/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:43:01.282752 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 179.8651, "process_user_time": 0.860062, "process_kernel_time": 0.154288, "process_mem_max_rss": "109379584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:01.284074 [debug] [MainThread]: Command `dbt init` succeeded at 14:43:01.283812 after 179.87 seconds
[0m14:43:01.285086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b79760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108834b60>]}
[0m14:43:01.286030 [debug] [MainThread]: Flushing usage events
[0m15:03:24.792396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eedd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eeffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f140e0>]}


============================== 15:03:24.795268 | a7783046-807c-4024-b143-7b35aab98d45 ==============================
[0m15:03:24.795268 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:03:24.795603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --config-dir', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:03:24.795890 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:03:24.797090 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.0189955, "process_user_time": 0.739302, "process_kernel_time": 0.102227, "process_mem_max_rss": "93798400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:03:24.797363 [debug] [MainThread]: Command `dbt debug` succeeded at 15:03:24.797302 after 0.02 seconds
[0m15:03:24.797524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c27770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eefa70>]}
[0m15:03:24.797685 [debug] [MainThread]: Flushing usage events
[0m15:07:46.007474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089af2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ad2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b45f70>]}


============================== 15:07:46.010132 | f0ff5426-93ae-4c4a-b8f8-0d6e01e2fa49 ==============================
[0m15:07:46.010132 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:07:46.010462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:46.010769 [info ] [MainThread]: dbt version: 1.7.9
[0m15:07:46.010911 [info ] [MainThread]: python version: 3.12.2
[0m15:07:46.011049 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:07:46.011187 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:07:46.012774 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:07:46.012933 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:07:46.013067 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:07:46.043878 [info ] [MainThread]: Configuration:
[0m15:07:46.044101 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:07:46.044259 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:07:46.044396 [info ] [MainThread]: Required dependencies:
[0m15:07:46.044552 [debug] [MainThread]: Executing "git --help"
[0m15:07:46.055224 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:07:46.055692 [debug] [MainThread]: STDERR: "b''"
[0m15:07:46.055892 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:07:46.056038 [info ] [MainThread]: Connection test skipped since no profile was found
[0m15:07:46.056174 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:07:46.056296 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'UnitF'


[0m15:07:46.057778 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07865229, "process_user_time": 0.788835, "process_kernel_time": 0.101611, "process_mem_max_rss": "95682560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:46.058158 [debug] [MainThread]: Command `dbt debug` failed at 15:07:46.058086 after 0.08 seconds
[0m15:07:46.058429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ba570>]}
[0m15:07:46.058675 [debug] [MainThread]: Flushing usage events
[0m15:08:44.839692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104815b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104845ca0>]}


============================== 15:08:44.842531 | 283de101-c1f3-40ed-8c97-ddfc67e3b440 ==============================
[0m15:08:44.842531 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:44.842858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:44.843178 [info ] [MainThread]: dbt version: 1.7.9
[0m15:08:44.843323 [info ] [MainThread]: python version: 3.12.2
[0m15:08:44.843452 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:08:44.843571 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:08:44.993362 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:08:44.993621 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:08:44.993787 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:08:44.994178 [info ] [MainThread]: adapter type: snowflake
[0m15:08:44.994360 [info ] [MainThread]: adapter version: 1.7.2
[0m15:08:45.024385 [info ] [MainThread]: Configuration:
[0m15:08:45.024634 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:08:45.024786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:08:45.024924 [info ] [MainThread]: Required dependencies:
[0m15:08:45.025112 [debug] [MainThread]: Executing "git --help"
[0m15:08:45.037949 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:08:45.038491 [debug] [MainThread]: STDERR: "b''"
[0m15:08:45.038680 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:08:45.038848 [info ] [MainThread]: Connection:
[0m15:08:45.039033 [info ] [MainThread]:   account: eua414323
[0m15:08:45.039158 [info ] [MainThread]:   user: nhuangsyr
[0m15:08:45.039288 [info ] [MainThread]:   database: northwind
[0m15:08:45.039401 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:08:45.039515 [info ] [MainThread]:   role: accountadmin
[0m15:08:45.039630 [info ] [MainThread]:   schema: northwind
[0m15:08:45.039742 [info ] [MainThread]:   authenticator: None
[0m15:08:45.039852 [info ] [MainThread]:   private_key_path: None
[0m15:08:45.039965 [info ] [MainThread]:   oauth_client_id: None
[0m15:08:45.040075 [info ] [MainThread]:   query_tag: None
[0m15:08:45.040186 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:08:45.040299 [info ] [MainThread]:   host: None
[0m15:08:45.040409 [info ] [MainThread]:   port: None
[0m15:08:45.040517 [info ] [MainThread]:   proxy_host: None
[0m15:08:45.040626 [info ] [MainThread]:   proxy_port: None
[0m15:08:45.040733 [info ] [MainThread]:   protocol: None
[0m15:08:45.040842 [info ] [MainThread]:   connect_retries: 1
[0m15:08:45.040948 [info ] [MainThread]:   connect_timeout: None
[0m15:08:45.041056 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:08:45.041168 [info ] [MainThread]:   retry_all: False
[0m15:08:45.041278 [info ] [MainThread]:   insecure_mode: False
[0m15:08:45.041385 [info ] [MainThread]:   reuse_connections: None
[0m15:08:45.041605 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:08:45.076272 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:08:45.077101 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:08:45.077254 [debug] [MainThread]: On debug: select 1 as id
[0m15:08:45.077396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:45.661069 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m15:08:45.661414 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m15:08:45.661656 [debug] [MainThread]: On debug: No close available on handle
[0m15:08:45.661915 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:08:45.662141 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:08:45.662344 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB. Verify the account name is correct: eua414323.snowflakecomputing.com:443. HTTP 403: Forbidden

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:08:45.663967 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.85116214, "process_user_time": 0.980456, "process_kernel_time": 0.144336, "process_mem_max_rss": "121192448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:08:45.664366 [debug] [MainThread]: Command `dbt debug` failed at 15:08:45.664277 after 0.85 seconds
[0m15:08:45.664596 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:08:45.664825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105174c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051741a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509d2e0>]}
[0m15:08:45.665098 [debug] [MainThread]: Flushing usage events
[0m15:09:14.327981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11add2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adf1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adf1ca0>]}


============================== 15:09:14.330681 | 3440051d-1571-4d19-b187-9b2a07cfd6e6 ==============================
[0m15:09:14.330681 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:09:14.331000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:14.331296 [info ] [MainThread]: dbt version: 1.7.9
[0m15:09:14.331439 [info ] [MainThread]: python version: 3.12.2
[0m15:09:14.331562 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:09:14.331682 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:09:14.476835 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:09:14.477082 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:09:14.477239 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:09:14.477615 [info ] [MainThread]: adapter type: snowflake
[0m15:09:14.477794 [info ] [MainThread]: adapter version: 1.7.2
[0m15:09:14.507818 [info ] [MainThread]: Configuration:
[0m15:09:14.508039 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:14.508196 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:14.508329 [info ] [MainThread]: Required dependencies:
[0m15:09:14.508498 [debug] [MainThread]: Executing "git --help"
[0m15:09:14.519690 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:14.520161 [debug] [MainThread]: STDERR: "b''"
[0m15:09:14.520327 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:14.520480 [info ] [MainThread]: Connection:
[0m15:09:14.520658 [info ] [MainThread]:   account: eua41432
[0m15:09:14.520788 [info ] [MainThread]:   user: nhuangsyr
[0m15:09:14.520912 [info ] [MainThread]:   database: northwind
[0m15:09:14.521041 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:09:14.521163 [info ] [MainThread]:   role: accountadmin
[0m15:09:14.521281 [info ] [MainThread]:   schema: northwind
[0m15:09:14.521405 [info ] [MainThread]:   authenticator: None
[0m15:09:14.521522 [info ] [MainThread]:   private_key_path: None
[0m15:09:14.521640 [info ] [MainThread]:   oauth_client_id: None
[0m15:09:14.521760 [info ] [MainThread]:   query_tag: None
[0m15:09:14.521874 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:09:14.521991 [info ] [MainThread]:   host: None
[0m15:09:14.522103 [info ] [MainThread]:   port: None
[0m15:09:14.522225 [info ] [MainThread]:   proxy_host: None
[0m15:09:14.522346 [info ] [MainThread]:   proxy_port: None
[0m15:09:14.522464 [info ] [MainThread]:   protocol: None
[0m15:09:14.522573 [info ] [MainThread]:   connect_retries: 1
[0m15:09:14.522690 [info ] [MainThread]:   connect_timeout: None
[0m15:09:14.522800 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:09:14.522915 [info ] [MainThread]:   retry_all: False
[0m15:09:14.523028 [info ] [MainThread]:   insecure_mode: False
[0m15:09:14.523137 [info ] [MainThread]:   reuse_connections: None
[0m15:09:14.523366 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:09:14.527145 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:09:14.527858 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:09:14.528004 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:14.528129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:14.960362 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m15:09:14.960877 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m15:09:14.961206 [debug] [MainThread]: On debug: No close available on handle
[0m15:09:14.961546 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:09:14.961834 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:09:14.962099 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB. Verify the account name is correct: eua41432.snowflakecomputing.com:443. HTTP 403: Forbidden

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:09:14.963881 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.66554, "process_user_time": 0.934442, "process_kernel_time": 0.139809, "process_mem_max_rss": "121274368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:14.964422 [debug] [MainThread]: Command `dbt debug` failed at 15:09:14.964305 after 0.67 seconds
[0m15:09:14.964728 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:14.965027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afddf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aecabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b034530>]}
[0m15:09:14.965390 [debug] [MainThread]: Flushing usage events
[0m15:09:55.962096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c0b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f01be0>]}


============================== 15:09:55.964626 | d3b77e82-1762-4957-833f-74eb5c6e35d9 ==============================
[0m15:09:55.964626 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:09:55.964960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:55.965264 [info ] [MainThread]: dbt version: 1.7.9
[0m15:09:55.965407 [info ] [MainThread]: python version: 3.12.2
[0m15:09:55.965534 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:09:55.965652 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:09:56.119963 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:09:56.120212 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:09:56.120368 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:09:56.120730 [info ] [MainThread]: adapter type: snowflake
[0m15:09:56.120915 [info ] [MainThread]: adapter version: 1.7.2
[0m15:09:56.151417 [info ] [MainThread]: Configuration:
[0m15:09:56.151635 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:56.151785 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:56.151923 [info ] [MainThread]: Required dependencies:
[0m15:09:56.152099 [debug] [MainThread]: Executing "git --help"
[0m15:09:56.163108 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:56.163579 [debug] [MainThread]: STDERR: "b''"
[0m15:09:56.163751 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:56.163910 [info ] [MainThread]: Connection:
[0m15:09:56.164080 [info ] [MainThread]:   account: eua41432.east-us-2.azure
[0m15:09:56.164221 [info ] [MainThread]:   user: nhuangsyr
[0m15:09:56.164343 [info ] [MainThread]:   database: northwind
[0m15:09:56.164470 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:09:56.164602 [info ] [MainThread]:   role: accountadmin
[0m15:09:56.164718 [info ] [MainThread]:   schema: northwind
[0m15:09:56.164842 [info ] [MainThread]:   authenticator: None
[0m15:09:56.164967 [info ] [MainThread]:   private_key_path: None
[0m15:09:56.165085 [info ] [MainThread]:   oauth_client_id: None
[0m15:09:56.165207 [info ] [MainThread]:   query_tag: None
[0m15:09:56.165323 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:09:56.165455 [info ] [MainThread]:   host: None
[0m15:09:56.165589 [info ] [MainThread]:   port: None
[0m15:09:56.165703 [info ] [MainThread]:   proxy_host: None
[0m15:09:56.165809 [info ] [MainThread]:   proxy_port: None
[0m15:09:56.165916 [info ] [MainThread]:   protocol: None
[0m15:09:56.166027 [info ] [MainThread]:   connect_retries: 1
[0m15:09:56.166152 [info ] [MainThread]:   connect_timeout: None
[0m15:09:56.166266 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:09:56.166393 [info ] [MainThread]:   retry_all: False
[0m15:09:56.166507 [info ] [MainThread]:   insecure_mode: False
[0m15:09:56.166624 [info ] [MainThread]:   reuse_connections: None
[0m15:09:56.166874 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:09:56.170438 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:09:56.171202 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:09:56.171355 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:56.171489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:56.773396 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m15:09:56.773987 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m15:09:56.774365 [debug] [MainThread]: On debug: No close available on handle
[0m15:09:56.774760 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:09:56.775103 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:09:56.775400 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: eua41432.east-us-2.azure.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:09:56.777984 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.8437415, "process_user_time": 0.976791, "process_kernel_time": 0.144934, "process_mem_max_rss": "121896960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:56.778739 [debug] [MainThread]: Command `dbt debug` failed at 15:09:56.778580 after 0.84 seconds
[0m15:09:56.779112 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:56.779437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a5c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128aaa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f2c080>]}
[0m15:09:56.779870 [debug] [MainThread]: Flushing usage events
[0m15:11:36.761055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f5d90>]}


============================== 15:11:36.763650 | de0bedd2-9dc1-4de5-a376-637c59f66ae5 ==============================
[0m15:11:36.763650 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:11:36.763967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:11:36.764264 [info ] [MainThread]: dbt version: 1.7.9
[0m15:11:36.764407 [info ] [MainThread]: python version: 3.12.2
[0m15:11:36.764542 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:11:36.764669 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:11:36.917661 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:11:36.917921 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:11:36.918093 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:11:36.918482 [info ] [MainThread]: adapter type: snowflake
[0m15:11:36.918670 [info ] [MainThread]: adapter version: 1.7.2
[0m15:11:36.949164 [info ] [MainThread]: Configuration:
[0m15:11:36.949390 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:11:36.949547 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:11:36.949680 [info ] [MainThread]: Required dependencies:
[0m15:11:36.949860 [debug] [MainThread]: Executing "git --help"
[0m15:11:36.961099 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:11:36.961623 [debug] [MainThread]: STDERR: "b''"
[0m15:11:36.961812 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:11:36.961974 [info ] [MainThread]: Connection:
[0m15:11:36.962155 [info ] [MainThread]:   account: eua41432.east-us-2.azure
[0m15:11:36.962289 [info ] [MainThread]:   user: nhuangsyr
[0m15:11:36.962408 [info ] [MainThread]:   database: northwind
[0m15:11:36.962528 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:11:36.962651 [info ] [MainThread]:   role: accountadmin
[0m15:11:36.962768 [info ] [MainThread]:   schema: northwind
[0m15:11:36.962890 [info ] [MainThread]:   authenticator: None
[0m15:11:36.963008 [info ] [MainThread]:   private_key_path: None
[0m15:11:36.963133 [info ] [MainThread]:   oauth_client_id: None
[0m15:11:36.963244 [info ] [MainThread]:   query_tag: None
[0m15:11:36.963362 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:11:36.963483 [info ] [MainThread]:   host: None
[0m15:11:36.963598 [info ] [MainThread]:   port: None
[0m15:11:36.963712 [info ] [MainThread]:   proxy_host: None
[0m15:11:36.963836 [info ] [MainThread]:   proxy_port: None
[0m15:11:36.963953 [info ] [MainThread]:   protocol: None
[0m15:11:36.964068 [info ] [MainThread]:   connect_retries: 1
[0m15:11:36.964186 [info ] [MainThread]:   connect_timeout: None
[0m15:11:36.964309 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:11:36.964421 [info ] [MainThread]:   retry_all: False
[0m15:11:36.964534 [info ] [MainThread]:   insecure_mode: False
[0m15:11:36.964649 [info ] [MainThread]:   reuse_connections: None
[0m15:11:36.964880 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:11:36.968904 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:11:36.969576 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:11:36.969709 [debug] [MainThread]: On debug: select 1 as id
[0m15:11:36.969835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:37.492053 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:11:37.495869 [debug] [MainThread]: On debug: Close
[0m15:11:37.584291 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:11:37.584780 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:11:37.586783 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.85425776, "process_user_time": 0.931503, "process_kernel_time": 0.139759, "process_mem_max_rss": "120668160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:37.587333 [debug] [MainThread]: Command `dbt debug` succeeded at 15:11:37.587219 after 0.85 seconds
[0m15:11:37.587605 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:11:37.587849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f36690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594d160>]}
[0m15:11:37.588139 [debug] [MainThread]: Flushing usage events
[0m15:14:58.582703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cde300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d02270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d01f40>]}


============================== 15:14:58.585229 | 69c160b7-c58b-4606-812e-a67452568762 ==============================
[0m15:14:58.585229 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:14:58.585544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:58.784814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69c160b7-c58b-4606-812e-a67452568762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113013aa0>]}
[0m15:14:58.819125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69c160b7-c58b-4606-812e-a67452568762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f3530>]}
[0m15:14:58.819636 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:14:58.824405 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:14:58.826074 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.2713018, "process_user_time": 0.916861, "process_kernel_time": 0.128785, "process_mem_max_rss": "113623040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:58.826515 [debug] [MainThread]: Command `dbt build` failed at 15:14:58.826440 after 0.27 seconds
[0m15:14:58.826845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d021b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113907020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113904380>]}
[0m15:14:58.827062 [debug] [MainThread]: Flushing usage events
[0m15:18:06.962341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e6060>]}


============================== 15:18:06.965312 | b001ae3b-6a80-4ef7-8aab-79f849717c62 ==============================
[0m15:18:06.965312 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:06.965672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:07.009791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b001ae3b-6a80-4ef7-8aab-79f849717c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678fe60>]}
[0m15:18:07.011811 [debug] [MainThread]: Set downloads directory='/var/folders/0t/7f6xygd17692gzp2hdyh_0r80000gn/T/dbt-downloads-ei75_c_u'
[0m15:18:07.012061 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:18:07.942024 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:18:07.943702 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:18:08.009109 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:18:08.015446 [info ] [MainThread]: Updating lock file in file path: /Users/nataliehuang/Desktop/ist722dbt/northwind/package-lock.yml
[0m15:18:08.017430 [debug] [MainThread]: Set downloads directory='/var/folders/0t/7f6xygd17692gzp2hdyh_0r80000gn/T/dbt-downloads-petikxvr'
[0m15:18:08.019383 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:18:08.184127 [info ] [MainThread]: Installed from version 1.1.1
[0m15:18:08.184407 [info ] [MainThread]: Up to date!
[0m15:18:08.184645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b001ae3b-6a80-4ef7-8aab-79f849717c62', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9dc0>]}
[0m15:18:08.186405 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2576764, "process_user_time": 0.886741, "process_kernel_time": 0.143376, "process_mem_max_rss": "99287040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:08.186769 [debug] [MainThread]: Command `dbt deps` succeeded at 15:18:08.186692 after 1.26 seconds
[0m15:18:08.186970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106358e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f6570>]}
[0m15:18:08.187164 [debug] [MainThread]: Flushing usage events
[0m15:18:14.848993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104de2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fe390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fe0f0>]}


============================== 15:18:14.851667 | 493a32e8-0e0a-41b8-b191-90ec8846f471 ==============================
[0m15:18:14.851667 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:14.851989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:18:15.038208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f2db0>]}
[0m15:18:15.071348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110530a70>]}
[0m15:18:15.072450 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:18:15.083656 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:18:15.084165 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:18:15.084349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105303b0>]}
[0m15:18:15.599246 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind
[0m15:18:15.601611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253c950>]}
[0m15:18:15.606874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112559310>]}
[0m15:18:15.607107 [info ] [MainThread]: Found 1 test, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m15:18:15.607817 [info ] [MainThread]: 
[0m15:18:15.608194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:15.608415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c2e40>]}
[0m15:18:15.608761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:15.608903 [info ] [MainThread]: 
[0m15:18:15.610313 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:15.610576 [info ] [Thread-1 (]: 1 of 1 START test source_unique_conformed_DateDimension_DateKey ................ [RUN]
[0m15:18:15.610970 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m15:18:15.611154 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:15.617643 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:18:15.618234 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 15:18:15.611269 => 15:18:15.618119
[0m15:18:15.618414 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:15.629726 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:18:15.630561 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:18:15.630752 [debug] [Thread-1 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:18:15.630925 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:17.038976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:17.048986 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 15:18:15.618519 => 15:18:17.048586
[0m15:18:17.049537 [debug] [Thread-1 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m15:18:17.122705 [info ] [Thread-1 (]: 1 of 1 PASS source_unique_conformed_DateDimension_DateKey ...................... [[32mPASS[0m in 1.51s]
[0m15:18:17.123568 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:17.125549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:17.125864 [debug] [MainThread]: Connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b' was properly closed.
[0m15:18:17.126169 [info ] [MainThread]: 
[0m15:18:17.126487 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m15:18:17.127194 [debug] [MainThread]: Command end result
[0m15:18:17.135949 [info ] [MainThread]: 
[0m15:18:17.136361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:17.136651 [info ] [MainThread]: 
[0m15:18:17.136941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:17.138619 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.3181357, "process_user_time": 1.487342, "process_kernel_time": 0.137114, "process_mem_max_rss": "128565248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:17.139128 [debug] [MainThread]: Command `dbt build` succeeded at 15:18:17.139023 after 2.32 seconds
[0m15:18:17.139444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102c9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125efce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a34050>]}
[0m15:18:17.139736 [debug] [MainThread]: Flushing usage events
[0m15:24:04.308728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe21b0>]}


============================== 15:24:04.311404 | 4977d9e1-6aeb-4eb5-aad2-57a5535219a7 ==============================
[0m15:24:04.311404 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:24:04.311734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:04.513837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4977d9e1-6aeb-4eb5-aad2-57a5535219a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583d7f0>]}
[0m15:24:04.547070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4977d9e1-6aeb-4eb5-aad2-57a5535219a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dee5a0>]}
[0m15:24:04.547547 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:24:04.559541 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:24:04.567751 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading northwind: sources.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |           - name: OrderID
    53 |             tests:
    54 |               - unique
    55 |       -name: Order Details
    56 |         tests:
    57 |         - dbt_utils_unique_combination_of_columns:
    58 |             combination_of_columns:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 20, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 55, column 7
[0m15:24:04.569130 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.28913835, "process_user_time": 0.927121, "process_kernel_time": 0.139595, "process_mem_max_rss": "117276672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:24:04.569473 [debug] [MainThread]: Command `dbt build` failed at 15:24:04.569404 after 0.29 seconds
[0m15:24:04.569710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599cdd0>]}
[0m15:24:04.569911 [debug] [MainThread]: Flushing usage events
[0m15:25:08.940677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ae2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fe420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fe0c0>]}


============================== 15:25:08.943150 | f4702d11-9658-485d-940c-045170fdc81b ==============================
[0m15:25:08.943150 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:25:08.943480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:25:09.140147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4702d11-9658-485d-940c-045170fdc81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062702f0>]}
[0m15:25:09.173717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4702d11-9658-485d-940c-045170fdc81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106723cb0>]}
[0m15:25:09.174258 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:25:09.185927 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:25:09.194086 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading northwind: sources.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |           - name: OrderID
    53 |             tests:
    54 |               - unique
    55 |       -name: Order Details
    56 |         tests:
    57 |         - dbt_utils_unique_combination_of_columns:
    58 |             combination_of_columns:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 20, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 55, column 7
[0m15:25:09.195417 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.28131813, "process_user_time": 0.933104, "process_kernel_time": 0.138174, "process_mem_max_rss": "117440512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:09.195736 [debug] [MainThread]: Command `dbt build` failed at 15:25:09.195669 after 0.28 seconds
[0m15:25:09.195946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbf020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6c380>]}
[0m15:25:09.196131 [debug] [MainThread]: Flushing usage events
[0m15:26:45.967513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fe3c0>]}


============================== 15:26:45.970155 | 899b1a10-d21d-457d-8943-55421390637b ==============================
[0m15:26:45.970155 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:26:45.970471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:46.166955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '899b1a10-d21d-457d-8943-55421390637b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a013ad0>]}
[0m15:26:46.200126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '899b1a10-d21d-457d-8943-55421390637b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a203110>]}
[0m15:26:46.200610 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:26:46.211144 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:26:46.219293 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading northwind: sources.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |           - name: OrderId
    53 |             tests:
    54 |               - unique
    55 |       -name: Order_Details
    56 |         tests:
    57 |         - dbt_utils_unique_combination_of_columns:
    58 |             combination_of_columns:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 20, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 55, column 7
[0m15:26:46.220705 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.28236014, "process_user_time": 0.923443, "process_kernel_time": 0.133873, "process_mem_max_rss": "115933184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:26:46.221064 [debug] [MainThread]: Command `dbt build` failed at 15:26:46.220990 after 0.28 seconds
[0m15:26:46.221293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109247230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2330b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04ad20>]}
[0m15:26:46.221488 [debug] [MainThread]: Flushing usage events
[0m15:41:41.487873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f01790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f01070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f221e0>]}


============================== 15:41:41.490446 | 14b39030-2fcd-4d5f-a61f-fa6e02ddd98b ==============================
[0m15:41:41.490446 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:41:41.490761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:41:41.705740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055de4b0>]}
[0m15:41:41.739306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051944a0>]}
[0m15:41:41.739822 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:41:41.750961 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:41:41.784169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:41.784548 [debug] [MainThread]: Partial parsing: updated file: northwind://models/sources.yml
[0m15:41:41.870599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind
[0m15:41:41.873305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f54530>]}
[0m15:41:41.879216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597d220>]}
[0m15:41:41.879445 [info ] [MainThread]: Found 9 tests, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m15:41:41.880381 [info ] [MainThread]: 
[0m15:41:41.880746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:41:41.880960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c668d0>]}
[0m15:41:41.881273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:41.881430 [info ] [MainThread]: 
[0m15:41:41.882862 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:41:41.883055 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:41.883237 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:41.883389 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:41.883580 [info ] [Thread-1 (]: 1 of 9 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m15:41:41.883781 [info ] [Thread-2 (]: 2 of 9 START test source_unique_conformed_DateDimension_DateKey ................ [RUN]
[0m15:41:41.883962 [info ] [Thread-3 (]: 3 of 9 START test source_unique_northwind_Categories_CategoryId ................ [RUN]
[0m15:41:41.884139 [info ] [Thread-4 (]: 4 of 9 START test source_unique_northwind_Customers_CustomerId ................. [RUN]
[0m15:41:41.884503 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf'
[0m15:41:41.884821 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m15:41:41.885119 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m15:41:41.885573 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m15:41:41.885773 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:41:41.885958 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:41.886118 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:41.886309 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:41.893234 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:41:41.895176 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:41:41.897130 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:41:41.897720 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 15:41:41.886452 => 15:41:41.897597
[0m15:41:41.897940 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 15:41:41.890358 => 15:41:41.897822
[0m15:41:41.898213 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 15:41:41.893397 => 15:41:41.898085
[0m15:41:41.899202 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:41.899388 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 15:41:41.895319 => 15:41:41.899300
[0m15:41:41.899621 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:41.911622 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:41:41.911811 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:41.913188 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:41:41.914532 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:41:41.915258 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:41:41.915672 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:41:41.915856 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.916109 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.916467 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:41:41.916694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:41.916895 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:41.917083 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.919134 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:41.920615 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:41:41.920894 [error] [Thread-1 (]: 1 of 9 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.04s]
[0m15:41:41.921162 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:41:41.921361 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:41.921606 [info ] [Thread-1 (]: 5 of 9 START test source_unique_northwind_Employees_EmployeeId ................. [RUN]
[0m15:41:41.921951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m15:41:41.922319 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:41.924438 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:41:41.924780 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 15:41:41.922439 => 15:41:41.924679
[0m15:41:41.924948 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:41.926160 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:41:41.926609 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:41:41.926781 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.926942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:43.916995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:41:43.928623 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 15:41:41.925043 => 15:41:43.928249
[0m15:41:43.929211 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m15:41:43.995899 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:41:43.997659 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 15:41:41.913385 => 15:41:43.997472
[0m15:41:43.997947 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m15:41:44.048342 [info ] [Thread-1 (]: 5 of 9 PASS source_unique_northwind_Employees_EmployeeId ....................... [[32mPASS[0m in 2.13s]
[0m15:41:44.048899 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:44.049249 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:44.049601 [info ] [Thread-1 (]: 6 of 9 START test source_unique_northwind_Orders_OrderId ....................... [RUN]
[0m15:41:44.050191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m15:41:44.050487 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:44.054353 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:41:44.055790 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 15:41:44.050647 => 15:41:44.055607
[0m15:41:44.056066 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:44.058201 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:41:44.059199 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:41:44.059576 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.059879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:44.125680 [info ] [Thread-4 (]: 4 of 9 PASS source_unique_northwind_Customers_CustomerId ....................... [[32mPASS[0m in 2.24s]
[0m15:41:44.126235 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:44.126516 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:44.126814 [info ] [Thread-4 (]: 7 of 9 START test source_unique_northwind_Products_ProductId ................... [RUN]
[0m15:41:44.127327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m15:41:44.127565 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:44.132018 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:41:44.132799 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 15:41:44.127704 => 15:41:44.132651
[0m15:41:44.133035 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:44.134762 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:41:44.135385 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:41:44.135606 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.135811 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:44.292621 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:41:44.297441 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 15:41:41.911939 => 15:41:44.297251
[0m15:41:44.297811 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m15:41:44.408728 [info ] [Thread-3 (]: 3 of 9 PASS source_unique_northwind_Categories_CategoryId ...................... [[32mPASS[0m in 2.52s]
[0m15:41:44.409291 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:44.409626 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:44.410015 [info ] [Thread-3 (]: 8 of 9 START test source_unique_northwind_Shippers_ShipperID ................... [RUN]
[0m15:41:44.410696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m15:41:44.411021 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:44.414515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:41:44.415190 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 15:41:44.411190 => 15:41:44.415030
[0m15:41:44.415452 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:44.417400 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:41:44.418140 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:41:44.418405 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.418649 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:44.497934 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:41:44.499682 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 15:41:41.899724 => 15:41:44.499499
[0m15:41:44.499970 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m15:41:44.607472 [info ] [Thread-2 (]: 2 of 9 PASS source_unique_conformed_DateDimension_DateKey ...................... [[32mPASS[0m in 2.72s]
[0m15:41:44.608235 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:44.608669 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:44.609098 [info ] [Thread-2 (]: 9 of 9 START test source_unique_northwind_Suppliers_SupplierId ................. [RUN]
[0m15:41:44.609789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m15:41:44.610131 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:44.614543 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:41:44.615337 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 15:41:44.610326 => 15:41:44.615139
[0m15:41:44.615658 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:44.617925 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:41:44.618744 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:41:44.619042 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.619316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:44.978531 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:44.981197 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 15:41:44.133162 => 15:41:44.980922
[0m15:41:44.981619 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m15:41:45.098330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:45.102751 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 15:41:44.056222 => 15:41:45.102321
[0m15:41:45.104112 [info ] [Thread-4 (]: 7 of 9 PASS source_unique_northwind_Products_ProductId ......................... [[32mPASS[0m in 0.98s]
[0m15:41:45.104864 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m15:41:45.105600 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:45.210914 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:45.213503 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 15:41:44.415601 => 15:41:45.213247
[0m15:41:45.214337 [info ] [Thread-1 (]: 6 of 9 PASS source_unique_northwind_Orders_OrderId ............................. [[32mPASS[0m in 1.16s]
[0m15:41:45.214793 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m15:41:45.215248 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:45.248068 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:45.249930 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 15:41:44.615844 => 15:41:45.249729
[0m15:41:45.250246 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m15:41:45.398043 [info ] [Thread-3 (]: 8 of 9 PASS source_unique_northwind_Shippers_ShipperID ......................... [[32mPASS[0m in 0.99s]
[0m15:41:45.398582 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:45.451975 [info ] [Thread-2 (]: 9 of 9 PASS source_unique_northwind_Suppliers_SupplierId ....................... [[32mPASS[0m in 0.84s]
[0m15:41:45.452527 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:45.453862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:45.454098 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7' was properly closed.
[0m15:41:45.454265 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b' was properly closed.
[0m15:41:45.454412 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1' was properly closed.
[0m15:41:45.454552 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45' was properly closed.
[0m15:41:45.454734 [info ] [MainThread]: 
[0m15:41:45.454914 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m15:41:45.455782 [debug] [MainThread]: Command end result
[0m15:41:45.462798 [info ] [MainThread]: 
[0m15:41:45.463076 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:45.463261 [info ] [MainThread]: 
[0m15:41:45.463430 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:41:45.463600 [info ] [MainThread]: 
[0m15:41:45.463774 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:41:45.465543 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.00876, "process_user_time": 1.633943, "process_kernel_time": 0.235274, "process_mem_max_rss": "140591104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:41:45.466062 [debug] [MainThread]: Command `dbt build` failed at 15:41:45.465975 after 4.01 seconds
[0m15:41:45.466333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28500>]}
[0m15:41:45.466566 [debug] [MainThread]: Flushing usage events
[0m15:57:43.363760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fe330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fe090>]}


============================== 15:57:43.366557 | 23bc53e3-988a-4ae6-8602-8027d2b270ce ==============================
[0m15:57:43.366557 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:57:43.366887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:43.557644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fe390>]}
[0m15:57:43.590876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d4500>]}
[0m15:57:43.591353 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:57:43.603749 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:57:43.641073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:57:43.641443 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_date.yml
[0m15:57:43.641605 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_date.sql
[0m15:57:43.755909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd9c5f0>]}
[0m15:57:43.761826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc83860>]}
[0m15:57:43.762053 [info ] [MainThread]: Found 13 tests, 1 model, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m15:57:43.763149 [info ] [MainThread]: 
[0m15:57:43.763525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:43.764031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:57:43.770049 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:57:43.770243 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:57:43.770384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:44.720417 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:57:44.723759 [debug] [ThreadPool]: On list_analytics: Close
[0m15:57:45.014571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_northwind_northwind)
[0m15:57:45.016362 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "northwind_northwind"
"
[0m15:57:45.023129 [debug] [ThreadPool]: Using snowflake connection "create_analytics_northwind_northwind"
[0m15:57:45.023598 [debug] [ThreadPool]: On create_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_analytics_northwind_northwind"} */
create schema if not exists analytics.northwind_northwind
[0m15:57:45.023949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:45.629325 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:45.631639 [debug] [ThreadPool]: On create_analytics_northwind_northwind: Close
[0m15:57:45.759691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_northwind_northwind, now list_analytics_northwind_northwind)
[0m15:57:45.767310 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m15:57:45.767537 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m15:57:45.767694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:46.180791 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:57:46.182826 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m15:57:46.297397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd1e930>]}
[0m15:57:46.299415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:46.300076 [info ] [MainThread]: 
[0m15:57:46.361627 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:57:46.361931 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:46.363077 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:46.363297 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:46.363579 [info ] [Thread-1 (]: 1 of 14 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m15:57:46.363848 [info ] [Thread-2 (]: 2 of 14 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m15:57:46.364078 [info ] [Thread-3 (]: 3 of 14 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m15:57:46.364361 [info ] [Thread-4 (]: 4 of 14 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m15:57:46.364857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf)
[0m15:57:46.365278 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m15:57:46.365663 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m15:57:46.366028 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m15:57:46.366231 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:57:46.366416 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:46.366586 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:46.366757 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:46.377293 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:57:46.379632 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:57:46.381817 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:57:46.382326 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 15:57:46.366875 => 15:57:46.382192
[0m15:57:46.383446 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 15:57:46.374011 => 15:57:46.383297
[0m15:57:46.383798 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 15:57:46.377533 => 15:57:46.383645
[0m15:57:46.384039 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:46.384497 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 15:57:46.379817 => 15:57:46.384211
[0m15:57:46.384795 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:46.395755 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:57:46.396057 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:46.397423 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:57:46.398820 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:57:46.399310 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:57:46.399844 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:57:46.400041 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.400393 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:57:46.400598 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.400798 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:57:46.401010 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.401319 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:46.401863 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:46.403926 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:57:46.404384 [error] [Thread-1 (]: 1 of 14 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.04s]
[0m15:57:46.404951 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:57:46.405283 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:46.405609 [info ] [Thread-1 (]: 5 of 14 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m15:57:46.405941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m15:57:46.406159 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:46.408939 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:57:46.409332 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 15:57:46.406298 => 15:57:46.409214
[0m15:57:46.409506 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:46.410765 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:57:46.411237 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:57:46.411431 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.411601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:46.849437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.861422 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 15:57:46.397675 => 15:57:46.861082
[0m15:57:46.862013 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m15:57:46.864839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.866864 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 15:57:46.384971 => 15:57:46.866649
[0m15:57:46.867324 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m15:57:46.869918 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.871903 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 15:57:46.396224 => 15:57:46.871685
[0m15:57:46.872350 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m15:57:46.873996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.875791 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 15:57:46.409603 => 15:57:46.875612
[0m15:57:46.876138 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m15:57:47.055892 [info ] [Thread-2 (]: 2 of 14 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.69s]
[0m15:57:47.057414 [info ] [Thread-1 (]: 5 of 14 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.65s]
[0m15:57:47.058583 [info ] [Thread-4 (]: 4 of 14 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.69s]
[0m15:57:47.059539 [info ] [Thread-3 (]: 3 of 14 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.69s]
[0m15:57:47.060822 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:47.061404 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:47.061916 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:47.062392 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:47.062894 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.063774 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.064467 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.064968 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.065433 [info ] [Thread-2 (]: 6 of 14 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m15:57:47.065886 [info ] [Thread-1 (]: 7 of 14 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m15:57:47.066312 [info ] [Thread-4 (]: 8 of 14 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m15:57:47.066705 [info ] [Thread-3 (]: 9 of 14 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m15:57:47.067310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m15:57:47.067860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m15:57:47.068400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m15:57:47.068922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m15:57:47.069278 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.069613 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.069926 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.070232 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.075505 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:57:47.078718 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:57:47.082115 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:57:47.085310 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:57:47.086131 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 15:57:47.082412 => 15:57:47.085930
[0m15:57:47.086472 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 15:57:47.071764 => 15:57:47.086291
[0m15:57:47.086764 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 15:57:47.075761 => 15:57:47.086619
[0m15:57:47.087068 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 15:57:47.070439 => 15:57:47.086918
[0m15:57:47.087317 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.087600 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.087890 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.088147 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.090213 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:57:47.092037 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:57:47.093770 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:57:47.095449 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:57:47.096311 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:57:47.096945 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:57:47.097205 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.097757 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:57:47.098020 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.098531 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:57:47.098789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:47.099040 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.099274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:47.099508 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.100172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:47.100908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:47.436905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.439428 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 15:57:47.090387 => 15:57:47.439188
[0m15:57:47.439814 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m15:57:47.450093 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.451834 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 15:57:47.088313 => 15:57:47.451627
[0m15:57:47.452176 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m15:57:47.458766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.459368 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.461205 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 15:57:47.093928 => 15:57:47.460984
[0m15:57:47.462816 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 15:57:47.092210 => 15:57:47.462643
[0m15:57:47.463161 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m15:57:47.463441 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m15:57:47.638958 [info ] [Thread-2 (]: 6 of 14 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.57s]
[0m15:57:47.640265 [info ] [Thread-3 (]: 9 of 14 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.57s]
[0m15:57:47.641281 [info ] [Thread-4 (]: 8 of 14 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.57s]
[0m15:57:47.642352 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.642967 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.643482 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.644717 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m15:57:47.644287 [info ] [Thread-1 (]: 7 of 14 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.58s]
[0m15:57:47.645547 [info ] [Thread-2 (]: 10 of 14 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m15:57:47.646125 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.646898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m15:57:47.647476 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m15:57:47.653333 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m15:57:47.654336 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 15:57:47.647731 => 15:57:47.654121
[0m15:57:47.654700 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m15:57:47.674059 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m15:57:47.674881 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m15:57:47.675136 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    datofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m15:57:47.675366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:48.102267 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c529-0000-17c7-0009-ec830002001e
[0m15:57:48.103090 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'DATOFWEEK'
[0m15:57:48.103773 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 15:57:47.654901 => 15:57:48.103504
[0m15:57:48.104231 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m15:57:48.228647 [debug] [Thread-2 (]: Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m15:57:48.229594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a5b20>]}
[0m15:57:48.230385 [error] [Thread-2 (]: 10 of 14 ERROR creating sql table model analytics.northwind_northwind.dim_date . [[31mERROR[0m in 0.58s]
[0m15:57:48.231139 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m15:57:48.232305 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m15:57:48.232739 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m15:57:48.233187 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m15:57:48.233626 [info ] [Thread-3 (]: 11 of 14 SKIP test not_null_dim_date_date ...................................... [[33mSKIP[0m]
[0m15:57:48.234073 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m15:57:48.234526 [info ] [Thread-4 (]: 12 of 14 SKIP test not_null_dim_date_datekey ................................... [[33mSKIP[0m]
[0m15:57:48.234976 [info ] [Thread-1 (]: 13 of 14 SKIP test unique_dim_date_date ........................................ [[33mSKIP[0m]
[0m15:57:48.235405 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m15:57:48.235775 [info ] [Thread-2 (]: 14 of 14 SKIP test unique_dim_date_datekey ..................................... [[33mSKIP[0m]
[0m15:57:48.236204 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m15:57:48.236572 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m15:57:48.237029 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m15:57:48.238878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:48.239174 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45' was properly closed.
[0m15:57:48.239449 [debug] [MainThread]: Connection 'model.northwind.dim_date' was properly closed.
[0m15:57:48.239677 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b' was properly closed.
[0m15:57:48.239909 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1' was properly closed.
[0m15:57:48.240239 [info ] [MainThread]: 
[0m15:57:48.240518 [info ] [MainThread]: Finished running 13 tests, 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m15:57:48.242002 [debug] [MainThread]: Command end result
[0m15:57:48.250158 [info ] [MainThread]: 
[0m15:57:48.250492 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:57:48.250727 [info ] [MainThread]: 
[0m15:57:48.250965 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:57:48.251196 [info ] [MainThread]: 
[0m15:57:48.251419 [error] [MainThread]:   Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m15:57:48.251650 [info ] [MainThread]: 
[0m15:57:48.251881 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=4 TOTAL=14
[0m15:57:48.253505 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.9194803, "process_user_time": 1.790067, "process_kernel_time": 0.228605, "process_mem_max_rss": "142524416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:57:48.253897 [debug] [MainThread]: Command `dbt build` failed at 15:57:48.253810 after 4.92 seconds
[0m15:57:48.254183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf48830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e844f50>]}
[0m15:57:48.254456 [debug] [MainThread]: Flushing usage events
[0m16:04:54.528075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10314e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583a090>]}


============================== 16:04:54.530716 | f9894226-d999-4952-8cca-e0ea80466301 ==============================
[0m16:04:54.530716 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:04:54.531013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:04:54.730686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e78980>]}
[0m16:04:54.766159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066945f0>]}
[0m16:04:54.766825 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:04:54.780140 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:04:54.823411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:04:54.823810 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_customer.yml
[0m16:04:54.823989 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_customer.sql
[0m16:04:54.949404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e7080>]}
[0m16:04:54.957417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106870590>]}
[0m16:04:54.957687 [info ] [MainThread]: Found 17 tests, 2 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:04:54.958951 [info ] [MainThread]: 
[0m16:04:54.959349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:54.959900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:04:54.966334 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:04:54.966523 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:04:54.966666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:56.018147 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:04:56.021737 [debug] [ThreadPool]: On list_analytics: Close
[0m16:04:56.192326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:04:56.205191 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:04:56.205654 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:04:56.205934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:56.940930 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m16:04:56.944372 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:04:57.070866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077889b0>]}
[0m16:04:57.072759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:57.073433 [info ] [MainThread]: 
[0m16:04:57.077976 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:04:57.078470 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.078912 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.079325 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.079744 [info ] [Thread-1 (]: 1 of 19 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:04:57.080494 [info ] [Thread-2 (]: 2 of 19 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:04:57.081146 [info ] [Thread-3 (]: 3 of 19 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:04:57.081571 [info ] [Thread-4 (]: 4 of 19 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:04:57.082358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf)
[0m16:04:57.083131 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:04:57.083793 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:04:57.084390 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:04:57.084726 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:04:57.085051 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.085336 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.085620 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.101706 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:04:57.104835 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:04:57.107762 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:04:57.108425 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 16:04:57.085818 => 16:04:57.108231
[0m16:04:57.109571 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:04:57.101975 => 16:04:57.109429
[0m16:04:57.109864 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:04:57.096869 => 16:04:57.109705
[0m16:04:57.110120 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:04:57.105062 => 16:04:57.109999
[0m16:04:57.110439 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.110665 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.110916 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.124624 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:04:57.126237 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:04:57.127854 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:04:57.128637 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:04:57.128987 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.129426 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:04:57.129838 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:04:57.130088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:04:57.130305 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.130691 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.131116 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:04:57.131731 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:04:57.133781 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:04:57.134142 [error] [Thread-1 (]: 1 of 19 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.05s]
[0m16:04:57.134980 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:04:57.135208 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.135449 [info ] [Thread-1 (]: 5 of 19 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:04:57.135808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:04:57.135996 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.139173 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:04:57.139587 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:04:57.136137 => 16:04:57.139456
[0m16:04:57.139788 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.141291 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:04:57.141827 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:04:57.142028 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.142212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:57.557468 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.569016 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:04:57.111071 => 16:04:57.568659
[0m16:04:57.570717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.571364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.571975 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.572319 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:04:57.574105 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:04:57.124799 => 16:04:57.573906
[0m16:04:57.575714 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:04:57.139903 => 16:04:57.575525
[0m16:04:57.577284 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:04:57.126452 => 16:04:57.577088
[0m16:04:57.578516 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:04:57.579195 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:04:57.579570 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:04:57.689278 [info ] [Thread-3 (]: 3 of 19 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.61s]
[0m16:04:57.690719 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.691583 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:57.692632 [info ] [Thread-3 (]: 6 of 19 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:04:57.693629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:04:57.694106 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:57.700623 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:04:57.696279 [info ] [Thread-1 (]: 5 of 19 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.56s]
[0m16:04:57.701851 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.702399 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:57.704191 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:04:57.694836 => 16:04:57.703991
[0m16:04:57.705289 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:57.703398 [info ] [Thread-2 (]: 2 of 19 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.62s]
[0m16:04:57.708250 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:04:57.703800 [info ] [Thread-1 (]: 7 of 19 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:04:57.708819 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.705007 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.62s]
[0m16:04:57.709527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:04:57.709963 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:57.710735 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:04:57.711198 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.711517 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:57.711822 [info ] [Thread-2 (]: 8 of 19 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:04:57.712209 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.712618 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:57.716346 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:04:57.716906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:04:57.717193 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:04:57.717484 [info ] [Thread-4 (]: 9 of 19 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:04:57.717846 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:57.719018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:04:57.719311 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:04:57.712899 => 16:04:57.719171
[0m16:04:57.722328 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:04:57.722630 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:57.723072 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:57.726308 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:04:57.728294 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:04:57.728600 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:04:57.719505 => 16:04:57.728465
[0m16:04:57.728940 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:57.730629 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:04:57.730964 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:04:57.723467 => 16:04:57.730832
[0m16:04:57.731439 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:04:57.731703 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:57.731958 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.732401 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:04:57.735116 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:04:57.735399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:57.735648 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.736296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:57.736900 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:04:57.737756 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.738091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:58.157938 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.162764 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:04:57.732545 => 16:04:58.162309
[0m16:04:58.164133 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.164580 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:04:58.167490 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:04:57.705595 => 16:04:58.167115
[0m16:04:58.169416 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:04:58.172292 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.174616 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:04:57.729118 => 16:04:58.174340
[0m16:04:58.175415 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:04:58.179913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.181631 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:04:57.726554 => 16:04:58.181428
[0m16:04:58.181962 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:04:58.287359 [info ] [Thread-4 (]: 9 of 19 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.57s]
[0m16:04:58.289681 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.58s]
[0m16:04:58.290609 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:58.292931 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:58.291664 [info ] [Thread-3 (]: 6 of 19 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:04:58.292457 [info ] [Thread-2 (]: 8 of 19 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.58s]
[0m16:04:58.293638 [debug] [Thread-4 (]: Began running node model.northwind.dim_date
[0m16:04:58.294160 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:04:58.294746 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:58.295230 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:58.295688 [info ] [Thread-4 (]: 10 of 19 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:04:58.296138 [info ] [Thread-1 (]: 11 of 19 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:04:58.297001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_date)
[0m16:04:58.297634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m16:04:58.297991 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_date
[0m16:04:58.298371 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:04:58.302053 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:04:58.305768 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:04:58.307490 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (compile): 16:04:58.298630 => 16:04:58.307311
[0m16:04:58.307822 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:04:58.302324 => 16:04:58.307653
[0m16:04:58.308080 [debug] [Thread-4 (]: Began executing node model.northwind.dim_date
[0m16:04:58.308330 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:04:58.326670 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:04:58.328565 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:04:58.329302 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:04:58.329570 [debug] [Thread-4 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    datofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:04:58.329808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:58.330292 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:04:58.331173 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:04:58.331410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:58.790184 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c530-0000-17c7-0009-ec830002008e
[0m16:04:58.790961 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'DATOFWEEK'
[0m16:04:58.791663 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (execute): 16:04:58.308487 => 16:04:58.791387
[0m16:04:58.792133 [debug] [Thread-4 (]: On model.northwind.dim_date: Close
[0m16:04:58.908603 [debug] [Thread-4 (]: Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m16:04:58.909313 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ede80>]}
[0m16:04:58.910046 [error] [Thread-4 (]: 10 of 19 ERROR creating sql table model analytics.northwind_northwind.dim_date . [[31mERROR[0m in 0.61s]
[0m16:04:58.910793 [debug] [Thread-4 (]: Finished running node model.northwind.dim_date
[0m16:04:58.911440 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:04:58.911870 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:04:58.912315 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:04:58.912672 [info ] [Thread-3 (]: 12 of 19 SKIP test not_null_dim_date_date ...................................... [[33mSKIP[0m]
[0m16:04:58.913109 [info ] [Thread-2 (]: 13 of 19 SKIP test not_null_dim_date_datekey ................................... [[33mSKIP[0m]
[0m16:04:58.913557 [info ] [Thread-4 (]: 14 of 19 SKIP test unique_dim_date_date ........................................ [[33mSKIP[0m]
[0m16:04:58.914030 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:04:58.914419 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:04:58.914795 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:04:58.915174 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:04:58.915748 [info ] [Thread-3 (]: 15 of 19 SKIP test unique_dim_date_datekey ..................................... [[33mSKIP[0m]
[0m16:04:58.916152 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:04:59.366246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:04:59.382564 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:04:58.326884 => 16:04:59.382379
[0m16:04:59.382910 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:04:59.568503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f58e90>]}
[0m16:04:59.570038 [info ] [Thread-1 (]: 11 of 19 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.27s]
[0m16:04:59.571070 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:04:59.572243 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:04:59.572834 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:04:59.573337 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:04:59.573753 [info ] [Thread-2 (]: 16 of 19 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:04:59.574285 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:04:59.574712 [info ] [Thread-4 (]: 17 of 19 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:04:59.575248 [info ] [Thread-3 (]: 18 of 19 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:04:59.576073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:04:59.576479 [info ] [Thread-1 (]: 19 of 19 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:04:59.577165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:04:59.577799 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:04:59.578207 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:04:59.578809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:04:59.579160 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:04:59.579578 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:04:59.580762 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:04:59.591425 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:04:59.592517 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:04:59.597382 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:04:59.600161 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:04:59.601118 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:04:59.579800 => 16:04:59.600845
[0m16:04:59.601581 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:04:59.587314 => 16:04:59.601366
[0m16:04:59.601973 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:04:59.592825 => 16:04:59.601759
[0m16:04:59.602303 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:04:59.602655 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:04:59.597601 => 16:04:59.602490
[0m16:04:59.602946 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:04:59.603216 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:04:59.605481 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:04:59.605748 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:04:59.607610 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:04:59.609435 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:04:59.611352 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:04:59.612016 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:04:59.612467 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:04:59.612908 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:04:59.613128 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:04:59.613415 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:04:59.613877 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:04:59.614125 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:59.614356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:59.614552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:59.614763 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:59.614971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:04:59.616318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:00.176521 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.182376 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:04:59.605914 => 16:05:00.181899
[0m16:05:00.183128 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:05:00.185960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.188845 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:04:59.603380 => 16:05:00.188583
[0m16:05:00.189418 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:05:00.311535 [info ] [Thread-4 (]: 17 of 19 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.73s]
[0m16:05:00.313435 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:05:00.317447 [info ] [Thread-2 (]: 16 of 19 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.74s]
[0m16:05:00.318289 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:05:00.687925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.689265 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.693370 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:04:59.609695 => 16:05:00.692957
[0m16:05:00.696752 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:04:59.607780 => 16:05:00.696321
[0m16:05:00.697386 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:05:00.697816 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:05:00.825228 [info ] [Thread-3 (]: 18 of 19 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.25s]
[0m16:05:00.827651 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:05:00.876495 [info ] [Thread-1 (]: 19 of 19 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.30s]
[0m16:05:00.877087 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:05:00.878523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:00.878798 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerkey.183274e37c' was properly closed.
[0m16:05:00.879002 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_customer_customerid.4d829c4322' was properly closed.
[0m16:05:00.879188 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerid.04913d3698' was properly closed.
[0m16:05:00.879361 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_customer_customerkey.904a936983' was properly closed.
[0m16:05:00.879593 [info ] [MainThread]: 
[0m16:05:00.879812 [info ] [MainThread]: Finished running 17 tests, 2 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m16:05:00.881344 [debug] [MainThread]: Command end result
[0m16:05:00.890608 [info ] [MainThread]: 
[0m16:05:00.891450 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:05:00.891996 [info ] [MainThread]: 
[0m16:05:00.892476 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:05:00.892734 [info ] [MainThread]: 
[0m16:05:00.892927 [error] [MainThread]:   Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m16:05:00.893118 [info ] [MainThread]: 
[0m16:05:00.893316 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=4 TOTAL=19
[0m16:05:00.895067 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.398954, "process_user_time": 2.030513, "process_kernel_time": 0.238578, "process_mem_max_rss": "141967360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:05:00.895453 [debug] [MainThread]: Command `dbt build` failed at 16:05:00.895376 after 6.40 seconds
[0m16:05:00.895697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10314e2d0>]}
[0m16:05:00.895959 [debug] [MainThread]: Flushing usage events
[0m16:07:02.434640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f6390>]}


============================== 16:07:02.437451 | 101a2a02-c055-4e74-9c14-98cd8fd1886c ==============================
[0m16:07:02.437451 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:07:02.437792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:02.630590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fed0d0>]}
[0m16:07:02.664199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112932b70>]}
[0m16:07:02.664774 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:07:02.676819 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:07:02.714060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:07:02.714473 [debug] [MainThread]: Partial parsing: updated file: northwind://models/sources.yml
[0m16:07:02.714696 [debug] [MainThread]: Partial parsing: updated file: northwind://models/dim_date.sql
[0m16:07:02.827280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146a83b0>]}
[0m16:07:02.834236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359a570>]}
[0m16:07:02.834445 [info ] [MainThread]: Found 17 tests, 2 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:07:02.835531 [info ] [MainThread]: 
[0m16:07:02.835919 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:02.836437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:07:02.842571 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:07:02.842759 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:07:02.842897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:03.919848 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:07:03.923162 [debug] [ThreadPool]: On list_analytics: Close
[0m16:07:04.066217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:07:04.077733 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:07:04.078294 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:07:04.078626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:04.580679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:04.583753 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:07:04.706726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077c860>]}
[0m16:07:04.708084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:04.708509 [info ] [MainThread]: 
[0m16:07:04.712455 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:07:04.713031 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:04.713493 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:04.713916 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:04.714338 [info ] [Thread-1 (]: 1 of 19 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:07:04.714837 [info ] [Thread-2 (]: 2 of 19 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:07:04.715305 [info ] [Thread-3 (]: 3 of 19 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:07:04.715722 [info ] [Thread-4 (]: 4 of 19 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:07:04.718275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf)
[0m16:07:04.718981 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:07:04.719608 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:07:04.720217 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:07:04.720760 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:07:04.721226 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:04.721551 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:04.721869 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:04.775326 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:04.777621 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:04.778124 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 16:07:04.722095 => 16:07:04.777969
[0m16:07:04.780334 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:04.781698 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:07:04.775590 => 16:07:04.781522
[0m16:07:04.781964 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:07:04.771722 => 16:07:04.781834
[0m16:07:04.782237 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:04.782519 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:07:04.778288 => 16:07:04.782402
[0m16:07:04.782693 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:04.793720 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:04.793966 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:04.795400 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:04.796815 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:04.797335 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:04.797830 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:04.798129 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.798351 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.798689 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:04.798886 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:04.799081 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:04.799321 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.800786 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:07:04.801106 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:04.801386 [error] [Thread-1 (]: 1 of 19 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.09s]
[0m16:07:04.801872 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:07:04.802202 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:04.802451 [info ] [Thread-1 (]: 5 of 19 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:07:04.802798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:07:04.803042 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:04.805792 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:04.806115 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:07:04.803799 => 16:07:04.806012
[0m16:07:04.806363 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:04.808419 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:04.808907 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:04.809094 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.809262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:05.284719 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:05.297444 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:07:04.794150 => 16:07:05.297082
[0m16:07:05.299493 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:07:05.476912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:05.479173 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:05.483483 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:07:04.782856 => 16:07:05.483044
[0m16:07:05.486724 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:07:04.795639 => 16:07:05.486399
[0m16:07:05.487515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:05.487912 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:07:05.488317 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:07:05.490712 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:07:04.806497 => 16:07:05.490472
[0m16:07:05.493866 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:07:05.494869 [info ] [Thread-2 (]: 2 of 19 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.78s]
[0m16:07:05.496243 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:05.496975 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:05.498224 [info ] [Thread-2 (]: 6 of 19 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:07:05.499364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:07:05.499744 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:05.504017 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:05.504752 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:07:05.499934 => 16:07:05.504587
[0m16:07:05.505034 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:05.507146 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:05.508377 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:05.508677 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.508957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:05.604202 [info ] [Thread-1 (]: 5 of 19 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.80s]
[0m16:07:05.604818 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.88s]
[0m16:07:05.605382 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:05.605736 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:05.606030 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:05.606361 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:05.606749 [info ] [Thread-1 (]: 7 of 19 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:07:05.607061 [info ] [Thread-4 (]: 8 of 19 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:07:05.607570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:07:05.608028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:07:05.608291 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:05.608518 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:05.611573 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:05.614280 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:05.615176 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:07:05.611757 => 16:07:05.614982
[0m16:07:05.615476 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:07:05.608662 => 16:07:05.615340
[0m16:07:05.615699 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:05.616191 [info ] [Thread-3 (]: 3 of 19 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.90s]
[0m16:07:05.616459 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:05.618230 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:05.618596 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:05.620226 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:05.620565 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:05.621250 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:05.621524 [info ] [Thread-3 (]: 9 of 19 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:07:05.621839 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.622303 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:05.622690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:07:05.622908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:05.623125 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.623351 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:05.623876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:05.626556 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:05.627653 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:07:05.624020 => 16:07:05.627520
[0m16:07:05.627873 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:05.629389 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:05.630573 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:05.630811 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.631039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:05.913921 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:05.921439 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:07:05.505200 => 16:07:05.921095
[0m16:07:05.922136 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:07:06.008782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:06.010566 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:06.014544 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:07:05.618743 => 16:07:06.014213
[0m16:07:06.015532 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:06.018590 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:07:05.627989 => 16:07:06.018141
[0m16:07:06.019340 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:07:06.021445 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:07:05.616600 => 16:07:06.021194
[0m16:07:06.021842 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:07:06.023306 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:07:06.044465 [info ] [Thread-2 (]: 6 of 19 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.55s]
[0m16:07:06.045050 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:06.045441 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:07:06.045920 [info ] [Thread-2 (]: 10 of 19 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:07:06.046591 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:07:06.046921 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:07:06.050251 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:07:06.051117 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:07:06.047111 => 16:07:06.050938
[0m16:07:06.051424 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:07:06.070356 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:07:06.071136 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:07:06.071402 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:07:06.071637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:06.138645 [info ] [Thread-3 (]: 9 of 19 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.52s]
[0m16:07:06.139221 [info ] [Thread-4 (]: 8 of 19 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.53s]
[0m16:07:06.139698 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:06.140004 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:06.140265 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m16:07:06.140641 [info ] [Thread-3 (]: 11 of 19 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:07:06.141097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_customer)
[0m16:07:06.141321 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m16:07:06.150954 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:07:06.151905 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 16:07:06.141454 => 16:07:06.151713
[0m16:07:06.152163 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m16:07:06.154306 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:07:06.155478 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:07:06.155743 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:07:06.155968 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:06.158960 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.55s]
[0m16:07:06.159314 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:07.030719 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:07.032418 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:07.055386 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 16:07:06.152306 => 16:07:07.055179
[0m16:07:07.057364 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:07:06.051581 => 16:07:07.057196
[0m16:07:07.057700 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m16:07:07.057969 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:07:07.178963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d53e90>]}
[0m16:07:07.180000 [info ] [Thread-3 (]: 11 of 19 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.04s]
[0m16:07:07.180741 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m16:07:07.181993 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.182666 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:07.183198 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:07.183782 [info ] [Thread-4 (]: 12 of 19 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:07:07.184299 [info ] [Thread-1 (]: 13 of 19 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:07:07.184774 [info ] [Thread-3 (]: 14 of 19 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:07:07.186078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:07:07.186922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:07:07.187562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:07:07.187936 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:07.188267 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.188592 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:07.195822 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:07.199659 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:07.202782 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:07.203521 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:07:07.188800 => 16:07:07.203333
[0m16:07:07.203870 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:07:07.196158 => 16:07:07.203696
[0m16:07:07.204172 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:07.204503 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.204851 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:07:07.199880 => 16:07:07.204659
[0m16:07:07.207074 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:07.210263 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:07.210531 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:07.212542 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:07.213182 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:07.213655 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:07.213931 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:07:07.214437 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:07.214980 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:07:07.215274 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:07.215552 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:07.215817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:07.216709 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:07.217205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136475c0>]}
[0m16:07:07.218598 [info ] [Thread-2 (]: 10 of 19 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.17s]
[0m16:07:07.219305 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:07:07.219588 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:07.220256 [info ] [Thread-2 (]: 15 of 19 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:07:07.220993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:07:07.221215 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:07.223970 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:07.224439 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:07:07.221343 => 16:07:07.224303
[0m16:07:07.224649 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:07.226408 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:07.227017 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:07.227243 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:07.227455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:07.669296 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:07.674433 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:07:07.207282 => 16:07:07.674122
[0m16:07:07.675428 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:07:07.801099 [info ] [Thread-4 (]: 12 of 19 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.62s]
[0m16:07:07.802361 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.802945 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:07.803490 [info ] [Thread-4 (]: 16 of 19 START test not_null_dim_date_date ..................................... [RUN]
[0m16:07:07.804389 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:07:07.805331 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:07.811507 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:07.812667 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:07:07.805668 => 16:07:07.812424
[0m16:07:07.813075 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:07.816030 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:07.817091 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:07.817443 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:07:07.817752 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:08.074696 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.077869 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:07:07.210830 => 16:07:08.077606
[0m16:07:08.078302 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:07:08.198076 [info ] [Thread-3 (]: 14 of 19 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.01s]
[0m16:07:08.199184 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:08.199810 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:08.200362 [info ] [Thread-3 (]: 17 of 19 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:07:08.201225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:07:08.201888 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:08.208422 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:08.209579 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:07:08.202541 => 16:07:08.209344
[0m16:07:08.209981 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:08.212934 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:08.213948 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:08.214325 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:07:08.214669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:08.220093 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.220790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.222867 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:07:07.224772 => 16:07:08.222627
[0m16:07:08.224436 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:07:07.205044 => 16:07:08.224270
[0m16:07:08.224740 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:07:08.225010 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:07:08.337896 [info ] [Thread-1 (]: 13 of 19 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 1.15s]
[0m16:07:08.338602 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:08.339034 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:08.339378 [info ] [Thread-1 (]: 18 of 19 START test unique_dim_date_date ....................................... [RUN]
[0m16:07:08.340068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:07:08.340448 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:08.346543 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:08.347681 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:07:08.340656 => 16:07:08.347497
[0m16:07:08.348066 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:08.350436 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:08.351110 [info ] [Thread-2 (]: 15 of 19 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.13s]
[0m16:07:08.351662 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:08.351960 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:08.352295 [info ] [Thread-2 (]: 19 of 19 START test unique_dim_date_datekey .................................... [RUN]
[0m16:07:08.352804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:07:08.353068 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:08.353660 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:08.356836 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:08.357136 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:08.357446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:08.358250 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:07:08.353820 => 16:07:08.358099
[0m16:07:08.358705 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:08.360557 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:08.361554 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:08.361821 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:08.362056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:08.530887 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.535420 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:07:07.813313 => 16:07:08.535130
[0m16:07:08.536361 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:07:08.656111 [info ] [Thread-4 (]: 16 of 19 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.85s]
[0m16:07:08.657346 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:08.670852 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:08.673321 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:07:08.210290 => 16:07:08.673064
[0m16:07:08.673720 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:07:08.795363 [info ] [Thread-3 (]: 17 of 19 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.59s]
[0m16:07:08.796069 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:09.164906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:09.171653 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:07:08.348249 => 16:07:09.170974
[0m16:07:09.172223 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:07:09.184027 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:09.186468 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:07:08.358879 => 16:07:09.186210
[0m16:07:09.186880 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:07:09.284065 [info ] [Thread-1 (]: 18 of 19 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.94s]
[0m16:07:09.285279 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:09.318880 [info ] [Thread-2 (]: 19 of 19 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.97s]
[0m16:07:09.319654 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:09.321540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:09.321855 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_date.dd069a8d31' was properly closed.
[0m16:07:09.322083 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:07:09.322279 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_datekey.1af65c721b' was properly closed.
[0m16:07:09.322462 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_date.78f11e7735' was properly closed.
[0m16:07:09.322747 [info ] [MainThread]: 
[0m16:07:09.323002 [info ] [MainThread]: Finished running 17 tests, 2 table models in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m16:07:09.324932 [debug] [MainThread]: Command end result
[0m16:07:09.332757 [info ] [MainThread]: 
[0m16:07:09.333022 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:07:09.333208 [info ] [MainThread]: 
[0m16:07:09.333396 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:07:09.333595 [info ] [MainThread]: 
[0m16:07:09.333782 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 TOTAL=19
[0m16:07:09.335401 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.929038, "process_user_time": 2.196352, "process_kernel_time": 0.260168, "process_mem_max_rss": "147750912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:07:09.335787 [debug] [MainThread]: Command `dbt build` failed at 16:07:09.335703 after 6.93 seconds
[0m16:07:09.336046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115deebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b694f0>]}
[0m16:07:09.336287 [debug] [MainThread]: Flushing usage events
[0m16:07:36.016371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e090>]}


============================== 16:07:36.018890 | b7b2e8b9-35b8-4e6a-97cc-273cc4243c66 ==============================
[0m16:07:36.018890 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:07:36.019205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:07:36.200640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baa2d0>]}
[0m16:07:36.239854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ad670>]}
[0m16:07:36.240695 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:07:36.252338 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:07:36.286392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:36.286942 [debug] [MainThread]: Partial parsing: updated file: northwind://models/sources.yml
[0m16:07:36.457972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904e90>]}
[0m16:07:36.494447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088baed0>]}
[0m16:07:36.494739 [info ] [MainThread]: Found 17 tests, 2 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:07:36.495909 [info ] [MainThread]: 
[0m16:07:36.496305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:36.496862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:07:36.503035 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:07:36.503228 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:07:36.503381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.476860 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:07:37.480257 [debug] [ThreadPool]: On list_analytics: Close
[0m16:07:37.598265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:07:37.609935 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:07:37.610318 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:07:37.610597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:38.221799 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:07:38.225412 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:07:38.484328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c800>]}
[0m16:07:38.485927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:38.486868 [info ] [MainThread]: 
[0m16:07:38.490935 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:38.491412 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:38.491816 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:38.492228 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:38.492628 [info ] [Thread-1 (]: 1 of 19 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:07:38.493071 [info ] [Thread-2 (]: 2 of 19 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:07:38.493468 [info ] [Thread-3 (]: 3 of 19 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:07:38.493845 [info ] [Thread-4 (]: 4 of 19 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:07:38.495458 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:07:38.495911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:07:38.496662 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:07:38.497357 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:07:38.497723 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:38.498027 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:38.498318 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:38.498690 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:38.509268 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:38.513217 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:07:38.516098 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:38.519029 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:38.520071 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:07:38.499261 => 16:07:38.519856
[0m16:07:38.520430 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:07:38.509578 => 16:07:38.520261
[0m16:07:38.520718 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:07:38.513458 => 16:07:38.520579
[0m16:07:38.520990 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:38.521317 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:07:38.516302 => 16:07:38.521130
[0m16:07:38.521594 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:38.521838 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:38.535974 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:38.536271 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:38.537897 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:07:38.539355 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:38.541860 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:38.542485 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:38.542933 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:38.543385 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:38.543832 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:07:38.544230 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:38.544423 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:38.544641 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:38.544876 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:07:38.545095 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:38.545678 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:38.546055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:38.546267 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:39.018689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.031507 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:07:38.521986 => 16:07:39.031165
[0m16:07:39.032802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.033463 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:07:39.035730 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:07:38.536426 => 16:07:39.035514
[0m16:07:39.037197 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:07:39.080496 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:39.082553 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:07:38.538054 => 16:07:39.082310
[0m16:07:39.082956 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:07:39.110570 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:39.113003 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:07:38.539561 => 16:07:39.112718
[0m16:07:39.113462 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:07:39.152157 [info ] [Thread-2 (]: 2 of 19 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.66s]
[0m16:07:39.153992 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:39.153266 [info ] [Thread-1 (]: 1 of 19 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.66s]
[0m16:07:39.154532 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.155241 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:39.155655 [info ] [Thread-2 (]: 5 of 19 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:07:39.156114 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.156846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:07:39.157245 [info ] [Thread-1 (]: 6 of 19 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:07:39.157636 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.158305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:07:39.159580 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.163734 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:39.167677 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:39.169408 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:07:39.158558 => 16:07:39.169205
[0m16:07:39.169740 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.170096 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:07:39.164006 => 16:07:39.169903
[0m16:07:39.172332 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:39.172990 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.175406 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:39.176432 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:39.176998 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:39.177260 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.177555 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.177820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:39.178041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:39.214602 [info ] [Thread-3 (]: 3 of 19 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.72s]
[0m16:07:39.215180 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:39.215510 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.215889 [info ] [Thread-3 (]: 7 of 19 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:07:39.216485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:07:39.216783 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.220369 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:39.221169 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:07:39.216963 => 16:07:39.221023
[0m16:07:39.221411 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.223494 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:39.224264 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:39.224604 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.224979 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:39.231724 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.73s]
[0m16:07:39.232137 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:39.232407 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.232787 [info ] [Thread-4 (]: 8 of 19 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:07:39.233214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:07:39.233441 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.236362 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:39.236822 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:07:39.233575 => 16:07:39.236692
[0m16:07:39.237034 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.239693 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:39.240339 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:39.240640 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.240887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:39.553432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.554802 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.558815 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:07:39.173356 => 16:07:39.558480
[0m16:07:39.561827 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:07:39.170343 => 16:07:39.561389
[0m16:07:39.562945 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:07:39.564569 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:07:39.657559 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.658779 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.662418 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:07:39.221610 => 16:07:39.662132
[0m16:07:39.665313 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:07:39.237165 => 16:07:39.664899
[0m16:07:39.665966 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:07:39.666457 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:07:39.679975 [info ] [Thread-1 (]: 6 of 19 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.52s]
[0m16:07:39.680648 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.681095 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:39.681571 [info ] [Thread-1 (]: 9 of 19 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:07:39.682361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:07:39.682760 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:39.687578 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:39.688498 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:07:39.682998 => 16:07:39.688299
[0m16:07:39.688827 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:39.691403 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:39.692223 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:39.692532 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.692812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:39.712141 [info ] [Thread-2 (]: 5 of 19 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.56s]
[0m16:07:39.712690 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.713018 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:07:39.713391 [info ] [Thread-2 (]: 10 of 19 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:07:39.713947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_date)
[0m16:07:39.714242 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:07:39.716710 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:07:39.717277 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:07:39.714400 => 16:07:39.717118
[0m16:07:39.717535 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:07:39.735545 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:07:39.737037 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:07:39.737291 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:07:39.737574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:39.793062 [info ] [Thread-4 (]: 8 of 19 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.56s]
[0m16:07:39.793691 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.793988 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m16:07:39.794286 [info ] [Thread-4 (]: 11 of 19 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:07:39.794673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:07:39.794865 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m16:07:39.795315 [info ] [Thread-3 (]: 7 of 19 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.58s]
[0m16:07:39.797929 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:07:39.798271 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.798719 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 16:07:39.795483 => 16:07:39.798604
[0m16:07:39.798912 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m16:07:39.800530 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:07:39.801104 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:07:39.801300 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:07:39.801492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:40.064744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:40.066591 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:07:39.689022 => 16:07:40.066373
[0m16:07:40.066935 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:07:40.183063 [info ] [Thread-1 (]: 9 of 19 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.50s]
[0m16:07:40.184240 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:40.511889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:40.512913 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:40.533114 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:07:39.717691 => 16:07:40.532911
[0m16:07:40.535360 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 16:07:39.799026 => 16:07:40.535190
[0m16:07:40.535787 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:07:40.536060 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m16:07:40.652359 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099764b0>]}
[0m16:07:40.653587 [info ] [Thread-4 (]: 11 of 19 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.86s]
[0m16:07:40.654478 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m16:07:40.655276 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:40.655763 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:40.656264 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:40.656695 [info ] [Thread-3 (]: 12 of 19 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:07:40.657692 [info ] [Thread-1 (]: 13 of 19 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:07:40.658363 [info ] [Thread-4 (]: 14 of 19 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:07:40.659339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:07:40.660092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:07:40.661292 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:40.661939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:07:40.662772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ee240>]}
[0m16:07:40.663193 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:40.671831 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:40.672238 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:40.672703 [info ] [Thread-2 (]: 10 of 19 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.95s]
[0m16:07:40.676056 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:40.679506 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:40.679964 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:07:40.680503 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:40.681028 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:07:40.663431 => 16:07:40.680781
[0m16:07:40.681762 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:07:40.672941 => 16:07:40.681593
[0m16:07:40.681342 [info ] [Thread-2 (]: 15 of 19 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:07:40.682145 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:07:40.676396 => 16:07:40.682012
[0m16:07:40.682369 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:40.682602 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:40.683065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:07:40.683316 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:40.685436 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:40.691450 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:40.691776 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:40.693835 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:40.697283 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:40.697966 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:40.698507 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:40.698819 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:07:40.699346 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:40.699647 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:07:40.699917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:40.700190 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:07:40.694237 => 16:07:40.700053
[0m16:07:40.700446 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:40.700674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:40.701382 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:40.701843 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:40.704214 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:40.705969 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:40.706225 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:40.706441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:41.361437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.362756 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.366728 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:07:40.689559 => 16:07:41.366174
[0m16:07:41.369830 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:07:40.683460 => 16:07:41.369420
[0m16:07:41.370420 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:07:41.370821 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:07:41.563286 [info ] [Thread-1 (]: 13 of 19 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.90s]
[0m16:07:41.564644 [info ] [Thread-3 (]: 12 of 19 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.91s]
[0m16:07:41.565890 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:41.566540 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:41.567083 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:41.567751 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:41.568337 [info ] [Thread-1 (]: 16 of 19 START test not_null_dim_date_date ..................................... [RUN]
[0m16:07:41.568810 [info ] [Thread-3 (]: 17 of 19 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:07:41.569760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:07:41.570489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:07:41.570847 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:41.571176 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:41.578135 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:41.583776 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:41.584966 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:07:41.571383 => 16:07:41.584742
[0m16:07:41.585385 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:07:41.573423 => 16:07:41.585163
[0m16:07:41.585785 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:41.586091 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:41.588479 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:41.590532 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:41.591333 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:41.591723 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:07:41.592039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:41.592521 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:41.593293 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:07:41.593809 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:41.811179 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.814223 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:07:40.691938 => 16:07:41.813879
[0m16:07:41.815113 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:07:41.817077 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.819484 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:07:40.702383 => 16:07:41.819234
[0m16:07:41.819930 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:07:41.947105 [info ] [Thread-2 (]: 15 of 19 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.26s]
[0m16:07:41.948264 [info ] [Thread-4 (]: 14 of 19 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.29s]
[0m16:07:41.949611 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:41.950436 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:41.951002 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:41.951687 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:41.952276 [info ] [Thread-2 (]: 18 of 19 START test unique_dim_date_date ....................................... [RUN]
[0m16:07:41.952924 [info ] [Thread-4 (]: 19 of 19 START test unique_dim_date_datekey .................................... [RUN]
[0m16:07:41.953988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:07:41.954806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:07:41.955196 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:41.955537 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:41.961078 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:41.964939 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:41.965790 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:07:41.961391 => 16:07:41.965538
[0m16:07:41.966220 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:07:41.955755 => 16:07:41.966028
[0m16:07:41.966521 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:41.966835 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:41.969273 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:41.971284 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:41.972137 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:41.972437 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:41.973063 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:41.973351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:41.973687 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:41.974728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:42.201039 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.204377 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:07:41.588693 => 16:07:42.204013
[0m16:07:42.204914 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:07:42.207371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.209743 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:07:41.586265 => 16:07:42.209503
[0m16:07:42.210185 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:07:42.331082 [info ] [Thread-3 (]: 17 of 19 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.76s]
[0m16:07:42.332596 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:42.335866 [info ] [Thread-1 (]: 16 of 19 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.77s]
[0m16:07:42.336943 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:42.608348 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.613624 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:07:41.969468 => 16:07:42.613233
[0m16:07:42.614277 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:07:42.644593 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.648903 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:07:41.967043 => 16:07:42.648558
[0m16:07:42.649509 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:07:42.778988 [info ] [Thread-2 (]: 18 of 19 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.83s]
[0m16:07:42.780050 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:42.794229 [info ] [Thread-4 (]: 19 of 19 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.84s]
[0m16:07:42.795083 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:42.797158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:42.797516 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_date.78f11e7735' was properly closed.
[0m16:07:42.797779 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_date.dd069a8d31' was properly closed.
[0m16:07:42.798011 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_datekey.1af65c721b' was properly closed.
[0m16:07:42.798234 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:07:42.798564 [info ] [MainThread]: 
[0m16:07:42.798865 [info ] [MainThread]: Finished running 17 tests, 2 table models in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m16:07:42.801117 [debug] [MainThread]: Command end result
[0m16:07:42.810200 [info ] [MainThread]: 
[0m16:07:42.810508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:42.810823 [info ] [MainThread]: 
[0m16:07:42.811163 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m16:07:42.813605 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.823697, "process_user_time": 2.308323, "process_kernel_time": 0.244481, "process_mem_max_rss": "145129472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:07:42.813967 [debug] [MainThread]: Command `dbt build` succeeded at 16:07:42.813885 after 6.82 seconds
[0m16:07:42.814212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108865b20>]}
[0m16:07:42.814456 [debug] [MainThread]: Flushing usage events
[0m16:09:57.671928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f2450>]}


============================== 16:09:57.674506 | 397d648b-4626-4f06-9f0e-548a053f3e95 ==============================
[0m16:09:57.674506 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:09:57.674836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:09:57.875215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da98e0>]}
[0m16:09:57.912968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053309b0>]}
[0m16:09:57.913712 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:09:57.927001 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:09:57.965753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:09:57.966148 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_employee.sql
[0m16:09:57.966332 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_employee.yml
[0m16:09:58.091887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc6f30>]}
[0m16:09:58.099938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca2030>]}
[0m16:09:58.100197 [info ] [MainThread]: Found 21 tests, 3 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:09:58.101507 [info ] [MainThread]: 
[0m16:09:58.101910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:58.102472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:09:58.108807 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:09:58.109055 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:09:58.109223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:59.052760 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:09:59.056473 [debug] [ThreadPool]: On list_analytics: Close
[0m16:09:59.175669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:09:59.228321 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:09:59.228696 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:09:59.228893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:59.731479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:09:59.734516 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:09:59.848513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f08530>]}
[0m16:09:59.850235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:59.850808 [info ] [MainThread]: 
[0m16:09:59.854484 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:09:59.855122 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:09:59.855618 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:09:59.855975 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:09:59.856373 [info ] [Thread-1 (]: 1 of 24 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:09:59.856848 [info ] [Thread-2 (]: 2 of 24 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:09:59.857277 [info ] [Thread-3 (]: 3 of 24 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:09:59.857665 [info ] [Thread-4 (]: 4 of 24 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:09:59.858913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:09:59.859686 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:09:59.860420 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:09:59.861115 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:09:59.861495 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:09:59.861851 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:09:59.862187 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:09:59.862525 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:09:59.878330 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:09:59.882960 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:09:59.885815 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:09:59.888465 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:09:59.889199 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:09:59.883179 => 16:09:59.889005
[0m16:09:59.889532 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:09:59.862751 => 16:09:59.889378
[0m16:09:59.889784 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:09:59.890077 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:09:59.886018 => 16:09:59.889944
[0m16:09:59.890331 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:09:59.890577 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:09:59.878607 => 16:09:59.890453
[0m16:09:59.903533 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:09:59.903793 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:09:59.905376 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:09:59.905619 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:09:59.908143 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:09:59.908702 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:09:59.910184 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:09:59.910663 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:09:59.910901 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:59.911372 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:09:59.911605 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:09:59.911833 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:59.912040 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:59.912428 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:09:59.912610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:59.913137 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:59.913516 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:59.914582 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:10:00.330122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.331027 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.331820 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.341766 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:09:59.908861 => 16:10:00.341413
[0m16:10:00.344368 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:09:59.905824 => 16:10:00.344080
[0m16:10:00.345142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.347343 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:09:59.890720 => 16:10:00.347045
[0m16:10:00.347809 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:10:00.348194 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:10:00.349953 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:09:59.903947 => 16:10:00.349746
[0m16:10:00.350297 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:10:00.352869 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:10:00.515793 [info ] [Thread-1 (]: 1 of 24 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.66s]
[0m16:10:00.516739 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:10:00.517254 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:00.517796 [info ] [Thread-1 (]: 5 of 24 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:10:00.518687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:10:00.519632 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:00.523357 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:10:00.523982 [info ] [Thread-3 (]: 3 of 24 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.66s]
[0m16:10:00.524904 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:10:00.525417 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:00.525792 [info ] [Thread-3 (]: 6 of 24 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:10:00.526304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:10:00.526644 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:10:00.519952 => 16:10:00.526469
[0m16:10:00.527667 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:00.527397 [info ] [Thread-4 (]: 4 of 24 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.67s]
[0m16:10:00.527996 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:00.530875 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:10:00.531233 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:10:00.532797 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:10:00.533132 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:00.533784 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:10:00.528159 => 16:10:00.533489
[0m16:10:00.534155 [info ] [Thread-4 (]: 7 of 24 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:10:00.534601 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:00.535090 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:10:00.535531 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:10:00.537452 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:10:00.537822 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.538122 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:00.538406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:00.540905 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:10:00.541523 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:10:00.542179 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.542434 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:00.542655 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:10:00.538567 => 16:10:00.542545
[0m16:10:00.543099 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:00.544671 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:10:00.545859 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:10:00.546236 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.546699 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:00.622783 [info ] [Thread-2 (]: 2 of 24 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.76s]
[0m16:10:00.623594 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:10:00.623885 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:00.624184 [info ] [Thread-2 (]: 8 of 24 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:10:00.624586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:10:00.624769 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:00.628051 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:10:00.628538 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:10:00.624867 => 16:10:00.628426
[0m16:10:00.628710 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:00.630340 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:10:00.630843 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:10:00.631042 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.631219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:00.942478 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.946003 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:10:00.535689 => 16:10:00.945697
[0m16:10:00.946667 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:10:00.954145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.955080 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.955778 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.958387 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:10:00.531364 => 16:10:00.958073
[0m16:10:00.959695 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:10:00.628810 => 16:10:00.959557
[0m16:10:00.960655 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:10:00.543380 => 16:10:00.960541
[0m16:10:00.960876 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:10:00.961099 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:10:00.961368 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:10:01.152772 [info ] [Thread-3 (]: 6 of 24 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.63s]
[0m16:10:01.153614 [info ] [Thread-1 (]: 5 of 24 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.64s]
[0m16:10:01.154244 [info ] [Thread-2 (]: 8 of 24 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.53s]
[0m16:10:01.154791 [info ] [Thread-4 (]: 7 of 24 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.62s]
[0m16:10:01.155535 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:01.155941 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:01.156320 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:01.156684 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:01.157017 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:01.157423 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:10:01.157867 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:10:01.158214 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:10:01.158558 [info ] [Thread-3 (]: 9 of 24 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:10:01.158876 [info ] [Thread-1 (]: 10 of 24 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:10:01.159157 [info ] [Thread-2 (]: 11 of 24 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:10:01.159431 [info ] [Thread-4 (]: 12 of 24 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:10:01.159970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:10:01.160469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m16:10:01.160913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m16:10:01.161324 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:10:01.161584 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:01.161827 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:10:01.162054 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:10:01.162291 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:10:01.166461 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:10:01.168779 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:10:01.172211 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:10:01.175627 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:10:01.177685 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:10:01.166757 => 16:10:01.177476
[0m16:10:01.178047 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:10:01.162445 => 16:10:01.177884
[0m16:10:01.178417 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:10:01.163440 => 16:10:01.178218
[0m16:10:01.178730 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:10:01.179073 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:10:01.172470 => 16:10:01.178917
[0m16:10:01.179391 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:01.179698 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:10:01.197250 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:10:01.197529 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:10:01.199201 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:10:01.200806 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:10:01.202537 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:10:01.203151 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:10:01.203623 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:10:01.203963 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:10:01.204389 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:10:01.205068 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:10:01.205285 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:01.205504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:01.205711 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:10:01.205947 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:10:01.206172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:01.206715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:01.206915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:01.669480 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:01.671356 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:10:01.197693 => 16:10:01.671169
[0m16:10:01.671658 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:10:01.789575 [info ] [Thread-3 (]: 9 of 24 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.63s]
[0m16:10:01.790391 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:02.238387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:02.260355 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:10:01.199368 => 16:10:02.260133
[0m16:10:02.260864 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:10:02.380262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e56960>]}
[0m16:10:02.381368 [info ] [Thread-1 (]: 10 of 24 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.22s]
[0m16:10:02.382171 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:10:02.383118 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.383960 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.384651 [info ] [Thread-3 (]: 13 of 24 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:10:02.385203 [info ] [Thread-1 (]: 14 of 24 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:10:02.386214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:10:02.387117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:10:02.387616 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.388045 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.400510 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:10:02.401119 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:10:02.401846 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:10:02.388289 => 16:10:02.401667
[0m16:10:02.402133 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.402494 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:10:02.388969 => 16:10:02.402303
[0m16:10:02.404859 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:10:02.405212 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.407573 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:10:02.408270 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:10:02.408618 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:10:02.409148 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:10:02.409397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:02.409669 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:10:02.410367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:02.579449 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:02.582381 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:10:01.179889 => 16:10:02.582157
[0m16:10:02.582778 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:10:02.766869 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:10:02.771933 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:10:01.201044 => 16:10:02.771628
[0m16:10:02.772588 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:10:02.780413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39af0>]}
[0m16:10:02.781180 [info ] [Thread-2 (]: 11 of 24 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.62s]
[0m16:10:02.781806 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:10:02.782234 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:02.782737 [info ] [Thread-2 (]: 15 of 24 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:10:02.783670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:10:02.784069 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:02.788799 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:10:02.789618 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:10:02.784299 => 16:10:02.789429
[0m16:10:02.789924 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:02.792420 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:10:02.793379 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:10:02.793711 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:02.793988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:02.862103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:02.863980 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:10:02.405466 => 16:10:02.863781
[0m16:10:02.864306 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:10:02.875162 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:02.876659 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:10:02.402659 => 16:10:02.876481
[0m16:10:02.876963 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:10:02.888028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e277a0>]}
[0m16:10:02.888517 [info ] [Thread-4 (]: 12 of 24 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.73s]
[0m16:10:02.888974 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:10:02.889292 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:02.889675 [info ] [Thread-4 (]: 16 of 24 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:10:02.890396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:10:02.890652 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:02.894010 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:10:02.894633 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:10:02.890798 => 16:10:02.894483
[0m16:10:02.894875 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:02.896860 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:10:02.897599 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:10:02.897856 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:02.898099 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:02.969394 [info ] [Thread-1 (]: 14 of 24 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.58s]
[0m16:10:02.969882 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.970146 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:02.970439 [info ] [Thread-1 (]: 17 of 24 START test not_null_dim_date_date ..................................... [RUN]
[0m16:10:02.970952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:10:02.971195 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:02.974185 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:10:02.975701 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:10:02.971331 => 16:10:02.975566
[0m16:10:02.975904 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:02.977569 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:10:02.978139 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:10:02.978360 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:10:02.978574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:02.989924 [info ] [Thread-3 (]: 13 of 24 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.60s]
[0m16:10:02.990436 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.990717 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:02.991013 [info ] [Thread-3 (]: 18 of 24 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:10:02.991521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:10:02.991759 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:02.994850 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:10:02.995411 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:10:02.991889 => 16:10:02.995275
[0m16:10:02.995621 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:02.997203 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:10:02.997753 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:10:02.997960 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:10:02.998152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:03.346637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.351202 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:10:02.790103 => 16:10:03.350735
[0m16:10:03.351936 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:10:03.469396 [info ] [Thread-2 (]: 15 of 24 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.69s]
[0m16:10:03.470824 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:03.471662 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:03.472360 [info ] [Thread-2 (]: 19 of 24 START test unique_dim_date_date ....................................... [RUN]
[0m16:10:03.473466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:10:03.473956 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:03.479525 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:10:03.480652 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:10:03.474236 => 16:10:03.480421
[0m16:10:03.481040 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:03.483737 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:10:03.484739 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:10:03.485158 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:03.485497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:03.546990 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.548675 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:10:02.895025 => 16:10:03.548494
[0m16:10:03.549009 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:10:03.665885 [info ] [Thread-4 (]: 16 of 24 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.78s]
[0m16:10:03.667543 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:03.668154 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:03.668624 [info ] [Thread-4 (]: 20 of 24 START test unique_dim_date_datekey .................................... [RUN]
[0m16:10:03.669378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:10:03.669749 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:03.674412 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:10:03.675248 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:10:03.669972 => 16:10:03.675056
[0m16:10:03.675571 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:03.678062 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:10:03.679080 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:10:03.679431 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:03.679729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:03.885756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.888825 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:10:02.976035 => 16:10:03.888492
[0m16:10:03.889366 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:10:03.891701 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:03.894062 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:10:03.481259 => 16:10:03.893831
[0m16:10:03.894577 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:10:03.896588 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.899373 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:10:02.995736 => 16:10:03.899118
[0m16:10:03.900469 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:10:04.021966 [info ] [Thread-3 (]: 18 of 24 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.03s]
[0m16:10:04.022958 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:04.024321 [info ] [Thread-2 (]: 19 of 24 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.55s]
[0m16:10:04.025844 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.025307 [info ] [Thread-1 (]: 17 of 24 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 1.05s]
[0m16:10:04.026604 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:04.027014 [info ] [Thread-3 (]: 21 of 24 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:10:04.027601 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:04.028013 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.028826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:10:04.029378 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.029813 [info ] [Thread-2 (]: 22 of 24 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:10:04.030236 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.030577 [info ] [Thread-1 (]: 23 of 24 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:10:04.031196 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:10:04.038263 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:10:04.038825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:10:04.039116 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.039501 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.042952 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:10:04.046273 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:10:04.046793 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:10:04.031414 => 16:10:04.046626
[0m16:10:04.047110 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.049184 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:10:04.049621 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:10:04.043184 => 16:10:04.049475
[0m16:10:04.050262 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.050686 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:10:04.039724 => 16:10:04.050497
[0m16:10:04.053466 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:10:04.054132 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:10:04.054467 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.055053 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:10:04.057046 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:10:04.057594 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:10:04.057944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:04.058461 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:04.059444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:04.059873 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:10:04.060548 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:10:04.061053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:04.294447 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:04.313868 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:10:03.675759 => 16:10:04.313546
[0m16:10:04.315646 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:10:04.432916 [info ] [Thread-4 (]: 20 of 24 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.76s]
[0m16:10:04.433855 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:04.434385 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.434986 [info ] [Thread-4 (]: 24 of 24 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:10:04.435856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:10:04.436250 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.441305 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:10:04.442198 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:10:04.436475 => 16:10:04.442001
[0m16:10:04.442525 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.445070 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:10:04.446131 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:10:04.446485 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:04.446801 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:04.554174 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:04.554909 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:04.557137 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:10:04.047312 => 16:10:04.556904
[0m16:10:04.558812 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:10:04.055298 => 16:10:04.558617
[0m16:10:04.559195 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:10:04.559531 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:10:04.562843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:04.564472 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:10:04.051630 => 16:10:04.564277
[0m16:10:04.564901 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:10:04.678609 [info ] [Thread-2 (]: 22 of 24 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.65s]
[0m16:10:04.680933 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.679700 [info ] [Thread-3 (]: 21 of 24 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.65s]
[0m16:10:04.682136 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.683882 [info ] [Thread-1 (]: 23 of 24 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.65s]
[0m16:10:04.684468 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.820009 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:04.823497 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:10:04.442710 => 16:10:04.823133
[0m16:10:04.824039 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:10:04.946975 [info ] [Thread-4 (]: 24 of 24 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.51s]
[0m16:10:04.948094 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.951318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:04.951978 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeeid.a3468da3ee' was properly closed.
[0m16:10:04.952352 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_employee_employeekey.59d58b8331' was properly closed.
[0m16:10:04.952686 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_employee_employeeid.47069b1dff' was properly closed.
[0m16:10:04.953015 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:10:04.953437 [info ] [MainThread]: 
[0m16:10:04.953852 [info ] [MainThread]: Finished running 21 tests, 3 table models in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m16:10:04.957345 [debug] [MainThread]: Command end result
[0m16:10:04.970647 [info ] [MainThread]: 
[0m16:10:04.971075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:04.971361 [info ] [MainThread]: 
[0m16:10:04.971639 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m16:10:04.973566 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.330577, "process_user_time": 2.464758, "process_kernel_time": 0.28495, "process_mem_max_rss": "144162816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:10:04.973998 [debug] [MainThread]: Command `dbt build` succeeded at 16:10:04.973904 after 7.33 seconds
[0m16:10:04.974285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10037b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105978b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104def230>]}
[0m16:10:04.974559 [debug] [MainThread]: Flushing usage events
[0m16:11:04.858355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a2d0>]}


============================== 16:11:04.860844 | 5c5b5c32-4373-49ef-861a-7700ac801094 ==============================
[0m16:11:04.860844 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:11:04.861143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:05.051379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739a690>]}
[0m16:11:05.084129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727f080>]}
[0m16:11:05.084599 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:11:05.096136 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:11:05.130198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:11:05.130542 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_order_fulfillment.yml
[0m16:11:05.130711 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_order_fulfillment.sql
[0m16:11:05.249192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795d160>]}
[0m16:11:05.256414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107907b30>]}
[0m16:11:05.256643 [info ] [MainThread]: Found 23 tests, 4 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:11:05.257889 [info ] [MainThread]: 
[0m16:11:05.258283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:05.258868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:11:05.264918 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:11:05.265117 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:11:05.265266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:06.161922 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:11:06.164885 [debug] [ThreadPool]: On list_analytics: Close
[0m16:11:06.289732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:11:06.343028 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:11:06.343371 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:11:06.343559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:07.073530 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:11:07.077499 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:11:07.265531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fc590>]}
[0m16:11:07.266720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:07.267118 [info ] [MainThread]: 
[0m16:11:07.270835 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:07.271344 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.271818 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:07.272224 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.272641 [info ] [Thread-1 (]: 1 of 27 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:11:07.273113 [info ] [Thread-2 (]: 2 of 27 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:11:07.273536 [info ] [Thread-3 (]: 3 of 27 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:11:07.273947 [info ] [Thread-4 (]: 4 of 27 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:11:07.275114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:11:07.275744 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:11:07.276367 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:11:07.276963 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:11:07.277335 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:07.277710 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.278036 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:07.278332 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.293950 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:11:07.298832 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:11:07.301683 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:11:07.304312 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:11:07.305438 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:11:07.278563 => 16:11:07.305168
[0m16:11:07.305800 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:07.306165 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:11:07.299083 => 16:11:07.305958
[0m16:11:07.306468 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:11:07.301876 => 16:11:07.306320
[0m16:11:07.306817 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:11:07.294249 => 16:11:07.306624
[0m16:11:07.321336 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:11:07.321684 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:07.321924 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.322137 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.323920 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:11:07.326552 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:11:07.328008 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:11:07.328524 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:11:07.328982 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:11:07.329391 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:11:07.329774 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:11:07.329997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.330379 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:11:07.330584 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.330812 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.331439 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.331837 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:07.332047 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:07.332247 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:07.840061 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.841420 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.850053 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:11:07.326709 => 16:11:07.849735
[0m16:11:07.851943 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:11:07.324111 => 16:11:07.851741
[0m16:11:07.852344 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:11:07.852696 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:11:07.863525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.865729 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:11:07.322363 => 16:11:07.865481
[0m16:11:07.866123 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:11:07.867668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.869433 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:11:07.306971 => 16:11:07.869248
[0m16:11:07.869785 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:11:07.967822 [info ] [Thread-4 (]: 4 of 27 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.69s]
[0m16:11:07.968314 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.968605 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:07.968935 [info ] [Thread-4 (]: 5 of 27 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:11:07.969482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:11:07.969721 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:07.972983 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:11:07.973555 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:11:07.969854 => 16:11:07.973412
[0m16:11:07.973797 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:07.975598 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:11:07.976259 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:11:07.976493 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.976705 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:07.981521 [info ] [Thread-2 (]: 2 of 27 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.71s]
[0m16:11:07.981892 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.982153 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:07.982439 [info ] [Thread-2 (]: 6 of 27 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:11:07.982816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:11:07.983032 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:07.985676 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:11:07.986120 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:11:07.983155 => 16:11:07.985992
[0m16:11:07.986333 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:07.987923 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:11:07.988449 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:11:07.988658 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.988850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:08.000220 [info ] [Thread-1 (]: 1 of 27 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.73s]
[0m16:11:08.000611 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:08.000852 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.001143 [info ] [Thread-1 (]: 7 of 27 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:11:08.001574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:11:08.001795 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.004314 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:11:08.004775 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:11:08.001919 => 16:11:08.004646
[0m16:11:08.004982 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.006516 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:11:08.007071 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:11:08.007280 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:08.007465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:08.010994 [info ] [Thread-3 (]: 3 of 27 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.73s]
[0m16:11:08.011353 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:08.011596 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.011818 [info ] [Thread-3 (]: 8 of 27 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:11:08.012166 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:11:08.012353 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.014790 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:11:08.015227 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:11:08.012462 => 16:11:08.015112
[0m16:11:08.015416 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.017843 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:11:08.018449 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:11:08.018681 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:08.018889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:08.346857 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.351306 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:11:07.973933 => 16:11:08.350869
[0m16:11:08.352001 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:11:08.437481 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.442327 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:11:08.015525 => 16:11:08.441918
[0m16:11:08.444047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.444547 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:11:08.445660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.448750 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:11:07.986455 => 16:11:08.448421
[0m16:11:08.452309 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:11:08.005098 => 16:11:08.452034
[0m16:11:08.453078 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:11:08.453532 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:11:08.482380 [info ] [Thread-4 (]: 5 of 27 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.51s]
[0m16:11:08.483053 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:08.483572 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:08.484133 [info ] [Thread-4 (]: 9 of 27 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:11:08.484986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:11:08.485396 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:08.490359 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:11:08.492569 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:11:08.485627 => 16:11:08.492357
[0m16:11:08.492894 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:08.495527 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:11:08.496694 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:11:08.497007 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:08.497289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:08.564529 [info ] [Thread-1 (]: 7 of 27 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.56s]
[0m16:11:08.565071 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.565411 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:11:08.565804 [info ] [Thread-1 (]: 10 of 27 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:11:08.566386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m16:11:08.566685 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:11:08.569901 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:11:08.571313 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:11:08.566859 => 16:11:08.571158
[0m16:11:08.571560 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:11:08.588164 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:11:08.589583 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:11:08.589854 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:11:08.590612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:08.590402 [info ] [Thread-2 (]: 6 of 27 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.61s]
[0m16:11:08.591338 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:08.591783 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:11:08.592084 [info ] [Thread-2 (]: 11 of 27 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:11:08.592479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:11:08.592682 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:11:08.594323 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:11:08.595024 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:11:08.592800 => 16:11:08.594909
[0m16:11:08.595214 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:11:08.596776 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:11:08.597366 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:11:08.597574 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:11:08.597766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:08.835573 [info ] [Thread-3 (]: 8 of 27 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.82s]
[0m16:11:08.836386 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.836849 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m16:11:08.837392 [info ] [Thread-3 (]: 12 of 27 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:11:08.838266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m16:11:08.838718 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m16:11:08.843492 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:11:08.844306 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 16:11:08.838964 => 16:11:08.844118
[0m16:11:08.844615 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m16:11:08.849066 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:11:08.850259 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:11:08.850586 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:11:08.850902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:08.880981 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.882893 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:11:08.493076 => 16:11:08.882704
[0m16:11:08.883213 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:11:08.999484 [info ] [Thread-4 (]: 9 of 27 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.51s]
[0m16:11:09.000189 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:09.000640 [debug] [Thread-4 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:11:09.001094 [info ] [Thread-4 (]: 13 of 27 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:11:09.001760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:11:09.002089 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:11:09.007669 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:11:09.008294 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:11:09.002273 => 16:11:09.008125
[0m16:11:09.008566 [debug] [Thread-4 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:11:09.010742 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:11:09.012502 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:11:09.012871 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:11:09.013206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:09.310394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:09.332467 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:11:08.571705 => 16:11:09.332219
[0m16:11:09.333193 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:11:09.525740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cda030>]}
[0m16:11:09.526895 [info ] [Thread-1 (]: 10 of 27 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.96s]
[0m16:11:09.527603 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:11:09.528385 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:09.528932 [info ] [Thread-1 (]: 14 of 27 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:11:09.529779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:11:09.530189 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:09.534741 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:11:09.535655 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:09.537353 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:11:08.595334 => 16:11:09.537236
[0m16:11:09.537613 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:11:09.538325 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:11:09.530489 => 16:11:09.538189
[0m16:11:09.538717 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:09.540284 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:11:09.541040 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:11:09.541265 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:11:09.541494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:09.664981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a570>]}
[0m16:11:09.665870 [info ] [Thread-2 (]: 11 of 27 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.07s]
[0m16:11:09.666771 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:11:09.667270 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:09.667916 [info ] [Thread-2 (]: 15 of 27 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:11:09.668741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:11:09.669060 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:09.671546 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:11:09.672006 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:11:09.669190 => 16:11:09.671896
[0m16:11:09.672177 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:09.673560 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:11:09.674018 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:11:09.674191 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:11:09.674350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:10.436556 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:10.439577 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:11:09.538876 => 16:11:10.439266
[0m16:11:10.440085 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:11:10.443171 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:10.445277 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:11:09.672276 => 16:11:10.445070
[0m16:11:10.445612 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:11:10.536556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:11:10.540694 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 16:11:08.844798 => 16:11:10.540406
[0m16:11:10.541317 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m16:11:10.568550 [info ] [Thread-2 (]: 15 of 27 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.90s]
[0m16:11:10.569602 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:10.570104 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:10.570680 [info ] [Thread-2 (]: 16 of 27 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:11:10.571646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:11:10.572685 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:10.576318 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:11:10.576888 [info ] [Thread-1 (]: 14 of 27 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 1.05s]
[0m16:11:10.577392 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:10.577720 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:10.578028 [info ] [Thread-1 (]: 17 of 27 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:11:10.578318 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:11:10.573069 => 16:11:10.578186
[0m16:11:10.578669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:11:10.578899 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:10.579110 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:10.581838 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:11:10.584099 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:11:10.584713 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:11:10.584956 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:11:10.581995 => 16:11:10.584840
[0m16:11:10.585137 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:10.585399 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:10.585709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:10.587372 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:11:10.589040 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:11:10.589423 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:10.589672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:10.648235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef16390>]}
[0m16:11:10.648661 [info ] [Thread-3 (]: 12 of 27 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.81s]
[0m16:11:10.648973 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m16:11:10.649180 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:10.649424 [info ] [Thread-3 (]: 18 of 27 START test not_null_dim_date_date ..................................... [RUN]
[0m16:11:10.649895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:11:10.650124 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:10.652469 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:11:10.652886 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:11:10.650231 => 16:11:10.652782
[0m16:11:10.653057 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:10.654338 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:11:10.654770 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:11:10.654939 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:11:10.655099 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:10.889122 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:11:10.896645 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:11:09.008720 => 16:11:10.896484
[0m16:11:10.897767 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:11:11.046048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.049696 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:11:10.585909 => 16:11:11.049333
[0m16:11:11.051131 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d34e90>]}
[0m16:11:11.051983 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:11:11.052697 [info ] [Thread-4 (]: 13 of 27 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 2.05s]
[0m16:11:11.054067 [debug] [Thread-4 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:11:11.054780 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.055302 [info ] [Thread-4 (]: 19 of 27 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:11:11.055935 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:11:11.056276 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.061563 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:11:11.062877 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:11:11.056589 => 16:11:11.062658
[0m16:11:11.063194 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.065815 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:11:11.066782 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:11:11.067145 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:11:11.067461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:11.101168 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:11.103813 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:11:10.579235 => 16:11:11.103553
[0m16:11:11.104241 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:11:11.168203 [info ] [Thread-1 (]: 17 of 27 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.59s]
[0m16:11:11.168909 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:11.169317 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.169731 [info ] [Thread-1 (]: 20 of 27 START test unique_dim_date_date ....................................... [RUN]
[0m16:11:11.170405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:11:11.170718 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.174684 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:11:11.175455 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:11:11.170898 => 16:11:11.175271
[0m16:11:11.175746 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.177888 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:11:11.178677 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:11:11.178937 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.179177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:11.209064 [info ] [Thread-2 (]: 16 of 27 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.64s]
[0m16:11:11.209567 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:11.209880 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.210228 [info ] [Thread-2 (]: 21 of 27 START test unique_dim_date_datekey .................................... [RUN]
[0m16:11:11.210783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:11:11.211061 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.216075 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:11:11.216577 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:11:11.211226 => 16:11:11.216433
[0m16:11:11.216814 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.218646 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:11:11.219325 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:11:11.219584 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.219822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:11.280977 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:11.282363 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:11:10.653155 => 16:11:11.282220
[0m16:11:11.282591 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:11:11.466294 [info ] [Thread-3 (]: 18 of 27 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.82s]
[0m16:11:11.467219 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:11.467717 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:11.468270 [info ] [Thread-3 (]: 22 of 27 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:11:11.468989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:11:11.469346 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:11.474557 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:11:11.475673 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:11:11.469561 => 16:11:11.475417
[0m16:11:11.476060 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:11.478516 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:11:11.479396 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:11:11.479707 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:11:11.479987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:11.523722 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.525690 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:11:11.063372 => 16:11:11.525470
[0m16:11:11.526074 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:11:11.641789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.644223 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:11:11.175916 => 16:11:11.643973
[0m16:11:11.645562 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:11:11.645163 [info ] [Thread-4 (]: 19 of 27 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.59s]
[0m16:11:11.647224 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.647982 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:11.648488 [info ] [Thread-4 (]: 23 of 27 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:11:11.649628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:11:11.654853 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:11.658539 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:11:11.660095 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:11:11.655152 => 16:11:11.659817
[0m16:11:11.660485 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:11.663141 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:11:11.663889 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:11:11.664187 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:11:11.664490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:11.688504 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.690437 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:11:11.216955 => 16:11:11.690241
[0m16:11:11.690746 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:11:11.766260 [info ] [Thread-1 (]: 20 of 27 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.60s]
[0m16:11:11.766793 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.767125 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:11.767479 [info ] [Thread-1 (]: 24 of 27 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:11:11.768082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:11:11.768372 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:11.772143 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:11:11.772805 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:11:11.768552 => 16:11:11.772634
[0m16:11:11.773167 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:11.775400 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:11:11.776222 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:11:11.776496 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.776759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:11.803709 [info ] [Thread-2 (]: 21 of 27 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.59s]
[0m16:11:11.804217 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.804529 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:11.804856 [info ] [Thread-2 (]: 25 of 27 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:11:11.805368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:11:11.805609 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:11.808660 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:11:11.809172 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:11:11.805752 => 16:11:11.809027
[0m16:11:11.809411 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:11.812707 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:11:11.813425 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:11:11.813683 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.813924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:11.923179 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.925264 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:11:11.476279 => 16:11:11.925025
[0m16:11:11.925783 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:11:12.039917 [info ] [Thread-3 (]: 22 of 27 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.57s]
[0m16:11:12.040607 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:12.041047 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.041514 [info ] [Thread-3 (]: 26 of 27 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:11:12.042262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:11:12.042641 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.047204 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:11:12.048066 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:11:12.042869 => 16:11:12.047873
[0m16:11:12.048386 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.050899 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:11:12.055764 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:11:12.056130 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:11:12.056402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:12.141669 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.145542 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:11:11.660700 => 16:11:12.145357
[0m16:11:12.146113 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:11:12.189099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.191154 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:11:11.773374 => 16:11:12.190905
[0m16:11:12.191532 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:11:12.248399 [info ] [Thread-4 (]: 23 of 27 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.60s]
[0m16:11:12.248948 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:12.249275 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.249614 [info ] [Thread-4 (]: 27 of 27 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:11:12.250194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:11:12.250546 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.255077 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:11:12.255830 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:11:12.250774 => 16:11:12.255636
[0m16:11:12.256159 [debug] [Thread-4 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.258589 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:11:12.259753 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.261685 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:11:11.809560 => 16:11:12.261467
[0m16:11:12.262013 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:11:12.262646 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:11:12.263669 [debug] [Thread-4 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:12.264198 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:12.323735 [info ] [Thread-1 (]: 24 of 27 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.56s]
[0m16:11:12.324246 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:12.454262 [info ] [Thread-2 (]: 25 of 27 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.65s]
[0m16:11:12.455509 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:12.501224 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.503790 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:11:12.048592 => 16:11:12.503532
[0m16:11:12.504325 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:11:12.624351 [info ] [Thread-3 (]: 26 of 27 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.58s]
[0m16:11:12.625556 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.722281 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.726708 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:11:12.256352 => 16:11:12.726257
[0m16:11:12.727396 [debug] [Thread-4 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:11:12.845734 [info ] [Thread-4 (]: 27 of 27 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:11:12.847721 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.850375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:12.850828 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeeid.a3468da3ee' was properly closed.
[0m16:11:12.851157 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:11:12.851415 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:11:12.851669 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:11:12.852023 [info ] [MainThread]: 
[0m16:11:12.852363 [info ] [MainThread]: Finished running 23 tests, 4 table models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m16:11:12.855847 [debug] [MainThread]: Command end result
[0m16:11:12.869473 [info ] [MainThread]: 
[0m16:11:12.869916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:12.870193 [info ] [MainThread]: 
[0m16:11:12.870458 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m16:11:12.872215 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.041116, "process_user_time": 2.478925, "process_kernel_time": 0.262149, "process_mem_max_rss": "144326656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:11:12.872561 [debug] [MainThread]: Command `dbt build` succeeded at 16:11:12.872490 after 8.04 seconds
[0m16:11:12.873013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3a870>]}
[0m16:11:12.873262 [debug] [MainThread]: Flushing usage events
[0m16:12:01.676042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e22030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eedf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102063f0>]}


============================== 16:12:01.678567 | 9d50b7b7-5a17-4b0a-9486-2f521da28a94 ==============================
[0m16:12:01.678567 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:12:01.678877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:01.869989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ed0d0>]}
[0m16:12:01.902955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e94560>]}
[0m16:12:01.903420 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:12:01.915481 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:12:01.949921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:12:01.950227 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_order_fulfillment.sql
[0m16:12:01.950401 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_order_fulfillment.yml
[0m16:12:02.027588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111187470>]}
[0m16:12:02.034953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f20650>]}
[0m16:12:02.035171 [info ] [MainThread]: Found 23 tests, 5 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:12:02.036452 [info ] [MainThread]: 
[0m16:12:02.036824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:02.037421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:12:02.043433 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:12:02.043612 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:12:02.043757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:02.815453 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:12:02.819261 [debug] [ThreadPool]: On list_analytics: Close
[0m16:12:02.955725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:12:02.965909 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:12:02.966324 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:12:02.966610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:03.411632 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:12:03.415858 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:12:03.535241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd8c80>]}
[0m16:12:03.536725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:03.537614 [info ] [MainThread]: 
[0m16:12:03.541236 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:03.541708 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:03.542133 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:03.542524 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:03.542920 [info ] [Thread-1 (]: 1 of 28 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:12:03.543344 [info ] [Thread-2 (]: 2 of 28 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:12:03.543748 [info ] [Thread-3 (]: 3 of 28 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:12:03.544259 [info ] [Thread-4 (]: 4 of 28 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:12:03.545124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:12:03.546221 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:12:03.546887 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:12:03.547473 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:12:03.547792 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:03.548088 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:03.548372 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:03.548651 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:03.564170 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:12:03.568768 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:12:03.572671 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:12:03.605543 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:12:03.607840 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:12:03.564443 => 16:12:03.607702
[0m16:12:03.608084 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:03.608361 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:12:03.572873 => 16:12:03.608220
[0m16:12:03.608588 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:12:03.548852 => 16:12:03.608476
[0m16:12:03.608788 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:12:03.568993 => 16:12:03.608688
[0m16:12:03.619710 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:12:03.619967 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:03.620179 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:03.620369 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:03.621789 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:12:03.623186 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:12:03.623581 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:12:03.624833 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:12:03.625121 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:03.625570 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:12:03.625782 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:03.625998 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:03.626354 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:12:03.626693 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:12:03.627181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:12:03.627393 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:03.627771 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:12:03.628203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:12:03.628584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.091451 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.103712 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:12:03.620554 => 16:12:04.103381
[0m16:12:04.104948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.105387 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:12:04.107510 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:12:03.608912 => 16:12:04.107272
[0m16:12:04.108727 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:12:04.279910 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:04.280974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:04.284364 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:12:03.623708 => 16:12:04.283989
[0m16:12:04.286040 [info ] [Thread-2 (]: 2 of 28 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.74s]
[0m16:12:04.287205 [info ] [Thread-4 (]: 4 of 28 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.74s]
[0m16:12:04.289843 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:12:03.621943 => 16:12:04.289559
[0m16:12:04.290288 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:12:04.290841 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:04.291336 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:04.291707 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:12:04.293220 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.294234 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.295614 [info ] [Thread-2 (]: 5 of 28 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:12:04.296201 [info ] [Thread-4 (]: 6 of 28 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:12:04.296943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:12:04.297850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:12:04.298710 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.299511 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.304450 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:12:04.307980 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:12:04.308778 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:12:04.299757 => 16:12:04.308582
[0m16:12:04.309138 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:12:04.300620 => 16:12:04.308961
[0m16:12:04.309406 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.309681 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.311873 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:12:04.315106 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:12:04.315902 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:12:04.316424 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:12:04.316720 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.317015 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.317279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:04.317507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:04.409810 [info ] [Thread-3 (]: 3 of 28 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.86s]
[0m16:12:04.410341 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:04.410661 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.411253 [info ] [Thread-3 (]: 7 of 28 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:12:04.411814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:12:04.412126 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.415506 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:12:04.416102 [info ] [Thread-1 (]: 1 of 28 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.87s]
[0m16:12:04.416641 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:04.416992 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.417303 [info ] [Thread-1 (]: 8 of 28 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:12:04.417645 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:12:04.412287 => 16:12:04.417482
[0m16:12:04.418094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:12:04.418364 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.418603 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.420680 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:12:04.423394 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:12:04.424077 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:12:04.424372 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:12:04.420865 => 16:12:04.424227
[0m16:12:04.424603 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.424846 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.425052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:04.426771 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:12:04.427958 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:12:04.428201 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.428421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.667583 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.671409 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:12:04.309852 => 16:12:04.670952
[0m16:12:04.672060 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:12:04.674702 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.676863 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:12:04.312094 => 16:12:04.676607
[0m16:12:04.677349 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:12:04.804255 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.810182 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:12:04.418753 => 16:12:04.809764
[0m16:12:04.811671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.812216 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:12:04.814929 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:12:04.425192 => 16:12:04.814679
[0m16:12:04.817113 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:12:04.875865 [info ] [Thread-2 (]: 5 of 28 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.58s]
[0m16:12:04.877331 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.877947 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:04.879186 [info ] [Thread-2 (]: 9 of 28 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:12:04.880302 [info ] [Thread-4 (]: 6 of 28 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.58s]
[0m16:12:04.882306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:12:04.882935 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.883330 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:04.883767 [debug] [Thread-4 (]: Began running node model.northwind.dim_date
[0m16:12:04.886131 [info ] [Thread-4 (]: 10 of 28 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:12:04.890311 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:12:04.891049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:12:04.893515 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_date
[0m16:12:04.896707 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:12:04.897392 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:12:04.884082 => 16:12:04.897146
[0m16:12:04.897773 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:04.898163 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (compile): 16:12:04.893804 => 16:12:04.897931
[0m16:12:04.900737 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:12:04.901158 [debug] [Thread-4 (]: Began executing node model.northwind.dim_date
[0m16:12:04.919769 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:12:04.920358 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:12:04.920733 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.921001 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:04.921646 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:12:04.922105 [debug] [Thread-4 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:12:04.922512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:04.939256 [info ] [Thread-1 (]: 8 of 28 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.52s]
[0m16:12:04.939808 [info ] [Thread-3 (]: 7 of 28 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.53s]
[0m16:12:04.940316 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.940658 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.940936 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:12:04.941305 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m16:12:04.941631 [info ] [Thread-1 (]: 11 of 28 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:12:04.941924 [info ] [Thread-3 (]: 12 of 28 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:12:04.942335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:12:04.942710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:12:04.942928 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:12:04.943126 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m16:12:04.953132 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:12:04.955659 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:12:04.956619 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:12:04.943255 => 16:12:04.956464
[0m16:12:04.956887 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 16:12:04.953351 => 16:12:04.956760
[0m16:12:04.957088 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:12:04.957283 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m16:12:04.958795 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:12:04.960198 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:12:04.960728 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:12:04.960934 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:12:04.961670 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:12:04.961887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.962109 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:12:04.962659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:05.333316 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:05.338958 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:12:04.898377 => 16:12:05.338548
[0m16:12:05.339731 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:12:05.458733 [info ] [Thread-2 (]: 9 of 28 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.58s]
[0m16:12:05.459233 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:05.459508 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:12:05.459847 [info ] [Thread-2 (]: 13 of 28 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:12:05.460289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:12:05.460514 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:12:05.464163 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:12:05.464905 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:12:05.460637 => 16:12:05.464738
[0m16:12:05.465141 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:12:05.466855 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:12:05.468201 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:12:05.468466 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:12:05.468709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:05.850517 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:05.873247 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 16:12:04.958929 => 16:12:05.873021
[0m16:12:05.873747 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m16:12:05.992624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11334e930>]}
[0m16:12:05.993726 [info ] [Thread-3 (]: 12 of 28 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.05s]
[0m16:12:05.994517 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m16:12:05.995794 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:05.996409 [info ] [Thread-3 (]: 14 of 28 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:12:05.997366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:12:05.997825 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:06.005648 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:12:06.006680 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:12:05.998099 => 16:12:06.006449
[0m16:12:06.007064 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:06.011497 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:12:06.012648 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:12:06.012977 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:12:06.013277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:06.055247 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:06.055951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:06.059058 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (execute): 16:12:04.901516 => 16:12:06.058858
[0m16:12:06.061206 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:12:04.957401 => 16:12:06.061030
[0m16:12:06.061677 [debug] [Thread-4 (]: On model.northwind.dim_date: Close
[0m16:12:06.062232 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:12:06.175081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111184770>]}
[0m16:12:06.175722 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111227b60>]}
[0m16:12:06.176231 [info ] [Thread-1 (]: 11 of 28 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.23s]
[0m16:12:06.177067 [info ] [Thread-4 (]: 10 of 28 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.28s]
[0m16:12:06.177774 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:12:06.178352 [debug] [Thread-4 (]: Finished running node model.northwind.dim_date
[0m16:12:06.178792 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:06.179345 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:06.179811 [info ] [Thread-1 (]: 15 of 28 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:12:06.180149 [info ] [Thread-4 (]: 16 of 28 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:12:06.180694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:12:06.181172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:12:06.181437 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:06.181658 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:06.184968 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:12:06.187825 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:12:06.188443 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:12:06.185197 => 16:12:06.188287
[0m16:12:06.188755 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:12:06.181823 => 16:12:06.188606
[0m16:12:06.188986 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:06.189227 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:06.190953 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:12:06.192606 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:12:06.193425 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:12:06.193871 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:12:06.194224 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:06.197752 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:12:06.198109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:06.198397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:06.769694 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:06.772812 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:12:06.007274 => 16:12:06.772410
[0m16:12:06.773396 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:12:06.963566 [info ] [Thread-3 (]: 14 of 28 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.97s]
[0m16:12:06.964470 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:06.964955 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:06.965492 [info ] [Thread-3 (]: 17 of 28 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:12:06.966372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:12:06.966805 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:06.971766 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:12:06.972627 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:12:06.967056 => 16:12:06.972417
[0m16:12:06.972973 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:06.975570 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:12:06.976533 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:12:06.976887 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:06.977207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:07.108414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:07.111110 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:12:06.191109 => 16:12:07.110823
[0m16:12:07.111600 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:12:07.113785 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:07.116171 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:12:06.189376 => 16:12:07.115943
[0m16:12:07.116601 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:12:07.236230 [info ] [Thread-1 (]: 15 of 28 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 1.06s]
[0m16:12:07.237707 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:07.238223 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:07.238777 [info ] [Thread-1 (]: 18 of 28 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:12:07.239695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:12:07.240105 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:07.240952 [info ] [Thread-4 (]: 16 of 28 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 1.06s]
[0m16:12:07.246057 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:12:07.246620 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:07.247095 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:07.247500 [info ] [Thread-4 (]: 19 of 28 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:12:07.248115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:12:07.248435 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:07.252190 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:12:07.252574 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:12:07.241291 => 16:12:07.252385
[0m16:12:07.252934 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:07.256774 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:12:07.257247 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:12:07.248667 => 16:12:07.257077
[0m16:12:07.257563 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:07.259563 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:12:07.260113 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:12:07.261584 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:12:07.262114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:07.262623 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:12:07.263283 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:12:07.263792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:07.422408 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.425252 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:12:06.973173 => 16:12:07.424935
[0m16:12:07.425910 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:12:07.428883 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:12:07.431634 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:12:05.465270 => 16:12:07.431402
[0m16:12:07.432135 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:12:07.560590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c65310>]}
[0m16:12:07.561947 [info ] [Thread-2 (]: 13 of 28 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 2.10s]
[0m16:12:07.563057 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:12:07.563626 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:07.564313 [info ] [Thread-2 (]: 20 of 28 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:12:07.565274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:12:07.565707 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:07.571127 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:12:07.575213 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:12:07.565975 => 16:12:07.574948
[0m16:12:07.575974 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:07.578793 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:12:07.581054 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:12:07.581391 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:07.582348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:07.582087 [info ] [Thread-3 (]: 17 of 28 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.62s]
[0m16:12:07.583215 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:07.583761 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:07.584121 [info ] [Thread-3 (]: 21 of 28 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:12:07.584657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:12:07.584942 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:07.588506 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:12:07.589332 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:12:07.585135 => 16:12:07.589183
[0m16:12:07.589575 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:07.591417 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:12:07.592149 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:12:07.592406 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:07.592663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:07.714201 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.716397 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:12:07.257745 => 16:12:07.716184
[0m16:12:07.716787 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:12:07.718234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.720304 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:12:07.253119 => 16:12:07.720072
[0m16:12:07.720726 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:12:07.969243 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.973538 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:12:07.576288 => 16:12:07.973158
[0m16:12:07.974133 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:12:08.088879 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.092109 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:12:07.589719 => 16:12:08.091795
[0m16:12:08.093704 [info ] [Thread-1 (]: 18 of 28 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.85s]
[0m16:12:08.094906 [info ] [Thread-2 (]: 20 of 28 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.53s]
[0m16:12:08.096679 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:12:08.096191 [info ] [Thread-4 (]: 19 of 28 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.85s]
[0m16:12:08.097345 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:08.097856 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:08.099392 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:08.100160 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.100715 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.101207 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.101650 [info ] [Thread-1 (]: 22 of 28 START test not_null_dim_date_date ..................................... [RUN]
[0m16:12:08.102502 [info ] [Thread-2 (]: 23 of 28 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:12:08.103013 [info ] [Thread-4 (]: 24 of 28 START test unique_dim_date_date ....................................... [RUN]
[0m16:12:08.103669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:12:08.104318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:12:08.104841 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:12:08.105151 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.105428 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.105700 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.110890 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:12:08.114188 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:12:08.117347 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:12:08.118216 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:12:08.107080 => 16:12:08.118013
[0m16:12:08.118522 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:12:08.105900 => 16:12:08.118388
[0m16:12:08.118844 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.119172 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:12:08.114448 => 16:12:08.119011
[0m16:12:08.119442 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.122799 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:12:08.123087 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.124869 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:12:08.126777 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:12:08.127390 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:12:08.127925 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:12:08.128158 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:12:08.128657 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:12:08.128864 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:12:08.129105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:08.129328 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:08.129553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:08.130238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:08.210377 [info ] [Thread-3 (]: 21 of 28 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.63s]
[0m16:12:08.210809 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:08.211067 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:08.211357 [info ] [Thread-3 (]: 25 of 28 START test unique_dim_date_datekey .................................... [RUN]
[0m16:12:08.211835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:12:08.212061 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:08.214868 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:12:08.215380 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:12:08.212194 => 16:12:08.215243
[0m16:12:08.215611 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:08.217413 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:12:08.218086 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:12:08.218342 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:08.218566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:08.613447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.619016 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:12:08.123248 => 16:12:08.618572
[0m16:12:08.620431 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.620887 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:12:08.624148 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:12:08.119597 => 16:12:08.623755
[0m16:12:08.626018 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:12:08.637544 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:08.639735 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:12:08.125116 => 16:12:08.639489
[0m16:12:08.640143 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:12:08.701419 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.705696 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:12:08.215742 => 16:12:08.705302
[0m16:12:08.706377 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:12:08.750833 [info ] [Thread-4 (]: 24 of 28 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.65s]
[0m16:12:08.751809 [info ] [Thread-1 (]: 22 of 28 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.65s]
[0m16:12:08.752738 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.754011 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.754695 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:08.755406 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:08.756021 [info ] [Thread-4 (]: 26 of 28 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:12:08.757574 [info ] [Thread-1 (]: 27 of 28 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:12:08.758870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:12:08.759673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:12:08.760649 [info ] [Thread-2 (]: 23 of 28 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.66s]
[0m16:12:08.761478 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:08.762507 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:08.763265 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.769487 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:12:08.772223 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:12:08.773045 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:12:08.763580 => 16:12:08.772862
[0m16:12:08.773409 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:12:08.765767 => 16:12:08.773232
[0m16:12:08.773678 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:08.773965 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:08.776241 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:12:08.778431 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:12:08.779242 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:12:08.779832 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:12:08.780160 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:12:08.780485 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:08.780746 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:08.780963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:08.818500 [info ] [Thread-3 (]: 25 of 28 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.61s]
[0m16:12:08.819027 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:09.319615 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:09.321090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:09.324757 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:12:08.774139 => 16:12:09.324325
[0m16:12:09.326979 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:12:08.776439 => 16:12:09.326740
[0m16:12:09.327435 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:12:09.327809 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:12:09.523117 [info ] [Thread-1 (]: 27 of 28 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.76s]
[0m16:12:09.524148 [info ] [Thread-4 (]: 26 of 28 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.77s]
[0m16:12:09.525077 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:09.525736 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:09.526479 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:12:09.526847 [info ] [Thread-2 (]: 28 of 28 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:12:09.527325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now model.northwind.obt_order_fulfillment)
[0m16:12:09.527536 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:12:09.531565 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:12:09.532260 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:12:09.527654 => 16:12:09.532132
[0m16:12:09.532463 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:12:09.534172 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:12:09.535213 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:12:09.535450 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:12:09.535670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:10.344277 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:10.350995 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:12:09.532586 => 16:12:10.350651
[0m16:12:10.351662 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:12:10.459636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114928fb0>]}
[0m16:12:10.460135 [info ] [Thread-2 (]: 28 of 28 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.93s]
[0m16:12:10.460507 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:12:10.461703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:10.461880 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:12:10.462025 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:12:10.462159 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:12:10.462297 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:12:10.462516 [info ] [MainThread]: 
[0m16:12:10.462691 [info ] [MainThread]: Finished running 23 tests, 5 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m16:12:10.464605 [debug] [MainThread]: Command end result
[0m16:12:10.471796 [info ] [MainThread]: 
[0m16:12:10.472073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:10.472249 [info ] [MainThread]: 
[0m16:12:10.472417 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m16:12:10.473901 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.829991, "process_user_time": 2.659895, "process_kernel_time": 0.294405, "process_mem_max_rss": "145031168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:12:10.474264 [debug] [MainThread]: Command `dbt build` succeeded at 16:12:10.474191 after 8.83 seconds
[0m16:12:10.474484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c33320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c683e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c68aa0>]}
[0m16:12:10.474690 [debug] [MainThread]: Flushing usage events
[0m16:41:30.614391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a63770>]}


============================== 16:41:30.617020 | ee250c41-e48a-433b-8602-e97d8d43fdaa ==============================
[0m16:41:30.617020 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:41:30.617349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m16:41:30.833851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f24b0>]}
[0m16:41:30.867359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ab470>]}
[0m16:41:30.867872 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:41:30.879777 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:41:30.923216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m16:41:30.923663 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_sales.yml
[0m16:41:30.923851 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_sales.yml
[0m16:41:30.923995 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_sales.sql
[0m16:41:30.924132 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_sales.sql
[0m16:41:31.046993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107034ad0>]}
[0m16:41:31.053883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c287a0>]}
[0m16:41:31.054093 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:41:31.055415 [info ] [MainThread]: 
[0m16:41:31.055807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:31.056436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:41:31.062389 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:41:31.062572 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:41:31.062711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:33.495919 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:41:33.498504 [debug] [ThreadPool]: On list_analytics: Close
[0m16:41:33.710383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:41:33.720782 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:41:33.721123 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:41:33.721392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:34.323636 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:41:34.327630 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:41:34.454658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107035610>]}
[0m16:41:34.455930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:34.456322 [info ] [MainThread]: 
[0m16:41:34.460068 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:34.460540 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:34.460942 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:34.461344 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:34.461728 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:41:34.462144 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:41:34.462529 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:41:34.462892 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:41:34.464073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:41:34.464844 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:41:34.465530 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:41:34.466166 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:41:34.466518 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:34.466833 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:34.467124 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:34.467411 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:34.482193 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:41:34.486820 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:41:34.489610 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:41:34.493296 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:41:34.493993 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:41:34.482468 => 16:41:34.493836
[0m16:41:34.494330 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:41:34.467607 => 16:41:34.494134
[0m16:41:34.494684 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:41:34.487077 => 16:41:34.494506
[0m16:41:34.494950 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:34.495200 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:34.495492 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:41:34.489800 => 16:41:34.495344
[0m16:41:34.495710 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:34.508648 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:41:34.510168 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:41:34.510383 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:34.511794 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:41:34.513510 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:41:34.513963 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:41:34.514423 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:41:34.514736 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:34.515196 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:41:34.515459 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:41:34.515874 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:41:34.516066 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:34.516266 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:34.516472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:34.516666 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:34.517206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:34.517941 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:34.883122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:34.884294 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:34.895395 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:41:34.508785 => 16:41:34.895006
[0m16:41:34.897639 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:41:34.512076 => 16:41:34.897397
[0m16:41:34.898099 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:41:34.898482 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:41:35.069025 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.61s]
[0m16:41:35.070143 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:35.070701 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.071396 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:41:35.072446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:41:35.072946 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.077996 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:41:35.079040 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:41:35.073217 => 16:41:35.078801
[0m16:41:35.079396 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.081975 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:41:35.082978 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:41:35.083340 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.083671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:35.228064 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.76s]
[0m16:41:35.228913 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:35.229357 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:35.229939 [info ] [Thread-4 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:41:35.230750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:41:35.231119 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:35.235908 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:41:35.236734 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:41:35.231335 => 16:41:35.236531
[0m16:41:35.237052 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:35.241095 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:41:35.242010 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:41:35.242346 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.242623 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:35.250766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:35.252841 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:41:34.495852 => 16:41:35.252652
[0m16:41:35.256253 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:41:35.263948 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:35.265457 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:41:34.510507 => 16:41:35.265284
[0m16:41:35.265743 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:41:35.415164 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.95s]
[0m16:41:35.416026 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:35.416555 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.417135 [info ] [Thread-3 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:41:35.417902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:41:35.418289 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.423177 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:41:35.423950 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:41:35.418512 => 16:41:35.423753
[0m16:41:35.424274 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.426738 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:41:35.427795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.429691 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:41:35.079588 => 16:41:35.429466
[0m16:41:35.430090 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:41:35.431503 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:41:35.432038 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.432386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:35.591612 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.52s]
[0m16:41:35.592511 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.593055 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:35.593747 [info ] [Thread-1 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:41:35.594720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:41:35.595166 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:35.600083 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:41:35.600931 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:41:35.595396 => 16:41:35.600702
[0m16:41:35.601265 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:35.603792 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:41:35.604793 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:41:35.605157 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.605483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:35.669180 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 1.20s]
[0m16:41:35.669714 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:35.670010 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:35.670321 [info ] [Thread-2 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:41:35.670887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:41:35.671131 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:35.674308 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:41:35.674869 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:41:35.671273 => 16:41:35.674720
[0m16:41:35.675123 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:35.677030 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:41:35.678063 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:41:35.678306 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.678537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:35.812828 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.814843 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:41:35.424458 => 16:41:35.814614
[0m16:41:35.815210 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:41:35.947725 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:35.952714 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:41:35.237234 => 16:41:35.952289
[0m16:41:35.953347 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:41:35.957392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.959915 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:41:35.601445 => 16:41:35.959644
[0m16:41:35.960904 [info ] [Thread-3 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.54s]
[0m16:41:35.961564 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:41:35.962232 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.963583 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m16:41:35.964274 [info ] [Thread-3 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:41:35.964973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m16:41:35.965310 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m16:41:35.969202 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:41:35.970400 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 16:41:35.965537 => 16:41:35.970207
[0m16:41:35.970680 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m16:41:35.989760 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:41:35.990534 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:41:35.990768 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:41:35.990984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:36.117066 [info ] [Thread-4 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.89s]
[0m16:41:36.117835 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:36.118285 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:41:36.118867 [info ] [Thread-4 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:41:36.119660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_employee)
[0m16:41:36.120093 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:41:36.124710 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:41:36.125442 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:41:36.120333 => 16:41:36.125248
[0m16:41:36.125758 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:41:36.128246 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:41:36.129658 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:41:36.130048 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:41:36.130391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:36.170188 [info ] [Thread-1 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.58s]
[0m16:41:36.170788 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:36.171155 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:41:36.171575 [info ] [Thread-1 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:41:36.172201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m16:41:36.172613 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:41:36.175471 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:41:36.176238 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:41:36.172869 => 16:41:36.175991
[0m16:41:36.176557 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:41:36.178745 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:41:36.179639 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:41:36.179985 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:41:36.180573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:36.488114 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:36.492703 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:41:35.675264 => 16:41:36.492390
[0m16:41:36.493363 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:41:36.692047 [info ] [Thread-2 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 1.02s]
[0m16:41:36.693216 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:36.693812 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m16:41:36.694549 [info ] [Thread-2 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:41:36.695562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_sales)
[0m16:41:36.696051 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m16:41:36.704492 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:41:36.705484 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 16:41:36.696338 => 16:41:36.705271
[0m16:41:36.705841 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m16:41:36.708509 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:41:36.710265 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:41:36.710651 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(ProductID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        Quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid;
[0m16:41:36.710972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:37.171893 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c555-0000-17c7-0009-ec83000201b2
[0m16:41:37.172667 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 55 unexpected ';'.
[0m16:41:37.173330 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 16:41:36.706038 => 16:41:37.173067
[0m16:41:37.173802 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m16:41:37.298588 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 55 unexpected ';'.
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:41:37.299335 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198b3b90>]}
[0m16:41:37.299974 [error] [Thread-2 (]: 13 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.60s]
[0m16:41:37.300581 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m16:41:37.301009 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:41:37.301630 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:41:37.302415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now model.northwind.fact_order_fulfillment)
[0m16:41:37.302806 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:41:37.308485 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:41:37.309599 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:41:37.303011 => 16:41:37.309337
[0m16:41:37.309979 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:41:37.314384 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:41:37.316224 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:41:37.316622 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:41:37.316965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:37.597286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:37.619856 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:41:36.176734 => 16:41:37.619621
[0m16:41:37.620366 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:41:37.687689 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:37.691426 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:41:36.125936 => 16:41:37.691134
[0m16:41:37.691908 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:41:37.931222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d09970>]}
[0m16:41:37.932298 [info ] [Thread-1 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.76s]
[0m16:41:37.933378 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:41:37.934272 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:41:37.935023 [info ] [Thread-1 (]: 15 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:41:37.935857 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:41:37.936383 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:41:37.936902 [info ] [Thread-1 (]: 16 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:41:37.937334 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:41:37.937718 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:37.938114 [info ] [Thread-1 (]: 17 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:41:37.938903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:41:37.939271 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:37.947193 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:41:37.948126 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:41:37.939491 => 16:41:37.947883
[0m16:41:37.948464 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:37.950880 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:41:37.951574 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:41:37.951857 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:41:37.952123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:38.048338 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ca3f0>]}
[0m16:41:38.049007 [info ] [Thread-4 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.93s]
[0m16:41:38.049533 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:41:38.049893 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:38.050310 [info ] [Thread-4 (]: 18 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:41:38.051066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:41:38.051359 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:38.055144 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:41:38.055836 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:41:38.051524 => 16:41:38.055666
[0m16:41:38.056120 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:38.058298 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:41:38.059094 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:41:38.059378 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:41:38.059922 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:38.098448 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:38.100688 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 16:41:35.970863 => 16:41:38.100520
[0m16:41:38.100993 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m16:41:38.293735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e3020>]}
[0m16:41:38.295075 [info ] [Thread-3 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 2.33s]
[0m16:41:38.296136 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m16:41:38.296692 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:38.297375 [info ] [Thread-3 (]: 19 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:41:38.298450 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:41:38.299021 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:38.304340 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:41:38.305440 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:41:38.299335 => 16:41:38.305081
[0m16:41:38.305959 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:38.308802 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:41:38.310011 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:41:38.310438 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:38.310869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:38.525924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:38.533550 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:41:37.310186 => 16:41:38.533142
[0m16:41:38.534283 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:41:38.748095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198c95e0>]}
[0m16:41:38.749258 [info ] [Thread-2 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.45s]
[0m16:41:38.750552 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:41:38.751228 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:38.751919 [info ] [Thread-2 (]: 20 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:41:38.753018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:41:38.753547 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:38.758913 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:41:38.760073 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:41:38.753789 => 16:41:38.759870
[0m16:41:38.760408 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:38.765414 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:41:38.766799 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:41:38.767209 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:38.767530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:39.567154 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:39.572972 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:41:38.306198 => 16:41:39.572587
[0m16:41:39.573662 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:41:39.616547 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:39.617676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:39.620892 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:41:38.056284 => 16:41:39.620576
[0m16:41:39.623496 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:41:37.948652 => 16:41:39.623216
[0m16:41:39.623987 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:41:39.624442 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:41:39.692827 [info ] [Thread-3 (]: 19 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.39s]
[0m16:41:39.694131 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:39.695029 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:39.695736 [info ] [Thread-3 (]: 21 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:41:39.696832 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:41:39.697329 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:39.702759 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:41:39.703772 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:41:39.697607 => 16:41:39.703568
[0m16:41:39.704084 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:39.706634 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:41:39.707557 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:41:39.707892 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:41:39.708210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:39.787251 [info ] [Thread-4 (]: 18 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.74s]
[0m16:41:39.787878 [info ] [Thread-1 (]: 17 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 1.85s]
[0m16:41:39.788464 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:39.788840 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:39.789129 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:39.789452 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:39.789767 [info ] [Thread-4 (]: 22 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:41:39.790072 [info ] [Thread-1 (]: 23 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:41:39.790542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:41:39.790960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:41:39.791200 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:39.791423 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:39.794543 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:41:39.797238 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:41:39.797828 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:41:39.791564 => 16:41:39.797683
[0m16:41:39.798132 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:41:39.794736 => 16:41:39.797969
[0m16:41:39.798381 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:39.798610 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:39.800343 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:41:39.801959 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:41:39.802526 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:41:39.802761 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:41:39.802984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:39.803417 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:41:39.804064 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:39.804494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:39.993677 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:39.995765 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:41:38.760608 => 16:41:39.995543
[0m16:41:39.996134 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:41:40.162805 [info ] [Thread-2 (]: 20 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 1.41s]
[0m16:41:40.164124 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:40.164716 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.165426 [info ] [Thread-2 (]: 24 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:41:40.166124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:41:40.166403 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.170042 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:41:40.170957 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:40.172814 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:41:39.704273 => 16:41:40.172612
[0m16:41:40.173165 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:41:40.173531 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:41:40.166556 => 16:41:40.173335
[0m16:41:40.174630 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.177238 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:41:40.178162 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:41:40.178492 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:40.178849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:40.412909 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:40.414268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:40.417075 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:41:39.798749 => 16:41:40.416763
[0m16:41:40.419061 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:41:39.800498 => 16:41:40.418827
[0m16:41:40.419508 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:41:40.419879 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:41:40.426055 [info ] [Thread-3 (]: 21 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.73s]
[0m16:41:40.426988 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:40.427700 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:40.428242 [info ] [Thread-3 (]: 25 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:41:40.428944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:41:40.429276 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:40.435679 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:41:40.436384 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:41:40.429468 => 16:41:40.436206
[0m16:41:40.436668 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:40.439005 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:41:40.439862 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:41:40.440198 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:41:40.440472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:40.639371 [info ] [Thread-1 (]: 23 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.85s]
[0m16:41:40.640252 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:40.640785 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:40.641316 [info ] [Thread-1 (]: 26 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:41:40.642088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:41:40.642477 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:40.647439 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:41:40.649111 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:41:40.642735 => 16:41:40.648905
[0m16:41:40.649440 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:40.651979 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:41:40.653492 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:41:40.653900 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:41:40.654219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:40.709734 [info ] [Thread-4 (]: 22 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.92s]
[0m16:41:40.710252 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:40.710566 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:40.710919 [info ] [Thread-4 (]: 27 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:41:40.711511 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:41:40.711807 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:40.715375 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:41:40.716030 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:41:40.711981 => 16:41:40.715866
[0m16:41:40.716393 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:40.718450 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:41:40.719190 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:41:40.719464 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:40.719723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:40.729793 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:40.731341 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:41:40.175152 => 16:41:40.731163
[0m16:41:40.731616 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:41:40.914074 [info ] [Thread-2 (]: 24 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.75s]
[0m16:41:40.914855 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.915303 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:40.915795 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:41:40.916604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:41:40.917000 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:40.921567 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:41:40.922417 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:41:40.917239 => 16:41:40.922217
[0m16:41:40.922782 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:40.925347 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:41:40.926353 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:41:40.926750 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:40.927045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:41.105764 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:41.109138 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:41:40.436843 => 16:41:41.108874
[0m16:41:41.109628 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:41:41.228696 [info ] [Thread-3 (]: 25 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.80s]
[0m16:41:41.229893 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:41.230600 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:41.231357 [info ] [Thread-3 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:41:41.232307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:41:41.232714 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:41.238498 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:41:41.239707 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:41:41.232951 => 16:41:41.239455
[0m16:41:41.240112 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:41.245163 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:41:41.246455 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:41:41.246873 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:41:41.247223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:41.358268 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:41.359670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:41.363219 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:41:40.716620 => 16:41:41.362861
[0m16:41:41.366331 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:41:40.649631 => 16:41:41.365964
[0m16:41:41.366974 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:41:41.367489 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:41:41.383302 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:41.385012 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:41:40.923012 => 16:41:41.384833
[0m16:41:41.385315 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:41:41.491987 [info ] [Thread-1 (]: 26 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.85s]
[0m16:41:41.492871 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:41.493454 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:41.494058 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:41:41.495051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:41:41.495543 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:41.501997 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:41:41.507868 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:41:41.496437 => 16:41:41.507620
[0m16:41:41.508224 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:41.510699 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:41:41.511595 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:41:41.511895 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:41.512172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:41.608324 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.69s]
[0m16:41:41.608931 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:41.629752 [info ] [Thread-4 (]: 27 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.92s]
[0m16:41:41.630319 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:42.233636 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:42.234916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:42.238740 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:41:41.240334 => 16:41:42.238410
[0m16:41:42.241989 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:41:41.508408 => 16:41:42.241545
[0m16:41:42.242811 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:41:42.243351 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:41:42.412461 [info ] [Thread-3 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 1.18s]
[0m16:41:42.413879 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:42.464506 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.97s]
[0m16:41:42.465387 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:42.466344 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:41:42.466948 [info ] [Thread-2 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:41:42.467731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now model.northwind.obt_order_fulfillment)
[0m16:41:42.468120 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:41:42.472708 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:41:42.473744 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:41:42.468340 => 16:41:42.473548
[0m16:41:42.474073 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:41:42.476798 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:41:42.478592 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:41:42.478988 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:41:42.479379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:45.095347 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:41:45.101345 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:41:42.474260 => 16:41:45.101077
[0m16:41:45.102139 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:41:45.235229 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c6dc40>]}
[0m16:41:45.236519 [info ] [Thread-2 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 2.77s]
[0m16:41:45.237427 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:41:45.240003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:45.240582 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:41:45.240884 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:41:45.241160 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:41:45.241432 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerid.04913d3698' was properly closed.
[0m16:41:45.241815 [info ] [MainThread]: 
[0m16:41:45.242153 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m16:41:45.245457 [debug] [MainThread]: Command end result
[0m16:41:45.255100 [info ] [MainThread]: 
[0m16:41:45.255510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:45.255755 [info ] [MainThread]: 
[0m16:41:45.255992 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 55 unexpected ';'.
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:41:45.256252 [info ] [MainThread]: 
[0m16:41:45.256501 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:41:45.258520 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 14.67319, "process_user_time": 2.915022, "process_kernel_time": 0.319221, "process_mem_max_rss": "148111360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:45.258909 [debug] [MainThread]: Command `dbt build` failed at 16:41:45.258828 after 14.67 seconds
[0m16:41:45.259172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c60290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bbee70>]}
[0m16:41:45.259434 [debug] [MainThread]: Flushing usage events
[0m16:42:08.564500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c20c0>]}


============================== 16:42:08.567339 | d7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00 ==============================
[0m16:42:08.567339 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:42:08.567683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:42:08.752741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cebb30>]}
[0m16:42:08.788586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8e1b0>]}
[0m16:42:08.789802 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:42:08.801725 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:42:08.836802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:08.837251 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:42:08.957724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960ac30>]}
[0m16:42:08.964703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109425d90>]}
[0m16:42:08.964923 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:42:08.966231 [info ] [MainThread]: 
[0m16:42:08.966601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:08.967195 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:42:08.973390 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:42:08.973599 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:42:08.973821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:09.871613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:42:09.875308 [debug] [ThreadPool]: On list_analytics: Close
[0m16:42:10.000989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:42:10.012097 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:42:10.012669 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:42:10.012984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:11.333650 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:42:11.337715 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:42:11.831492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960a6c0>]}
[0m16:42:11.833028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:11.833509 [info ] [MainThread]: 
[0m16:42:11.838273 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:11.839012 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:11.839447 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:11.839847 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:11.840397 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:42:11.840961 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:42:11.841420 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:42:11.841844 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:42:11.843237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:42:11.844028 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:42:11.844780 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:42:11.845490 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:42:11.845854 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:11.846172 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:11.846470 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:11.846763 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:11.862955 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:42:11.867760 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:42:11.870586 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:42:11.873223 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:42:11.874133 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:42:11.868002 => 16:42:11.873877
[0m16:42:11.874510 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:42:11.847196 => 16:42:11.874317
[0m16:42:11.874836 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:42:11.863206 => 16:42:11.874702
[0m16:42:11.875119 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:11.875457 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:42:11.870785 => 16:42:11.875262
[0m16:42:11.875733 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:11.875980 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:11.890171 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:42:11.890444 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:11.892050 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:42:11.893510 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:42:11.895126 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:42:11.895785 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:42:11.896260 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:42:11.896500 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:11.896788 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:42:11.897223 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:42:11.897414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:42:11.897785 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:42:11.897969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:11.898169 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:11.898806 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:11.899653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:42:11.899888 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:12.508700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:12.514317 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:42:11.890598 => 16:42:12.514139
[0m16:42:12.514605 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:42:12.990680 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 1.15s]
[0m16:42:12.992310 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:12.993157 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:12.993963 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:42:12.994814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:42:12.995164 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:12.999838 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:42:13.000702 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:42:12.995361 => 16:42:13.000524
[0m16:42:13.000984 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:13.003242 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:42:13.004124 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:42:13.004443 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:13.004727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:13.947803 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:13.953516 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:42:11.893720 => 16:42:13.953105
[0m16:42:13.954156 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:42:14.179269 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:14.184897 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:42:11.876130 => 16:42:14.184592
[0m16:42:14.185746 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:42:14.372065 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 2.53s]
[0m16:42:14.373607 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:14.374383 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:14.375219 [info ] [Thread-4 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:42:14.376311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:42:14.376797 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:14.382475 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:42:14.383499 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:42:14.377072 => 16:42:14.383268
[0m16:42:14.383911 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:14.388395 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:42:14.389596 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:42:14.389989 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:14.390363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:14.427105 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 2.58s]
[0m16:42:14.427831 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:14.428222 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:14.428653 [info ] [Thread-3 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:42:14.429376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:42:14.429725 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:14.433814 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:42:14.434474 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:42:14.429927 => 16:42:14.434296
[0m16:42:14.434780 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:14.436912 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:42:14.438011 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:42:14.438321 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:14.438603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:14.581041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:14.583079 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:42:13.001160 => 16:42:14.582853
[0m16:42:14.583456 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:42:15.231272 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:15.235763 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:42:14.384134 => 16:42:15.235393
[0m16:42:15.236333 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:42:15.447747 [info ] [Thread-4 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 1.07s]
[0m16:42:15.448893 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:15.449499 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:15.451006 [info ] [Thread-4 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:42:15.452213 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:42:15.453179 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:42:15.455504 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:42:11.892205 => 16:42:15.455251
[0m16:42:15.455927 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:15.456327 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:42:15.462097 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:42:15.464689 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:42:15.456559 => 16:42:15.464340
[0m16:42:15.465137 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:15.468033 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:42:15.468773 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 2.47s]
[0m16:42:15.469508 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:15.470179 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:15.471121 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:42:15.471440 [info ] [Thread-1 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:42:15.471839 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:15.472417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:42:15.472713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:15.472974 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:15.477239 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:42:15.478067 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:42:15.473640 => 16:42:15.477888
[0m16:42:15.478320 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:15.480225 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:42:15.481293 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:42:15.481576 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:15.481875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:15.800386 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 3.96s]
[0m16:42:15.801717 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:15.802385 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m16:42:15.803261 [info ] [Thread-2 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:42:15.804200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now model.northwind.dim_customer)
[0m16:42:15.804651 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m16:42:15.810075 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:42:15.811150 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 16:42:15.805307 => 16:42:15.810934
[0m16:42:15.811506 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m16:42:15.832427 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:42:15.833281 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:42:15.833561 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:42:15.833811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:15.957531 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:15.959407 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:42:15.465468 => 16:42:15.959206
[0m16:42:15.959859 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:42:16.217394 [info ] [Thread-4 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.76s]
[0m16:42:16.218487 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:16.219047 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:42:16.219716 [info ] [Thread-4 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:42:16.220673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m16:42:16.221082 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:42:16.227895 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:42:16.228836 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:42:16.221314 => 16:42:16.228646
[0m16:42:16.229153 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:42:16.232051 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:42:16.233488 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:42:16.233842 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:42:16.234151 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:16.237166 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:16.238841 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:42:14.434964 => 16:42:16.238637
[0m16:42:16.239546 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:42:16.469073 [info ] [Thread-3 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 2.04s]
[0m16:42:16.471114 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:16.471823 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m16:42:16.472464 [info ] [Thread-3 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:42:16.473282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m16:42:16.473676 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m16:42:16.477229 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:42:16.478208 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 16:42:16.473904 => 16:42:16.477993
[0m16:42:16.478587 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m16:42:16.481405 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:42:16.482463 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:42:16.482798 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:42:16.483110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:16.547744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.549483 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:42:15.478466 => 16:42:16.549289
[0m16:42:16.549797 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:42:16.640375 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.661454 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 16:42:15.811701 => 16:42:16.661276
[0m16:42:16.664907 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m16:42:16.778822 [info ] [Thread-1 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 1.31s]
[0m16:42:16.780348 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:16.781195 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:42:16.781952 [info ] [Thread-1 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:42:16.783021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:42:16.783513 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:42:16.790470 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:42:16.791505 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:42:16.783801 => 16:42:16.791314
[0m16:42:16.791843 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:42:16.794588 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:42:16.796884 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:42:16.797321 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:42:16.797725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:16.873045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109096e40>]}
[0m16:42:16.873656 [info ] [Thread-2 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.07s]
[0m16:42:16.874133 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m16:42:16.874488 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m16:42:16.874940 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:42:16.875559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:42:16.875883 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m16:42:16.881483 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:42:16.882028 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 16:42:16.876062 => 16:42:16.881889
[0m16:42:16.882275 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m16:42:16.884242 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:42:16.885555 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:42:16.885862 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(ProductID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        Quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:42:16.886145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:17.064198 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.067363 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:42:16.229342 => 16:42:17.067133
[0m16:42:17.067746 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:42:17.196917 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d69c0>]}
[0m16:42:17.198715 [info ] [Thread-4 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.98s]
[0m16:42:17.200407 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:42:17.201332 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:17.201982 [info ] [Thread-4 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:42:17.203018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:42:17.204060 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:17.213080 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:42:17.216370 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:42:17.204689 => 16:42:17.216073
[0m16:42:17.216868 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:17.219741 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:42:17.221144 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:42:17.221563 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:42:17.221985 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:17.321267 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c556-0000-17a6-0009-ec83000211e2
[0m16:42:17.321680 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:42:17.322089 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 16:42:16.882418 => 16:42:17.321923
[0m16:42:17.322369 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m16:42:17.533097 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:42:17.533492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094270e0>]}
[0m16:42:17.533842 [error] [Thread-2 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.66s]
[0m16:42:17.534175 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m16:42:17.534413 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:17.534738 [info ] [Thread-2 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:42:17.535150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:42:17.535341 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:17.538033 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:42:17.538478 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:42:17.535456 => 16:42:17.538359
[0m16:42:17.538667 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:17.540140 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:42:17.540653 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:42:17.540850 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:42:17.541033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:17.814475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.819954 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:42:17.217088 => 16:42:17.819544
[0m16:42:17.820686 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:42:18.099298 [info ] [Thread-4 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.90s]
[0m16:42:18.100538 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:18.101513 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:18.102358 [info ] [Thread-4 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:42:18.103452 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:42:18.103950 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:18.109315 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:42:18.110349 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:42:18.104225 => 16:42:18.110110
[0m16:42:18.110727 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:18.113725 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:42:18.114910 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:42:18.115324 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:18.115679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:18.376558 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:18.381985 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:42:17.538776 => 16:42:18.381638
[0m16:42:18.382816 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:42:18.408152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:18.412908 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:42:16.792048 => 16:42:18.412523
[0m16:42:18.413537 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:42:18.565469 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:18.570118 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 16:42:16.478799 => 16:42:18.569819
[0m16:42:18.570739 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m16:42:18.573806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f53d0>]}
[0m16:42:18.574804 [info ] [Thread-2 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 1.04s]
[0m16:42:18.575486 [info ] [Thread-1 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.79s]
[0m16:42:18.576424 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:18.577135 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:42:18.577707 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:18.578192 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:18.578781 [info ] [Thread-2 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:42:18.579181 [info ] [Thread-1 (]: 19 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:42:18.579793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:42:18.580337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:42:18.580653 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:18.580966 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:18.585720 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:42:18.589589 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:42:18.590334 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:42:18.581167 => 16:42:18.590138
[0m16:42:18.590670 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:42:18.586019 => 16:42:18.590499
[0m16:42:18.590951 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:18.591269 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:18.594952 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:42:18.596868 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:42:18.597744 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:42:18.598264 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:42:18.598558 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:18.598837 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:42:18.599102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:18.599333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:18.755520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb2a2a0>]}
[0m16:42:18.756195 [info ] [Thread-3 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 2.28s]
[0m16:42:18.756785 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m16:42:18.757194 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:18.757712 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:42:18.758491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:42:18.758908 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:18.763565 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:42:18.771662 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:42:18.759138 => 16:42:18.771438
[0m16:42:18.773135 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:18.775485 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:42:18.776236 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:42:18.776546 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:42:18.776787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:19.085883 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.091670 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:42:18.110924 => 16:42:19.091332
[0m16:42:19.092196 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:42:19.330628 [info ] [Thread-4 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.23s]
[0m16:42:19.331907 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:19.332479 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:19.333059 [info ] [Thread-4 (]: 21 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:42:19.333957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:42:19.334373 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:19.337983 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:42:19.338628 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:42:19.334560 => 16:42:19.338459
[0m16:42:19.338886 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:19.341714 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:42:19.343068 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:42:19.343403 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:19.343668 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:19.941405 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.943136 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.944001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.946794 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:42:18.591475 => 16:42:19.946523
[0m16:42:19.948807 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:42:18.773468 => 16:42:19.948579
[0m16:42:19.950700 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:42:18.595135 => 16:42:19.950466
[0m16:42:19.951125 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:42:19.951494 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:42:19.951851 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:42:20.138895 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 1.38s]
[0m16:42:20.140038 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:20.140578 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:20.141053 [info ] [Thread-3 (]: 22 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:42:20.141629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:42:20.141894 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:20.145436 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:42:20.146002 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:42:20.142048 => 16:42:20.145850
[0m16:42:20.146248 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:20.148201 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:42:20.148918 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:42:20.149185 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:20.149429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:20.196295 [info ] [Thread-1 (]: 19 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 1.62s]
[0m16:42:20.197002 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:20.197439 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:42:20.197938 [info ] [Thread-1 (]: 23 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:42:20.198405 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:42:20.198809 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:42:20.199244 [info ] [Thread-1 (]: 24 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:42:20.199662 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:42:20.200014 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:20.200362 [info ] [Thread-1 (]: 25 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:42:20.200964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:42:20.201286 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:20.205482 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:42:20.206158 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:42:20.201482 => 16:42:20.205987
[0m16:42:20.206444 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:20.210495 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:42:20.211391 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:42:20.211794 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:42:20.212140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:20.228024 [info ] [Thread-2 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.65s]
[0m16:42:20.228538 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:20.228869 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:20.229240 [info ] [Thread-2 (]: 26 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:42:20.229822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:42:20.230126 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:20.233732 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:42:20.234303 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:42:20.230294 => 16:42:20.234144
[0m16:42:20.234567 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:20.236514 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:42:20.237251 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:42:20.237523 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:20.237768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:20.283720 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:20.285224 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:42:19.339034 => 16:42:20.285075
[0m16:42:20.285506 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:42:20.460455 [info ] [Thread-4 (]: 21 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 1.13s]
[0m16:42:20.461357 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:20.461900 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:20.462491 [info ] [Thread-4 (]: 27 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:42:20.463336 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:42:20.463724 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:20.468836 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:42:20.469763 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:42:20.463949 => 16:42:20.469539
[0m16:42:20.470134 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:20.472713 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:42:20.473541 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:42:20.473888 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:42:20.474215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:20.799572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:20.804132 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:42:20.206614 => 16:42:20.803749
[0m16:42:20.804713 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:42:20.961997 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:20.967124 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:42:20.146391 => 16:42:20.966845
[0m16:42:20.967970 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:42:21.184328 [info ] [Thread-1 (]: 25 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.98s]
[0m16:42:21.185519 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:21.186018 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:21.186564 [info ] [Thread-1 (]: 28 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:42:21.187398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:42:21.187802 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:21.192966 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:42:21.193891 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:42:21.188031 => 16:42:21.193697
[0m16:42:21.194215 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:21.197129 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:42:21.198305 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:42:21.198671 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:42:21.199042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:21.316042 [info ] [Thread-3 (]: 22 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 1.17s]
[0m16:42:21.316875 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:21.317329 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:21.317817 [info ] [Thread-3 (]: 29 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:42:21.318562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:42:21.318913 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:21.323386 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:42:21.324261 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:42:21.319127 => 16:42:21.324055
[0m16:42:21.324590 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:21.326992 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:42:21.327886 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:42:21.328240 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:21.328540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:21.611731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:21.615997 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:42:21.194411 => 16:42:21.615588
[0m16:42:21.616770 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:42:22.653773 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:22.654637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:22.655639 [info ] [Thread-1 (]: 28 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.47s]
[0m16:42:22.657908 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:42:20.470359 => 16:42:22.657670
[0m16:42:22.659601 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:42:20.234714 => 16:42:22.659391
[0m16:42:22.660094 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:22.660428 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:42:22.660736 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:42:22.661095 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:22.663799 [info ] [Thread-1 (]: 30 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:42:22.664600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:42:22.664983 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:22.670939 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:42:22.672404 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:42:22.665168 => 16:42:22.672217
[0m16:42:22.672691 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:22.674621 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:42:22.675317 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:42:22.675576 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:22.675822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:22.854305 [info ] [Thread-2 (]: 26 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 2.62s]
[0m16:42:22.855130 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:26.964518 [info ] [Thread-4 (]: 27 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 6.50s]
[0m16:42:26.966307 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:27.104092 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m16:42:27.108763 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:42:21.324779 => 16:42:27.108294
[0m16:42:27.109649 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:42:28.854885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m16:42:28.859042 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:42:22.672841 => 16:42:28.858538
[0m16:42:28.859786 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:42:29.121140 [info ] [Thread-1 (]: 30 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 6.46s]
[0m16:42:29.122532 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:29.863153 [info ] [Thread-3 (]: 29 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 8.54s]
[0m16:42:29.864701 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:29.865862 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:42:29.866631 [info ] [Thread-2 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:42:29.867720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now model.northwind.obt_order_fulfillment)
[0m16:42:29.868235 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:42:29.873219 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:42:29.874255 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:42:29.868531 => 16:42:29.874016
[0m16:42:29.874639 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:42:29.877463 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:42:29.879115 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:42:29.879538 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:42:29.879906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:33.474863 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:42:33.481045 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:42:29.874861 => 16:42:33.480710
[0m16:42:33.481753 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:42:34.284971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950a480>]}
[0m16:42:34.286000 [info ] [Thread-2 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 4.42s]
[0m16:42:34.286657 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:42:34.288640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:34.288974 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:42:34.289229 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:42:34.289457 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_date.dd069a8d31' was properly closed.
[0m16:42:34.289681 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_date.78f11e7735' was properly closed.
[0m16:42:34.290002 [info ] [MainThread]: 
[0m16:42:34.290301 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 25.32 seconds (25.32s).
[0m16:42:34.293544 [debug] [MainThread]: Command end result
[0m16:42:34.302655 [info ] [MainThread]: 
[0m16:42:34.303043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:42:34.303285 [info ] [MainThread]: 
[0m16:42:34.303523 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:42:34.303775 [info ] [MainThread]: 
[0m16:42:34.303995 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:42:34.305734 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 25.780346, "process_user_time": 3.029697, "process_kernel_time": 0.307656, "process_mem_max_rss": "143982592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:42:34.306163 [debug] [MainThread]: Command `dbt build` failed at 16:42:34.306068 after 25.78 seconds
[0m16:42:34.306451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109727050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a674b60>]}
[0m16:42:34.306719 [debug] [MainThread]: Flushing usage events
[0m16:43:42.024918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ae8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0e2a0>]}


============================== 16:43:42.027617 | 78ed5dce-c510-43c1-8d2d-35dc5b867962 ==============================
[0m16:43:42.027617 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:43:42.027927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:42.210422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153f3170>]}
[0m16:43:42.245012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e55430>]}
[0m16:43:42.246261 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:43:42.258245 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:43:42.293091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:42.293536 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:43:42.413281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b8cd10>]}
[0m16:43:42.420246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158252e0>]}
[0m16:43:42.420467 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:43:42.421791 [info ] [MainThread]: 
[0m16:43:42.422157 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:42.422751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:43:42.428870 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:43:42.429094 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:43:42.429243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:43.328828 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:43:43.331981 [debug] [ThreadPool]: On list_analytics: Close
[0m16:43:43.465365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:43:43.476270 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:43:43.476685 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:43:43.477020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:43.986174 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:43:43.991430 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:43:44.176317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115153ec0>]}
[0m16:43:44.177727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:44.178195 [info ] [MainThread]: 
[0m16:43:44.182831 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.183420 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.183881 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.184332 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.184758 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:43:44.185228 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:43:44.185637 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:43:44.186031 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:43:44.187269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:43:44.188063 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:43:44.188772 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:43:44.189358 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:43:44.189693 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.190001 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.190285 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.190568 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.206512 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:43:44.211236 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:43:44.214101 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:43:44.217065 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:43:44.217928 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:43:44.190767 => 16:43:44.217720
[0m16:43:44.218308 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:43:44.211479 => 16:43:44.218156
[0m16:43:44.218586 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.218902 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:43:44.206775 => 16:43:44.218761
[0m16:43:44.219169 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.219416 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:43:44.214339 => 16:43:44.219291
[0m16:43:44.233549 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:43:44.233848 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.235445 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:43:44.235696 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.237234 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:43:44.238909 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:43:44.239380 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:43:44.239824 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:43:44.240113 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:43:44.240568 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:43:44.240760 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.240972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.241331 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:43:44.241537 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.241743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:43:44.242338 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.242745 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:44.243218 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:44.785492 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.800417 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:43:44.237472 => 16:43:44.800055
[0m16:43:44.801187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.801839 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.802501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.802977 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:43:44.805054 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:43:44.219557 => 16:43:44.804847
[0m16:43:44.806665 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:43:44.234017 => 16:43:44.806478
[0m16:43:44.808215 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:43:44.235912 => 16:43:44.808025
[0m16:43:44.809427 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:43:44.810047 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:43:44.810424 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:43:44.927020 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.74s]
[0m16:43:44.928471 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.929881 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.74s]
[0m16:43:44.931092 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:44.932167 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.932733 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:43:44.933367 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:44.934261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:43:44.934763 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:43:44.935183 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:44.935855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:43:44.936740 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.75s]
[0m16:43:44.937595 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.75s]
[0m16:43:44.942561 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:43:44.943055 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:44.943543 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.943970 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.947836 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:43:44.948281 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:44.948674 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:43:44.937876 => 16:43:44.948509
[0m16:43:44.949073 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:44.949537 [info ] [Thread-4 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:43:44.949886 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:44.950227 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:43:44.944272 => 16:43:44.950055
[0m16:43:44.950511 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:43:44.951163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:43:44.953481 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:43:44.953809 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:44.954307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:43:44.954582 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:44.956968 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:43:44.957758 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:43:44.958054 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:44.962689 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:43:44.963038 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.965864 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:43:44.966460 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:43:44.966712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.967048 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:43:44.958260 => 16:43:44.966899
[0m16:43:44.967311 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.968182 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:43:44.963241 => 16:43:44.968056
[0m16:43:44.968607 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:44.968875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:44.969112 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:44.970917 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:43:44.973479 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:43:44.974487 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:43:44.974973 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:43:44.975295 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.975866 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.976110 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:44.976336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:45.423997 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.425360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.429237 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:43:44.969252 => 16:43:45.428604
[0m16:43:45.432538 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:43:44.951418 => 16:43:45.432160
[0m16:43:45.433562 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:43:45.434608 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.435296 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.435736 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:43:45.438763 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:43:44.971801 => 16:43:45.438524
[0m16:43:45.440838 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:43:44.954811 => 16:43:45.440632
[0m16:43:45.442076 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:43:45.442682 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:43:45.559807 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.61s]
[0m16:43:45.561712 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.63s]
[0m16:43:45.562715 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:45.563460 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:45.564028 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:45.564701 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:43:45.565389 [info ] [Thread-2 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:43:45.566037 [info ] [Thread-1 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:43:45.566816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:43:45.567513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m16:43:45.568345 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:45.568739 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:43:45.572375 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.64s]
[0m16:43:45.577070 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:43:45.579627 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:43:45.580147 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:45.580688 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m16:43:45.581153 [info ] [Thread-3 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:43:45.581818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:43:45.582201 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m16:43:45.582903 [info ] [Thread-4 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.63s]
[0m16:43:45.583290 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:43:45.569012 => 16:43:45.583114
[0m16:43:45.585811 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:43:45.586155 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:43:45.573120 => 16:43:45.585998
[0m16:43:45.586544 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:45.586825 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:45.587149 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:43:45.587473 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:43:45.587844 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 16:43:45.583479 => 16:43:45.587716
[0m16:43:45.589768 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:43:45.607972 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:43:45.608329 [info ] [Thread-4 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:43:45.608594 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m16:43:45.609172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:43:45.610983 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:43:45.611470 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:43:45.611906 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:43:45.612113 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:43:45.612386 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:43:45.612639 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:45.615063 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:43:45.615489 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:43:45.615703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:45.615933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:45.616209 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:43:45.617367 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:43:45.612781 => 16:43:45.617243
[0m16:43:45.617711 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:45.617963 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:43:45.619968 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:43:45.621303 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:43:45.621545 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:43:45.621745 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:46.051286 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:46.052843 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:43:45.587973 => 16:43:46.052677
[0m16:43:46.053110 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:43:46.155697 [info ] [Thread-2 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.59s]
[0m16:43:46.156271 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:46.156648 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:43:46.157102 [info ] [Thread-2 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:43:46.157798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:43:46.158138 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:43:46.164145 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:43:46.164982 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:43:46.158328 => 16:43:46.164808
[0m16:43:46.165276 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:43:46.167775 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:43:46.170028 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:43:46.170425 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:43:46.170774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:46.293916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.308842 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:43:45.589947 => 16:43:46.308674
[0m16:43:46.309154 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:43:46.421709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157eef60>]}
[0m16:43:46.422372 [info ] [Thread-1 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.85s]
[0m16:43:46.422987 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:43:46.423418 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m16:43:46.424010 [info ] [Thread-1 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:43:46.424799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:43:46.425248 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m16:43:46.432334 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:43:46.433112 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 16:43:46.425491 => 16:43:46.432920
[0m16:43:46.433429 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m16:43:46.437406 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:43:46.438938 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:43:46.439294 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(ProductID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:43:46.439617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:46.547564 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.549957 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 16:43:45.609396 => 16:43:46.549775
[0m16:43:46.550272 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m16:43:46.793894 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.800060 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:43:45.618462 => 16:43:46.799797
[0m16:43:46.800580 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:43:46.866641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11669e9f0>]}
[0m16:43:46.867677 [info ] [Thread-3 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.28s]
[0m16:43:46.868462 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m16:43:46.869500 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:46.870328 [info ] [Thread-3 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:43:46.871302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:43:46.871746 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:46.880199 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:43:46.881370 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:43:46.872020 => 16:43:46.881085
[0m16:43:46.881748 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:46.884497 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:43:46.885426 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:43:46.885771 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:43:46.886082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:46.903567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11765d340>]}
[0m16:43:46.904183 [info ] [Thread-4 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.29s]
[0m16:43:46.904809 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:43:46.905257 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:46.905684 [info ] [Thread-4 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:43:46.906324 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:43:46.906701 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:46.910360 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:43:46.910960 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:43:46.906876 => 16:43:46.910805
[0m16:43:46.911276 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:46.913389 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:43:46.914089 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:43:46.914431 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:43:46.914744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:46.915591 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c557-0000-17a6-0009-ec8300021226
[0m16:43:46.916063 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:43:46.916414 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 16:43:46.433624 => 16:43:46.916281
[0m16:43:46.916645 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m16:43:47.033483 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:43:47.033900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167954f0>]}
[0m16:43:47.034306 [error] [Thread-1 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.61s]
[0m16:43:47.034702 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m16:43:47.034980 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.035319 [info ] [Thread-1 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:43:47.035867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:43:47.036103 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.039215 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:43:47.039737 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:43:47.036245 => 16:43:47.039594
[0m16:43:47.039977 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.041931 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:43:47.042663 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:43:47.042927 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.043144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.141439 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.143558 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:43:46.165438 => 16:43:47.143396
[0m16:43:47.143865 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:43:47.322924 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167710a0>]}
[0m16:43:47.324490 [info ] [Thread-2 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.17s]
[0m16:43:47.325507 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:43:47.326051 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.326602 [info ] [Thread-2 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:43:47.327384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:43:47.327771 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.332873 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:43:47.333864 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:43:47.327993 => 16:43:47.333660
[0m16:43:47.334200 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.336707 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:43:47.337677 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:43:47.338022 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.338333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:47.411868 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.415450 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:43:46.881961 => 16:43:47.415245
[0m16:43:47.416071 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:43:47.416583 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.418799 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:43:46.911519 => 16:43:47.418624
[0m16:43:47.419339 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:43:47.473047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:47.474789 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:43:47.040156 => 16:43:47.474583
[0m16:43:47.475179 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:43:47.534213 [info ] [Thread-4 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.63s]
[0m16:43:47.535145 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:47.535592 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:47.536059 [info ] [Thread-4 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:43:47.536823 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:43:47.537202 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:47.541674 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:43:47.542423 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:43:47.537423 => 16:43:47.542234
[0m16:43:47.542738 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:47.545137 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:43:47.546432 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:43:47.546795 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:43:47.547727 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:47.547456 [info ] [Thread-3 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.68s]
[0m16:43:47.548666 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:47.549191 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:47.549547 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:43:47.550092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:43:47.550425 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:47.554024 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:43:47.554841 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:43:47.550776 => 16:43:47.554655
[0m16:43:47.555130 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:47.557070 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:43:47.557753 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:43:47.558024 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:43:47.558264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:47.588511 [info ] [Thread-1 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.55s]
[0m16:43:47.589060 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.589379 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:47.589696 [info ] [Thread-1 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:43:47.590216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:43:47.590489 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:47.593613 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:43:47.594261 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:43:47.590637 => 16:43:47.594119
[0m16:43:47.594519 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:47.596512 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:43:47.597481 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:43:47.597953 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.598246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.852012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.855848 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:43:47.334391 => 16:43:47.855510
[0m16:43:47.856574 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:43:47.973246 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:47.974663 [info ] [Thread-2 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.65s]
[0m16:43:47.978261 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:43:47.542923 => 16:43:47.977845
[0m16:43:47.979023 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.979434 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:43:47.979887 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:47.981508 [info ] [Thread-2 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:43:47.982724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:43:47.983238 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:47.988390 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:43:47.991384 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:43:47.983486 => 16:43:47.991147
[0m16:43:47.991766 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:47.994281 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:43:47.995569 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:43:47.995907 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.996202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:48.097748 [info ] [Thread-4 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.56s]
[0m16:43:48.098421 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:48.098803 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.099211 [info ] [Thread-4 (]: 23 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:43:48.099869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:43:48.100198 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.103997 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:43:48.104708 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:43:48.100391 => 16:43:48.104534
[0m16:43:48.104989 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.108726 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:43:48.109498 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:43:48.109770 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:43:48.110021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:48.179728 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.181477 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:43:47.555285 => 16:43:48.181289
[0m16:43:48.181752 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:43:48.182979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.184354 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:43:47.594756 => 16:43:48.184195
[0m16:43:48.184613 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:43:48.376046 [info ] [Thread-1 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.79s]
[0m16:43:48.377012 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.83s]
[0m16:43:48.378068 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:48.378597 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:48.379036 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.379578 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.380049 [info ] [Thread-1 (]: 24 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:43:48.380460 [info ] [Thread-3 (]: 25 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:43:48.381153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:43:48.381768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:43:48.382134 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.382507 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.387253 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:43:48.390942 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:43:48.391702 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:43:48.382759 => 16:43:48.391523
[0m16:43:48.392079 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:43:48.387544 => 16:43:48.391892
[0m16:43:48.392358 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.392641 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.394765 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:43:48.396764 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:43:48.397504 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:43:48.397825 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:43:48.398445 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:43:48.398699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:48.398980 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:48.399715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:48.491798 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:48.493452 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:43:47.991964 => 16:43:48.493268
[0m16:43:48.493750 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:43:48.602054 [info ] [Thread-2 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.62s]
[0m16:43:48.602809 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:48.603260 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:48.603743 [info ] [Thread-2 (]: 26 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:43:48.604584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:43:48.605005 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:48.609789 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:43:48.610621 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:43:48.605234 => 16:43:48.610418
[0m16:43:48.610939 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:48.613398 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:43:48.614368 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:43:48.614746 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:48.615063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:48.649561 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.651646 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:43:48.105145 => 16:43:48.651436
[0m16:43:48.651986 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:43:48.756870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:48.759057 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:43:48.392813 => 16:43:48.758808
[0m16:43:48.759921 [info ] [Thread-4 (]: 23 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.66s]
[0m16:43:48.760428 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:43:48.760966 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.762356 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:43:48.763115 [info ] [Thread-4 (]: 27 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:43:48.763660 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:43:48.764064 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:43:48.764490 [info ] [Thread-4 (]: 28 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:43:48.764992 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:43:48.765602 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:48.766076 [info ] [Thread-4 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:43:48.766756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:43:48.767095 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:48.771540 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:43:48.772275 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:43:48.767291 => 16:43:48.772093
[0m16:43:48.772577 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:48.774860 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:43:48.775643 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:43:48.775938 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:43:48.776210 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:48.777368 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:48.779090 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:43:48.394966 => 16:43:48.778916
[0m16:43:48.779444 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:43:48.953022 [info ] [Thread-1 (]: 24 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.57s]
[0m16:43:48.953976 [info ] [Thread-3 (]: 25 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.57s]
[0m16:43:48.954771 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.955207 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.955584 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:48.956047 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:43:48.956651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:43:48.956971 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:48.963855 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:43:48.964936 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:43:48.957160 => 16:43:48.964725
[0m16:43:48.965262 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:48.967760 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:43:48.968782 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:43:48.969098 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:48.969379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:49.010953 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:49.013094 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:43:48.611125 => 16:43:49.012863
[0m16:43:49.013680 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:43:49.134493 [info ] [Thread-2 (]: 26 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.53s]
[0m16:43:49.135327 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:49.297338 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:49.300999 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:43:48.772745 => 16:43:49.300677
[0m16:43:49.301549 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:43:49.415160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:49.419025 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:43:48.965437 => 16:43:49.418540
[0m16:43:49.419848 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:43:49.481272 [info ] [Thread-4 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.71s]
[0m16:43:49.482246 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:49.545164 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.59s]
[0m16:43:49.546188 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:49.547162 [debug] [Thread-3 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:43:49.547769 [info ] [Thread-3 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:43:49.548526 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:43:49.548902 [debug] [Thread-3 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:43:49.553654 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:43:49.554681 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:43:49.549124 => 16:43:49.554475
[0m16:43:49.555025 [debug] [Thread-3 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:43:49.557761 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:43:49.559407 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:43:49.559795 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:43:49.560155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:50.513634 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.518954 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:43:49.555227 => 16:43:50.518681
[0m16:43:50.519500 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:43:50.632104 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167e47d0>]}
[0m16:43:50.633211 [info ] [Thread-3 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.08s]
[0m16:43:50.634005 [debug] [Thread-3 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:43:50.637005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:50.637682 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:43:50.638053 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:43:50.638394 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:43:50.638704 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:43:50.639203 [info ] [MainThread]: 
[0m16:43:50.639630 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m16:43:50.643475 [debug] [MainThread]: Command end result
[0m16:43:50.654636 [info ] [MainThread]: 
[0m16:43:50.654958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:50.655181 [info ] [MainThread]: 
[0m16:43:50.655403 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:43:50.655651 [info ] [MainThread]: 
[0m16:43:50.655880 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:43:50.657952 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.659736, "process_user_time": 2.78211, "process_kernel_time": 0.284469, "process_mem_max_rss": "149569536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:50.658340 [debug] [MainThread]: Command `dbt build` failed at 16:43:50.658254 after 8.66 seconds
[0m16:43:50.658617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12246bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122495b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153c9580>]}
[0m16:43:50.658886 [debug] [MainThread]: Flushing usage events
[0m16:44:43.361386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d56c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7d5b0>]}


============================== 16:44:43.364228 | 25e70b54-e0a4-4c62-9bbf-1dd6772e0209 ==============================
[0m16:44:43.364228 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:44:43.364558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:43.562760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f102f0>]}
[0m16:44:43.599775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ce6f0>]}
[0m16:44:43.600484 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:44:43.613624 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:44:43.650511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:43.650999 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:44:43.773757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782ba70>]}
[0m16:44:43.780987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eb710>]}
[0m16:44:43.781235 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:44:43.782659 [info ] [MainThread]: 
[0m16:44:43.783078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:44:43.783710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:44:43.789886 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:44:43.790103 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:44:43.790248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:44.860740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:44:44.863963 [debug] [ThreadPool]: On list_analytics: Close
[0m16:44:45.125335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:44:45.133434 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:44:45.133782 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:44:45.134050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:45.669698 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:44:45.672072 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:44:45.783284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d56600>]}
[0m16:44:45.784220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:45.784650 [info ] [MainThread]: 
[0m16:44:45.787863 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:45.788309 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:45.788954 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:45.788650 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:44:45.789331 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:45.789686 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:44:45.790045 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:44:45.791159 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:44:45.790696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:44:45.792086 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:44:45.792691 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:44:45.793635 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:44:45.794086 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:45.794405 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:45.794673 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:45.794943 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:45.809099 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:44:45.813610 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:44:45.816196 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:44:45.818672 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:44:45.819534 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:44:45.809347 => 16:44:45.819284
[0m16:44:45.819921 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:44:45.795119 => 16:44:45.819720
[0m16:44:45.820205 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:44:45.813823 => 16:44:45.820072
[0m16:44:45.820463 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:45.820714 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:44:45.816369 => 16:44:45.820579
[0m16:44:45.820931 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:45.821137 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:45.835427 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:44:45.835714 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:45.837231 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:44:45.838657 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:44:45.840251 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:44:45.840828 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:44:45.841199 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:45.841657 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:44:45.841874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:44:45.842166 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:44:45.842621 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:44:45.843397 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:44:45.843708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:45.844102 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:45.844366 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:45.844820 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:44:45.845179 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:44:46.263046 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.264232 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.273934 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:44:45.837374 => 16:44:46.273597
[0m16:44:46.274948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.276828 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:44:45.838861 => 16:44:46.276617
[0m16:44:46.277385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.277778 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:44:46.279498 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:44:45.821276 => 16:44:46.279304
[0m16:44:46.279840 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:44:46.281405 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:44:45.835857 => 16:44:46.281215
[0m16:44:46.282665 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:44:46.284050 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:44:46.384954 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.59s]
[0m16:44:46.385495 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:46.385750 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.386063 [info ] [Thread-4 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:44:46.386420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:44:46.386599 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.389717 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:44:46.390422 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:44:46.386704 => 16:44:46.390287
[0m16:44:46.390636 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.392395 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:44:46.393021 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:44:46.393227 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.393414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:46.396328 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.60s]
[0m16:44:46.396772 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.61s]
[0m16:44:46.397157 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.61s]
[0m16:44:46.397664 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:46.397991 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:46.398236 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:46.398446 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.398691 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.398924 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.399187 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:44:46.399408 [info ] [Thread-1 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:44:46.399595 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:44:46.399925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:44:46.400220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:44:46.400505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:44:46.400676 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.400830 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.400990 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.403559 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:44:46.406937 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:44:46.409238 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:44:46.409896 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:44:46.407152 => 16:44:46.409723
[0m16:44:46.410181 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:44:46.401088 => 16:44:46.410030
[0m16:44:46.410457 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:44:46.403742 => 16:44:46.410310
[0m16:44:46.410642 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.410818 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.411002 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.412574 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:44:46.414034 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:44:46.415583 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:44:46.416224 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:44:46.416590 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:44:46.416928 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:44:46.417137 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.417337 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.417541 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.417713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:46.417861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:46.418011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:46.766047 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.768079 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:44:46.390750 => 16:44:46.767869
[0m16:44:46.768404 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:44:46.775751 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.777291 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:44:46.412709 => 16:44:46.777119
[0m16:44:46.777571 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:44:46.812750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.814693 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:44:46.414192 => 16:44:46.814501
[0m16:44:46.815004 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:44:46.832065 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.833723 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:44:46.411102 => 16:44:46.833538
[0m16:44:46.834079 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:44:46.877309 [info ] [Thread-4 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.49s]
[0m16:44:46.877886 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.878262 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:46.878714 [info ] [Thread-4 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:44:46.879315 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:44:46.879643 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:46.884279 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:44:46.885064 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:44:46.879841 => 16:44:46.884867
[0m16:44:46.885362 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:46.888175 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:44:46.889067 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:44:46.889427 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.889849 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:46.892978 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.49s]
[0m16:44:46.893501 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.893823 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m16:44:46.894202 [info ] [Thread-3 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:44:46.894700 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_customer)
[0m16:44:46.894968 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m16:44:46.898164 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:44:46.898768 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 16:44:46.895110 => 16:44:46.898621
[0m16:44:46.899007 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m16:44:46.916373 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:44:46.917124 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:44:46.917348 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:44:46.917554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:46.923733 [info ] [Thread-1 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.52s]
[0m16:44:46.924130 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.924375 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:44:46.924699 [info ] [Thread-1 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:44:46.925062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m16:44:46.925245 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:44:46.927035 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:44:46.927458 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:44:46.925355 => 16:44:46.927346
[0m16:44:46.927635 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:44:46.929214 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:44:46.929799 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:44:46.930000 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:44:46.930188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:46.951856 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.55s]
[0m16:44:46.952258 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.952487 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m16:44:46.952798 [info ] [Thread-2 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:44:46.953166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m16:44:46.953345 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m16:44:46.956040 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:44:46.956512 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 16:44:46.953453 => 16:44:46.956401
[0m16:44:46.956700 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m16:44:46.958242 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:44:46.959137 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:44:46.959360 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:44:46.959567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:47.319511 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:47.324341 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:44:46.886053 => 16:44:47.323919
[0m16:44:47.325037 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:44:47.468584 [info ] [Thread-4 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.59s]
[0m16:44:47.470259 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:47.471040 [debug] [Thread-4 (]: Began running node model.northwind.fact_sales
[0m16:44:47.471804 [info ] [Thread-4 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:44:47.472912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_sales)
[0m16:44:47.473354 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_sales
[0m16:44:47.481924 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:44:47.482811 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (compile): 16:44:47.473582 => 16:44:47.482611
[0m16:44:47.483146 [debug] [Thread-4 (]: Began executing node model.northwind.fact_sales
[0m16:44:47.485838 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:44:47.487511 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:44:47.487912 [debug] [Thread-4 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:44:47.488436 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:47.615131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:47.617047 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:47.639834 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:44:46.927748 => 16:44:47.639636
[0m16:44:47.641979 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 16:44:46.899148 => 16:44:47.641817
[0m16:44:47.642296 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:44:47.642569 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m16:44:47.751124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078815e0>]}
[0m16:44:47.752231 [info ] [Thread-1 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.83s]
[0m16:44:47.753063 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:44:47.753618 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:44:47.754274 [info ] [Thread-1 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:44:47.755409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_order_fulfillment)
[0m16:44:47.756470 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:44:47.767660 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:44:47.768521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba192b0>]}
[0m16:44:47.769931 [info ] [Thread-3 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.87s]
[0m16:44:47.770503 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m16:44:47.770887 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:47.771277 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:44:47.757492 => 16:44:47.771069
[0m16:44:47.771649 [info ] [Thread-3 (]: 15 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:44:47.772057 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:44:47.772556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:44:47.776846 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:44:47.777163 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:47.782536 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:44:47.784128 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:44:47.784528 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:44:47.784921 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:44:47.777427 => 16:44:47.784779
[0m16:44:47.785135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:47.785361 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:47.787688 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:44:47.788556 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:44:47.788854 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:44:47.789094 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:47.977335 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c558-0000-17c7-0009-ec830002027a
[0m16:44:47.977818 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:44:47.978283 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (execute): 16:44:47.483368 => 16:44:47.978099
[0m16:44:47.978580 [debug] [Thread-4 (]: On model.northwind.fact_sales: Close
[0m16:44:48.265097 [debug] [Thread-4 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:44:48.265819 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f410>]}
[0m16:44:48.266462 [error] [Thread-4 (]: 13 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.79s]
[0m16:44:48.267093 [debug] [Thread-4 (]: Finished running node model.northwind.fact_sales
[0m16:44:48.267533 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.268130 [info ] [Thread-4 (]: 16 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:44:48.268995 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:44:48.269449 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.274448 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:44:48.275291 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:44:48.269683 => 16:44:48.275092
[0m16:44:48.275603 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.278112 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:44:48.279069 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:44:48.279863 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:44:48.280181 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:48.286249 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:48.288505 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 16:44:46.956806 => 16:44:48.288345
[0m16:44:48.288843 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m16:44:48.412444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4a300>]}
[0m16:44:48.413158 [info ] [Thread-2 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.46s]
[0m16:44:48.413767 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m16:44:48.414201 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:48.414569 [info ] [Thread-2 (]: 17 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:44:48.415423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:44:48.415802 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:48.420291 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:44:48.421052 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:44:48.416013 => 16:44:48.420857
[0m16:44:48.421364 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:48.423534 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:44:48.424333 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:44:48.424627 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:48.424905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:48.428513 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:48.430270 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:44:47.785923 => 16:44:48.430073
[0m16:44:48.430584 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:44:48.533404 [info ] [Thread-3 (]: 15 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.76s]
[0m16:44:48.533960 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:48.534277 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:48.534626 [info ] [Thread-3 (]: 18 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:44:48.535205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:44:48.535490 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:48.539108 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:44:48.539700 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:44:48.535654 => 16:44:48.539541
[0m16:44:48.539969 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:48.542088 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:44:48.544176 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:44:48.544503 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:48.544757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:48.664266 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:48.674763 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:44:48.275787 => 16:44:48.674433
[0m16:44:48.675987 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:44:48.800125 [info ] [Thread-4 (]: 16 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.53s]
[0m16:44:48.801546 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.802244 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:48.803056 [info ] [Thread-4 (]: 19 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:44:48.809014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:44:48.809460 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:48.817042 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:44:48.817917 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:44:48.810389 => 16:44:48.817701
[0m16:44:48.818229 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:48.820678 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:44:48.821426 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:44:48.821715 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:44:48.821989 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:48.847063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:48.849407 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:44:47.772732 => 16:44:48.849227
[0m16:44:48.849735 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:44:48.952579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f4b30>]}
[0m16:44:48.953222 [info ] [Thread-1 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.20s]
[0m16:44:48.953822 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:44:48.954242 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:48.954742 [info ] [Thread-1 (]: 20 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:44:48.955511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:44:48.955976 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:48.960292 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:44:48.961067 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:44:48.956243 => 16:44:48.960879
[0m16:44:48.961391 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:48.963849 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:44:48.964629 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:44:48.965353 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:44:48.965686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:49.184443 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.188652 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:44:48.540126 => 16:44:49.188041
[0m16:44:49.189376 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:44:49.304669 [info ] [Thread-3 (]: 18 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.77s]
[0m16:44:49.305696 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:49.306264 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.306814 [info ] [Thread-3 (]: 21 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:44:49.308105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:44:49.308885 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.314494 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:44:49.315840 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:49.318031 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:44:48.818406 => 16:44:49.317811
[0m16:44:49.318452 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:44:49.319738 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:44:49.309194 => 16:44:49.319527
[0m16:44:49.320398 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.323161 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:44:49.324606 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:44:49.325042 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:49.325426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:49.326794 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.328632 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:44:48.421548 => 16:44:49.328430
[0m16:44:49.330026 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:44:49.434615 [info ] [Thread-4 (]: 19 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.63s]
[0m16:44:49.435236 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:49.435600 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:49.435995 [info ] [Thread-4 (]: 22 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:44:49.436655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:44:49.436982 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:49.441115 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:44:49.441803 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:44:49.437171 => 16:44:49.441615
[0m16:44:49.442085 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:49.444284 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:44:49.445680 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:44:49.446099 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:49.446406 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:49.447158 [info ] [Thread-2 (]: 17 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.03s]
[0m16:44:49.448438 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:49.448795 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:44:49.449111 [info ] [Thread-2 (]: 23 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:44:49.449399 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:44:49.449671 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:44:49.450001 [info ] [Thread-2 (]: 24 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:44:49.450490 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:44:49.450902 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:49.451147 [info ] [Thread-2 (]: 25 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:44:49.451607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:44:49.451830 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:49.455123 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:44:49.455738 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:44:49.451980 => 16:44:49.455583
[0m16:44:49.455990 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:49.457919 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:44:49.458609 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:44:49.458853 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:44:49.459142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:49.709577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.725161 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:44:48.961588 => 16:44:49.724838
[0m16:44:49.725828 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:44:49.830207 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.833314 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:44:49.320658 => 16:44:49.832967
[0m16:44:49.833919 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:44:49.844977 [info ] [Thread-1 (]: 20 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.89s]
[0m16:44:49.845963 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:49.846525 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:49.847046 [info ] [Thread-1 (]: 26 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:44:49.847844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:44:49.848231 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:49.853314 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:44:49.855576 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:44:49.848480 => 16:44:49.855364
[0m16:44:49.855996 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:49.858570 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:44:49.859914 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:44:49.860293 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:44:49.860646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:49.951384 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:49.953483 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:44:49.456129 => 16:44:49.953270
[0m16:44:49.954250 [info ] [Thread-3 (]: 21 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.65s]
[0m16:44:49.954678 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:44:49.955128 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.956315 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:49.956853 [info ] [Thread-3 (]: 27 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:44:49.957497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:44:49.957824 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:49.961515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:44:49.962404 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:44:49.958053 => 16:44:49.962233
[0m16:44:49.962707 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:49.964785 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:44:49.965540 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:44:49.965797 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:49.966034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:50.003586 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:50.005314 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:44:49.442245 => 16:44:50.005131
[0m16:44:50.005628 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:44:50.066683 [info ] [Thread-2 (]: 25 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.62s]
[0m16:44:50.067159 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:50.067478 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.067847 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:44:50.068415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:44:50.068676 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.072017 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:44:50.072696 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:44:50.068823 => 16:44:50.072523
[0m16:44:50.072949 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.074939 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:44:50.075686 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:44:50.075950 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:50.076195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:50.128490 [info ] [Thread-4 (]: 22 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.69s]
[0m16:44:50.129770 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:50.133983 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.134488 [info ] [Thread-4 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:44:50.134994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:44:50.138996 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.142512 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:44:50.143129 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:44:50.139325 => 16:44:50.142985
[0m16:44:50.143363 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.145136 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:44:50.145710 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:44:50.145937 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:44:50.146237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:50.266019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.268599 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:44:49.856206 => 16:44:50.268331
[0m16:44:50.269031 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:44:50.401626 [info ] [Thread-1 (]: 26 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.55s]
[0m16:44:50.402457 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:50.402901 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:50.403397 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:44:50.404401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:44:50.409227 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:50.414529 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:44:50.415464 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:44:50.410178 => 16:44:50.415242
[0m16:44:50.415811 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:50.419652 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:44:50.420467 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:44:50.420763 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:50.421041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:50.429502 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.431156 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:44:49.962880 => 16:44:50.430966
[0m16:44:50.431460 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:44:50.520640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.522390 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:44:50.073098 => 16:44:50.522189
[0m16:44:50.522731 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:44:50.553087 [info ] [Thread-3 (]: 27 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.60s]
[0m16:44:50.553738 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:50.638730 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.57s]
[0m16:44:50.639999 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.640932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.643229 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:44:50.143499 => 16:44:50.642958
[0m16:44:50.643660 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:44:50.824608 [info ] [Thread-4 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.69s]
[0m16:44:50.825741 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.881657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.886041 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:44:50.415996 => 16:44:50.885621
[0m16:44:50.886691 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:44:50.999653 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:44:51.001030 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:51.002371 [debug] [Thread-3 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:44:51.003101 [info ] [Thread-3 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:44:51.004177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:44:51.004677 [debug] [Thread-3 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:44:51.009441 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:44:51.010518 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:44:51.004965 => 16:44:51.010289
[0m16:44:51.010898 [debug] [Thread-3 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:44:51.013810 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:44:51.015631 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:44:51.016024 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:44:51.016386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:51.847546 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:51.853322 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:44:51.011116 => 16:44:51.852980
[0m16:44:51.854056 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:44:52.009436 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba40ec0>]}
[0m16:44:52.010677 [info ] [Thread-3 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.01s]
[0m16:44:52.012051 [debug] [Thread-3 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:44:52.014682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:52.015168 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:44:52.015564 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:44:52.015885 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:44:52.016206 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:44:52.016638 [info ] [MainThread]: 
[0m16:44:52.017007 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m16:44:52.020892 [debug] [MainThread]: Command end result
[0m16:44:52.030874 [info ] [MainThread]: 
[0m16:44:52.031204 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:44:52.031438 [info ] [MainThread]: 
[0m16:44:52.031669 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:44:52.031917 [info ] [MainThread]: 
[0m16:44:52.032150 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:44:52.034036 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.699287, "process_user_time": 2.648442, "process_kernel_time": 0.285021, "process_mem_max_rss": "148504576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:52.034469 [debug] [MainThread]: Command `dbt build` failed at 16:44:52.034377 after 8.70 seconds
[0m16:44:52.034767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d48650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd68bf0>]}
[0m16:44:52.035066 [debug] [MainThread]: Flushing usage events
[0m16:48:23.394920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f7770>]}


============================== 16:48:23.397504 | e7443b2f-8709-4486-ae8b-a379519fab73 ==============================
[0m16:48:23.397504 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:48:23.397823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:48:23.575785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069182f0>]}
[0m16:48:23.608611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3800>]}
[0m16:48:23.609706 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:48:23.621085 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:48:23.657173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:23.657606 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:48:23.777952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107568b90>]}
[0m16:48:23.785783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fdb50>]}
[0m16:48:23.786020 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:48:23.787405 [info ] [MainThread]: 
[0m16:48:23.787784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:23.788393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:48:23.794429 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:48:23.794604 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:48:23.794743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:24.751582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:48:24.754537 [debug] [ThreadPool]: On list_analytics: Close
[0m16:48:24.894563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:48:24.905729 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:48:24.906234 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:48:24.906522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.566862 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:48:25.571593 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:48:25.789334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e2780>]}
[0m16:48:25.790613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:25.790980 [info ] [MainThread]: 
[0m16:48:25.794478 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:25.794862 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:25.795213 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:25.795536 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:25.795856 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:48:25.796202 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:48:25.796687 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:48:25.797080 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:48:25.798107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:48:25.798703 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:48:25.799235 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:48:25.799754 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:48:25.800034 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:25.800303 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:25.800552 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:25.800830 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:25.813630 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:25.817861 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:25.820301 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:25.822669 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:25.823551 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:48:25.801044 => 16:48:25.823376
[0m16:48:25.823929 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:48:25.813888 => 16:48:25.823753
[0m16:48:25.824233 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:25.824502 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:48:25.820479 => 16:48:25.824381
[0m16:48:25.824799 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:48:25.818065 => 16:48:25.824622
[0m16:48:25.825068 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:25.838385 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:25.838651 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:25.838864 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:25.840350 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:25.841805 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:25.843235 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:25.843717 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:25.844134 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:48:25.844553 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:25.844788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:25.845011 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:25.845417 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:25.845778 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:25.846310 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:25.846686 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:25.846937 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:25.847347 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:25.847658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:26.242833 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.245199 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.246165 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.257412 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:48:25.838995 => 16:48:26.257055
[0m16:48:26.258204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.260426 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:48:25.841965 => 16:48:26.260222
[0m16:48:26.262046 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:48:25.840556 => 16:48:26.261855
[0m16:48:26.262413 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:48:26.263952 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:48:25.825224 => 16:48:26.263748
[0m16:48:26.264286 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:48:26.264594 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:48:26.265871 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:48:26.385103 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.59s]
[0m16:48:26.386627 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:26.387228 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:26.387940 [info ] [Thread-3 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:48:26.389384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:48:26.390611 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.59s]
[0m16:48:26.391311 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:26.391989 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:26.397930 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:26.398526 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:26.399731 [info ] [Thread-1 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:48:26.400559 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.60s]
[0m16:48:26.402091 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:48:26.392774 => 16:48:26.401833
[0m16:48:26.401360 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.60s]
[0m16:48:26.402789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:48:26.403280 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:26.403610 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:26.404033 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:26.404335 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:26.404675 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:26.407387 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:26.407821 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:26.411716 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:26.412112 [info ] [Thread-4 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:48:26.412562 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:48:26.413234 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:48:26.413841 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:26.414355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:48:26.414667 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:48:26.408132 => 16:48:26.414514
[0m16:48:26.414919 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:26.415202 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.415494 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:26.415777 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:26.418906 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:26.419252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:26.423501 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:26.425249 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:26.426560 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:48:26.415941 => 16:48:26.426338
[0m16:48:26.427182 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:48:26.419427 => 16:48:26.426834
[0m16:48:26.427476 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:26.427993 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:26.428276 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:26.430298 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:26.430761 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.432526 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:26.432920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:26.433712 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:26.434417 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.434927 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:26.435207 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:26.435455 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.436590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:26.883927 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.886526 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.887640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.888495 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.892289 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:48:26.430950 => 16:48:26.891795
[0m16:48:26.895306 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:48:26.404999 => 16:48:26.895008
[0m16:48:26.897317 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:48:26.423679 => 16:48:26.897041
[0m16:48:26.899229 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:48:26.428608 => 16:48:26.898996
[0m16:48:26.899658 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:48:26.900031 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:48:26.900393 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:48:26.900730 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:48:27.022246 [info ] [Thread-3 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.63s]
[0m16:48:27.023618 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.61s]
[0m16:48:27.025125 [info ] [Thread-1 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.62s]
[0m16:48:27.027064 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:27.027765 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:27.028334 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:27.029142 [info ] [Thread-4 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.62s]
[0m16:48:27.029742 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.030347 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m16:48:27.030969 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:48:27.031748 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:27.032723 [info ] [Thread-3 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:48:27.033283 [info ] [Thread-2 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:48:27.037363 [info ] [Thread-1 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:48:27.037854 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:48:27.038681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:48:27.039259 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:48:27.039884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:48:27.040304 [info ] [Thread-4 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:48:27.040704 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.041017 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m16:48:27.041307 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:48:27.041886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:48:27.046089 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:48:27.048231 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:48:27.051562 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:27.051868 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:48:27.054641 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:48:27.055049 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:48:27.046336 => 16:48:27.054940
[0m16:48:27.055265 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 16:48:27.042922 => 16:48:27.055161
[0m16:48:27.055446 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:48:27.042123 => 16:48:27.055357
[0m16:48:27.055615 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:48:27.055788 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:48:27.052400 => 16:48:27.055700
[0m16:48:27.055960 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m16:48:27.056131 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.072183 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:48:27.072504 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:48:27.074285 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:48:27.077021 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:27.078671 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:48:27.079280 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:48:27.079618 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:48:27.080071 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:48:27.080555 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:27.080768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:27.081004 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:48:27.081695 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:48:27.081908 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:27.082515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:27.083079 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:48:27.083369 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:27.083858 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:27.538096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:27.540955 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:48:27.074483 => 16:48:27.540682
[0m16:48:27.541415 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:48:27.661982 [info ] [Thread-3 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.62s]
[0m16:48:27.663086 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.663667 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:48:27.664394 [info ] [Thread-3 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:48:27.665454 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:48:27.665855 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:48:27.672850 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:48:27.673915 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:48:27.666101 => 16:48:27.673704
[0m16:48:27.674260 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:48:27.677109 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:48:27.679177 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:48:27.679570 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:48:27.679915 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:28.335977 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:28.357728 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 16:48:27.072659 => 16:48:28.357506
[0m16:48:28.358244 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m16:48:28.486270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781d730>]}
[0m16:48:28.487340 [info ] [Thread-2 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.45s]
[0m16:48:28.488010 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m16:48:28.488457 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m16:48:28.489247 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:48:28.490486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:48:28.490897 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m16:48:28.498069 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:48:28.499088 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 16:48:28.491131 => 16:48:28.498886
[0m16:48:28.499419 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m16:48:28.502073 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:48:28.503852 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:48:28.504256 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_order_details as 
(
    select
        od.OrderID,
        od.ProductID,
        od.Quantity,
        od.UnitPrice,
        od.Discount,
        (od.UnitPrice * od.Quantity) - (od.Discount * od.UnitPrice * od.Quantity) as soldamount
    from raw.northwind.Order_Details od
),
stg_sales as 
(
    select
        o.OrderID,
        md5(cast(coalesce(cast(o.EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(o.CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        od.ProductID as productid, -- Assuming ProductID comes from the stg_order_details
        replace(to_date(o.OrderDate)::varchar, '-', '')::int as orderdate,
        od.Quantity,
        od.UnitPrice as extendedpriceamount,
        od.Discount * od.UnitPrice * od.Quantity as discountamount,
        od.soldamount
    from raw.northwind.Orders o
    join stg_order_details od on o.OrderID = od.OrderID
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.ProductID
    join stg_employees e on s.employeeid = e.EmployeeID
    join stg_customers c on s.customerid = c.CustomerID
        );
[0m16:48:28.504626 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:28.894527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:48:28.901402 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:48:27.056231 => 16:48:28.901125
[0m16:48:28.902267 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:48:29.023223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870f500>]}
[0m16:48:29.024141 [info ] [Thread-1 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.98s]
[0m16:48:29.024777 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:48:29.025336 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:29.026349 [info ] [Thread-1 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:48:29.027206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:48:29.027553 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:29.035520 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:29.036256 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:48:29.027747 => 16:48:29.036073
[0m16:48:29.036577 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:29.038836 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:29.039574 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:29.039861 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:48:29.040139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:29.165791 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.168705 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:48:27.674465 => 16:48:29.168527
[0m16:48:29.169141 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:48:29.214884 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:48:29.217627 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:48:27.077295 => 16:48:29.217397
[0m16:48:29.218105 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:48:29.281449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772b7a0>]}
[0m16:48:29.282295 [info ] [Thread-3 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.62s]
[0m16:48:29.283096 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:48:29.283654 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:29.284329 [info ] [Thread-3 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:48:29.285331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:48:29.285817 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:29.291195 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:29.292125 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:48:29.286055 => 16:48:29.291930
[0m16:48:29.292452 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:29.295032 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:29.295907 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:29.296247 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:48:29.296568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:29.394790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107893da0>]}
[0m16:48:29.395900 [info ] [Thread-4 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 2.35s]
[0m16:48:29.396924 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:48:29.397466 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:29.398570 [info ] [Thread-4 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:48:29.399553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:48:29.399947 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:29.404876 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:29.405583 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:48:29.400188 => 16:48:29.405388
[0m16:48:29.405895 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:29.408516 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:29.409454 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:29.409789 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:29.410104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:29.912172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.918368 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:48:29.036744 => 16:48:29.917734
[0m16:48:29.919126 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:48:29.931516 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.934220 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:48:29.406075 => 16:48:29.933947
[0m16:48:29.934660 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:48:29.954317 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.956464 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:48:29.292646 => 16:48:29.956233
[0m16:48:29.956839 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:48:30.020717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:48:30.025938 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 16:48:28.499604 => 16:48:30.025676
[0m16:48:30.027465 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m16:48:30.030084 [info ] [Thread-1 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 1.00s]
[0m16:48:30.031259 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:30.031814 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.032294 [info ] [Thread-1 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:48:30.033066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:48:30.033516 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.038696 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:30.039950 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:48:30.033937 => 16:48:30.039742
[0m16:48:30.040291 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.042856 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:30.044296 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:30.044664 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.044969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:30.045633 [info ] [Thread-4 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.65s]
[0m16:48:30.046584 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:30.047133 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.047515 [info ] [Thread-4 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:48:30.048086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:48:30.048436 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.052496 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:30.053085 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:48:30.049020 => 16:48:30.052917
[0m16:48:30.053332 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.056573 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:30.057209 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:30.057472 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:48:30.057713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:30.088201 [info ] [Thread-3 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.80s]
[0m16:48:30.088761 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:30.089077 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.089408 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:48:30.089951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:48:30.090219 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.093533 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:30.094158 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:48:30.090370 => 16:48:30.094003
[0m16:48:30.094419 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.096307 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:30.097203 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:30.097457 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:48:30.097679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:30.157554 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078568a0>]}
[0m16:48:30.158081 [info ] [Thread-2 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_sales ... [[32mSUCCESS 1[0m in 1.67s]
[0m16:48:30.158456 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m16:48:30.158715 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.159275 [info ] [Thread-2 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:48:30.159944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:48:30.160241 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.163125 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:30.163678 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:48:30.160387 => 16:48:30.163548
[0m16:48:30.163885 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.165455 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:30.166071 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:30.166288 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.166484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:30.440825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.447055 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:48:30.040475 => 16:48:30.446627
[0m16:48:30.448691 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:48:30.449808 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.453282 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:48:30.053476 => 16:48:30.452987
[0m16:48:30.454152 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:48:30.561137 [info ] [Thread-4 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.51s]
[0m16:48:30.562720 [info ] [Thread-1 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.53s]
[0m16:48:30.563801 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.564423 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.564947 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:30.565535 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:30.566020 [info ] [Thread-4 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:48:30.566433 [info ] [Thread-1 (]: 23 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:48:30.567130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:48:30.567756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:48:30.568122 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:30.568559 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:30.575007 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:30.577886 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:30.579102 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.579610 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.581396 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:48:30.094567 => 16:48:30.581188
[0m16:48:30.583154 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:48:30.164001 => 16:48:30.582949
[0m16:48:30.583496 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:48:30.568808 => 16:48:30.583331
[0m16:48:30.583800 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:48:30.570865 => 16:48:30.583647
[0m16:48:30.584106 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:48:30.584371 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:48:30.584638 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:30.584922 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:30.589050 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:30.591025 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:30.592503 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:30.592873 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.593164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:30.593640 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:30.594319 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:48:30.594764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:30.701106 [info ] [Thread-2 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.54s]
[0m16:48:30.701628 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.701945 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:30.702314 [info ] [Thread-2 (]: 24 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:48:30.702898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:48:30.703199 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:30.707994 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:30.708893 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:48:30.703364 => 16:48:30.708721
[0m16:48:30.709161 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:30.711258 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:30.711799 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.62s]
[0m16:48:30.712499 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.712940 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:30.713361 [info ] [Thread-3 (]: 25 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:48:30.713972 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:30.714473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:48:30.714787 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.715058 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:30.715285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:30.718515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:30.719680 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:48:30.715433 => 16:48:30.719512
[0m16:48:30.719978 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:30.721787 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:30.722703 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:30.722965 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:48:30.723203 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:30.984925 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.987655 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:48:30.587005 => 16:48:30.987423
[0m16:48:30.988299 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:48:30.988869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.991556 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:48:30.589317 => 16:48:30.991319
[0m16:48:30.992193 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:48:31.109060 [info ] [Thread-1 (]: 23 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.54s]
[0m16:48:31.110163 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:31.111272 [info ] [Thread-4 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.54s]
[0m16:48:31.111997 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.112736 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:31.113224 [info ] [Thread-1 (]: 26 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:48:31.113691 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.114424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:48:31.115380 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.114844 [info ] [Thread-4 (]: 27 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:48:31.118262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:48:31.121652 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:31.122050 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.126204 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:31.126874 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:48:31.115704 => 16:48:31.126653
[0m16:48:31.127218 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.127607 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:48:31.122368 => 16:48:31.127401
[0m16:48:31.129936 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:31.130241 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.132360 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:31.133098 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:31.133489 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:48:31.134118 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:31.134409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:31.134730 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:31.135731 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:31.190597 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.192251 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:48:30.709320 => 16:48:31.192069
[0m16:48:31.192687 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:48:31.212137 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.213570 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:48:30.720142 => 16:48:31.213390
[0m16:48:31.213847 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:48:31.299054 [info ] [Thread-2 (]: 24 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:48:31.299728 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:31.300158 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.300652 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:48:31.301424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:48:31.301831 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.306351 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:31.307121 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:48:31.302062 => 16:48:31.306926
[0m16:48:31.307444 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.309883 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:31.310823 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:31.311210 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:31.312018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:31.325855 [info ] [Thread-3 (]: 25 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.61s]
[0m16:48:31.326344 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:31.326645 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:31.326956 [info ] [Thread-3 (]: 29 of 31 START test not_null_fact_sales_saleskey ............................... [RUN]
[0m16:48:31.327480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_sales_saleskey.0bc31ce210)
[0m16:48:31.327741 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:31.332363 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m16:48:31.332996 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_sales_saleskey.0bc31ce210 (compile): 16:48:31.327893 => 16:48:31.332842
[0m16:48:31.333238 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:31.334989 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m16:48:31.335671 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m16:48:31.335903 [debug] [Thread-3 (]: On test.northwind.not_null_fact_sales_saleskey.0bc31ce210: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select saleskey
from analytics.northwind_northwind.fact_sales
where saleskey is null



      
    ) dbt_internal_test
[0m16:48:31.336135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:31.607660 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.611877 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:48:31.130476 => 16:48:31.611368
[0m16:48:31.612568 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:48:31.618770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.622410 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:48:31.127845 => 16:48:31.622158
[0m16:48:31.622866 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:48:31.738909 [info ] [Thread-4 (]: 27 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.62s]
[0m16:48:31.740071 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.740631 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:31.741300 [info ] [Thread-4 (]: 30 of 31 START test unique_fact_sales_saleskey ................................. [RUN]
[0m16:48:31.742255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_fact_sales_saleskey.c07ec0958d)
[0m16:48:31.743007 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:31.743737 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.748264 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m16:48:31.750874 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:48:31.307629 => 16:48:31.750582
[0m16:48:31.751770 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:48:31.753258 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_sales_saleskey.c07ec0958d (compile): 16:48:31.743993 => 16:48:31.753065
[0m16:48:31.754235 [debug] [Thread-4 (]: Began executing node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:31.758344 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m16:48:31.759375 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m16:48:31.759695 [debug] [Thread-4 (]: On test.northwind.unique_fact_sales_saleskey.c07ec0958d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_sales_saleskey.c07ec0958d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    saleskey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_sales
where saleskey is not null
group by saleskey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:31.760006 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:31.762173 [info ] [Thread-1 (]: 26 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.65s]
[0m16:48:31.762494 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.784805 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b2c55c-0000-17a6-0009-ec83000212be
[0m16:48:31.785094 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'SALESKEY'
[0m16:48:31.785335 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_sales_saleskey.0bc31ce210 (execute): 16:48:31.333378 => 16:48:31.785238
[0m16:48:31.785508 [debug] [Thread-3 (]: On test.northwind.not_null_fact_sales_saleskey.0bc31ce210: Close
[0m16:48:31.881522 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.58s]
[0m16:48:31.882138 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.882695 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:48:31.883168 [info ] [Thread-1 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:48:31.883784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now model.northwind.obt_order_fulfillment)
[0m16:48:31.884104 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:48:31.887853 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:48:31.888523 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:48:31.884295 => 16:48:31.888328
[0m16:48:31.888964 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:48:31.891268 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:48:31.892734 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:48:31.893117 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:48:31.893447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:31.900148 [debug] [Thread-3 (]: Database Error in test not_null_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/not_null_fact_sales_saleskey.sql
[0m16:48:31.900529 [error] [Thread-3 (]: 29 of 31 ERROR not_null_fact_sales_saleskey .................................... [[31mERROR[0m in 0.57s]
[0m16:48:31.900938 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:32.190025 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c55c-0000-17a6-0009-ec83000212c2
[0m16:48:32.191261 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'SALESKEY'
[0m16:48:32.192005 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_sales_saleskey.c07ec0958d (execute): 16:48:31.754613 => 16:48:32.191712
[0m16:48:32.192509 [debug] [Thread-4 (]: On test.northwind.unique_fact_sales_saleskey.c07ec0958d: Close
[0m16:48:32.349384 [debug] [Thread-4 (]: Database Error in test unique_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/unique_fact_sales_saleskey.sql
[0m16:48:32.350360 [error] [Thread-4 (]: 30 of 31 ERROR unique_fact_sales_saleskey ...................................... [[31mERROR[0m in 0.61s]
[0m16:48:32.351044 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:32.834223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:32.840410 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:48:31.889164 => 16:48:32.840068
[0m16:48:32.841088 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:48:32.965415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019fb90>]}
[0m16:48:32.966660 [info ] [Thread-1 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.08s]
[0m16:48:32.967507 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:48:32.970598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:32.971255 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:48:32.971621 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:48:32.971947 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_sales_saleskey.0bc31ce210' was properly closed.
[0m16:48:32.972265 [debug] [MainThread]: Connection 'test.northwind.unique_fact_sales_saleskey.c07ec0958d' was properly closed.
[0m16:48:32.972701 [info ] [MainThread]: 
[0m16:48:32.973042 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m16:48:32.977061 [debug] [MainThread]: Command end result
[0m16:48:32.989899 [info ] [MainThread]: 
[0m16:48:32.990282 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:48:32.990531 [info ] [MainThread]: 
[0m16:48:32.990763 [error] [MainThread]:   Database Error in test not_null_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/not_null_fact_sales_saleskey.sql
[0m16:48:32.990987 [info ] [MainThread]: 
[0m16:48:32.991195 [error] [MainThread]:   Database Error in test unique_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/unique_fact_sales_saleskey.sql
[0m16:48:32.991425 [info ] [MainThread]: 
[0m16:48:32.991650 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=2 SKIP=0 TOTAL=31
[0m16:48:32.993820 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 9.627314, "process_user_time": 2.854724, "process_kernel_time": 0.306528, "process_mem_max_rss": "145211392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:48:32.994260 [debug] [MainThread]: Command `dbt build` failed at 16:48:32.994161 after 9.63 seconds
[0m16:48:32.994558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b6990>]}
[0m16:48:32.994849 [debug] [MainThread]: Flushing usage events
[0m16:48:52.057304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110206480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110206150>]}


============================== 16:48:52.059809 | 1036dd45-7259-4494-9ddd-f08fd95109fa ==============================
[0m16:48:52.059809 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:48:52.060117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:52.251482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf63f0>]}
[0m16:48:52.284494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110280500>]}
[0m16:48:52.284944 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:48:52.296351 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:48:52.331151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:52.331549 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:48:52.451348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cc6b0>]}
[0m16:48:52.458388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126bcb0>]}
[0m16:48:52.458610 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:48:52.460018 [info ] [MainThread]: 
[0m16:48:52.460415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:52.461015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:48:52.467198 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:48:52.467404 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:48:52.467555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:53.182858 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:48:53.186025 [debug] [ThreadPool]: On list_analytics: Close
[0m16:48:53.322869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:48:53.333851 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:48:53.334297 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:48:53.334620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:53.907251 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:48:53.911717 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:48:54.089123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c554c0>]}
[0m16:48:54.090838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:54.091381 [info ] [MainThread]: 
[0m16:48:54.095220 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.095698 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.096126 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.096516 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.097025 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:48:54.097590 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:48:54.098013 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:48:54.098454 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:48:54.099629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:48:54.100370 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:48:54.101104 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:48:54.101716 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:48:54.102042 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.102353 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.102647 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.102941 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.118245 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:54.124753 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:54.127839 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:54.131903 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:54.135253 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:48:54.103146 => 16:48:54.135069
[0m16:48:54.135572 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:48:54.120471 => 16:48:54.135404
[0m16:48:54.135904 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.136224 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:48:54.125165 => 16:48:54.136076
[0m16:48:54.136503 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.136787 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:48:54.129405 => 16:48:54.136646
[0m16:48:54.151460 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:54.151737 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.153280 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:54.153511 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.155125 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:54.156884 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:54.157387 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:54.157867 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:54.158149 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:48:54.158489 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.158926 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:54.159300 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:54.159493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:54.159672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:54.159876 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.160095 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.161255 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:54.161463 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:54.551286 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.552617 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.553503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.554443 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.564859 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:48:54.155387 => 16:48:54.564461
[0m16:48:54.567212 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:48:54.151882 => 16:48:54.566962
[0m16:48:54.569121 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:48:54.136946 => 16:48:54.568880
[0m16:48:54.570800 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:48:54.153718 => 16:48:54.570602
[0m16:48:54.571159 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:48:54.571475 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:48:54.571794 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:48:54.572099 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:48:54.690443 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.59s]
[0m16:48:54.691532 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.59s]
[0m16:48:54.692940 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.695407 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.696148 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:54.697121 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:54.698379 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.60s]
[0m16:48:54.699372 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.60s]
[0m16:48:54.700002 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:48:54.700495 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:48:54.701062 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.701564 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.702288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:48:54.702959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:48:54.703393 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:54.704035 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:54.704520 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:54.704855 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:54.705191 [info ] [Thread-2 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:48:54.705535 [info ] [Thread-4 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:48:54.710017 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:54.713247 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:54.713772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:48:54.714248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:48:54.714809 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:54.715127 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:54.715456 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:48:54.705765 => 16:48:54.715285
[0m16:48:54.715778 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:48:54.710265 => 16:48:54.715626
[0m16:48:54.719027 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:54.722175 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:54.722491 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:54.722764 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:54.726224 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:54.728226 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:54.728565 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:48:54.715922 => 16:48:54.728375
[0m16:48:54.728862 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:48:54.719298 => 16:48:54.728715
[0m16:48:54.729270 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:54.729548 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:54.730022 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:54.730487 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:54.732201 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:54.733972 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:54.734283 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.734561 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.734920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:54.735176 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:54.735638 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:54.736079 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:54.737426 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.737706 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.737953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:54.738168 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:55.170259 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.171291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.172153 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.176088 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:48:54.730627 => 16:48:55.175620
[0m16:48:55.177230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.179324 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:48:54.732382 => 16:48:55.179086
[0m16:48:55.181330 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:48:54.726508 => 16:48:55.181109
[0m16:48:55.181766 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:48:55.183591 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:48:54.723070 => 16:48:55.183366
[0m16:48:55.183967 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:48:55.184319 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:48:55.185703 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:48:55.309821 [info ] [Thread-2 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.60s]
[0m16:48:55.311347 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.61s]
[0m16:48:55.313809 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:55.313063 [info ] [Thread-4 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.60s]
[0m16:48:55.314808 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.61s]
[0m16:48:55.315584 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:55.316026 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.316644 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:55.317185 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:55.317622 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:48:55.318032 [info ] [Thread-2 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:48:55.318467 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m16:48:55.319073 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m16:48:55.319659 [info ] [Thread-1 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:48:55.320478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:48:55.321047 [info ] [Thread-4 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:48:55.321482 [info ] [Thread-3 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:48:55.322146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_date)
[0m16:48:55.322497 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.323034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:48:55.323589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_employee)
[0m16:48:55.323912 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:48:55.325200 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m16:48:55.325560 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m16:48:55.328259 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:48:55.331295 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:55.334589 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:48:55.338035 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:48:55.338801 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:48:55.325775 => 16:48:55.338605
[0m16:48:55.339137 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:48:55.324108 => 16:48:55.338979
[0m16:48:55.339439 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 16:48:55.331517 => 16:48:55.339288
[0m16:48:55.339723 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:48:55.340017 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 16:48:55.334829 => 16:48:55.339873
[0m16:48:55.340278 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.340525 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m16:48:55.358534 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:48:55.358859 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m16:48:55.360564 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:55.362056 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:48:55.363728 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:48:55.364364 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:48:55.364713 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:48:55.365202 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:55.365604 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:48:55.365804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:55.366459 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:48:55.366667 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:55.366911 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:48:55.367552 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:48:55.367972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:55.368185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:55.368381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:55.794406 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.800233 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:48:55.359028 => 16:48:55.799797
[0m16:48:55.800932 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:48:55.967309 [info ] [Thread-2 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.65s]
[0m16:48:55.967843 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.968163 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:48:55.968552 [info ] [Thread-2 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:48:55.969092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:48:55.969350 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:48:55.973572 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:48:55.974920 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:48:55.969498 => 16:48:55.974767
[0m16:48:55.975161 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:48:55.977066 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:48:55.978668 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:48:55.978984 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:48:55.979253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:56.122897 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.123937 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.124552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.140380 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 16:48:55.360709 => 16:48:56.140200
[0m16:48:56.142201 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 16:48:55.362270 => 16:48:56.142053
[0m16:48:56.143800 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:48:55.340672 => 16:48:56.143663
[0m16:48:56.144076 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m16:48:56.144304 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m16:48:56.144523 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:48:56.261921 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11121c560>]}
[0m16:48:56.263348 [info ] [Thread-4 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.94s]
[0m16:48:56.264102 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m16:48:56.264540 [debug] [Thread-4 (]: Began running node model.northwind.fact_sales
[0m16:48:56.265136 [info ] [Thread-4 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:48:56.265906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:48:56.266298 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_sales
[0m16:48:56.273224 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:48:56.274026 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (compile): 16:48:56.266521 => 16:48:56.273831
[0m16:48:56.274358 [debug] [Thread-4 (]: Began executing node model.northwind.fact_sales
[0m16:48:56.278397 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:48:56.279863 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:48:56.280793 [debug] [Thread-4 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:48:56.281292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:56.282792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d09820>]}
[0m16:48:56.283383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d09430>]}
[0m16:48:56.283854 [info ] [Thread-1 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.96s]
[0m16:48:56.284533 [info ] [Thread-3 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.96s]
[0m16:48:56.285159 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:48:56.285534 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m16:48:56.285878 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.286296 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.286879 [info ] [Thread-1 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:48:56.287186 [info ] [Thread-3 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:48:56.287673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:48:56.288118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:48:56.288361 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.288594 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.293538 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:56.296220 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:56.296737 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:48:56.288752 => 16:48:56.296600
[0m16:48:56.297025 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:48:56.293749 => 16:48:56.296879
[0m16:48:56.297240 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.297464 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.299491 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:56.301564 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:56.302229 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:56.302652 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:56.302867 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:48:56.303102 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:48:56.303324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:56.303517 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:56.738956 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c55c-0000-17a6-0009-ec83000212ee
[0m16:48:56.739713 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:48:56.740373 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (execute): 16:48:56.274543 => 16:48:56.740104
[0m16:48:56.740821 [debug] [Thread-4 (]: On model.northwind.fact_sales: Close
[0m16:48:56.773867 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.778132 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:48:55.975305 => 16:48:56.777858
[0m16:48:56.778630 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:48:56.794934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:56.795865 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:56.798173 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:48:56.297593 => 16:48:56.797923
[0m16:48:56.800125 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:48:56.299729 => 16:48:56.799898
[0m16:48:56.800680 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:48:56.801369 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:48:56.863358 [debug] [Thread-4 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:48:56.863890 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d350d0>]}
[0m16:48:56.864462 [error] [Thread-4 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.60s]
[0m16:48:56.865057 [debug] [Thread-4 (]: Finished running node model.northwind.fact_sales
[0m16:48:56.865479 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:56.865980 [info ] [Thread-4 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:48:56.866644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:48:56.866987 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:56.871458 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:56.872250 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:48:56.867181 => 16:48:56.872045
[0m16:48:56.872568 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:56.874867 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:56.875735 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:56.876021 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:56.876291 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:56.915082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d07fb0>]}
[0m16:48:56.914342 [info ] [Thread-3 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.63s]
[0m16:48:56.915727 [info ] [Thread-2 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 0.95s]
[0m16:48:56.916291 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.917106 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:48:56.917603 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:56.918080 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:56.918736 [info ] [Thread-3 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:48:56.919530 [info ] [Thread-1 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.63s]
[0m16:48:56.920109 [info ] [Thread-2 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:48:56.920872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:48:56.921393 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.921911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:48:56.922194 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:56.922497 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:56.922792 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:56.926455 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:56.926780 [info ] [Thread-1 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:48:56.929631 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:56.930285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:48:56.930785 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:56.935997 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:56.936390 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:48:56.922971 => 16:48:56.936219
[0m16:48:56.936838 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:56.937100 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:48:56.926978 => 16:48:56.936976
[0m16:48:56.937346 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:48:56.931006 => 16:48:56.937238
[0m16:48:56.939201 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:56.939458 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:56.939735 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:56.941699 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:56.943478 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:56.944112 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:56.944428 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:56.944689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:56.945068 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:56.945660 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:56.946134 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:48:56.946612 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:48:56.946871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:56.947083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:57.307984 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:57.312668 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:48:56.872751 => 16:48:57.312220
[0m16:48:57.313383 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:48:57.407323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:57.411107 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:48:56.941908 => 16:48:57.410782
[0m16:48:57.412176 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:48:57.418799 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:57.421630 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:48:56.939943 => 16:48:57.421322
[0m16:48:57.422140 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:48:57.444818 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:57.448663 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:48:56.937484 => 16:48:57.448381
[0m16:48:57.449102 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:48:57.470459 [info ] [Thread-4 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.60s]
[0m16:48:57.471654 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:57.472203 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:57.472681 [info ] [Thread-4 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:48:57.474169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:48:57.474596 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:57.480000 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:57.481287 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:48:57.474824 => 16:48:57.481084
[0m16:48:57.481605 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:57.484559 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:57.485670 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:57.486025 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:57.486350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:57.532324 [info ] [Thread-1 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.60s]
[0m16:48:57.533103 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:57.533537 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:57.533984 [info ] [Thread-1 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:48:57.534777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:48:57.535198 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:57.539797 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:57.541168 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:48:57.535541 => 16:48:57.540975
[0m16:48:57.541471 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:57.543775 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:57.544555 [info ] [Thread-2 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.62s]
[0m16:48:57.545343 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:57.545742 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:57.546413 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:57.546792 [info ] [Thread-2 (]: 23 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:48:57.547140 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:57.547746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:48:57.548429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:57.548746 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:57.552883 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:57.553809 [info ] [Thread-3 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.63s]
[0m16:48:57.554372 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:57.554714 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:57.555319 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:48:57.549448 => 16:48:57.555172
[0m16:48:57.555021 [info ] [Thread-3 (]: 24 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:48:57.555834 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:57.556490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:48:57.560178 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:57.560552 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:57.563390 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:57.563946 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:57.564230 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:48:57.564465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:57.564756 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:48:57.560820 => 16:48:57.564591
[0m16:48:57.565334 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:57.567285 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:57.567863 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:57.568081 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:48:57.568313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:58.283057 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.287329 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:48:57.481786 => 16:48:58.286720
[0m16:48:58.288133 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:48:58.290782 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.293501 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:48:57.556661 => 16:48:58.293260
[0m16:48:58.294201 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:48:58.395518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.400011 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:48:57.541641 => 16:48:58.399633
[0m16:48:58.401707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.402170 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:48:58.404818 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:48:57.565654 => 16:48:58.404241
[0m16:48:58.407534 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:48:58.408693 [info ] [Thread-4 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.93s]
[0m16:48:58.410929 [info ] [Thread-2 (]: 23 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.86s]
[0m16:48:58.411948 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:58.412460 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:58.412959 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:58.413651 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:58.414436 [info ] [Thread-4 (]: 25 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:48:58.415002 [info ] [Thread-2 (]: 26 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:48:58.416128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:48:58.416829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:48:58.417186 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:58.417500 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:58.422518 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:58.425783 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:58.426493 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:48:58.417702 => 16:48:58.426291
[0m16:48:58.426874 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:48:58.418509 => 16:48:58.426676
[0m16:48:58.427182 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:58.427472 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:58.429833 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:58.431638 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:58.432440 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:58.433007 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:58.433306 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:58.433615 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:58.433863 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:58.434077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:58.528229 [info ] [Thread-3 (]: 24 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.97s]
[0m16:48:58.528886 [info ] [Thread-1 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.99s]
[0m16:48:58.529452 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:58.529826 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:58.530140 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:58.530488 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:58.530829 [info ] [Thread-3 (]: 27 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:48:58.531141 [info ] [Thread-1 (]: 28 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:48:58.531447 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:58.531712 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:58.531989 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:58.532305 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:58.532608 [info ] [Thread-3 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:48:58.532900 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:48:58.533616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:48:58.534201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:48:58.534489 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:58.534731 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:58.538147 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:58.540997 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:58.541781 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:48:58.538346 => 16:48:58.541543
[0m16:48:58.542147 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:48:58.534883 => 16:48:58.541969
[0m16:48:58.542416 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:58.542680 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:58.544845 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:58.547847 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:58.548563 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:58.548836 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:58.549096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:58.549917 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:58.550382 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:48:58.550623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:58.868262 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:58.872660 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:48:58.427636 => 16:48:58.872308
[0m16:48:58.873553 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:48:58.995676 [info ] [Thread-4 (]: 25 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.58s]
[0m16:48:58.996642 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:59.269747 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:59.274210 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:48:58.545019 => 16:48:59.273742
[0m16:48:59.274897 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:48:59.347960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:59.350418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:59.353484 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:48:58.430024 => 16:48:59.353203
[0m16:48:59.356704 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:48:58.542832 => 16:48:59.356258
[0m16:48:59.357899 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:48:59.358648 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:48:59.426691 [info ] [Thread-3 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.89s]
[0m16:48:59.427676 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:59.481730 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.95s]
[0m16:48:59.482820 [info ] [Thread-2 (]: 26 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 1.07s]
[0m16:48:59.483812 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:59.484397 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:59.485388 [debug] [Thread-4 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:48:59.485944 [info ] [Thread-4 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:48:59.486761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:48:59.487170 [debug] [Thread-4 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:48:59.491573 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:48:59.492537 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:48:59.487417 => 16:48:59.492314
[0m16:48:59.492878 [debug] [Thread-4 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:48:59.495606 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:48:59.497065 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:48:59.497402 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:48:59.497725 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:49:00.685040 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:00.691742 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:48:59.493075 => 16:49:00.691392
[0m16:49:00.692338 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:49:00.844172 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111241b80>]}
[0m16:49:00.845324 [info ] [Thread-4 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.36s]
[0m16:49:00.846116 [debug] [Thread-4 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:49:00.849462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:00.850099 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:49:00.850464 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:49:00.850832 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:49:00.851157 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:49:00.851581 [info ] [MainThread]: 
[0m16:49:00.851954 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m16:49:00.855758 [debug] [MainThread]: Command end result
[0m16:49:00.868122 [info ] [MainThread]: 
[0m16:49:00.868463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:49:00.868703 [info ] [MainThread]: 
[0m16:49:00.868939 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:49:00.869189 [info ] [MainThread]: 
[0m16:49:00.869421 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:49:00.871198 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.840415, "process_user_time": 2.729026, "process_kernel_time": 0.294948, "process_mem_max_rss": "146374656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:00.871493 [debug] [MainThread]: Command `dbt build` failed at 16:49:00.871433 after 8.84 seconds
[0m16:49:00.871698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eefce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d023c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d03980>]}
[0m16:49:00.871883 [debug] [MainThread]: Flushing usage events
[0m16:55:02.869081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d64860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d82480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d82240>]}


============================== 16:55:02.874313 | c0897bd6-7440-4308-bf9b-d2f4d29c896d ==============================
[0m16:55:02.874313 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:55:02.874636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:03.071667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db4860>]}
[0m16:55:03.104837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f9280>]}
[0m16:55:03.105313 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:55:03.116838 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:55:03.152598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:03.152807 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:03.156051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d6d50>]}
[0m16:55:03.163264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079da420>]}
[0m16:55:03.163478 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:55:03.164892 [info ] [MainThread]: 
[0m16:55:03.165264 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:03.165872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:55:03.172238 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:55:03.172445 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:55:03.172604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:04.103999 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:55:04.106716 [debug] [ThreadPool]: On list_analytics: Close
[0m16:55:04.357084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:55:04.365616 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:55:04.365919 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:55:04.366173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:04.978846 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:55:04.982836 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:55:05.097473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d5a30>]}
[0m16:55:05.099456 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:55:05.100188 [info ] [MainThread]: 
[0m16:55:05.104228 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:55:05.104686 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:55:05.105146 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:55:05.105546 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:55:05.105956 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:55:05.106357 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:55:05.106771 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:55:05.107518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:55:05.108293 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:55:05.109101 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:55:05.109837 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:55:05.110225 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:55:05.110829 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:55:05.111123 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:55:05.111414 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:55:05.127273 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:55:05.127653 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:55:05.132094 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:55:05.134907 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:55:05.137780 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:55:05.138325 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:55:05.111671 => 16:55:05.138152
[0m16:55:05.138734 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:55:05.139040 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:55:05.127833 => 16:55:05.138904
[0m16:55:05.144975 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:55:05.135180 => 16:55:05.144849
[0m16:55:05.151416 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:55:05.132320 => 16:55:05.151275
[0m16:55:05.153561 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:55:05.153800 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:55:05.154032 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:55:05.154230 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:55:05.155780 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:55:05.157252 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:55:05.157705 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:55:05.159121 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:55:05.159453 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:55:05.159940 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:55:05.160125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:05.160514 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:55:05.160749 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.161143 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:55:05.161683 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.162060 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:55:05.162291 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.162492 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:55:05.162942 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:55:05.602443 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:05.603515 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:05.613997 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:55:05.154401 => 16:55:05.613622
[0m16:55:05.616253 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:55:05.155940 => 16:55:05.616017
[0m16:55:05.617105 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:55:05.617770 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:05.618158 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:55:05.620766 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:55:05.157831 => 16:55:05.620536
[0m16:55:05.622820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:05.623175 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:55:05.625145 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:55:05.139236 => 16:55:05.624935
[0m16:55:05.626902 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:55:05.739903 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.63s]
[0m16:55:05.741034 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.63s]
[0m16:55:05.742014 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.63s]
[0m16:55:05.743104 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.63s]
[0m16:55:05.744123 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:55:05.744700 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:55:05.745210 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:55:05.745685 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:55:05.746133 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:55:05.746667 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:55:05.747372 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:55:05.747977 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:55:05.748437 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:55:05.748872 [info ] [Thread-4 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:55:05.749269 [info ] [Thread-2 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:55:05.749655 [info ] [Thread-3 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:55:05.750414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:55:05.751060 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:55:05.751607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:55:05.752133 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:55:05.752453 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:55:05.752768 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:55:05.753063 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:55:05.753350 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:55:05.758268 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:55:05.761406 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:55:05.764618 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:55:05.768004 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:55:05.770229 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:55:05.754673 => 16:55:05.770038
[0m16:55:05.770561 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:55:05.753534 => 16:55:05.770390
[0m16:55:05.770836 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:55:05.764864 => 16:55:05.770703
[0m16:55:05.771159 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:55:05.758508 => 16:55:05.770993
[0m16:55:05.771405 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:55:05.771652 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:55:05.771886 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:55:05.772116 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:55:05.774003 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:55:05.776810 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:55:05.778466 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:55:05.780128 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:55:05.781164 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:55:05.781802 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:55:05.782212 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.782698 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:55:05.783006 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.783498 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:55:05.783700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:05.783945 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.784166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:05.784392 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:05.785070 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:05.785980 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:06.185546 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:06.188348 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:55:05.772257 => 16:55:06.188074
[0m16:55:06.188803 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:55:06.211367 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:06.213430 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:55:05.776993 => 16:55:06.213187
[0m16:55:06.213823 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:55:06.216318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:06.218326 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:55:05.774180 => 16:55:06.218055
[0m16:55:06.218794 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:55:06.222776 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:06.224486 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:55:05.778627 => 16:55:06.224284
[0m16:55:06.224817 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:55:06.297954 [info ] [Thread-4 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.55s]
[0m16:55:06.298620 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:55:06.299027 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:55:06.299460 [info ] [Thread-4 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:55:06.300155 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:55:06.300493 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:55:06.304732 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:55:06.306532 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:55:06.300692 => 16:55:06.306362
[0m16:55:06.306810 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:55:06.309030 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:55:06.309895 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:55:06.310191 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:06.310440 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:06.325438 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.58s]
[0m16:55:06.326070 [info ] [Thread-3 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.57s]
[0m16:55:06.326631 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:55:06.326980 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:55:06.327267 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:55:06.327624 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m16:55:06.327968 [info ] [Thread-1 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:55:06.328308 [info ] [Thread-3 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:55:06.328812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m16:55:06.329265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m16:55:06.329508 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:55:06.329731 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m16:55:06.339598 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:55:06.341330 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:55:06.342235 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:55:06.329872 => 16:55:06.342079
[0m16:55:06.342527 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 16:55:06.339761 => 16:55:06.342372
[0m16:55:06.343246 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:55:06.343040 [info ] [Thread-2 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.59s]
[0m16:55:06.343524 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m16:55:06.357879 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:55:06.358289 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:55:06.361026 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:55:06.361574 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m16:55:06.362578 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:55:06.362062 [info ] [Thread-2 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:55:06.362944 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:55:06.363369 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:55:06.363744 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:55:06.363943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:06.364139 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:55:06.364332 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m16:55:06.364924 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:06.396587 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:55:06.398110 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 16:55:06.365229 => 16:55:06.397975
[0m16:55:06.398311 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m16:55:06.399665 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:55:06.400634 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:55:06.400843 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:55:06.401025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:06.703785 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:06.711596 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:55:06.306966 => 16:55:06.711152
[0m16:55:06.713877 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:55:06.834028 [info ] [Thread-4 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.53s]
[0m16:55:06.835223 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:55:06.835880 [debug] [Thread-4 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:55:06.836685 [info ] [Thread-4 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:55:06.837680 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:55:06.838110 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:55:06.845396 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:55:06.846457 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:55:06.838388 => 16:55:06.846207
[0m16:55:06.846850 [debug] [Thread-4 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:55:06.849945 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:55:06.852049 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:55:06.852476 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:55:06.852876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:07.517089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:07.539300 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:55:06.343660 => 16:55:07.539081
[0m16:55:07.539795 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:55:07.659524 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e35a60>]}
[0m16:55:07.660474 [info ] [Thread-1 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.33s]
[0m16:55:07.661256 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:55:07.661720 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m16:55:07.662270 [info ] [Thread-1 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:55:07.663180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:55:07.663583 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m16:55:07.671493 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:55:07.673418 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 16:55:07.663823 => 16:55:07.673221
[0m16:55:07.673744 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m16:55:07.676304 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:55:07.677968 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:55:07.678314 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:55:07.678632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:07.738593 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:07.740529 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 16:55:06.358462 => 16:55:07.740400
[0m16:55:07.740768 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m16:55:07.855275 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a383e0>]}
[0m16:55:07.855887 [info ] [Thread-3 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.53s]
[0m16:55:07.856374 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m16:55:07.856705 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:55:07.857132 [info ] [Thread-3 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:55:07.857731 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:55:07.858063 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:55:07.864858 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:55:07.865505 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:55:07.858240 => 16:55:07.865349
[0m16:55:07.865758 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:55:07.867736 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:55:07.868441 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:55:07.868702 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:55:07.868943 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:07.883420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:07.885386 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 16:55:06.398421 => 16:55:07.885240
[0m16:55:07.885648 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m16:55:08.064360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c563-0000-17c7-0009-ec8300020326
[0m16:55:08.064774 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:55:08.065218 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 16:55:07.673930 => 16:55:08.065040
[0m16:55:08.065526 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m16:55:08.079988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6a000>]}
[0m16:55:08.080565 [info ] [Thread-2 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.72s]
[0m16:55:08.081085 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m16:55:08.081467 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:55:08.081958 [info ] [Thread-2 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:55:08.082643 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:55:08.083028 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:55:08.087216 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:55:08.087877 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:55:08.083247 => 16:55:08.087711
[0m16:55:08.088151 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:55:08.090291 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:55:08.091045 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:55:08.091338 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:55:08.091609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:08.184907 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:55:08.185460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a23ec0>]}
[0m16:55:08.185904 [error] [Thread-1 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.52s]
[0m16:55:08.186327 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m16:55:08.186628 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:55:08.186993 [info ] [Thread-1 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:55:08.187637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:55:08.187942 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:55:08.191346 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:55:08.191979 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:55:08.188105 => 16:55:08.191825
[0m16:55:08.192226 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:55:08.194163 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:55:08.194891 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:55:08.195128 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:08.195366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:08.341628 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:08.343162 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:55:06.847086 => 16:55:08.343055
[0m16:55:08.343365 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:55:08.545108 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:08.545804 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:08.547534 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:55:08.088313 => 16:55:08.547385
[0m16:55:08.548116 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b565d0>]}
[0m16:55:08.549604 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:55:07.865912 => 16:55:08.549442
[0m16:55:08.549984 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:55:08.550447 [info ] [Thread-4 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.71s]
[0m16:55:08.550709 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:55:08.551502 [debug] [Thread-4 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:55:08.552399 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:55:08.552795 [info ] [Thread-4 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:55:08.553259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:55:08.553510 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:55:08.556326 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:55:08.557067 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:55:08.553883 => 16:55:08.556943
[0m16:55:08.557253 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:55:08.558677 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:55:08.559218 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:55:08.559410 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:08.559579 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:08.669160 [info ] [Thread-2 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.59s]
[0m16:55:08.669692 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:55:08.669968 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:55:08.670265 [info ] [Thread-2 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:55:08.670726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:55:08.670950 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:55:08.673854 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:55:08.674628 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:55:08.671074 => 16:55:08.674502
[0m16:55:08.674836 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:55:08.676475 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:55:08.677075 [info ] [Thread-3 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.82s]
[0m16:55:08.677445 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:55:08.677717 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:55:08.677968 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:55:08.678360 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:55:08.678715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:55:08.678942 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:55:08.679149 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:55:08.679326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:08.683019 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:55:08.684280 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:55:08.679438 => 16:55:08.684144
[0m16:55:08.684473 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:55:08.686025 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:55:08.686824 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:55:08.687021 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:55:08.687199 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:08.831694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:08.833084 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:55:08.192379 => 16:55:08.832937
[0m16:55:08.833329 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:55:08.941584 [info ] [Thread-1 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.75s]
[0m16:55:08.942009 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:55:08.942243 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:55:08.942502 [info ] [Thread-1 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:55:08.942908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:55:08.943102 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:55:08.945586 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:55:08.946207 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:08.947241 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:55:08.557353 => 16:55:08.947129
[0m16:55:08.947462 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:55:08.948134 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:55:08.943219 => 16:55:08.948026
[0m16:55:08.948358 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:55:08.949940 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:55:08.950606 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:55:08.951011 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:08.952380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:09.081578 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:09.083071 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:55:08.674961 => 16:55:09.082907
[0m16:55:09.083336 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:55:09.088250 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:09.089537 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:55:08.684580 => 16:55:09.089385
[0m16:55:09.089782 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:55:09.128000 [info ] [Thread-4 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.57s]
[0m16:55:09.128420 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:55:09.128695 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:55:09.128923 [info ] [Thread-4 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:55:09.129434 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:55:09.129715 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:55:09.132974 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:55:09.133524 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:55:09.129865 => 16:55:09.133387
[0m16:55:09.133768 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:55:09.135472 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:55:09.136122 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:55:09.136345 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:09.136552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:09.244367 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.57s]
[0m16:55:09.244909 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:55:09.245201 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:55:09.245524 [info ] [Thread-3 (]: 23 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:55:09.246042 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:55:09.246292 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:55:09.249464 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:55:09.250126 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:55:09.246436 => 16:55:09.249936
[0m16:55:09.250401 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:55:09.252123 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:55:09.252753 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:55:09.252984 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:55:09.253192 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:09.259261 [info ] [Thread-2 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.59s]
[0m16:55:09.259636 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:55:09.259890 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:55:09.260165 [info ] [Thread-2 (]: 24 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:55:09.260592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:55:09.260822 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:55:09.263618 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:55:09.264135 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:55:09.260950 => 16:55:09.264008
[0m16:55:09.264336 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:55:09.267212 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:55:09.267785 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:55:09.267994 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:55:09.268197 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:09.440914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:09.442611 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:55:08.948618 => 16:55:09.442448
[0m16:55:09.442903 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:55:09.593328 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:09.595441 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:55:09.133894 => 16:55:09.595208
[0m16:55:09.595980 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:55:09.645455 [info ] [Thread-1 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.70s]
[0m16:55:09.646291 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:55:09.646746 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:55:09.647279 [info ] [Thread-1 (]: 25 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:55:09.648106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:55:09.648516 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:55:09.653958 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:55:09.655591 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:55:09.648772 => 16:55:09.655387
[0m16:55:09.655918 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:55:09.658497 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:55:09.659778 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:55:09.660157 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:09.660605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:09.714566 [info ] [Thread-4 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.59s]
[0m16:55:09.715082 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:55:09.715375 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:55:09.715691 [info ] [Thread-4 (]: 26 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:55:09.716209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:55:09.716458 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:55:09.719787 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:55:09.720505 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:55:09.716603 => 16:55:09.720336
[0m16:55:09.720781 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:55:09.722637 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:55:09.723303 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:55:09.723539 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:09.723761 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:55:09.736760 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:09.738195 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:55:09.264452 => 16:55:09.738042
[0m16:55:09.738446 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:55:09.747602 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:09.748951 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:55:09.250543 => 16:55:09.748805
[0m16:55:09.749170 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:55:09.863758 [info ] [Thread-2 (]: 24 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.60s]
[0m16:55:09.864454 [info ] [Thread-3 (]: 23 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.62s]
[0m16:55:09.865009 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:55:09.865358 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:55:09.865679 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:55:09.866015 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:55:09.866332 [info ] [Thread-2 (]: 27 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:55:09.866688 [info ] [Thread-3 (]: 28 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:55:09.867075 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:55:09.867351 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:55:09.867619 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:55:09.867908 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:55:09.868189 [info ] [Thread-2 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:55:09.868456 [info ] [Thread-3 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:55:09.868922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:55:09.869344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:55:09.869594 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:55:09.869819 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:55:09.873261 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:55:09.875901 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:55:09.877345 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:55:09.873446 => 16:55:09.877195
[0m16:55:09.877635 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:55:09.869964 => 16:55:09.877481
[0m16:55:09.877879 [debug] [Thread-3 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:55:09.878106 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:55:09.879964 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:55:09.881590 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:55:09.882298 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:55:09.882533 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:55:09.882971 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:55:09.883237 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:55:09.883475 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:55:09.884110 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:55:10.115238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:10.116132 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:10.122920 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:55:09.656105 => 16:55:10.122665
[0m16:55:10.128061 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:55:09.720924 => 16:55:10.127873
[0m16:55:10.128495 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:55:10.128836 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:55:10.241599 [info ] [Thread-1 (]: 25 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.59s]
[0m16:55:10.242224 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:55:10.244730 [info ] [Thread-4 (]: 26 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.53s]
[0m16:55:10.245274 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:55:10.363823 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:10.368011 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:55:09.880132 => 16:55:10.367568
[0m16:55:10.368366 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:55:10.369884 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:55:10.371292 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:55:09.878244 => 16:55:10.371140
[0m16:55:10.371583 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:55:10.474007 [info ] [Thread-2 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.61s]
[0m16:55:10.475165 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:55:10.476590 [info ] [Thread-3 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.61s]
[0m16:55:10.476945 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:55:10.477482 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:55:10.477836 [info ] [Thread-1 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:55:10.478248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:55:10.478525 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:55:10.483535 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:55:10.484271 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:55:10.478687 => 16:55:10.484116
[0m16:55:10.484540 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:55:10.486626 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:55:10.487915 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:55:10.488294 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:55:10.488614 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:11.377573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:55:11.382566 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:55:10.484686 => 16:55:11.382284
[0m16:55:11.383432 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:55:11.491127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0897bd6-7440-4308-bf9b-d2f4d29c896d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7b500>]}
[0m16:55:11.491671 [info ] [Thread-1 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.01s]
[0m16:55:11.492086 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:55:11.493495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:11.493853 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:55:11.494052 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:55:11.494226 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:55:11.494394 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:55:11.494665 [info ] [MainThread]: 
[0m16:55:11.494883 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.33 seconds (8.33s).
[0m16:55:11.497224 [debug] [MainThread]: Command end result
[0m16:55:11.505249 [info ] [MainThread]: 
[0m16:55:11.505553 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:55:11.505726 [info ] [MainThread]: 
[0m16:55:11.505895 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:55:11.506071 [info ] [MainThread]: 
[0m16:55:11.506249 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:55:11.507858 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.66394, "process_user_time": 2.376927, "process_kernel_time": 0.252042, "process_mem_max_rss": "138887168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:11.508220 [debug] [MainThread]: Command `dbt build` failed at 16:55:11.508147 after 8.66 seconds
[0m16:55:11.508456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079da5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106636570>]}
[0m16:55:11.508673 [debug] [MainThread]: Flushing usage events
[0m18:00:18.608443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e64590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e37290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7e390>]}


============================== 18:00:18.611127 | 1578bbe2-b19e-4620-a800-964149b27ce5 ==============================
[0m18:00:18.611127 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:00:18.611434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:18.810982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f9880>]}
[0m18:00:18.844439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e375f0>]}
[0m18:00:18.844947 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:00:18.856311 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:00:18.894106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:00:18.894532 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m18:00:19.014443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1b590>]}
[0m18:00:19.022013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058cc080>]}
[0m18:00:19.022229 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m18:00:19.023560 [info ] [MainThread]: 
[0m18:00:19.023938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:19.024575 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m18:00:19.030526 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m18:00:19.030717 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m18:00:19.030856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:19.820540 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:00:19.824215 [debug] [ThreadPool]: On list_analytics: Close
[0m18:00:19.934332 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m18:00:19.944534 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m18:00:19.944873 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m18:00:19.945142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:20.251028 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:00:20.256095 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m18:00:20.341248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7b8c0>]}
[0m18:00:20.342352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:00:20.342747 [info ] [MainThread]: 
[0m18:00:20.345302 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:00:20.345630 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:00:20.345911 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:00:20.346230 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:00:20.346545 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m18:00:20.346880 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m18:00:20.347160 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m18:00:20.347427 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m18:00:20.348178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m18:00:20.348688 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m18:00:20.349163 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m18:00:20.349608 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m18:00:20.349858 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:00:20.350098 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:00:20.350310 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:00:20.350521 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:00:20.363602 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:00:20.368618 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:00:20.371687 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:00:20.374557 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:00:20.375915 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 18:00:20.363847 => 18:00:20.375699
[0m18:00:20.376271 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 18:00:20.350663 => 18:00:20.376078
[0m18:00:20.376566 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 18:00:20.371928 => 18:00:20.376426
[0m18:00:20.376827 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 18:00:20.368845 => 18:00:20.376698
[0m18:00:20.377086 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:00:20.377355 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:00:20.377591 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:00:20.377838 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:00:20.392668 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:00:20.394322 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:00:20.395868 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:00:20.397376 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:00:20.398232 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:00:20.398733 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:00:20.399169 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:00:20.399411 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.399652 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:00:20.400034 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:00:20.400229 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.400438 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:00:20.400629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:20.400820 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.401012 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:00:20.402191 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:00:20.670143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:20.682184 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 18:00:20.392854 => 18:00:20.681860
[0m18:00:20.682699 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m18:00:20.687315 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:20.689474 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 18:00:20.394509 => 18:00:20.689232
[0m18:00:20.689872 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m18:00:20.767733 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.42s]
[0m18:00:20.769314 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:00:20.770156 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:00:20.770879 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m18:00:20.771944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m18:00:20.772439 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:00:20.778173 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:00:20.779786 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 18:00:20.772728 => 18:00:20.779468
[0m18:00:20.780222 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:00:20.782943 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:00:20.783872 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.43s]
[0m18:00:20.784901 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:00:20.785400 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:00:20.787425 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:00:20.787789 [info ] [Thread-4 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m18:00:20.789776 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.790783 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m18:00:20.791421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:20.791763 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:00:20.796473 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:00:20.797322 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 18:00:20.792881 => 18:00:20.797151
[0m18:00:20.797595 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:00:20.799622 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:00:20.802052 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:00:20.802427 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.802764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:20.871582 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:20.873322 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 18:00:20.396018 => 18:00:20.873140
[0m18:00:20.873615 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m18:00:20.895199 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:20.896574 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 18:00:20.378003 => 18:00:20.896410
[0m18:00:20.896839 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m18:00:20.950951 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.60s]
[0m18:00:20.951524 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:00:20.951876 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:00:20.952258 [info ] [Thread-3 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m18:00:20.952881 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m18:00:20.953178 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:00:20.956915 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:00:20.957563 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 18:00:20.953344 => 18:00:20.957408
[0m18:00:20.957814 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:00:20.959748 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:00:20.960480 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:00:20.960751 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.961015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:20.980961 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.63s]
[0m18:00:20.981477 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:00:20.981768 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:00:20.982134 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m18:00:20.982723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m18:00:20.983032 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:00:20.986118 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:00:20.986666 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 18:00:20.983203 => 18:00:20.986523
[0m18:00:20.986895 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:00:20.988621 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:00:20.990230 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:00:20.990680 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:20.991127 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:21.064594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:21.066128 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 18:00:20.780477 => 18:00:21.065966
[0m18:00:21.066384 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m18:00:21.110096 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:21.111604 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 18:00:20.797789 => 18:00:21.111434
[0m18:00:21.111877 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m18:00:21.138732 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.37s]
[0m18:00:21.139182 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:00:21.139469 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:00:21.139799 [info ] [Thread-1 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m18:00:21.140369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m18:00:21.140609 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:00:21.143956 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:00:21.145119 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 18:00:21.140750 => 18:00:21.144960
[0m18:00:21.145454 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:00:21.147328 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:00:21.149467 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:00:21.149814 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:21.150163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:21.190160 [info ] [Thread-4 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.40s]
[0m18:00:21.190586 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:00:21.190844 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m18:00:21.191165 [info ] [Thread-4 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m18:00:21.191622 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_customer)
[0m18:00:21.191841 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m18:00:21.194635 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m18:00:21.195107 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 18:00:21.191966 => 18:00:21.194981
[0m18:00:21.195319 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m18:00:21.210986 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m18:00:21.211699 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m18:00:21.211913 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m18:00:21.212101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:21.214253 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:21.215558 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 18:00:20.957957 => 18:00:21.215439
[0m18:00:21.215872 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m18:00:21.237296 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:21.238456 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 18:00:20.987026 => 18:00:21.238322
[0m18:00:21.238677 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m18:00:21.286851 [info ] [Thread-3 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.33s]
[0m18:00:21.287244 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:00:21.287487 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m18:00:21.287771 [info ] [Thread-3 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m18:00:21.288221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m18:00:21.288434 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m18:00:21.290332 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m18:00:21.291995 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 18:00:21.288558 => 18:00:21.291874
[0m18:00:21.292186 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m18:00:21.293968 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m18:00:21.294606 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m18:00:21.294824 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m18:00:21.295025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:21.308352 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.33s]
[0m18:00:21.308758 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:00:21.309009 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m18:00:21.309355 [info ] [Thread-2 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m18:00:21.309804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m18:00:21.310017 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m18:00:21.312700 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m18:00:21.313158 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 18:00:21.310144 => 18:00:21.313032
[0m18:00:21.313356 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m18:00:21.314904 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m18:00:21.315793 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m18:00:21.316024 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m18:00:21.316230 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:21.403692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:21.407519 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 18:00:21.145621 => 18:00:21.407349
[0m18:00:21.408380 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m18:00:21.479133 [info ] [Thread-1 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.34s]
[0m18:00:21.480039 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:00:21.480438 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m18:00:21.480848 [info ] [Thread-1 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m18:00:21.481456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_sales)
[0m18:00:21.481865 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m18:00:21.487954 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m18:00:21.489473 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 18:00:21.482164 => 18:00:21.489289
[0m18:00:21.489746 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m18:00:21.491820 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m18:00:21.493151 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m18:00:21.493461 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        Quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m18:00:21.493752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:21.776335 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c5a4-0000-17a6-0009-ec8300021372
[0m18:00:21.777063 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m18:00:21.777683 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 18:00:21.489899 => 18:00:21.777452
[0m18:00:21.778056 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m18:00:21.882946 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:00:21.883792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4fc80>]}
[0m18:00:21.884571 [error] [Thread-1 (]: 13 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.40s]
[0m18:00:21.885784 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m18:00:21.886216 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m18:00:21.886854 [info ] [Thread-1 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m18:00:21.887635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now model.northwind.fact_order_fulfillment)
[0m18:00:21.888016 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m18:00:21.894887 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m18:00:21.895718 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 18:00:21.888229 => 18:00:21.895522
[0m18:00:21.896037 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m18:00:21.898859 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m18:00:21.900955 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m18:00:21.901348 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m18:00:21.901700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:38.899545 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 18.0 seconds
[0m18:00:38.914598 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 18:00:21.313469 => 18:00:38.914421
[0m18:00:38.915085 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m18:00:39.072338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e2c800>]}
[0m18:00:39.073801 [info ] [Thread-2 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 17.76s]
[0m18:00:39.074844 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m18:00:39.075419 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:00:39.076168 [info ] [Thread-2 (]: 15 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m18:00:39.076811 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:00:39.077385 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:00:39.077813 [info ] [Thread-2 (]: 16 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m18:00:39.078215 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:00:39.078620 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:00:39.079034 [info ] [Thread-2 (]: 17 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m18:00:39.079813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m18:00:39.080178 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:00:39.087626 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:00:39.089529 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 18:00:39.080407 => 18:00:39.089318
[0m18:00:39.089860 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:00:39.092217 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:00:39.093285 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:00:39.093582 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m18:00:39.093846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:39.621861 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:39.626656 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 18:00:39.090054 => 18:00:39.626199
[0m18:00:39.627397 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m18:00:39.717929 [info ] [Thread-2 (]: 17 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.64s]
[0m18:00:39.719230 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:00:39.719823 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:00:39.720392 [info ] [Thread-2 (]: 18 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m18:00:39.721452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m18:00:39.721919 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:00:39.726372 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:00:39.728357 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 18:00:39.722117 => 18:00:39.728139
[0m18:00:39.728687 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:00:39.731286 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:00:39.732222 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:00:39.732569 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m18:00:39.732886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:39.857542 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 19.0 seconds
[0m18:00:39.860363 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 18:00:21.292309 => 18:00:39.860153
[0m18:00:39.860754 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m18:00:39.869401 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 19.0 seconds
[0m18:00:39.871643 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 18:00:21.195440 => 18:00:39.871469
[0m18:00:39.871945 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m18:00:39.879213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 18.0 seconds
[0m18:00:39.881590 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 18:00:21.896259 => 18:00:39.881400
[0m18:00:39.881904 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m18:00:40.024296 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075650a0>]}
[0m18:00:40.025211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107584b30>]}
[0m18:00:40.025985 [info ] [Thread-3 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 18.74s]
[0m18:00:40.026661 [info ] [Thread-1 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 18.14s]
[0m18:00:40.027354 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m18:00:40.027868 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m18:00:40.028267 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:00:40.028781 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:00:40.029205 [info ] [Thread-3 (]: 19 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m18:00:40.029637 [info ] [Thread-1 (]: 20 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m18:00:40.030282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m18:00:40.030848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m18:00:40.031153 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:00:40.031436 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:00:40.036202 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:00:40.039418 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:00:40.040139 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 18:00:40.036436 => 18:00:40.039949
[0m18:00:40.040474 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 18:00:40.031618 => 18:00:40.040304
[0m18:00:40.040756 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:00:40.041025 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:00:40.043199 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:00:40.045185 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:00:40.045935 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:00:40.046211 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:40.046456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:40.046967 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:00:40.048149 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:40.048487 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:40.049864 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075b78f0>]}
[0m18:00:40.050357 [info ] [Thread-4 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 18.86s]
[0m18:00:40.051417 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m18:00:40.051691 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:00:40.052033 [info ] [Thread-4 (]: 21 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m18:00:40.052505 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m18:00:40.052739 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:00:40.056728 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:00:40.057230 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 18:00:40.052918 => 18:00:40.057092
[0m18:00:40.057459 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:00:40.059199 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:00:40.059739 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:00:40.059947 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m18:00:40.060146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:40.493697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:40.505333 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 18:00:39.728877 => 18:00:40.505015
[0m18:00:40.506168 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m18:00:40.592878 [info ] [Thread-2 (]: 18 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.87s]
[0m18:00:40.593965 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:00:40.594537 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:00:40.595533 [info ] [Thread-2 (]: 22 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m18:00:40.596708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m18:00:40.597203 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:00:40.602716 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:00:40.603725 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 18:00:40.597472 => 18:00:40.603496
[0m18:00:40.604093 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:00:40.606769 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:00:40.607655 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:00:40.607985 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m18:00:40.608296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:41.007293 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:41.008443 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:41.009552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:41.012829 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 18:00:40.057604 => 18:00:41.012498
[0m18:00:41.014733 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 18:00:40.043390 => 18:00:41.014508
[0m18:00:41.016547 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 18:00:40.041191 => 18:00:41.016331
[0m18:00:41.016944 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m18:00:41.017306 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m18:00:41.017648 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m18:00:41.113714 [info ] [Thread-1 (]: 20 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 1.08s]
[0m18:00:41.115287 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:00:41.116254 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:00:41.117108 [info ] [Thread-1 (]: 23 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m18:00:41.118176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m18:00:41.118664 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:00:41.124008 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:00:41.124913 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 18:00:41.118937 => 18:00:41.124692
[0m18:00:41.125277 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:00:41.128037 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:00:41.128928 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:00:41.129260 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:41.129571 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:41.251468 [info ] [Thread-3 (]: 19 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 1.22s]
[0m18:00:41.252038 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:00:41.252372 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:00:41.252718 [info ] [Thread-3 (]: 24 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m18:00:41.253321 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m18:00:41.253619 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:00:41.257014 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:00:41.257549 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 18:00:41.253801 => 18:00:41.257403
[0m18:00:41.257785 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:00:41.259671 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:00:41.260375 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:00:41.260634 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:41.260872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:41.318546 [info ] [Thread-4 (]: 21 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 1.27s]
[0m18:00:41.319021 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:00:41.319304 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:00:41.319626 [info ] [Thread-4 (]: 25 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m18:00:41.320125 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m18:00:41.320383 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:00:41.323396 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:00:41.323918 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 18:00:41.320538 => 18:00:41.323779
[0m18:00:41.324139 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:00:41.327180 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:00:41.327768 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:00:41.327995 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m18:00:41.328203 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:41.392195 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:41.393691 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 18:00:40.604342 => 18:00:41.393534
[0m18:00:41.393966 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m18:00:41.560317 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:41.565143 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 18:00:41.257930 => 18:00:41.564727
[0m18:00:41.565861 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m18:00:41.642180 [info ] [Thread-3 (]: 24 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.39s]
[0m18:00:41.643633 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:00:41.644266 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:00:41.644932 [info ] [Thread-3 (]: 26 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m18:00:41.646020 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m18:00:41.646530 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:00:41.651930 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:00:41.652927 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 18:00:41.646773 => 18:00:41.652697
[0m18:00:41.653311 [debug] [Thread-3 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:00:41.656008 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:00:41.656939 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:00:41.657435 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:41.657807 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:41.701788 [info ] [Thread-2 (]: 22 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.11s]
[0m18:00:41.702287 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:00:41.702604 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:00:41.702962 [info ] [Thread-2 (]: 27 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m18:00:41.703575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m18:00:41.703865 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:00:41.707066 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:00:41.707626 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 18:00:41.704018 => 18:00:41.707483
[0m18:00:41.707871 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:00:41.709765 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:00:41.710384 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:00:41.710633 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m18:00:41.710870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:42.304964 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:42.311318 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 18:00:41.324271 => 18:00:42.310873
[0m18:00:42.312083 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m18:00:42.378425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:42.382699 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 18:00:41.125492 => 18:00:42.382305
[0m18:00:42.383431 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m18:00:42.437364 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:42.441575 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 18:00:41.708010 => 18:00:42.441175
[0m18:00:42.442306 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m18:00:42.510817 [info ] [Thread-4 (]: 25 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 1.19s]
[0m18:00:42.512350 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:00:42.513001 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:00:42.513680 [info ] [Thread-4 (]: 28 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m18:00:42.514724 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m18:00:42.515208 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:00:42.520752 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:00:42.521990 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:42.524042 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 18:00:41.653534 => 18:00:42.523819
[0m18:00:42.524449 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 18:00:42.515443 => 18:00:42.524249
[0m18:00:42.524803 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m18:00:42.525190 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:00:42.528804 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:00:42.529810 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:00:42.530108 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m18:00:42.530377 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:00:42.594555 [info ] [Thread-1 (]: 23 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.48s]
[0m18:00:42.595084 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:00:42.595412 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:00:42.595752 [info ] [Thread-1 (]: 29 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m18:00:42.596342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m18:00:42.596630 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:00:42.600123 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:00:42.600677 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 18:00:42.596798 => 18:00:42.600530
[0m18:00:42.600926 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:00:42.602774 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:00:42.603490 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:00:42.603747 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:42.603985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:42.740365 [info ] [Thread-2 (]: 27 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 1.04s]
[0m18:00:42.740985 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:00:42.741355 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:00:42.741762 [info ] [Thread-2 (]: 30 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m18:00:42.742410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m18:00:42.742728 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:00:42.748323 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:00:42.748963 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 18:00:42.742913 => 18:00:42.748792
[0m18:00:42.749237 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:00:42.751317 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:00:42.752105 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:00:42.752394 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:00:42.752665 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:00:42.755934 [info ] [Thread-3 (]: 26 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 1.11s]
[0m18:00:42.756320 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:00:42.929060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:00:42.931310 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 18:00:42.601071 => 18:00:42.931073
[0m18:00:42.931698 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m18:00:43.363899 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:43.371883 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 18:00:42.526307 => 18:00:43.371527
[0m18:00:43.368837 [info ] [Thread-1 (]: 29 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.77s]
[0m18:00:43.372596 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m18:00:43.373141 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:00:43.457783 [info ] [Thread-4 (]: 28 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.94s]
[0m18:00:43.458720 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:00:43.468103 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:43.470485 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 18:00:42.749398 => 18:00:43.470243
[0m18:00:43.470887 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m18:00:43.706263 [info ] [Thread-2 (]: 30 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.96s]
[0m18:00:43.707624 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:00:43.708318 [debug] [Thread-3 (]: Began running node model.northwind.obt_order_fulfillment
[0m18:00:43.708634 [info ] [Thread-3 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m18:00:43.709032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now model.northwind.obt_order_fulfillment)
[0m18:00:43.709222 [debug] [Thread-3 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m18:00:43.711468 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m18:00:43.712136 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 18:00:43.709331 => 18:00:43.712017
[0m18:00:43.712328 [debug] [Thread-3 (]: Began executing node model.northwind.obt_order_fulfillment
[0m18:00:43.713853 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m18:00:43.714783 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m18:00:43.715006 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m18:00:43.715214 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:00:44.996204 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:45.004967 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 18:00:43.712443 => 18:00:45.004803
[0m18:00:45.005319 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: Close
[0m18:00:45.173587 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1578bbe2-b19e-4620-a800-964149b27ce5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116ac15b0>]}
[0m18:00:45.174197 [info ] [Thread-3 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.46s]
[0m18:00:45.174625 [debug] [Thread-3 (]: Finished running node model.northwind.obt_order_fulfillment
[0m18:00:45.175938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:45.176186 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerid.04913d3698' was properly closed.
[0m18:00:45.176374 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerkey.183274e37c' was properly closed.
[0m18:00:45.176540 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m18:00:45.176698 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_customer_customerkey.904a936983' was properly closed.
[0m18:00:45.176937 [info ] [MainThread]: 
[0m18:00:45.177150 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 26.15 seconds (26.15s).
[0m18:00:45.179423 [debug] [MainThread]: Command end result
[0m18:00:45.188738 [info ] [MainThread]: 
[0m18:00:45.189004 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:00:45.189183 [info ] [MainThread]: 
[0m18:00:45.189355 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:00:45.189540 [info ] [MainThread]: 
[0m18:00:45.189715 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m18:00:45.191403 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 26.614634, "process_user_time": 2.616457, "process_kernel_time": 0.286426, "process_mem_max_rss": "145489920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:00:45.191740 [debug] [MainThread]: Command `dbt build` failed at 18:00:45.191668 after 26.62 seconds
[0m18:00:45.191971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bdb1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e9e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb8b60>]}
[0m18:00:45.192191 [debug] [MainThread]: Flushing usage events
[0m18:01:24.602670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114018320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c6a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11403a420>]}


============================== 18:01:24.605414 | 1311cce7-adb4-4382-9adb-8d7aafe371ed ==============================
[0m18:01:24.605414 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:01:24.605730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:01:24.797190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11403a360>]}
[0m18:01:24.833081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cca3c0>]}
[0m18:01:24.833824 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:01:24.846704 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:01:24.881772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:01:24.882185 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m18:01:25.006537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116cc19a0>]}
[0m18:01:25.014304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116920980>]}
[0m18:01:25.014560 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m18:01:25.015986 [info ] [MainThread]: 
[0m18:01:25.016390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:25.016992 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m18:01:25.023057 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m18:01:25.023237 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m18:01:25.023383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:25.920464 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:01:25.922814 [debug] [ThreadPool]: On list_analytics: Close
[0m18:01:26.114481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m18:01:26.124136 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m18:01:26.124546 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m18:01:26.124805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:27.234436 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:01:27.238543 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m18:01:27.430547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116db0b30>]}
[0m18:01:27.431466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:27.431844 [info ] [MainThread]: 
[0m18:01:27.435294 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:01:27.435755 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:01:27.436159 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:01:27.436899 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:01:27.436569 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m18:01:27.437327 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m18:01:27.437686 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m18:01:27.438023 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m18:01:27.438655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m18:01:27.439624 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m18:01:27.440232 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m18:01:27.440814 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m18:01:27.441142 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:01:27.441451 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:01:27.441737 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:01:27.442014 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:01:27.456520 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:01:27.461036 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:01:27.463726 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:01:27.466359 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:01:27.467087 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 18:01:27.442202 => 18:01:27.466902
[0m18:01:27.467491 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 18:01:27.461233 => 18:01:27.467297
[0m18:01:27.467759 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:01:27.468021 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 18:01:27.456762 => 18:01:27.467893
[0m18:01:27.468255 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 18:01:27.463913 => 18:01:27.468138
[0m18:01:27.468463 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:01:27.482324 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:01:27.482587 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:01:27.482795 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:01:27.484326 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:01:27.485859 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:01:27.487336 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:01:27.487857 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:01:27.488373 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:01:27.488631 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:01:27.489075 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:01:27.489497 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:01:27.489688 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:27.489896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:27.490098 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:27.490312 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:27.490499 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:27.491017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:27.491372 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:01:28.495242 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:28.505299 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 18:01:27.482924 => 18:01:28.504991
[0m18:01:28.506117 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m18:01:28.507574 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:28.509541 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 18:01:27.486026 => 18:01:28.509310
[0m18:01:28.510168 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m18:01:28.610976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:28.612635 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 18:01:27.468596 => 18:01:28.612447
[0m18:01:28.612930 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m18:01:28.787457 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 1.35s]
[0m18:01:28.789057 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:01:28.789607 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:01:28.790278 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m18:01:28.790983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m18:01:28.791567 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 1.35s]
[0m18:01:28.791847 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:01:28.792209 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:01:28.795306 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:01:28.795636 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:01:28.796075 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m18:01:28.796689 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m18:01:28.796984 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:01:28.797296 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 18:01:28.792415 => 18:01:28.797137
[0m18:01:28.800362 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:01:28.800631 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:01:28.802365 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:01:28.802770 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 18:01:28.797445 => 18:01:28.802647
[0m18:01:28.803239 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:01:28.803497 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:01:28.803755 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:28.805473 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:01:28.805701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:28.807899 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:01:28.808186 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:28.808407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:28.906390 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 1.47s]
[0m18:01:28.907104 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:01:28.907490 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:01:28.907998 [info ] [Thread-4 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m18:01:28.908691 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m18:01:28.909024 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:01:28.912895 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:01:28.913529 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 18:01:28.909221 => 18:01:28.913358
[0m18:01:28.913804 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:01:28.915950 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:01:28.916730 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:01:28.917024 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:28.917300 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:29.219193 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:01:29.224060 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 18:01:27.484526 => 18:01:29.223689
[0m18:01:29.224671 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m18:01:29.682480 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 2.24s]
[0m18:01:29.683370 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:01:29.683787 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:01:29.684348 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m18:01:29.685003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m18:01:29.685325 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:01:29.689450 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:01:29.690302 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 18:01:29.685516 => 18:01:29.690133
[0m18:01:29.690566 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:01:29.692685 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:01:29.693703 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:01:29.694190 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:29.694638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:30.263941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:30.269785 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 18:01:28.800834 => 18:01:30.269421
[0m18:01:30.270366 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m18:01:30.281282 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:30.283610 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 18:01:28.803907 => 18:01:30.283346
[0m18:01:30.284067 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m18:01:30.324152 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:30.326877 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 18:01:29.690718 => 18:01:30.326559
[0m18:01:30.327383 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m18:01:30.417829 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 1.62s]
[0m18:01:30.418997 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:01:30.419762 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:01:30.420325 [info ] [Thread-3 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m18:01:30.420908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m18:01:30.421213 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:01:30.424837 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:01:30.426867 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 18:01:30.421384 => 18:01:30.426660
[0m18:01:30.427174 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:01:30.429428 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:01:30.430284 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:01:30.430590 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:30.430884 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:30.527868 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:01:30.529896 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 18:01:28.913962 => 18:01:30.529666
[0m18:01:30.530288 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m18:01:30.628241 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 1.84s]
[0m18:01:30.629319 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:01:30.630214 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m18:01:30.631409 [info ] [Thread-1 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m18:01:30.632469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m18:01:30.632920 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m18:01:30.637891 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m18:01:30.638727 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 18:01:30.633170 => 18:01:30.638526
[0m18:01:30.639058 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m18:01:30.660919 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m18:01:30.661738 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m18:01:30.662010 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m18:01:30.662256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:30.712707 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 1.03s]
[0m18:01:30.713160 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:01:30.713433 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m18:01:30.713798 [info ] [Thread-2 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m18:01:30.714233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m18:01:30.714442 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m18:01:30.716403 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m18:01:30.718093 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 18:01:30.714588 => 18:01:30.717959
[0m18:01:30.718304 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m18:01:30.720023 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m18:01:30.720606 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m18:01:30.720831 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m18:01:30.721035 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:30.801535 [info ] [Thread-4 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 1.89s]
[0m18:01:30.802043 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:01:30.802337 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m18:01:30.802697 [info ] [Thread-4 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m18:01:30.803263 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m18:01:30.803501 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m18:01:30.806809 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m18:01:30.807333 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 18:01:30.803643 => 18:01:30.807197
[0m18:01:30.807567 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m18:01:30.809421 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m18:01:30.810478 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m18:01:30.810773 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m18:01:30.811017 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:31.062329 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:31.067900 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 18:01:30.427360 => 18:01:31.067458
[0m18:01:31.068742 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m18:01:31.154344 [info ] [Thread-3 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.73s]
[0m18:01:31.155492 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:01:31.156326 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m18:01:31.157337 [info ] [Thread-3 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m18:01:31.158405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m18:01:31.158920 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m18:01:31.166240 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m18:01:31.168035 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 18:01:31.159216 => 18:01:31.167812
[0m18:01:31.168396 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m18:01:31.171267 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m18:01:31.173431 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m18:01:31.173866 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m18:01:31.174212 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:31.353728 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:31.376089 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 18:01:30.718429 => 18:01:31.375881
[0m18:01:31.376498 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m18:01:31.452989 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b74c50>]}
[0m18:01:31.453764 [info ] [Thread-2 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.74s]
[0m18:01:31.454491 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m18:01:31.455002 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m18:01:31.455664 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m18:01:31.456659 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m18:01:31.457135 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m18:01:31.465066 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m18:01:31.466895 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 18:01:31.457386 => 18:01:31.466676
[0m18:01:31.467248 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m18:01:31.471754 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m18:01:31.473295 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m18:01:31.473657 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * quantity as discountamount,
        (UnitPrice * quantity) - (Discount * UnitPrice * quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m18:01:31.473988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:32.348832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:01:32.350805 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 18:01:30.639251 => 18:01:32.350662
[0m18:01:32.351076 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m18:01:32.589242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f77800>]}
[0m18:01:32.590609 [info ] [Thread-1 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.96s]
[0m18:01:32.591414 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m18:01:32.591955 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:01:32.592642 [info ] [Thread-1 (]: 15 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m18:01:32.593975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m18:01:32.594565 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:01:32.603187 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:01:32.604936 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 18:01:32.594858 => 18:01:32.604706
[0m18:01:32.605270 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:01:32.608004 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:01:32.609074 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:01:32.609480 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m18:01:32.609828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:32.617788 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c5a5-0000-17a6-0009-ec83000213a2
[0m18:01:32.618136 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m18:01:32.618528 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 18:01:31.467437 => 18:01:32.618369
[0m18:01:32.618805 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m18:01:33.093683 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:01:33.094463 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116a7cad0>]}
[0m18:01:33.095112 [error] [Thread-2 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 1.64s]
[0m18:01:33.095734 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m18:01:33.096157 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:01:33.096740 [info ] [Thread-2 (]: 16 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m18:01:33.097493 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m18:01:33.097838 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:01:33.102430 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:01:33.103179 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 18:01:33.098051 => 18:01:33.102992
[0m18:01:33.103484 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:01:33.105944 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:01:33.106801 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:01:33.107127 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m18:01:33.107397 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:33.402642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:33.407450 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 18:01:32.605462 => 18:01:33.407018
[0m18:01:33.408184 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m18:01:33.448653 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:01:33.453694 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 18:01:30.807699 => 18:01:33.453293
[0m18:01:33.454477 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m18:01:33.639874 [info ] [Thread-1 (]: 15 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 1.05s]
[0m18:01:33.640493 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:01:33.640835 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:01:33.641226 [info ] [Thread-1 (]: 17 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m18:01:33.641841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m18:01:33.642134 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:01:33.645785 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:01:33.646414 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 18:01:33.642306 => 18:01:33.646257
[0m18:01:33.646662 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:01:33.648589 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:01:33.649292 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:01:33.649561 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:33.649804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:34.664204 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:01:34.670637 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 18:01:31.168605 => 18:01:34.670332
[0m18:01:34.671830 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m18:01:34.674277 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116c24140>]}
[0m18:01:34.675196 [info ] [Thread-4 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 3.87s]
[0m18:01:34.676367 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m18:01:34.677010 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:01:34.677675 [info ] [Thread-4 (]: 18 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m18:01:34.678482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m18:01:34.678951 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:01:34.684158 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:01:34.685771 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 18:01:34.679412 => 18:01:34.685539
[0m18:01:34.686135 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:01:34.690799 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:01:34.691887 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:01:34.692228 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:34.692523 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:36.450805 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117fce720>]}
[0m18:01:36.452006 [info ] [Thread-3 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 5.29s]
[0m18:01:36.452813 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m18:01:36.453378 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:01:36.454058 [info ] [Thread-3 (]: 19 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m18:01:36.455154 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m18:01:36.455649 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:01:36.460927 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:01:36.461965 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 18:01:36.455900 => 18:01:36.461693
[0m18:01:36.462366 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:01:36.465147 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:01:36.466195 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:01:36.466550 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m18:01:36.466870 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:36.741827 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:01:36.745452 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 18:01:33.103667 => 18:01:36.745061
[0m18:01:36.746109 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m18:01:37.195882 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:01:37.198436 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 18:01:34.686341 => 18:01:37.198205
[0m18:01:37.198849 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m18:01:37.336541 [info ] [Thread-4 (]: 18 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 2.66s]
[0m18:01:37.337466 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:01:37.338067 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:01:37.338754 [info ] [Thread-4 (]: 20 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m18:01:37.339854 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m18:01:37.340337 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:01:37.346312 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:01:37.348187 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 18:01:37.340576 => 18:01:37.347837
[0m18:01:37.348622 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:01:37.351690 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:01:37.352770 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:01:37.353178 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m18:01:37.353522 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:38.761654 [info ] [Thread-2 (]: 16 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 5.66s]
[0m18:01:38.762462 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:01:38.762864 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:01:38.763286 [info ] [Thread-2 (]: 21 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m18:01:38.763990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m18:01:38.764301 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:01:38.767943 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:01:38.768585 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 18:01:38.764481 => 18:01:38.768425
[0m18:01:38.768831 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:01:38.770786 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:01:38.771556 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:01:38.771822 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:38.772069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:39.883499 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:01:39.887935 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 18:01:38.768980 => 18:01:39.887707
[0m18:01:39.888305 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m18:01:40.804782 [info ] [Thread-2 (]: 21 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 2.04s]
[0m18:01:40.805405 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:01:40.805703 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:01:40.806059 [info ] [Thread-2 (]: 22 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m18:01:40.806588 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m18:01:40.806841 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:01:40.810145 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:01:40.810791 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 18:01:40.806987 => 18:01:40.810645
[0m18:01:40.811043 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:01:40.813931 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:01:40.814639 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:01:40.814874 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:40.815093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:45.005839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 11.0 seconds
[0m18:01:45.010278 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 18:01:33.646810 => 18:01:45.009628
[0m18:01:45.011382 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m18:01:45.098870 [info ] [Thread-1 (]: 17 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 11.46s]
[0m18:01:45.100284 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:01:45.101691 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:01:45.102248 [info ] [Thread-1 (]: 23 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m18:01:45.102741 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:01:45.103167 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:01:45.103622 [info ] [Thread-1 (]: 24 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m18:01:45.104091 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:01:45.104504 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:01:45.104921 [info ] [Thread-1 (]: 25 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m18:01:45.105894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m18:01:45.106665 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:01:45.113421 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:01:45.115570 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 18:01:45.107420 => 18:01:45.115237
[0m18:01:45.116590 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:01:45.120967 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:01:45.122434 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:01:45.122747 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m18:01:45.122954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:49.308024 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 13.0 seconds
[0m18:01:49.316360 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 18:01:36.462591 => 18:01:49.315550
[0m18:01:49.317714 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m18:01:49.414696 [info ] [Thread-3 (]: 19 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 12.96s]
[0m18:01:49.416831 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:01:49.417998 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:01:49.419059 [info ] [Thread-3 (]: 26 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m18:01:49.420719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m18:01:49.421539 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:01:49.431515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:01:49.434281 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 18:01:49.422020 => 18:01:49.433929
[0m18:01:49.434736 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:01:49.437504 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:01:49.438662 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:01:49.439102 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m18:01:49.439440 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:53.349963 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 16.0 seconds
[0m18:01:53.357330 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 18:01:37.348886 => 18:01:53.356480
[0m18:01:53.358679 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m18:01:55.366150 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m18:01:55.373816 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 18:01:49.434956 => 18:01:55.373026
[0m18:01:55.375154 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m18:01:55.406644 [info ] [Thread-4 (]: 20 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 18.07s]
[0m18:01:55.408267 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:01:55.409335 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:01:55.410374 [info ] [Thread-4 (]: 27 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m18:01:55.412012 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m18:01:55.413720 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:01:55.422794 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:01:55.427180 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 18:01:55.414369 => 18:01:55.426699
[0m18:01:55.427891 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:01:55.431887 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:01:55.433482 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:01:55.433970 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:55.434373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:55.752703 [info ] [Thread-3 (]: 26 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 6.33s]
[0m18:01:55.754561 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:01:55.755486 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:01:55.756539 [info ] [Thread-3 (]: 28 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m18:01:55.757911 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m18:01:55.758663 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:01:55.767479 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:01:55.769445 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 18:01:55.759042 => 18:01:55.768916
[0m18:01:55.770142 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:01:55.776398 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:01:55.777928 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:01:55.778342 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:55.778722 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:01:55.900564 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 15.0 seconds
[0m18:01:55.907741 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 18:01:40.811180 => 18:01:55.907080
[0m18:01:55.909865 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m18:01:56.002866 [info ] [Thread-2 (]: 22 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 15.20s]
[0m18:01:56.004581 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:01:56.005559 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:01:56.006627 [info ] [Thread-2 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m18:01:56.008437 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m18:01:56.009501 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:01:56.019695 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:01:56.020945 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 18:01:56.009967 => 18:01:56.020638
[0m18:01:56.021435 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:01:56.025172 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:01:56.026359 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:01:56.026773 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m18:01:56.027147 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:57.397048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 12.0 seconds
[0m18:01:57.404408 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 18:01:45.117053 => 18:01:57.403780
[0m18:01:57.405447 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m18:02:01.431893 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m18:02:01.439183 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 18:01:55.770451 => 18:02:01.438075
[0m18:02:01.440634 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m18:02:03.546323 [info ] [Thread-1 (]: 25 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 18.44s]
[0m18:02:03.548995 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:02:03.550135 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:02:03.551142 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m18:02:03.552889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m18:02:03.553800 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:02:03.563466 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:02:03.566736 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 18:02:03.554405 => 18:02:03.566259
[0m18:02:03.567348 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:02:03.571113 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:02:03.572574 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:02:03.573028 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:02:03.573414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:04.222695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:02:04.230013 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 18:02:03.567649 => 18:02:04.229569
[0m18:02:04.230729 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m18:02:05.799228 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m18:02:05.805392 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 18:01:55.428711 => 18:02:05.804915
[0m18:02:05.806236 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m18:02:05.890665 [info ] [Thread-4 (]: 27 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 10.48s]
[0m18:02:05.893369 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:02:07.641028 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 4.09s]
[0m18:02:07.644058 [info ] [Thread-3 (]: 28 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 11.89s]
[0m18:02:07.645304 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:02:07.645947 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:02:15.927716 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 20.0 seconds
[0m18:02:15.931489 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 18:01:56.021730 => 18:02:15.931131
[0m18:02:15.932254 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m18:02:19.932810 [info ] [Thread-2 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 23.92s]
[0m18:02:19.934923 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:02:19.936476 [debug] [Thread-4 (]: Began running node model.northwind.obt_order_fulfillment
[0m18:02:19.937438 [info ] [Thread-4 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m18:02:19.938777 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m18:02:19.939649 [debug] [Thread-4 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m18:02:19.948074 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m18:02:19.951402 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 18:02:19.940060 => 18:02:19.950853
[0m18:02:19.952065 [debug] [Thread-4 (]: Began executing node model.northwind.obt_order_fulfillment
[0m18:02:19.955945 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m18:02:19.958181 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m18:02:19.958665 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m18:02:19.959093 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:02:21.149906 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:02:21.154708 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 18:02:19.952393 => 18:02:21.154408
[0m18:02:21.155452 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: Close
[0m18:02:24.331048 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1311cce7-adb4-4382-9adb-8d7aafe371ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12683d040>]}
[0m18:02:24.333026 [info ] [Thread-4 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 4.39s]
[0m18:02:24.334341 [debug] [Thread-4 (]: Finished running node model.northwind.obt_order_fulfillment
[0m18:02:24.338776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:24.339772 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m18:02:24.340404 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m18:02:24.341130 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m18:02:24.341769 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m18:02:24.342504 [info ] [MainThread]: 
[0m18:02:24.343113 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 59.33 seconds (59.33s).
[0m18:02:24.350311 [debug] [MainThread]: Command end result
[0m18:02:24.368685 [info ] [MainThread]: 
[0m18:02:24.369214 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:02:24.369523 [info ] [MainThread]: 
[0m18:02:24.369830 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:02:24.370123 [info ] [MainThread]: 
[0m18:02:24.370421 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m18:02:24.373857 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 59.800064, "process_user_time": 3.106868, "process_kernel_time": 0.317611, "process_mem_max_rss": "146063360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:02:24.374485 [debug] [MainThread]: Command `dbt build` failed at 18:02:24.374349 after 59.80 seconds
[0m18:02:24.374852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114018470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fdc410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116b38d40>]}
[0m18:02:24.375221 [debug] [MainThread]: Flushing usage events
[0m18:11:49.447114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510a240>]}


============================== 18:11:49.449601 | fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac ==============================
[0m18:11:49.449601 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:11:49.449904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:11:49.640354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513c380>]}
[0m18:11:49.673176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10517c380>]}
[0m18:11:49.673627 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:11:49.684771 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:11:49.720398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m18:11:49.720773 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_product.yml
[0m18:11:49.720943 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_product.sql
[0m18:11:49.841718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5b4a0>]}
[0m18:11:49.848747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a32990>]}
[0m18:11:49.848957 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m18:11:49.850332 [info ] [MainThread]: 
[0m18:11:49.850713 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:11:49.851314 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m18:11:49.857263 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m18:11:49.857448 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m18:11:49.857592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:02.374992 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 13.0 seconds
[0m18:12:02.377536 [debug] [ThreadPool]: On list_analytics: Close
[0m18:12:04.306008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m18:12:04.315968 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m18:12:04.316323 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m18:12:04.316593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:04.758880 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:12:04.762511 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m18:12:04.845186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c10830>]}
[0m18:12:04.846308 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:12:04.846734 [info ] [MainThread]: 
[0m18:12:04.850540 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:12:04.851008 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:12:04.851456 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:12:04.851816 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:12:04.852225 [info ] [Thread-1 (]: 1 of 36 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m18:12:04.852678 [info ] [Thread-2 (]: 2 of 36 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m18:12:04.853078 [info ] [Thread-3 (]: 3 of 36 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m18:12:04.853459 [info ] [Thread-4 (]: 4 of 36 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m18:12:04.854624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m18:12:04.855341 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m18:12:04.856046 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m18:12:04.856630 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m18:12:04.856954 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:12:04.857252 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:12:04.857536 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:12:04.857810 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:12:04.873728 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:12:04.879077 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:12:04.881833 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:12:04.884512 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:12:04.885562 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 18:12:04.858009 => 18:12:04.885275
[0m18:12:04.885999 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:12:04.886335 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 18:12:04.879365 => 18:12:04.886142
[0m18:12:04.886639 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 18:12:04.874044 => 18:12:04.886504
[0m18:12:04.893300 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 18:12:04.882025 => 18:12:04.893084
[0m18:12:04.905409 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:12:04.905714 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:12:04.905997 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:12:04.906216 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:12:04.907999 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:12:04.909568 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:12:04.911226 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:12:04.911711 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:12:04.912338 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:12:04.912655 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:12:04.913083 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:12:04.913461 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:12:04.913676 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:04.913889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:04.914088 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:04.914299 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:04.914486 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:12:04.915023 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:12:04.915403 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:12:05.474242 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:05.485571 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 18:12:04.909741 => 18:12:05.485259
[0m18:12:05.486063 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m18:12:06.372221 [info ] [Thread-4 (]: 4 of 36 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 1.52s]
[0m18:12:06.373396 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:12:06.373950 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:12:06.374591 [info ] [Thread-4 (]: 5 of 36 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m18:12:06.375501 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m18:12:06.375936 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:12:06.381673 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:12:06.384083 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 18:12:06.376183 => 18:12:06.383818
[0m18:12:06.384469 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:12:06.387171 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:12:06.388235 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:12:06.388680 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:06.388990 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:08.422614 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:12:08.427872 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 18:12:04.906433 => 18:12:08.427439
[0m18:12:08.428602 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m18:12:10.480563 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m18:12:10.485018 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 18:12:04.908200 => 18:12:10.484563
[0m18:12:10.485720 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m18:12:10.541635 [info ] [Thread-3 (]: 3 of 36 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 5.69s]
[0m18:12:10.543156 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:12:10.544212 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:12:10.544919 [info ] [Thread-3 (]: 6 of 36 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m18:12:10.545966 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m18:12:10.546469 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:12:10.552143 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:12:10.553442 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 18:12:10.546754 => 18:12:10.553204
[0m18:12:10.553843 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:12:10.558534 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:12:10.559521 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:12:10.559866 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:10.560190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:10.874911 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:10.877618 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 18:12:10.554069 => 18:12:10.877355
[0m18:12:10.878046 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m18:12:12.518498 [info ] [Thread-3 (]: 6 of 36 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 1.97s]
[0m18:12:12.519901 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:12:12.520480 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:12:12.521147 [info ] [Thread-3 (]: 7 of 36 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m18:12:12.522695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m18:12:12.523147 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:12:12.528573 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:12:12.529343 [info ] [Thread-2 (]: 2 of 36 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 7.67s]
[0m18:12:12.529954 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:12:12.530438 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:12:12.531681 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 18:12:12.523429 => 18:12:12.531311
[0m18:12:12.531111 [info ] [Thread-2 (]: 8 of 36 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m18:12:12.532218 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:12:12.532821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m18:12:12.535589 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:12:12.535973 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:12:12.539749 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:12:12.540626 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:12:12.541044 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:12.541426 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 18:12:12.536279 => 18:12:12.541250
[0m18:12:12.541730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:12.542064 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:12:12.545077 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:12:12.545903 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:12:12.546280 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:12.546763 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:14.669324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 10.0 seconds
[0m18:12:14.670863 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 8.0 seconds
[0m18:12:14.674927 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 18:12:04.886797 => 18:12:14.674410
[0m18:12:14.677800 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 18:12:06.384675 => 18:12:14.677463
[0m18:12:14.678359 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m18:12:14.678763 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m18:12:14.767956 [info ] [Thread-1 (]: 1 of 36 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 9.91s]
[0m18:12:14.769256 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:12:14.770085 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:12:14.770919 [info ] [Thread-1 (]: 9 of 36 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m18:12:14.771976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m18:12:14.772495 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:12:14.778307 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:12:14.779348 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 18:12:14.772786 => 18:12:14.779111
[0m18:12:14.779705 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:12:14.782355 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:12:14.783255 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:12:14.783592 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:14.783905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:16.657068 [info ] [Thread-4 (]: 5 of 36 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 10.28s]
[0m18:12:16.658715 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:12:16.659370 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m18:12:16.660111 [info ] [Thread-4 (]: 10 of 36 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m18:12:16.660983 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m18:12:16.661384 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m18:12:16.666472 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m18:12:16.667466 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 18:12:16.661613 => 18:12:16.667236
[0m18:12:16.667786 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m18:12:16.689449 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m18:12:16.690321 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m18:12:16.690591 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m18:12:16.690836 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:16.698324 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m18:12:16.699805 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 18:12:12.543008 => 18:12:16.699644
[0m18:12:16.700066 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m18:12:16.731413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:12:16.732779 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 18:12:14.779907 => 18:12:16.732633
[0m18:12:16.733022 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m18:12:16.775262 [info ] [Thread-2 (]: 8 of 36 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 4.24s]
[0m18:12:16.775701 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:12:16.776005 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m18:12:16.776372 [info ] [Thread-2 (]: 11 of 36 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m18:12:16.777075 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m18:12:16.777381 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m18:12:16.779809 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m18:12:16.781382 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 18:12:16.777543 => 18:12:16.781241
[0m18:12:16.781623 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m18:12:16.783597 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m18:12:16.784253 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m18:12:16.784480 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m18:12:16.784694 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:17.141532 [info ] [Thread-1 (]: 9 of 36 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 2.37s]
[0m18:12:17.143038 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:12:17.143984 [debug] [Thread-1 (]: Began running node model.northwind.dim_employee
[0m18:12:17.144893 [info ] [Thread-1 (]: 12 of 36 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m18:12:17.145943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_employee)
[0m18:12:17.146411 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_employee
[0m18:12:17.151882 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m18:12:17.152879 [debug] [Thread-1 (]: Timing info for model.northwind.dim_employee (compile): 18:12:17.146691 => 18:12:17.152654
[0m18:12:17.153246 [debug] [Thread-1 (]: Began executing node model.northwind.dim_employee
[0m18:12:17.155854 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m18:12:17.157205 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_employee"
[0m18:12:17.157596 [debug] [Thread-1 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m18:12:17.157933 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:17.193943 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m18:12:17.195674 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 18:12:12.533070 => 18:12:17.195476
[0m18:12:17.195984 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m18:12:17.271090 [info ] [Thread-3 (]: 7 of 36 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 4.75s]
[0m18:12:17.271690 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:12:17.272077 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m18:12:17.272586 [info ] [Thread-3 (]: 13 of 36 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m18:12:17.273212 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.fact_order_fulfillment)
[0m18:12:17.273524 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m18:12:17.279297 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m18:12:17.283601 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 18:12:17.273712 => 18:12:17.283382
[0m18:12:17.284011 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m18:12:17.286393 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m18:12:17.288351 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m18:12:17.288771 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m18:12:17.289132 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:17.410032 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:17.429513 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 18:12:16.667974 => 18:12:17.429344
[0m18:12:17.429888 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m18:12:17.503650 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d62840>]}
[0m18:12:17.504274 [info ] [Thread-4 (]: 10 of 36 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.84s]
[0m18:12:17.504871 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m18:12:17.505288 [debug] [Thread-4 (]: Began running node model.northwind.dim_product
[0m18:12:17.505795 [info ] [Thread-4 (]: 14 of 36 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m18:12:17.506643 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_product)
[0m18:12:17.506995 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_product
[0m18:12:17.511119 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m18:12:17.511880 [debug] [Thread-4 (]: Timing info for model.northwind.dim_product (compile): 18:12:17.507205 => 18:12:17.511691
[0m18:12:17.512201 [debug] [Thread-4 (]: Began executing node model.northwind.dim_product
[0m18:12:17.516346 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m18:12:17.517215 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_product"
[0m18:12:17.517501 [debug] [Thread-4 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m18:12:17.517764 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:17.707043 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:17.709145 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 18:12:16.781764 => 18:12:17.708994
[0m18:12:17.709418 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m18:12:17.786561 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121ee360>]}
[0m18:12:17.787185 [info ] [Thread-2 (]: 11 of 36 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.01s]
[0m18:12:17.787769 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m18:12:17.788177 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m18:12:17.788744 [info ] [Thread-2 (]: 15 of 36 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m18:12:17.789566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m18:12:17.790030 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m18:12:17.797374 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m18:12:17.799104 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 18:12:17.790276 => 18:12:17.798847
[0m18:12:17.799502 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m18:12:17.802014 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m18:12:17.803474 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m18:12:17.803821 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * quantity as discountamount,
        (UnitPrice * quantity) - (Discount * UnitPrice * quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m18:12:17.804187 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:18.100111 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c5b0-0000-17c7-0009-ec83000203fa
[0m18:12:18.100882 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m18:12:18.101534 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 18:12:17.799693 => 18:12:18.101271
[0m18:12:18.101979 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m18:12:18.194300 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:12:18.195188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10691c950>]}
[0m18:12:18.195964 [error] [Thread-2 (]: 15 of 36 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.41s]
[0m18:12:18.196648 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m18:12:18.197098 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:12:18.197737 [info ] [Thread-2 (]: 16 of 36 START test not_null_dim_customer_customerid ........................... [RUN]
[0m18:12:18.198545 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m18:12:18.198996 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:12:18.206865 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:12:18.207879 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 18:12:18.199230 => 18:12:18.207666
[0m18:12:18.208230 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:12:18.210660 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:12:18.211439 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:12:18.211732 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m18:12:18.211993 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:18.457020 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:18.466095 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 18:12:17.284262 => 18:12:18.465808
[0m18:12:18.466767 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m18:12:18.550858 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e3710>]}
[0m18:12:18.552257 [info ] [Thread-3 (]: 13 of 36 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.28s]
[0m18:12:18.553276 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m18:12:18.553854 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:12:18.554512 [info ] [Thread-3 (]: 17 of 36 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m18:12:18.555700 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m18:12:18.556166 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:12:18.561669 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:12:18.562650 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 18:12:18.556428 => 18:12:18.562419
[0m18:12:18.563029 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:12:18.565657 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:12:18.566613 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:12:18.566954 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m18:12:18.567255 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:18.734178 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:18.737393 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 18:12:18.208424 => 18:12:18.737057
[0m18:12:18.737907 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m18:12:18.784052 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:18.788560 [debug] [Thread-4 (]: Timing info for model.northwind.dim_product (execute): 18:12:17.512388 => 18:12:18.788101
[0m18:12:18.789147 [debug] [Thread-4 (]: On model.northwind.dim_product: Close
[0m18:12:18.791926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:12:18.794724 [debug] [Thread-1 (]: Timing info for model.northwind.dim_employee (execute): 18:12:17.153462 => 18:12:18.794513
[0m18:12:18.795170 [debug] [Thread-1 (]: On model.northwind.dim_employee: Close
[0m18:12:18.820132 [info ] [Thread-2 (]: 16 of 36 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.62s]
[0m18:12:18.820799 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:12:18.821235 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:12:18.821712 [info ] [Thread-2 (]: 18 of 36 START test unique_dim_customer_customerid ............................. [RUN]
[0m18:12:18.822445 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m18:12:18.822823 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:12:18.827785 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:12:18.830064 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 18:12:18.823034 => 18:12:18.829835
[0m18:12:18.830406 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:12:18.834729 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:12:18.836162 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:12:18.836517 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:18.836948 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:18.876770 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125005c0>]}
[0m18:12:18.877302 [info ] [Thread-1 (]: 12 of 36 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.73s]
[0m18:12:18.877925 [debug] [Thread-1 (]: Finished running node model.northwind.dim_employee
[0m18:12:18.878279 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:12:18.879198 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124eaba0>]}
[0m18:12:18.879509 [info ] [Thread-1 (]: 19 of 36 START test unique_dim_customer_customerkey ............................ [RUN]
[0m18:12:18.880269 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:18.880649 [info ] [Thread-4 (]: 14 of 36 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.37s]
[0m18:12:18.881143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m18:12:18.882572 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 18:12:18.563255 => 18:12:18.882429
[0m18:12:18.882892 [debug] [Thread-4 (]: Finished running node model.northwind.dim_product
[0m18:12:18.883119 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:12:18.883345 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m18:12:18.883585 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:12:18.886862 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:12:18.887823 [info ] [Thread-4 (]: 20 of 36 START test not_null_dim_date_date ..................................... [RUN]
[0m18:12:18.888536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m18:12:18.888825 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:12:18.891628 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:12:18.892236 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 18:12:18.883834 => 18:12:18.892072
[0m18:12:18.892711 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:12:18.893002 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 18:12:18.889004 => 18:12:18.892870
[0m18:12:18.894789 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:12:18.895083 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:12:18.896882 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:12:18.897377 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:12:18.897664 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:18.898047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:18.898513 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:12:18.899147 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m18:12:18.899606 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:18.982505 [info ] [Thread-3 (]: 17 of 36 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.43s]
[0m18:12:18.983049 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:12:18.983334 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:12:18.983654 [info ] [Thread-3 (]: 21 of 36 START test not_null_dim_date_datekey .................................. [RUN]
[0m18:12:18.984164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m18:12:18.984431 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:12:18.987594 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:12:18.988168 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 18:12:18.984580 => 18:12:18.988026
[0m18:12:18.988401 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:12:18.990161 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:12:18.990762 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:12:18.990994 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m18:12:18.991206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:19.132290 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.134775 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 18:12:18.830600 => 18:12:19.134579
[0m18:12:19.135097 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m18:12:19.205343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.208302 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 18:12:18.893155 => 18:12:19.207994
[0m18:12:19.208784 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m18:12:19.211020 [info ] [Thread-2 (]: 18 of 36 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.39s]
[0m18:12:19.212076 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:12:19.212733 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.213235 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:12:19.215140 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 18:12:18.895365 => 18:12:19.214928
[0m18:12:19.215564 [info ] [Thread-2 (]: 22 of 36 START test unique_dim_date_date ....................................... [RUN]
[0m18:12:19.216475 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m18:12:19.217141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m18:12:19.218432 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:12:19.223213 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:12:19.225198 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 18:12:19.218887 => 18:12:19.225001
[0m18:12:19.225486 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:12:19.227696 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:12:19.228546 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:12:19.228841 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:19.229128 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:19.274028 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.275565 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 18:12:18.988532 => 18:12:19.275401
[0m18:12:19.275828 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m18:12:19.286423 [info ] [Thread-1 (]: 19 of 36 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.41s]
[0m18:12:19.286834 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:12:19.287108 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:12:19.287425 [info ] [Thread-1 (]: 23 of 36 START test unique_dim_date_datekey .................................... [RUN]
[0m18:12:19.287949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m18:12:19.288206 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:12:19.292567 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:12:19.293118 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 18:12:19.288355 => 18:12:19.292981
[0m18:12:19.293338 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:12:19.295072 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:12:19.295743 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:12:19.295984 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:19.296216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.298812 [info ] [Thread-4 (]: 20 of 36 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.41s]
[0m18:12:19.299174 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:12:19.299428 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:12:19.299699 [info ] [Thread-4 (]: 24 of 36 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m18:12:19.299965 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:12:19.300187 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:12:19.300410 [info ] [Thread-4 (]: 25 of 36 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m18:12:19.300627 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:12:19.300844 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:12:19.301055 [info ] [Thread-4 (]: 26 of 36 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m18:12:19.301428 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m18:12:19.301626 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:12:19.304440 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:12:19.305219 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 18:12:19.301742 => 18:12:19.305044
[0m18:12:19.305478 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:12:19.307110 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:12:19.307695 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:12:19.307915 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m18:12:19.308116 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:19.349668 [info ] [Thread-3 (]: 21 of 36 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.37s]
[0m18:12:19.350104 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:12:19.350331 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:12:19.350582 [info ] [Thread-3 (]: 27 of 36 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m18:12:19.350986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m18:12:19.351176 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:12:19.353723 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:12:19.354820 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 18:12:19.351287 => 18:12:19.354710
[0m18:12:19.355002 [debug] [Thread-3 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:12:19.356453 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:12:19.356978 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:12:19.357167 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:19.357338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:19.518919 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.520714 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 18:12:19.225653 => 18:12:19.520518
[0m18:12:19.521021 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m18:12:19.589695 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.592193 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 18:12:19.293470 => 18:12:19.591900
[0m18:12:19.592662 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m18:12:19.596935 [info ] [Thread-2 (]: 22 of 36 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.38s]
[0m18:12:19.597956 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:12:19.598551 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:12:19.599102 [info ] [Thread-2 (]: 28 of 36 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m18:12:19.599836 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m18:12:19.600203 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:12:19.605112 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:12:19.606050 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 18:12:19.600421 => 18:12:19.605853
[0m18:12:19.606390 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:12:19.608955 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:12:19.609758 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:12:19.610058 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m18:12:19.610328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:19.611764 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.613321 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 18:12:19.305624 => 18:12:19.613135
[0m18:12:19.613654 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m18:12:19.669336 [info ] [Thread-1 (]: 23 of 36 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.38s]
[0m18:12:19.669851 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:12:19.670150 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:12:19.670491 [info ] [Thread-1 (]: 29 of 36 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m18:12:19.671024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m18:12:19.671279 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:12:19.674794 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:12:19.676476 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 18:12:19.671432 => 18:12:19.676326
[0m18:12:19.676721 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:12:19.680104 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:12:19.681059 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:12:19.681352 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m18:12:19.681604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:19.684980 [info ] [Thread-4 (]: 26 of 36 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.38s]
[0m18:12:19.685366 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:12:19.685667 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:12:19.686014 [info ] [Thread-4 (]: 30 of 36 START test unique_dim_employee_employeeid ............................. [RUN]
[0m18:12:19.686758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m18:12:19.687077 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:12:19.690068 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:12:19.690679 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 18:12:19.687243 => 18:12:19.690540
[0m18:12:19.690903 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:12:19.692582 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:12:19.693525 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:12:19.693840 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:19.694073 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:19.697183 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.698675 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 18:12:19.355106 => 18:12:19.698505
[0m18:12:19.698967 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m18:12:19.771001 [info ] [Thread-3 (]: 27 of 36 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.42s]
[0m18:12:19.771494 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:12:19.771757 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:12:19.772040 [info ] [Thread-3 (]: 31 of 36 START test unique_dim_employee_employeekey ............................ [RUN]
[0m18:12:19.772504 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m18:12:19.772751 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:12:19.775654 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:12:19.776191 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 18:12:19.772882 => 18:12:19.776061
[0m18:12:19.776400 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:12:19.778066 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:12:19.778708 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:12:19.778943 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:19.779141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:19.922297 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.924438 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 18:12:19.606586 => 18:12:19.924202
[0m18:12:19.924817 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m18:12:19.979257 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.981808 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 18:12:19.691044 => 18:12:19.981506
[0m18:12:19.982306 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m18:12:19.993431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:19.995605 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 18:12:19.676861 => 18:12:19.995366
[0m18:12:19.995985 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m18:12:20.000279 [info ] [Thread-2 (]: 28 of 36 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.40s]
[0m18:12:20.001012 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:12:20.001429 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:12:20.001836 [info ] [Thread-2 (]: 32 of 36 START test not_null_dim_product_productid ............................. [RUN]
[0m18:12:20.002461 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m18:12:20.002777 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:12:20.007574 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:12:20.008580 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 18:12:20.002964 => 18:12:20.008414
[0m18:12:20.008857 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:12:20.011126 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:12:20.011960 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:12:20.012253 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m18:12:20.012522 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:20.055074 [info ] [Thread-4 (]: 30 of 36 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.37s]
[0m18:12:20.055651 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:12:20.055938 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:12:20.056252 [info ] [Thread-4 (]: 33 of 36 START test not_null_dim_product_productkey ............................ [RUN]
[0m18:12:20.056761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m18:12:20.057235 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:12:20.057706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:20.060893 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:12:20.062319 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 18:12:19.776524 => 18:12:20.062164
[0m18:12:20.062749 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m18:12:20.064016 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 18:12:20.057859 => 18:12:20.063864
[0m18:12:20.064313 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:12:20.066180 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:12:20.067527 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:12:20.067832 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m18:12:20.068087 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:12:20.068584 [info ] [Thread-1 (]: 29 of 36 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.40s]
[0m18:12:20.069317 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:12:20.069791 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:12:20.070066 [info ] [Thread-1 (]: 34 of 36 START test unique_dim_product_productid ............................... [RUN]
[0m18:12:20.070469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m18:12:20.070676 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:12:20.074615 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:12:20.075333 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 18:12:20.070802 => 18:12:20.075207
[0m18:12:20.075536 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:12:20.077056 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:12:20.077679 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:12:20.077891 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:20.078084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:12:20.145931 [info ] [Thread-3 (]: 31 of 36 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.37s]
[0m18:12:20.146407 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:12:20.146663 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:12:20.147005 [info ] [Thread-3 (]: 35 of 36 START test unique_dim_product_productkey .............................. [RUN]
[0m18:12:20.147489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m18:12:20.147750 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:12:20.150578 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:12:20.151121 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 18:12:20.147896 => 18:12:20.150990
[0m18:12:20.151332 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:12:20.153004 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:12:20.153652 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:12:20.153870 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:20.154075 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:12:20.316709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:20.318616 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 18:12:20.009018 => 18:12:20.318401
[0m18:12:20.318940 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m18:12:20.364142 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:20.365833 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 18:12:20.064447 => 18:12:20.365642
[0m18:12:20.366121 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m18:12:20.378235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:20.379801 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 18:12:20.075656 => 18:12:20.379629
[0m18:12:20.380083 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m18:12:20.391671 [info ] [Thread-2 (]: 32 of 36 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.39s]
[0m18:12:20.392194 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:12:20.392541 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m18:12:20.392902 [info ] [Thread-2 (]: 36 of 36 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m18:12:20.393392 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now model.northwind.obt_order_fulfillment)
[0m18:12:20.393641 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m18:12:20.396408 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m18:12:20.397987 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 18:12:20.393784 => 18:12:20.397833
[0m18:12:20.398216 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m18:12:20.400001 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m18:12:20.401135 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m18:12:20.401407 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m18:12:20.401648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:12:20.447049 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:20.448611 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 18:12:20.151460 => 18:12:20.448460
[0m18:12:20.448887 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m18:12:20.451369 [info ] [Thread-4 (]: 33 of 36 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.39s]
[0m18:12:20.452147 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:12:20.452929 [info ] [Thread-1 (]: 34 of 36 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.38s]
[0m18:12:20.453277 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:12:20.532363 [info ] [Thread-3 (]: 35 of 36 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.38s]
[0m18:12:20.532903 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:12:21.121183 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:21.126185 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 18:12:20.398343 => 18:12:21.125870
[0m18:12:21.126746 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m18:12:21.307217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd17a4e5-cbfb-4852-a8c0-a01fdbdc61ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121090d0>]}
[0m18:12:21.308248 [info ] [Thread-2 (]: 36 of 36 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.91s]
[0m18:12:21.309036 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m18:12:21.311700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:21.312047 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productid.cfdf676d85' was properly closed.
[0m18:12:21.312331 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m18:12:21.312582 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productkey.52e0eda426' was properly closed.
[0m18:12:21.312835 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_product_productkey.f710b87f84' was properly closed.
[0m18:12:21.313194 [info ] [MainThread]: 
[0m18:12:21.313528 [info ] [MainThread]: Finished running 29 tests, 7 table models in 0 hours 0 minutes and 31.46 seconds (31.46s).
[0m18:12:21.317820 [debug] [MainThread]: Command end result
[0m18:12:21.331158 [info ] [MainThread]: 
[0m18:12:21.331510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:12:21.331762 [info ] [MainThread]: 
[0m18:12:21.331993 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:12:21.332248 [info ] [MainThread]: 
[0m18:12:21.332487 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=2 TOTAL=36
[0m18:12:21.334192 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 31.915115, "process_user_time": 2.845882, "process_kernel_time": 0.306797, "process_mem_max_rss": "140541952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:12:21.334614 [debug] [MainThread]: Command `dbt build` failed at 18:12:21.334524 after 31.92 seconds
[0m18:12:21.334890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a47440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051aba40>]}
[0m18:12:21.335148 [debug] [MainThread]: Flushing usage events
[0m18:13:40.454107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104742510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047422a0>]}


============================== 18:13:40.456585 | ba450717-0179-4035-9adf-887550036940 ==============================
[0m18:13:40.456585 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:13:40.456898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:40.650906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e73440>]}
[0m18:13:40.685130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471e0f0>]}
[0m18:13:40.685684 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:13:40.697254 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:13:40.732501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:40.732901 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m18:13:40.846226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105767080>]}
[0m18:13:40.855310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e21b0>]}
[0m18:13:40.855546 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m18:13:40.856987 [info ] [MainThread]: 
[0m18:13:40.857365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:40.857952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m18:13:40.863963 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m18:13:40.864145 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m18:13:40.864283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:41.474604 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:13:41.478075 [debug] [ThreadPool]: On list_analytics: Close
[0m18:13:41.571714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m18:13:41.582056 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m18:13:41.582426 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m18:13:41.582700 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:41.858271 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m18:13:41.862461 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m18:13:41.952812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589ec90>]}
[0m18:13:41.954158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:13:41.954769 [info ] [MainThread]: 
[0m18:13:41.958284 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:41.958739 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:41.959195 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:41.959526 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:41.959888 [info ] [Thread-1 (]: 1 of 36 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m18:13:41.960310 [info ] [Thread-2 (]: 2 of 36 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m18:13:41.960771 [info ] [Thread-3 (]: 3 of 36 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m18:13:41.961207 [info ] [Thread-4 (]: 4 of 36 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m18:13:41.962324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m18:13:41.963073 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m18:13:41.963668 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m18:13:41.964199 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m18:13:41.964556 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:41.964891 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:41.965189 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:41.965450 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:41.980960 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:13:41.985537 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:13:41.988725 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:13:41.991472 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:13:41.992503 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 18:13:41.965677 => 18:13:41.992289
[0m18:13:41.992845 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 18:13:41.988951 => 18:13:41.992695
[0m18:13:41.993177 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 18:13:41.981247 => 18:13:41.992999
[0m18:13:41.993442 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:41.993690 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:41.993946 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 18:13:41.985793 => 18:13:41.993816
[0m18:13:41.994159 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:42.007557 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:13:42.010165 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:13:42.010411 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:42.011920 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:13:42.013767 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:13:42.014279 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:13:42.014694 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:13:42.015061 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:13:42.015487 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:13:42.015872 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:13:42.016089 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.016304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:42.016503 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.016714 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.016919 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:13:42.017501 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:13:42.017860 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:13:42.266805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.278284 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 18:13:41.994295 => 18:13:42.277957
[0m18:13:42.278796 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m18:13:42.365641 [info ] [Thread-1 (]: 1 of 36 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.40s]
[0m18:13:42.367360 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:42.368158 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:42.369361 [info ] [Thread-1 (]: 5 of 36 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m18:13:42.371636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m18:13:42.373650 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:42.379405 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:13:42.381930 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 18:13:42.374561 => 18:13:42.381704
[0m18:13:42.382284 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:42.385065 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:13:42.386337 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:13:42.386694 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.387025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:42.425689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.427179 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 18:13:42.010550 => 18:13:42.427013
[0m18:13:42.427451 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m18:13:42.444023 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.445597 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 18:13:42.007735 => 18:13:42.445408
[0m18:13:42.445909 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m18:13:42.447597 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.449011 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 18:13:42.012277 => 18:13:42.448854
[0m18:13:42.449316 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m18:13:42.504154 [info ] [Thread-2 (]: 2 of 36 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.54s]
[0m18:13:42.504746 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:42.505143 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:42.505551 [info ] [Thread-2 (]: 6 of 36 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m18:13:42.506285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m18:13:42.506650 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:42.510262 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:13:42.514852 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 18:13:42.506816 => 18:13:42.514644
[0m18:13:42.515175 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:42.517340 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:13:42.518031 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:13:42.518304 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.518926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:42.520793 [info ] [Thread-4 (]: 4 of 36 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.56s]
[0m18:13:42.521251 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:42.521859 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:42.522227 [info ] [Thread-4 (]: 7 of 36 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m18:13:42.522760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m18:13:42.523062 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:42.526168 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:13:42.526670 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 18:13:42.523220 => 18:13:42.526527
[0m18:13:42.526904 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:42.530009 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:13:42.530952 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:13:42.531197 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.531424 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:42.531913 [info ] [Thread-3 (]: 3 of 36 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.57s]
[0m18:13:42.532587 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:42.532985 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:42.533226 [info ] [Thread-3 (]: 8 of 36 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m18:13:42.533595 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m18:13:42.533787 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:42.536332 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:13:42.537022 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 18:13:42.533900 => 18:13:42.536895
[0m18:13:42.537229 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:42.538818 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:13:42.539449 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:13:42.539727 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.539939 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:42.778201 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.782948 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 18:13:42.537351 => 18:13:42.782557
[0m18:13:42.783724 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m18:13:42.870920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.877455 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 18:13:42.382598 => 18:13:42.877069
[0m18:13:42.880429 [info ] [Thread-3 (]: 8 of 36 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.35s]
[0m18:13:42.882167 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m18:13:42.882967 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:42.885007 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:42.885741 [info ] [Thread-3 (]: 9 of 36 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m18:13:42.887690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m18:13:42.888612 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:42.893837 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:13:42.894686 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 18:13:42.889114 => 18:13:42.894470
[0m18:13:42.895006 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:42.897261 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:13:42.898040 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:13:42.898336 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:42.898618 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:42.942857 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.944536 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 18:13:42.527037 => 18:13:42.944360
[0m18:13:42.944820 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m18:13:42.948670 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:42.950057 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 18:13:42.515373 => 18:13:42.949890
[0m18:13:42.950319 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m18:13:42.969858 [info ] [Thread-1 (]: 5 of 36 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.60s]
[0m18:13:42.970286 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:42.970585 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m18:13:42.970984 [info ] [Thread-1 (]: 10 of 36 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m18:13:42.971455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_date)
[0m18:13:42.971693 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m18:13:42.974084 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m18:13:42.974838 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 18:13:42.971838 => 18:13:42.974697
[0m18:13:42.975071 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m18:13:42.992246 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m18:13:42.993232 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m18:13:42.993466 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m18:13:42.993684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:43.032398 [info ] [Thread-4 (]: 7 of 36 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.51s]
[0m18:13:43.032796 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:43.033042 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m18:13:43.033378 [info ] [Thread-4 (]: 11 of 36 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m18:13:43.033762 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m18:13:43.033951 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m18:13:43.042640 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m18:13:43.043423 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 18:13:43.034067 => 18:13:43.043272
[0m18:13:43.043646 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m18:13:43.046416 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m18:13:43.046900 [info ] [Thread-2 (]: 6 of 36 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.54s]
[0m18:13:43.047304 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:43.047540 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m18:13:43.047937 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m18:13:43.048229 [info ] [Thread-2 (]: 12 of 36 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m18:13:43.048454 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m18:13:43.048807 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_employee)
[0m18:13:43.048991 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:43.049163 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m18:13:43.051761 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m18:13:43.052342 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 18:13:43.049586 => 18:13:43.052220
[0m18:13:43.052523 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m18:13:43.053974 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m18:13:43.054995 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m18:13:43.055202 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m18:13:43.055470 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:43.180148 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:43.181981 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 18:13:42.895195 => 18:13:43.181783
[0m18:13:43.182300 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m18:13:43.261191 [info ] [Thread-3 (]: 9 of 36 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.37s]
[0m18:13:43.261868 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:43.262301 [debug] [Thread-3 (]: Began running node model.northwind.dim_product
[0m18:13:43.262806 [info ] [Thread-3 (]: 13 of 36 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m18:13:43.263598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m18:13:43.263990 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_product
[0m18:13:43.268284 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m18:13:43.269929 [debug] [Thread-3 (]: Timing info for model.northwind.dim_product (compile): 18:13:43.264213 => 18:13:43.269746
[0m18:13:43.270234 [debug] [Thread-3 (]: Began executing node model.northwind.dim_product
[0m18:13:43.272902 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m18:13:43.276625 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_product"
[0m18:13:43.276994 [debug] [Thread-3 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m18:13:43.277574 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:43.523070 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:43.545893 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 18:13:42.975210 => 18:13:43.545698
[0m18:13:43.546351 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m18:13:43.622289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106372fc0>]}
[0m18:13:43.622953 [info ] [Thread-1 (]: 10 of 36 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.65s]
[0m18:13:43.623538 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m18:13:43.623930 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m18:13:43.624419 [info ] [Thread-1 (]: 14 of 36 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m18:13:43.625286 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_order_fulfillment)
[0m18:13:43.625681 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m18:13:43.631689 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m18:13:43.632751 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 18:13:43.625900 => 18:13:43.632556
[0m18:13:43.633071 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m18:13:43.635748 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m18:13:43.637695 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m18:13:43.638087 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m18:13:43.638417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:43.751803 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:43.754312 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 18:13:43.043775 => 18:13:43.754129
[0m18:13:43.754623 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m18:13:43.825501 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102668f50>]}
[0m18:13:43.827481 [info ] [Thread-4 (]: 11 of 36 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.79s]
[0m18:13:43.828377 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m18:13:43.828795 [debug] [Thread-4 (]: Began running node model.northwind.fact_sales
[0m18:13:43.829383 [info ] [Thread-4 (]: 15 of 36 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m18:13:43.830438 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m18:13:43.830814 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_sales
[0m18:13:43.834449 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m18:13:43.835970 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (compile): 18:13:43.831056 => 18:13:43.835803
[0m18:13:43.836244 [debug] [Thread-4 (]: Began executing node model.northwind.fact_sales
[0m18:13:43.839982 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m18:13:43.841606 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_sales"
[0m18:13:43.841934 [debug] [Thread-4 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (-- Step 1: Basic Join between Orders and Order_Details
WITH stg_order_details AS (
    SELECT
        d.OrderID,
        d.ProductID,
        d.Quantity,
        d.UnitPrice,
        d.Discount,
        (d.UnitPrice * d.Quantity) - (d.Discount * d.UnitPrice * d.Quantity) AS soldamount
    FROM raw.northwind.Order_Details d
),

-- Step 2: Join Orders with stg_order_details
enriched_orders AS (
    SELECT
        o.OrderID,
        o.CustomerID,
        o.EmployeeID,
        o.OrderDate,
        od.ProductID,
        od.Quantity,
        od.UnitPrice AS extendedpriceamount,
        od.Discount * od.UnitPrice * od.Quantity AS discountamount,
        od.soldamount
    FROM raw.northwind.Orders o
    JOIN stg_order_details od ON o.OrderID = od.OrderID
),

-- Step 3: Join with Products, Employees, and Customers (Simplified)
final_select AS (
    SELECT
        eo.OrderID,
        eo.CustomerID,
        eo.EmployeeID,
        eo.OrderDate,
        eo.ProductID,
        eo.Quantity,
        eo.extendedpriceamount,
        eo.discountamount,
        eo.soldamount,
        p.ProductName,
        emp.FirstName AS EmployeeName,
        c.CompanyName AS CustomerName
    FROM enriched_orders eo
    LEFT JOIN raw.northwind.Products p ON eo.ProductID = p.ProductID
    LEFT JOIN raw.northwind.Employees emp ON eo.EmployeeID = emp.EmployeeID
    LEFT JOIN raw.northwind.Customers c ON eo.CustomerID = c.CustomerID
)

SELECT * FROM final_select;
[0m18:13:43.842235 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:44.115093 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c5b1-0000-17a6-0009-ec8300021432
[0m18:13:44.115541 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 52 at position 26 unexpected ';'.
[0m18:13:44.115919 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (execute): 18:13:43.836408 => 18:13:44.115766
[0m18:13:44.116175 [debug] [Thread-4 (]: On model.northwind.fact_sales: Close
[0m18:13:44.202746 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:44.205465 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 18:13:43.052624 => 18:13:44.205274
[0m18:13:44.206333 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m18:13:44.207877 [debug] [Thread-4 (]: Database Error in model fact_sales (models/fact_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 26 unexpected ';'.
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:13:44.208890 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518ae70>]}
[0m18:13:44.209546 [error] [Thread-4 (]: 15 of 36 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.38s]
[0m18:13:44.210144 [debug] [Thread-4 (]: Finished running node model.northwind.fact_sales
[0m18:13:44.210514 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:13:44.210942 [info ] [Thread-4 (]: 16 of 36 START test not_null_dim_date_date ..................................... [RUN]
[0m18:13:44.211574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m18:13:44.212005 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:13:44.217696 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:13:44.218530 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 18:13:44.212290 => 18:13:44.218375
[0m18:13:44.218774 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:13:44.220701 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:13:44.221341 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:13:44.221600 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m18:13:44.221826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:44.230672 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:44.232671 [debug] [Thread-3 (]: Timing info for model.northwind.dim_product (execute): 18:13:43.270413 => 18:13:44.232528
[0m18:13:44.232920 [debug] [Thread-3 (]: On model.northwind.dim_product: Close
[0m18:13:44.290796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052948f0>]}
[0m18:13:44.291306 [info ] [Thread-2 (]: 12 of 36 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.24s]
[0m18:13:44.291693 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m18:13:44.291959 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:13:44.292262 [info ] [Thread-2 (]: 17 of 36 START test not_null_dim_date_datekey .................................. [RUN]
[0m18:13:44.292811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m18:13:44.293041 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:13:44.296069 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:13:44.296655 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 18:13:44.293174 => 18:13:44.296526
[0m18:13:44.296859 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:13:44.298461 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:13:44.299032 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:13:44.299235 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m18:13:44.299425 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:44.311426 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f5ac0>]}
[0m18:13:44.311813 [info ] [Thread-3 (]: 13 of 36 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.05s]
[0m18:13:44.312155 [debug] [Thread-3 (]: Finished running node model.northwind.dim_product
[0m18:13:44.312397 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:13:44.312666 [info ] [Thread-3 (]: 18 of 36 START test unique_dim_date_date ....................................... [RUN]
[0m18:13:44.313156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m18:13:44.313385 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:13:44.316891 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:13:44.319724 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 18:13:44.314231 => 18:13:44.319603
[0m18:13:44.319915 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:13:44.321425 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:13:44.321975 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:13:44.322179 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:44.322365 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:44.448681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:44.450689 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 18:13:43.633238 => 18:13:44.450545
[0m18:13:44.450957 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m18:13:44.523232 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:44.524950 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 18:13:44.218923 => 18:13:44.524776
[0m18:13:44.525554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063b57c0>]}
[0m18:13:44.525880 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m18:13:44.526283 [info ] [Thread-1 (]: 14 of 36 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 0.90s]
[0m18:13:44.527354 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m18:13:44.527884 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:13:44.528288 [info ] [Thread-1 (]: 19 of 36 START test unique_dim_date_datekey .................................... [RUN]
[0m18:13:44.529012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m18:13:44.529500 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:13:44.533439 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:13:44.534390 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 18:13:44.529972 => 18:13:44.534157
[0m18:13:44.534683 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:13:44.536932 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:13:44.537715 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:13:44.537980 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:44.538210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:44.600307 [info ] [Thread-4 (]: 16 of 36 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.39s]
[0m18:13:44.600879 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:13:44.601171 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:13:44.601495 [info ] [Thread-4 (]: 20 of 36 START test not_null_dim_customer_customerid ........................... [RUN]
[0m18:13:44.602022 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m18:13:44.602277 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:13:44.605554 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:13:44.606182 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 18:13:44.602420 => 18:13:44.606030
[0m18:13:44.606398 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:13:44.608063 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:13:44.608656 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:13:44.608875 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m18:13:44.609080 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:44.982206 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:44.985522 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 18:13:44.320032 => 18:13:44.985205
[0m18:13:44.986025 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m18:13:45.068539 [info ] [Thread-3 (]: 18 of 36 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.76s]
[0m18:13:45.069566 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:13:45.070090 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:13:45.070715 [info ] [Thread-3 (]: 21 of 36 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m18:13:45.071499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m18:13:45.071851 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:13:45.076970 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:13:45.077946 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 18:13:45.072052 => 18:13:45.077748
[0m18:13:45.078288 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:13:45.081327 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:13:45.082373 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:13:45.082705 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m18:13:45.083110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:45.319379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:45.323330 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 18:13:44.534833 => 18:13:45.323064
[0m18:13:45.323790 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m18:13:45.325641 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:45.327592 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 18:13:44.606525 => 18:13:45.327394
[0m18:13:45.328262 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m18:13:45.332557 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:45.334073 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 18:13:44.296981 => 18:13:45.333924
[0m18:13:45.334329 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m18:13:45.405819 [info ] [Thread-1 (]: 19 of 36 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.88s]
[0m18:13:45.406947 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:13:45.407369 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:13:45.407793 [info ] [Thread-1 (]: 22 of 36 START test unique_dim_customer_customerid ............................. [RUN]
[0m18:13:45.408425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m18:13:45.409279 [info ] [Thread-4 (]: 20 of 36 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.81s]
[0m18:13:45.410415 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:13:45.410082 [info ] [Thread-2 (]: 17 of 36 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.12s]
[0m18:13:45.410865 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:13:45.415087 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:13:45.415843 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:13:45.416187 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:13:45.416731 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:45.417326 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:13:45.417730 [info ] [Thread-4 (]: 23 of 36 START test unique_dim_customer_customerkey ............................ [RUN]
[0m18:13:45.419829 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 18:13:45.078490 => 18:13:45.419643
[0m18:13:45.420147 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 18:13:45.411036 => 18:13:45.420003
[0m18:13:45.420412 [info ] [Thread-2 (]: 24 of 36 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m18:13:45.420900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m18:13:45.421166 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m18:13:45.421393 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:13:45.421639 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:13:45.421854 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:13:45.424746 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:13:45.425291 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:13:45.428224 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:13:45.429385 [info ] [Thread-2 (]: 25 of 36 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m18:13:45.430430 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:13:45.430900 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:13:45.431204 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:45.431546 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:13:45.431902 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 18:13:45.425517 => 18:13:45.431745
[0m18:13:45.432137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:45.432370 [info ] [Thread-2 (]: 26 of 36 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m18:13:45.432606 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:13:45.433592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m18:13:45.436007 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:13:45.436486 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:13:45.441495 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:13:45.442708 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:13:45.443019 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:45.443253 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:45.443517 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 18:13:45.436796 => 18:13:45.443363
[0m18:13:45.444492 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:13:45.446630 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:13:45.447417 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:13:45.447664 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m18:13:45.447861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:45.503013 [info ] [Thread-3 (]: 21 of 36 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.43s]
[0m18:13:45.503563 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:13:45.503858 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:13:45.504141 [info ] [Thread-3 (]: 27 of 36 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m18:13:45.504596 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m18:13:45.504826 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:13:45.507826 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:13:45.508400 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 18:13:45.504947 => 18:13:45.508280
[0m18:13:45.508594 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:13:45.510486 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:13:45.511288 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:13:45.511518 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m18:13:45.511707 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:45.757215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:45.758011 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:45.760468 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 18:13:45.444923 => 18:13:45.760232
[0m18:13:45.761462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:45.763353 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 18:13:45.433942 => 18:13:45.763150
[0m18:13:45.763723 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m18:13:45.765135 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 18:13:45.422678 => 18:13:45.764962
[0m18:13:45.765440 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m18:13:45.766512 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m18:13:45.782984 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:45.784684 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 18:13:45.508704 => 18:13:45.784496
[0m18:13:45.784987 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m18:13:45.842723 [info ] [Thread-2 (]: 26 of 36 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.41s]
[0m18:13:45.843554 [info ] [Thread-1 (]: 22 of 36 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.44s]
[0m18:13:45.844298 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:13:45.844773 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:13:45.845168 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:13:45.845634 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:13:45.846086 [info ] [Thread-2 (]: 28 of 36 START test unique_dim_employee_employeeid ............................. [RUN]
[0m18:13:45.846500 [info ] [Thread-1 (]: 29 of 36 START test unique_dim_employee_employeekey ............................ [RUN]
[0m18:13:45.847102 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m18:13:45.847604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m18:13:45.847896 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:13:45.848166 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:13:45.852718 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:13:45.855897 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:13:45.857318 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 18:13:45.852909 => 18:13:45.857121
[0m18:13:45.857667 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 18:13:45.848360 => 18:13:45.857483
[0m18:13:45.857962 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:13:45.858255 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:13:45.860468 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:13:45.861402 [info ] [Thread-3 (]: 27 of 36 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.36s]
[0m18:13:45.864144 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:13:45.862089 [info ] [Thread-4 (]: 23 of 36 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.44s]
[0m18:13:45.864693 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:13:45.865183 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:13:45.865814 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:13:45.866158 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:13:45.866714 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:13:45.866955 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:13:45.867251 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:45.867521 [info ] [Thread-3 (]: 30 of 36 START test not_null_dim_product_productid ............................. [RUN]
[0m18:13:45.867783 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:45.868033 [info ] [Thread-4 (]: 31 of 36 START test not_null_dim_product_productkey ............................ [RUN]
[0m18:13:45.868274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:45.868717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m18:13:45.868969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:45.869373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m18:13:45.870486 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:13:45.871024 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:13:45.874362 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:13:45.877111 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:13:45.878127 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 18:13:45.871351 => 18:13:45.877962
[0m18:13:45.878389 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 18:13:45.874621 => 18:13:45.878258
[0m18:13:45.878611 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:13:45.878871 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:13:45.883139 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:13:45.885235 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:13:45.886014 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:13:45.886471 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:13:45.886796 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m18:13:45.887101 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m18:13:45.887378 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:45.887561 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:46.167324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.171845 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 18:13:45.858452 => 18:13:46.171476
[0m18:13:46.172420 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m18:13:46.200686 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.202652 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.205812 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 18:13:45.883463 => 18:13:46.205467
[0m18:13:46.208259 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 18:13:45.862326 => 18:13:46.207987
[0m18:13:46.209387 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m18:13:46.209822 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m18:13:46.214254 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.216799 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 18:13:45.879281 => 18:13:46.216550
[0m18:13:46.217369 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m18:13:46.250238 [info ] [Thread-1 (]: 29 of 36 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.40s]
[0m18:13:46.252473 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:13:46.252921 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:13:46.253429 [info ] [Thread-1 (]: 32 of 36 START test unique_dim_product_productid ............................... [RUN]
[0m18:13:46.254163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m18:13:46.254554 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:13:46.260108 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:13:46.261027 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 18:13:46.254775 => 18:13:46.260828
[0m18:13:46.261365 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:13:46.263853 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:13:46.264922 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:13:46.265233 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:46.265555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:46.285177 [info ] [Thread-4 (]: 31 of 36 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.42s]
[0m18:13:46.285852 [info ] [Thread-2 (]: 28 of 36 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.44s]
[0m18:13:46.286493 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:13:46.286899 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:13:46.287225 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:13:46.287648 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:13:46.288005 [info ] [Thread-4 (]: 33 of 36 START test unique_dim_product_productkey .............................. [RUN]
[0m18:13:46.288345 [info ] [Thread-2 (]: 34 of 36 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m18:13:46.288923 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m18:13:46.289434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m18:13:46.289726 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:13:46.289988 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:13:46.293686 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:13:46.297180 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:13:46.298092 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 18:13:46.293999 => 18:13:46.297927
[0m18:13:46.298411 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 18:13:46.290158 => 18:13:46.298236
[0m18:13:46.298679 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:13:46.298914 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:13:46.300720 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:13:46.302880 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:13:46.303676 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:13:46.304362 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:13:46.304942 [info ] [Thread-3 (]: 30 of 36 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.44s]
[0m18:13:46.305272 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:46.305556 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m18:13:46.305906 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:13:46.306121 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:46.306330 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:46.306582 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:13:46.307952 [info ] [Thread-3 (]: 35 of 36 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m18:13:46.308399 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m18:13:46.308601 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:13:46.311395 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:13:46.312532 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 18:13:46.308721 => 18:13:46.312395
[0m18:13:46.312755 [debug] [Thread-3 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:13:46.315670 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:13:46.316323 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:13:46.316543 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:46.316744 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:46.574663 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.577366 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 18:13:46.261559 => 18:13:46.577089
[0m18:13:46.577822 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m18:13:46.600281 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.602214 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 18:13:46.301296 => 18:13:46.601997
[0m18:13:46.602562 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m18:13:46.608196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.609845 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 18:13:46.299055 => 18:13:46.609552
[0m18:13:46.610377 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m18:13:46.627203 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:46.629048 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 18:13:46.312879 => 18:13:46.628819
[0m18:13:46.629395 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m18:13:46.678569 [info ] [Thread-4 (]: 33 of 36 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.39s]
[0m18:13:46.679343 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:13:46.680947 [info ] [Thread-1 (]: 32 of 36 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.43s]
[0m18:13:46.681616 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:13:46.682860 [info ] [Thread-2 (]: 34 of 36 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.39s]
[0m18:13:46.683444 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:13:46.733914 [info ] [Thread-3 (]: 35 of 36 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.43s]
[0m18:13:46.734540 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:13:46.735200 [debug] [Thread-4 (]: Began running node model.northwind.obt_order_fulfillment
[0m18:13:46.735709 [info ] [Thread-4 (]: 36 of 36 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m18:13:46.736278 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productkey.52e0eda426, now model.northwind.obt_order_fulfillment)
[0m18:13:46.736535 [debug] [Thread-4 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m18:13:46.739853 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m18:13:46.741540 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 18:13:46.736686 => 18:13:46.741378
[0m18:13:46.741785 [debug] [Thread-4 (]: Began executing node model.northwind.obt_order_fulfillment
[0m18:13:46.743738 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m18:13:46.744946 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m18:13:46.745234 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m18:13:46.745502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:47.548949 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:47.555445 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 18:13:46.741931 => 18:13:47.555102
[0m18:13:47.556441 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: Close
[0m18:13:47.644030 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba450717-0179-4035-9adf-887550036940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11160ee10>]}
[0m18:13:47.644937 [info ] [Thread-4 (]: 36 of 36 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.91s]
[0m18:13:47.645771 [debug] [Thread-4 (]: Finished running node model.northwind.obt_order_fulfillment
[0m18:13:47.648167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:47.648488 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productid.cfdf676d85' was properly closed.
[0m18:13:47.648755 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m18:13:47.649024 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m18:13:47.649276 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m18:13:47.649632 [info ] [MainThread]: 
[0m18:13:47.649943 [info ] [MainThread]: Finished running 29 tests, 7 table models in 0 hours 0 minutes and 6.79 seconds (6.79s).
[0m18:13:47.654189 [debug] [MainThread]: Command end result
[0m18:13:47.664571 [info ] [MainThread]: 
[0m18:13:47.664934 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:13:47.665184 [info ] [MainThread]: 
[0m18:13:47.665418 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 52 at position 26 unexpected ';'.
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m18:13:47.665661 [info ] [MainThread]: 
[0m18:13:47.665896 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=2 TOTAL=36
[0m18:13:47.667770 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.2425604, "process_user_time": 2.64003, "process_kernel_time": 0.292582, "process_mem_max_rss": "150585344", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:13:47.668255 [debug] [MainThread]: Command `dbt build` failed at 18:13:47.668147 after 7.24 seconds
[0m18:13:47.668570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104742510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105705280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471d610>]}
[0m18:13:47.668855 [debug] [MainThread]: Flushing usage events
[0m18:13:56.243931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10518a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051a6150>]}


============================== 18:13:56.246495 | 55e40a16-7046-4b2a-aa04-c93346ffdb9f ==============================
[0m18:13:56.246495 [info ] [MainThread]: Running with dbt=1.7.9
[0m18:13:56.246826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:13:56.410078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d8530>]}
[0m18:13:56.442941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105062c00>]}
[0m18:13:56.444036 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:13:56.454432 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m18:13:56.489760 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:13:56.490229 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m18:13:56.601224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6f080>]}
[0m18:13:56.609688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf38f0>]}
[0m18:13:56.609915 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m18:13:56.611344 [info ] [MainThread]: 
[0m18:13:56.611746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:56.612368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m18:13:56.618342 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m18:13:56.618531 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m18:13:56.618668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:57.166892 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m18:13:57.168384 [debug] [ThreadPool]: On list_analytics: Close
[0m18:13:57.252227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m18:13:57.261956 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m18:13:57.262318 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m18:13:57.262593 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:57.692683 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m18:13:57.697195 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m18:13:57.784819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106004c20>]}
[0m18:13:57.786561 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:13:57.787280 [info ] [MainThread]: 
[0m18:13:57.791146 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:57.791618 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:57.792026 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:57.792436 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:57.792817 [info ] [Thread-1 (]: 1 of 36 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m18:13:57.793234 [info ] [Thread-2 (]: 2 of 36 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m18:13:57.793620 [info ] [Thread-3 (]: 3 of 36 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m18:13:57.794002 [info ] [Thread-4 (]: 4 of 36 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m18:13:57.795475 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m18:13:57.795914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m18:13:57.796610 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m18:13:57.797307 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m18:13:57.797664 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:57.797987 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:57.798293 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:57.798577 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:57.810545 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:13:57.817944 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:13:57.820983 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:13:57.823629 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:13:57.824345 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 18:13:57.798769 => 18:13:57.824164
[0m18:13:57.824646 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 18:13:57.810801 => 18:13:57.824500
[0m18:13:57.824974 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 18:13:57.818188 => 18:13:57.824797
[0m18:13:57.825226 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:57.825500 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:57.825771 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 18:13:57.821197 => 18:13:57.825626
[0m18:13:57.826014 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:57.839102 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:13:57.841754 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:13:57.842029 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:57.843550 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:13:57.845331 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:13:57.845913 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m18:13:57.846362 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m18:13:57.846831 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m18:13:57.847096 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m18:13:57.847342 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:57.847756 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m18:13:57.847994 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:57.848211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:57.848392 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:13:57.848602 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:57.848791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:13:57.849898 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:13:58.105324 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.106476 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.114978 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 18:13:57.842183 => 18:13:58.114689
[0m18:13:58.115637 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.117602 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 18:13:57.826165 => 18:13:58.117369
[0m18:13:58.118162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.118526 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m18:13:58.120120 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 18:13:57.843944 => 18:13:58.119932
[0m18:13:58.120446 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m18:13:58.121983 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 18:13:57.839290 => 18:13:58.121790
[0m18:13:58.123207 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m18:13:58.124589 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m18:13:58.194642 [info ] [Thread-4 (]: 4 of 36 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.40s]
[0m18:13:58.195355 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m18:13:58.195798 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:58.196295 [info ] [Thread-4 (]: 5 of 36 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m18:13:58.197193 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m18:13:58.197667 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:58.202959 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:13:58.203783 [info ] [Thread-3 (]: 3 of 36 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.41s]
[0m18:13:58.205413 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m18:13:58.205946 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 18:13:58.198232 => 18:13:58.205669
[0m18:13:58.206383 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:58.208184 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:58.207226 [info ] [Thread-1 (]: 1 of 36 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.41s]
[0m18:13:58.207902 [info ] [Thread-2 (]: 2 of 36 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.41s]
[0m18:13:58.208675 [info ] [Thread-3 (]: 6 of 36 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m18:13:58.211127 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:13:58.211614 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m18:13:58.212000 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m18:13:58.212493 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m18:13:58.212889 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:58.213266 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:58.213979 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m18:13:58.214277 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:58.214627 [info ] [Thread-1 (]: 7 of 36 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m18:13:58.214965 [info ] [Thread-2 (]: 8 of 36 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m18:13:58.215287 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:58.218560 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:13:58.219031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m18:13:58.219448 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m18:13:58.219694 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:58.219979 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:58.220234 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:58.220716 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 18:13:58.215489 => 18:13:58.220575
[0m18:13:58.224022 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:13:58.227109 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:13:58.227400 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:58.229244 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:13:58.229537 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 18:13:58.221246 => 18:13:58.229395
[0m18:13:58.230046 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:58.230317 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 18:13:58.224499 => 18:13:58.230177
[0m18:13:58.233367 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:13:58.233834 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m18:13:58.234102 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:58.234404 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:58.236089 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:13:58.236334 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:58.236851 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m18:13:58.237645 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:58.238128 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m18:13:58.238333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:58.238581 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:58.239360 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:58.508207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.515503 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 18:13:58.230649 => 18:13:58.515007
[0m18:13:58.517506 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.518366 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m18:13:58.519318 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.521547 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 18:13:58.227688 => 18:13:58.521298
[0m18:13:58.522179 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.525246 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 18:13:58.234599 => 18:13:58.525014
[0m18:13:58.525947 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m18:13:58.527719 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 18:13:58.208901 => 18:13:58.527531
[0m18:13:58.528034 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m18:13:58.529237 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m18:13:58.610777 [info ] [Thread-3 (]: 6 of 36 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.40s]
[0m18:13:58.611832 [info ] [Thread-2 (]: 8 of 36 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.39s]
[0m18:13:58.612594 [info ] [Thread-1 (]: 7 of 36 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.39s]
[0m18:13:58.613286 [info ] [Thread-4 (]: 5 of 36 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.42s]
[0m18:13:58.614194 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m18:13:58.614715 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m18:13:58.615202 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m18:13:58.615672 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m18:13:58.616088 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:58.616567 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m18:13:58.617168 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m18:13:58.617699 [debug] [Thread-4 (]: Began running node model.northwind.fact_order_fulfillment
[0m18:13:58.618259 [info ] [Thread-3 (]: 9 of 36 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m18:13:58.618800 [info ] [Thread-2 (]: 10 of 36 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m18:13:58.619239 [info ] [Thread-1 (]: 11 of 36 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m18:13:58.619603 [info ] [Thread-4 (]: 12 of 36 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m18:13:58.620229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m18:13:58.621053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m18:13:58.621824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m18:13:58.622412 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.fact_order_fulfillment)
[0m18:13:58.622773 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:58.623117 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m18:13:58.623434 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m18:13:58.623715 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m18:13:58.636365 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m18:13:58.639734 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:13:58.641655 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m18:13:58.645468 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m18:13:58.646173 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 18:13:58.624892 => 18:13:58.646011
[0m18:13:58.646487 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 18:13:58.623911 => 18:13:58.646324
[0m18:13:58.646789 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m18:13:58.647047 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:58.647297 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 18:13:58.639916 => 18:13:58.647171
[0m18:13:58.647546 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 18:13:58.641866 => 18:13:58.647419
[0m18:13:58.663734 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m18:13:58.665457 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:13:58.665716 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m18:13:58.665923 [debug] [Thread-4 (]: Began executing node model.northwind.fact_order_fulfillment
[0m18:13:58.668592 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m18:13:58.670087 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m18:13:58.670542 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m18:13:58.670943 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m18:13:58.671268 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m18:13:58.671688 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m18:13:58.671922 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:13:58.672125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:58.673231 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m18:13:58.673431 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m18:13:58.673631 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:58.674281 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m18:13:58.674701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:13:58.675234 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:13:58.927300 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:13:58.931229 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 18:13:58.663935 => 18:13:58.930833
[0m18:13:58.931817 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m18:13:59.019983 [info ] [Thread-3 (]: 9 of 36 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.40s]
[0m18:13:59.021307 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m18:13:59.021908 [debug] [Thread-3 (]: Began running node model.northwind.dim_product
[0m18:13:59.022587 [info ] [Thread-3 (]: 13 of 36 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m18:13:59.023630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m18:13:59.024046 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_product
[0m18:13:59.027834 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m18:13:59.028405 [debug] [Thread-3 (]: Timing info for model.northwind.dim_product (compile): 18:13:59.024238 => 18:13:59.028258
[0m18:13:59.028645 [debug] [Thread-3 (]: Began executing node model.northwind.dim_product
[0m18:13:59.030597 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m18:13:59.031340 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_product"
[0m18:13:59.031603 [debug] [Thread-3 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m18:13:59.031846 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:13:59.206807 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:59.229505 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 18:13:58.647685 => 18:13:59.229284
[0m18:13:59.231311 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m18:13:59.306029 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030d1100>]}
[0m18:13:59.306843 [info ] [Thread-2 (]: 10 of 36 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.69s]
[0m18:13:59.307610 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m18:13:59.308131 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m18:13:59.308842 [info ] [Thread-2 (]: 14 of 36 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m18:13:59.309848 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_employee)
[0m18:13:59.310325 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m18:13:59.315584 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m18:13:59.316470 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 18:13:59.310588 => 18:13:59.316293
[0m18:13:59.316778 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m18:13:59.319605 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m18:13:59.321204 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m18:13:59.321732 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m18:13:59.322123 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:13:59.459664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:13:59.463007 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 18:13:58.666199 => 18:13:59.462779
[0m18:13:59.463412 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m18:13:59.552207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106227a40>]}
[0m18:13:59.553501 [info ] [Thread-1 (]: 11 of 36 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.93s]
[0m18:13:59.554306 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m18:13:59.554828 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m18:13:59.556116 [info ] [Thread-1 (]: 15 of 36 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m18:13:59.557278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m18:13:59.557766 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m18:13:59.562701 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m18:13:59.563644 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 18:13:59.558040 => 18:13:59.563428
[0m18:13:59.564008 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m18:13:59.566777 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m18:13:59.570593 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m18:13:59.571067 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (-- Step 1: Basic Join between Orders and Order_Details
WITH stg_order_details AS (
    SELECT
        d.OrderID,
        d.ProductID,
        d.Quantity,
        d.UnitPrice,
        d.Discount,
        (d.UnitPrice * d.Quantity) - (d.Discount * d.UnitPrice * d.Quantity) AS soldamount
    FROM raw.northwind.Order_Details d
),

-- Step 2: Join Orders with stg_order_details
enriched_orders AS (
    SELECT
        o.OrderID,
        o.CustomerID,
        o.EmployeeID,
        o.OrderDate,
        od.ProductID,
        od.Quantity,
        od.UnitPrice AS extendedpriceamount,
        od.Discount * od.UnitPrice * od.Quantity AS discountamount,
        od.soldamount
    FROM raw.northwind.Orders o
    JOIN stg_order_details od ON o.OrderID = od.OrderID
),

-- Step 3: Join with Products, Employees, and Customers (Simplified)
final_select AS (
    SELECT
        eo.OrderID,
        eo.CustomerID,
        eo.EmployeeID,
        eo.OrderDate,
        eo.ProductID,
        eo.Quantity,
        eo.extendedpriceamount,
        eo.discountamount,
        eo.soldamount,
        p.ProductName,
        emp.FirstName AS EmployeeName,
        c.CompanyName AS CustomerName
    FROM enriched_orders eo
    LEFT JOIN raw.northwind.Products p ON eo.ProductID = p.ProductID
    LEFT JOIN raw.northwind.Employees emp ON eo.EmployeeID = emp.EmployeeID
    LEFT JOIN raw.northwind.Customers c ON eo.CustomerID = c.CustomerID
)

SELECT * FROM final_select
        );
[0m18:13:59.571457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:00.140283 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:00.146237 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 18:13:59.316953 => 18:14:00.145926
[0m18:14:00.146907 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m18:14:00.219499 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:00.224134 [debug] [Thread-3 (]: Timing info for model.northwind.dim_product (execute): 18:13:59.028784 => 18:14:00.223889
[0m18:14:00.224635 [debug] [Thread-3 (]: On model.northwind.dim_product: Close
[0m18:14:00.232149 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106277440>]}
[0m18:14:00.232817 [info ] [Thread-2 (]: 14 of 36 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.92s]
[0m18:14:00.233417 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m18:14:00.233849 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:14:00.234399 [info ] [Thread-2 (]: 16 of 36 START test not_null_dim_customer_customerid ........................... [RUN]
[0m18:14:00.235097 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m18:14:00.235399 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:14:00.242450 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:14:00.244331 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 18:14:00.235579 => 18:14:00.244158
[0m18:14:00.244618 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:14:00.247073 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:14:00.247909 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m18:14:00.248209 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m18:14:00.248495 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:14:00.306971 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed7680>]}
[0m18:14:00.307431 [info ] [Thread-3 (]: 13 of 36 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.28s]
[0m18:14:00.307802 [debug] [Thread-3 (]: Finished running node model.northwind.dim_product
[0m18:14:00.308065 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:14:00.308380 [info ] [Thread-3 (]: 17 of 36 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m18:14:00.308837 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m18:14:00.309087 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:14:00.311991 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:14:00.313060 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 18:14:00.309221 => 18:14:00.312888
[0m18:14:00.313324 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:14:00.314940 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:14:00.315498 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m18:14:00.315713 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m18:14:00.315903 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:00.525037 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:14:00.528491 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 18:13:58.668760 => 18:14:00.528263
[0m18:14:00.528975 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: Close
[0m18:14:00.613378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0e570>]}
[0m18:14:00.613980 [info ] [Thread-4 (]: 12 of 36 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.99s]
[0m18:14:00.614459 [debug] [Thread-4 (]: Finished running node model.northwind.fact_order_fulfillment
[0m18:14:00.614793 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:14:00.615145 [info ] [Thread-4 (]: 18 of 36 START test unique_dim_customer_customerid ............................. [RUN]
[0m18:14:00.615767 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m18:14:00.616155 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:14:00.620185 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:14:00.620912 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 18:14:00.616616 => 18:14:00.620730
[0m18:14:00.621188 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:14:00.623220 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:14:00.624005 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m18:14:00.624271 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:00.624513 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:14:00.899759 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:00.901550 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:00.904318 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 18:14:00.244783 => 18:14:00.904043
[0m18:14:00.906319 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 18:14:00.313465 => 18:14:00.906088
[0m18:14:00.906757 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m18:14:00.907130 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m18:14:00.932334 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:00.934528 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 18:14:00.621331 => 18:14:00.934273
[0m18:14:00.934929 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m18:14:01.017603 [info ] [Thread-3 (]: 17 of 36 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.71s]
[0m18:14:01.018617 [info ] [Thread-4 (]: 18 of 36 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.40s]
[0m18:14:01.019372 [info ] [Thread-2 (]: 16 of 36 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.78s]
[0m18:14:01.020253 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m18:14:01.020781 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m18:14:01.021264 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m18:14:01.021677 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:14:01.022174 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:14:01.022636 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:14:01.023061 [info ] [Thread-3 (]: 19 of 36 START test unique_dim_customer_customerkey ............................ [RUN]
[0m18:14:01.023496 [info ] [Thread-4 (]: 20 of 36 START test not_null_dim_date_date ..................................... [RUN]
[0m18:14:01.023891 [info ] [Thread-2 (]: 21 of 36 START test not_null_dim_date_datekey .................................. [RUN]
[0m18:14:01.024510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m18:14:01.025049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m18:14:01.025548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m18:14:01.025851 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:14:01.026132 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:14:01.026402 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:14:01.031084 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:14:01.034419 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:14:01.039202 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:14:01.040131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:01.042294 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 18:13:59.564214 => 18:14:01.042144
[0m18:14:01.042641 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m18:14:01.043029 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 18:14:01.026584 => 18:14:01.042865
[0m18:14:01.043291 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 18:14:01.031296 => 18:14:01.043166
[0m18:14:01.044190 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 18:14:01.034640 => 18:14:01.044051
[0m18:14:01.044689 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:14:01.045024 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:14:01.045254 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:14:01.047289 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:14:01.049196 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:14:01.050952 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:14:01.052050 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m18:14:01.052424 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:01.052733 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:01.053208 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m18:14:01.053816 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m18:14:01.054329 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m18:14:01.054852 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m18:14:01.055136 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:14:01.055368 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:14:01.119930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cbe90>]}
[0m18:14:01.120401 [info ] [Thread-1 (]: 15 of 36 OK created sql table model analytics.northwind_northwind.fact_sales ... [[32mSUCCESS 1[0m in 1.56s]
[0m18:14:01.120789 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m18:14:01.121053 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:14:01.121388 [info ] [Thread-1 (]: 22 of 36 START test unique_dim_date_date ....................................... [RUN]
[0m18:14:01.121816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m18:14:01.122024 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:14:01.124954 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:14:01.125434 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 18:14:01.122151 => 18:14:01.125302
[0m18:14:01.125657 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:14:01.127371 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:14:01.127994 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m18:14:01.128223 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:01.128442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:01.346939 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.350326 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 18:14:01.045398 => 18:14:01.349943
[0m18:14:01.350877 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m18:14:01.360643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.361480 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.363416 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 18:14:01.049460 => 18:14:01.363189
[0m18:14:01.365229 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 18:14:01.047488 => 18:14:01.365003
[0m18:14:01.365622 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m18:14:01.365977 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m18:14:01.427775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.431572 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 18:14:01.125784 => 18:14:01.431225
[0m18:14:01.432301 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m18:14:01.449784 [info ] [Thread-4 (]: 20 of 36 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.42s]
[0m18:14:01.450815 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m18:14:01.451398 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:14:01.451962 [info ] [Thread-4 (]: 23 of 36 START test unique_dim_date_datekey .................................... [RUN]
[0m18:14:01.454298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m18:14:01.452831 [info ] [Thread-2 (]: 21 of 36 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.43s]
[0m18:14:01.454803 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:14:01.453573 [info ] [Thread-3 (]: 19 of 36 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.43s]
[0m18:14:01.455488 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m18:14:01.458225 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m18:14:01.461308 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:14:01.461761 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:14:01.462299 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:14:01.462868 [info ] [Thread-2 (]: 24 of 36 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m18:14:01.463368 [info ] [Thread-3 (]: 25 of 36 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m18:14:01.464121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m18:14:01.464601 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 18:14:01.455754 => 18:14:01.464354
[0m18:14:01.465201 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m18:14:01.465525 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:14:01.465803 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:14:01.466062 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:14:01.469546 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:14:01.472473 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:14:01.476935 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:14:01.477989 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 18:14:01.466232 => 18:14:01.477775
[0m18:14:01.478645 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m18:14:01.479031 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:14:01.479388 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 18:14:01.472726 => 18:14:01.479227
[0m18:14:01.479681 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:01.481708 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:14:01.481967 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:14:01.482219 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:14:01.484170 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:14:01.485046 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m18:14:01.485633 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m18:14:01.485892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:14:01.486327 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m18:14:01.487362 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m18:14:01.487619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:01.529223 [info ] [Thread-1 (]: 22 of 36 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.41s]
[0m18:14:01.529668 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m18:14:01.529919 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:14:01.530196 [info ] [Thread-1 (]: 26 of 36 START test unique_dim_employee_employeeid ............................. [RUN]
[0m18:14:01.530643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m18:14:01.530855 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:14:01.533555 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:14:01.533997 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 18:14:01.530979 => 18:14:01.533869
[0m18:14:01.534198 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:14:01.535785 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:14:01.536337 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m18:14:01.536544 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:01.536736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:01.776694 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.779818 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 18:14:01.470345 => 18:14:01.779474
[0m18:14:01.780335 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m18:14:01.820109 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.823985 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 18:14:01.482443 => 18:14:01.823662
[0m18:14:01.824548 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m18:14:01.832290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:01.834865 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 18:14:01.534319 => 18:14:01.834562
[0m18:14:01.835347 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m18:14:01.939708 [info ] [Thread-1 (]: 26 of 36 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.41s]
[0m18:14:01.940893 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m18:14:01.941438 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:14:01.942324 [info ] [Thread-1 (]: 27 of 36 START test unique_dim_employee_employeekey ............................ [RUN]
[0m18:14:01.943542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m18:14:01.944035 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:14:01.949862 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:14:01.950868 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 18:14:01.944322 => 18:14:01.950631
[0m18:14:01.951249 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:14:01.954130 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:14:01.955096 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m18:14:01.955432 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:01.955743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:02.259429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:02.264024 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 18:14:01.951473 => 18:14:02.263571
[0m18:14:02.264693 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m18:14:02.357978 [info ] [Thread-1 (]: 27 of 36 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.41s]
[0m18:14:02.359389 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m18:14:02.360176 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:14:02.360855 [info ] [Thread-1 (]: 28 of 36 START test not_null_dim_product_productid ............................. [RUN]
[0m18:14:02.361846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m18:14:02.362535 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:14:02.368806 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:14:02.369867 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 18:14:02.363124 => 18:14:02.369621
[0m18:14:02.370319 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:14:02.374253 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:14:02.375521 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m18:14:02.375920 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m18:14:02.376345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:02.377158 [info ] [Thread-4 (]: 23 of 36 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.92s]
[0m18:14:02.378622 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m18:14:02.379027 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:14:02.379381 [info ] [Thread-4 (]: 29 of 36 START test not_null_dim_product_productkey ............................ [RUN]
[0m18:14:02.379956 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m18:14:02.380270 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:14:02.385683 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:14:02.386527 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 18:14:02.380635 => 18:14:02.386343
[0m18:14:02.386812 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:14:02.389003 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:14:02.389774 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m18:14:02.390048 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m18:14:02.390285 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:14:02.429750 [info ] [Thread-3 (]: 25 of 36 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.96s]
[0m18:14:02.430282 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m18:14:02.430647 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:14:02.430966 [info ] [Thread-3 (]: 30 of 36 START test unique_dim_product_productid ............................... [RUN]
[0m18:14:02.431463 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m18:14:02.431694 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:14:02.434582 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:14:02.435420 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 18:14:02.431827 => 18:14:02.435287
[0m18:14:02.435631 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:14:02.437293 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:14:02.437891 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m18:14:02.438114 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:02.438324 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:02.695352 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:02.696430 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:02.700137 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 18:14:02.386974 => 18:14:02.699697
[0m18:14:02.703018 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 18:14:02.371242 => 18:14:02.702685
[0m18:14:02.703953 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m18:14:02.704544 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m18:14:02.736741 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:02.739222 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 18:14:02.435750 => 18:14:02.738933
[0m18:14:02.739684 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m18:14:02.796844 [info ] [Thread-4 (]: 29 of 36 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.42s]
[0m18:14:02.797663 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m18:14:02.798199 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:14:02.798769 [info ] [Thread-4 (]: 31 of 36 START test unique_dim_product_productkey .............................. [RUN]
[0m18:14:02.799690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m18:14:02.800151 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:14:02.805368 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:14:02.806372 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 18:14:02.800421 => 18:14:02.806144
[0m18:14:02.806733 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:14:02.809257 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:14:02.810192 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m18:14:02.810539 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:02.810872 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:14:02.816105 [info ] [Thread-3 (]: 30 of 36 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.38s]
[0m18:14:02.816600 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m18:14:02.816947 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:14:02.817395 [info ] [Thread-3 (]: 32 of 36 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m18:14:02.818072 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m18:14:02.818437 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:14:02.821964 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:14:02.822557 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 18:14:02.818619 => 18:14:02.822390
[0m18:14:02.823197 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:14:02.825424 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:14:02.826192 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m18:14:02.826476 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m18:14:02.826724 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:14:02.827241 [info ] [Thread-1 (]: 28 of 36 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.47s]
[0m18:14:02.828032 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m18:14:02.828541 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:14:02.828895 [info ] [Thread-1 (]: 33 of 36 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m18:14:02.829423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m18:14:02.829734 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:14:02.833183 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:14:02.833694 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 18:14:02.830414 => 18:14:02.833551
[0m18:14:02.833942 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:14:02.837267 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:14:02.838139 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m18:14:02.838492 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:02.838914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:02.882176 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:02.883615 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 18:14:01.479859 => 18:14:02.883474
[0m18:14:02.883843 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m18:14:02.960947 [info ] [Thread-2 (]: 24 of 36 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 1.50s]
[0m18:14:02.961405 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m18:14:02.961705 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:14:02.962022 [info ] [Thread-2 (]: 34 of 36 START test not_null_fact_sales_saleskey ............................... [RUN]
[0m18:14:02.962552 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_sales_saleskey.0bc31ce210)
[0m18:14:02.962814 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:14:02.966185 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m18:14:02.966822 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_sales_saleskey.0bc31ce210 (compile): 18:14:02.962971 => 18:14:02.966678
[0m18:14:02.967057 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:14:02.968858 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m18:14:02.969512 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m18:14:02.969759 [debug] [Thread-2 (]: On test.northwind.not_null_fact_sales_saleskey.0bc31ce210: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select saleskey
from analytics.northwind_northwind.fact_sales
where saleskey is null



      
    ) dbt_internal_test
[0m18:14:02.969987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:14:03.106889 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:03.109038 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 18:14:02.806918 => 18:14:03.108807
[0m18:14:03.109420 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m18:14:03.119805 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:03.121580 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 18:14:02.823434 => 18:14:03.121373
[0m18:14:03.121925 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m18:14:03.129499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:14:03.131161 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 18:14:02.834083 => 18:14:03.130966
[0m18:14:03.131479 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m18:14:03.182706 [info ] [Thread-4 (]: 31 of 36 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.38s]
[0m18:14:03.183399 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m18:14:03.183829 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:14:03.184315 [info ] [Thread-4 (]: 35 of 36 START test unique_fact_sales_saleskey ................................. [RUN]
[0m18:14:03.185109 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productkey.52e0eda426, now test.northwind.unique_fact_sales_saleskey.c07ec0958d)
[0m18:14:03.185493 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:14:03.190211 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m18:14:03.191137 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_sales_saleskey.c07ec0958d (compile): 18:14:03.185716 => 18:14:03.190944
[0m18:14:03.191460 [debug] [Thread-4 (]: Began executing node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:14:03.193903 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m18:14:03.194750 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m18:14:03.195051 [debug] [Thread-4 (]: On test.northwind.unique_fact_sales_saleskey.c07ec0958d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_sales_saleskey.c07ec0958d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    saleskey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_sales
where saleskey is not null
group by saleskey
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:03.195324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:14:03.202677 [info ] [Thread-1 (]: 33 of 36 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.37s]
[0m18:14:03.203322 [info ] [Thread-3 (]: 32 of 36 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.39s]
[0m18:14:03.203931 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m18:14:03.204324 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m18:14:03.204854 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m18:14:03.205232 [info ] [Thread-1 (]: 36 of 36 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m18:14:03.205781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now model.northwind.obt_order_fulfillment)
[0m18:14:03.206057 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m18:14:03.209010 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m18:14:03.209537 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 18:14:03.206237 => 18:14:03.209386
[0m18:14:03.209772 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m18:14:03.211767 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m18:14:03.213020 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m18:14:03.213316 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m18:14:03.213599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:03.228976 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c5b2-0000-17c7-0009-ec83000204c2
[0m18:14:03.229279 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'SALESKEY'
[0m18:14:03.229602 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_sales_saleskey.0bc31ce210 (execute): 18:14:02.967187 => 18:14:03.229473
[0m18:14:03.229831 [debug] [Thread-2 (]: On test.northwind.not_null_fact_sales_saleskey.0bc31ce210: Close
[0m18:14:03.317591 [debug] [Thread-2 (]: Database Error in test not_null_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/not_null_fact_sales_saleskey.sql
[0m18:14:03.317994 [error] [Thread-2 (]: 34 of 36 ERROR not_null_fact_sales_saleskey .................................... [[31mERROR[0m in 0.36s]
[0m18:14:03.318407 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m18:14:03.436622 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c5b2-0000-17a6-0009-ec830002147e
[0m18:14:03.437234 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'SALESKEY'
[0m18:14:03.437875 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_sales_saleskey.c07ec0958d (execute): 18:14:03.191649 => 18:14:03.437613
[0m18:14:03.438265 [debug] [Thread-4 (]: On test.northwind.unique_fact_sales_saleskey.c07ec0958d: Close
[0m18:14:03.528587 [debug] [Thread-4 (]: Database Error in test unique_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/unique_fact_sales_saleskey.sql
[0m18:14:03.529644 [error] [Thread-4 (]: 35 of 36 ERROR unique_fact_sales_saleskey ...................................... [[31mERROR[0m in 0.34s]
[0m18:14:03.530294 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m18:14:03.931567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:14:03.936864 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 18:14:03.209913 => 18:14:03.936559
[0m18:14:03.937432 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m18:14:04.019570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55e40a16-7046-4b2a-aa04-c93346ffdb9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f3350>]}
[0m18:14:04.020686 [info ] [Thread-1 (]: 36 of 36 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.81s]
[0m18:14:04.021474 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m18:14:04.024451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:04.025058 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m18:14:04.025415 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_sales_saleskey.0bc31ce210' was properly closed.
[0m18:14:04.025732 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m18:14:04.025998 [debug] [MainThread]: Connection 'test.northwind.unique_fact_sales_saleskey.c07ec0958d' was properly closed.
[0m18:14:04.026344 [info ] [MainThread]: 
[0m18:14:04.026672 [info ] [MainThread]: Finished running 29 tests, 7 table models in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m18:14:04.031130 [debug] [MainThread]: Command end result
[0m18:14:04.044644 [info ] [MainThread]: 
[0m18:14:04.045014 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:14:04.045246 [info ] [MainThread]: 
[0m18:14:04.045478 [error] [MainThread]:   Database Error in test not_null_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/not_null_fact_sales_saleskey.sql
[0m18:14:04.045695 [info ] [MainThread]: 
[0m18:14:04.045904 [error] [MainThread]:   Database Error in test unique_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/unique_fact_sales_saleskey.sql
[0m18:14:04.046128 [info ] [MainThread]: 
[0m18:14:04.046356 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=2 SKIP=0 TOTAL=36
[0m18:14:04.048098 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.8305874, "process_user_time": 2.862214, "process_kernel_time": 0.278441, "process_mem_max_rss": "149356544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:14:04.048444 [debug] [MainThread]: Command `dbt build` failed at 18:14:04.048367 after 7.83 seconds
[0m18:14:04.048694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10419df70>]}
[0m18:14:04.048938 [debug] [MainThread]: Flushing usage events
[0m22:39:34.702419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e808c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d5f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea61e0>]}


============================== 22:39:34.705090 | b57d224f-491f-4161-bd46-a0b00e26cae9 ==============================
[0m22:39:34.705090 [info ] [MainThread]: Running with dbt=1.7.9
[0m22:39:34.705416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/work/Spring 2024/IST 722/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/work/Spring 2024/IST 722/ist722dbt/northwind/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:39:34.899809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a6db0>]}
[0m22:39:34.933248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074b8770>]}
[0m22:39:34.933759 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:39:34.946100 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m22:39:34.983373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:39:34.983809 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m22:39:35.104378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8fd10>]}
[0m22:39:35.113133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3ee40>]}
[0m22:39:35.113369 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m22:39:35.114778 [info ] [MainThread]: 
[0m22:39:35.115165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:39:35.115772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m22:39:35.121890 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m22:39:35.122129 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m22:39:35.122287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:35.743443 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m22:39:35.747074 [debug] [ThreadPool]: On list_analytics: Close
[0m22:39:35.857034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m22:39:35.868263 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m22:39:35.868859 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m22:39:35.869203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:39:36.365435 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m22:39:36.370821 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m22:39:36.459016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e66ed0>]}
[0m22:39:36.460702 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:39:36.461270 [info ] [MainThread]: 
[0m22:39:36.465257 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m22:39:36.465734 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m22:39:36.466166 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m22:39:36.466500 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m22:39:36.466884 [info ] [Thread-1 (]: 1 of 36 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m22:39:36.467320 [info ] [Thread-2 (]: 2 of 36 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m22:39:36.467707 [info ] [Thread-3 (]: 3 of 36 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m22:39:36.468093 [info ] [Thread-4 (]: 4 of 36 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m22:39:36.469236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m22:39:36.469951 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m22:39:36.470647 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m22:39:36.471284 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m22:39:36.471626 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m22:39:36.471934 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m22:39:36.472283 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m22:39:36.472650 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m22:39:36.488732 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m22:39:36.493429 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m22:39:36.496211 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m22:39:36.498821 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m22:39:36.500222 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 22:39:36.473107 => 22:39:36.500012
[0m22:39:36.500546 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m22:39:36.500844 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 22:39:36.489014 => 22:39:36.500695
[0m22:39:36.501145 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 22:39:36.496403 => 22:39:36.500984
[0m22:39:36.501411 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 22:39:36.493674 => 22:39:36.501285
[0m22:39:36.516256 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m22:39:36.516551 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m22:39:36.516794 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m22:39:36.517002 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m22:39:36.518744 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m22:39:36.520256 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m22:39:36.521729 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m22:39:36.522178 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m22:39:36.522752 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m22:39:36.522983 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m22:39:36.523240 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:36.523616 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m22:39:36.523998 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m22:39:36.524222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:36.524412 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:39:36.524622 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:36.524840 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:36.526081 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:39:36.526295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:39:37.874973 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:37.885890 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 22:39:36.520409 => 22:39:37.885526
[0m22:39:37.886531 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m22:39:37.967853 [info ] [Thread-3 (]: 3 of 36 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 1.50s]
[0m22:39:37.969009 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m22:39:37.970031 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m22:39:37.970791 [info ] [Thread-3 (]: 5 of 36 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m22:39:37.971876 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m22:39:37.972363 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m22:39:37.977498 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m22:39:37.978621 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 22:39:37.972643 => 22:39:37.978387
[0m22:39:37.979008 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m22:39:37.981959 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m22:39:37.983234 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m22:39:37.983606 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:37.983934 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:38.272610 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:38.274242 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 22:39:36.518915 => 22:39:38.274074
[0m22:39:38.274539 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m22:39:38.352460 [info ] [Thread-4 (]: 4 of 36 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 1.88s]
[0m22:39:38.352990 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m22:39:38.353320 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m22:39:38.353729 [info ] [Thread-4 (]: 6 of 36 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m22:39:38.354272 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m22:39:38.354562 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m22:39:38.358111 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m22:39:38.358780 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 22:39:38.354724 => 22:39:38.358614
[0m22:39:38.359066 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m22:39:38.362380 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m22:39:38.363553 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m22:39:38.363880 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:38.364146 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:38.403581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:38.405392 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 22:39:36.501537 => 22:39:38.405162
[0m22:39:38.406602 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:39:38.406962 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m22:39:38.408447 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 22:39:36.517217 => 22:39:38.408264
[0m22:39:38.409477 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m22:39:38.506490 [info ] [Thread-2 (]: 2 of 36 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 2.04s]
[0m22:39:38.507343 [info ] [Thread-1 (]: 1 of 36 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 2.04s]
[0m22:39:38.508651 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m22:39:38.509197 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m22:39:38.509587 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m22:39:38.510095 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m22:39:38.510499 [info ] [Thread-2 (]: 7 of 36 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m22:39:38.510889 [info ] [Thread-1 (]: 8 of 36 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m22:39:38.511511 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m22:39:38.512062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m22:39:38.512384 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m22:39:38.512687 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m22:39:38.517221 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m22:39:38.521020 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m22:39:38.521792 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 22:39:38.512902 => 22:39:38.521587
[0m22:39:38.522222 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 22:39:38.517523 => 22:39:38.521988
[0m22:39:38.522520 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m22:39:38.522825 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m22:39:38.524812 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m22:39:38.526735 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m22:39:38.527506 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m22:39:38.527788 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:38.528340 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m22:39:38.528615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:38.528895 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:38.529573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:38.603759 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:38.605466 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 22:39:37.979240 => 22:39:38.605273
[0m22:39:38.605793 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m22:39:38.800633 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:38.815596 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 22:39:38.359235 => 22:39:38.815267
[0m22:39:38.816936 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m22:39:38.858084 [info ] [Thread-3 (]: 5 of 36 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.89s]
[0m22:39:38.858758 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m22:39:38.859206 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m22:39:38.859608 [info ] [Thread-3 (]: 9 of 36 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m22:39:38.860853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m22:39:38.861721 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m22:39:38.866190 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m22:39:38.867496 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 22:39:38.861993 => 22:39:38.867265
[0m22:39:38.867911 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m22:39:38.870349 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m22:39:38.871271 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m22:39:38.871594 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:38.871888 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:38.933887 [info ] [Thread-4 (]: 6 of 36 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.58s]
[0m22:39:38.934387 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m22:39:38.934690 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m22:39:38.935035 [info ] [Thread-4 (]: 10 of 36 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m22:39:38.935555 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_customer)
[0m22:39:38.935812 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m22:39:38.939144 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m22:39:38.940684 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 22:39:38.935963 => 22:39:38.940475
[0m22:39:38.940998 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m22:39:38.958667 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m22:39:38.959493 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m22:39:38.959731 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m22:39:38.959956 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:39.367841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:39.372193 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 22:39:38.525001 => 22:39:39.371831
[0m22:39:39.372835 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m22:39:39.427271 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:39.430324 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 22:39:38.523011 => 22:39:39.429996
[0m22:39:39.431299 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m22:39:39.433358 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:39.435645 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 22:39:38.868156 => 22:39:39.435407
[0m22:39:39.436084 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m22:39:39.484986 [info ] [Thread-1 (]: 8 of 36 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.97s]
[0m22:39:39.485825 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m22:39:39.486358 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m22:39:39.486941 [info ] [Thread-1 (]: 11 of 36 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m22:39:39.487883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m22:39:39.488296 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m22:39:39.492253 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m22:39:39.494355 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 22:39:39.488546 => 22:39:39.494108
[0m22:39:39.494726 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m22:39:39.497556 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m22:39:39.498676 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m22:39:39.499039 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m22:39:39.499393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:39.509421 [info ] [Thread-2 (]: 7 of 36 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 1.00s]
[0m22:39:39.510028 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m22:39:39.510362 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m22:39:39.510788 [info ] [Thread-2 (]: 12 of 36 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m22:39:39.511427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m22:39:39.511778 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m22:39:39.515528 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m22:39:39.516379 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 22:39:39.511968 => 22:39:39.516190
[0m22:39:39.516691 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m22:39:39.518914 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m22:39:39.519937 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m22:39:39.520223 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m22:39:39.520505 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:39.524868 [info ] [Thread-3 (]: 9 of 36 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.66s]
[0m22:39:39.525287 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m22:39:39.525567 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m22:39:39.525907 [info ] [Thread-3 (]: 13 of 36 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m22:39:39.526374 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m22:39:39.526630 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m22:39:39.530836 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m22:39:39.531593 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 22:39:39.526808 => 22:39:39.531419
[0m22:39:39.531852 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m22:39:39.533841 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m22:39:39.535330 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m22:39:39.535641 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m22:39:39.535920 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:39.557860 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:39.567757 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 22:39:38.941168 => 22:39:39.567642
[0m22:39:39.567979 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m22:39:39.662341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111001610>]}
[0m22:39:39.662827 [info ] [Thread-4 (]: 10 of 36 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.73s]
[0m22:39:39.663248 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m22:39:39.663533 [debug] [Thread-4 (]: Began running node model.northwind.dim_product
[0m22:39:39.663908 [info ] [Thread-4 (]: 14 of 36 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m22:39:39.664472 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.dim_product)
[0m22:39:39.664781 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_product
[0m22:39:39.667747 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m22:39:39.669413 [debug] [Thread-4 (]: Timing info for model.northwind.dim_product (compile): 22:39:39.664953 => 22:39:39.669242
[0m22:39:39.669679 [debug] [Thread-4 (]: Began executing node model.northwind.dim_product
[0m22:39:39.671563 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m22:39:39.672285 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_product"
[0m22:39:39.672563 [debug] [Thread-4 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m22:39:39.672826 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:40.057932 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:40.062920 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 22:39:39.494930 => 22:39:40.062674
[0m22:39:40.063429 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m22:39:40.145556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e3770>]}
[0m22:39:40.146412 [info ] [Thread-1 (]: 11 of 36 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.66s]
[0m22:39:40.147116 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m22:39:40.147547 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m22:39:40.148144 [info ] [Thread-1 (]: 15 of 36 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m22:39:40.148945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m22:39:40.149395 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m22:39:40.157521 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m22:39:40.158783 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:40.161645 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 22:39:39.532001 => 22:39:40.161431
[0m22:39:40.162053 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m22:39:40.163171 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 22:39:40.149639 => 22:39:40.162995
[0m22:39:40.163680 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m22:39:40.166037 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m22:39:40.168083 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m22:39:40.168542 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m22:39:40.169020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:40.203215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:40.205607 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 22:39:39.516876 => 22:39:40.205441
[0m22:39:40.205905 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m22:39:40.261396 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107910d10>]}
[0m22:39:40.261946 [info ] [Thread-3 (]: 13 of 36 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 0.74s]
[0m22:39:40.262490 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m22:39:40.263421 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m22:39:40.263934 [info ] [Thread-3 (]: 16 of 36 START test not_null_dim_customer_customerid ........................... [RUN]
[0m22:39:40.264599 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m22:39:40.264968 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m22:39:40.270996 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m22:39:40.271936 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 22:39:40.265292 => 22:39:40.271760
[0m22:39:40.272229 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m22:39:40.274475 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m22:39:40.275462 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m22:39:40.275737 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m22:39:40.275987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:40.373293 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:40.376761 [debug] [Thread-4 (]: Timing info for model.northwind.dim_product (execute): 22:39:39.669820 => 22:39:40.376497
[0m22:39:40.377725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110865a0>]}
[0m22:39:40.378184 [debug] [Thread-4 (]: On model.northwind.dim_product: Close
[0m22:39:40.378737 [info ] [Thread-2 (]: 12 of 36 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.87s]
[0m22:39:40.380267 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m22:39:40.381033 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m22:39:40.381549 [info ] [Thread-2 (]: 17 of 36 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m22:39:40.382413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m22:39:40.382912 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m22:39:40.387748 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m22:39:40.388617 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 22:39:40.383450 => 22:39:40.388413
[0m22:39:40.388948 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m22:39:40.391602 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m22:39:40.392696 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m22:39:40.393001 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m22:39:40.393277 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:40.544919 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111424110>]}
[0m22:39:40.545545 [info ] [Thread-4 (]: 14 of 36 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 0.88s]
[0m22:39:40.546176 [debug] [Thread-4 (]: Finished running node model.northwind.dim_product
[0m22:39:40.546708 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m22:39:40.547166 [info ] [Thread-4 (]: 18 of 36 START test unique_dim_customer_customerid ............................. [RUN]
[0m22:39:40.547989 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m22:39:40.548523 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m22:39:40.552459 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m22:39:40.553172 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 22:39:40.548741 => 22:39:40.553003
[0m22:39:40.553457 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m22:39:40.555402 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m22:39:40.556138 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m22:39:40.556432 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:40.556693 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:40.743895 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c6bb-0000-17bf-0009-ec8300022056
[0m22:39:40.744696 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m22:39:40.745460 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 22:39:40.163892 => 22:39:40.745243
[0m22:39:40.745952 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m22:39:40.779132 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:40.781669 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 22:39:40.272401 => 22:39:40.781408
[0m22:39:40.782794 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m22:39:40.899083 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:40.899954 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:40.903386 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 22:39:40.553620 => 22:39:40.902976
[0m22:39:40.908282 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 22:39:40.389179 => 22:39:40.907993
[0m22:39:40.909095 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m22:39:40.909760 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m22:39:40.914738 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m22:39:40.915238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11146f290>]}
[0m22:39:40.915756 [error] [Thread-1 (]: 15 of 36 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.77s]
[0m22:39:40.916266 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m22:39:40.916627 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m22:39:40.917201 [info ] [Thread-1 (]: 19 of 36 START test unique_dim_customer_customerkey ............................ [RUN]
[0m22:39:40.918358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m22:39:40.918947 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m22:39:40.923364 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m22:39:40.924173 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 22:39:40.919313 => 22:39:40.923998
[0m22:39:40.924476 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m22:39:40.927005 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m22:39:40.928059 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m22:39:40.928380 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:40.928667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:40.945327 [info ] [Thread-3 (]: 16 of 36 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.68s]
[0m22:39:40.945933 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m22:39:40.946267 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m22:39:40.946610 [info ] [Thread-3 (]: 20 of 36 START test not_null_dim_date_date ..................................... [RUN]
[0m22:39:40.947155 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m22:39:40.947418 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m22:39:40.950748 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m22:39:40.951864 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 22:39:40.947573 => 22:39:40.951702
[0m22:39:40.952124 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m22:39:40.954105 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m22:39:40.956090 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m22:39:40.956585 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m22:39:40.956928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:40.999905 [info ] [Thread-4 (]: 18 of 36 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.45s]
[0m22:39:41.000417 [info ] [Thread-2 (]: 17 of 36 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.62s]
[0m22:39:41.000877 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m22:39:41.001166 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m22:39:41.001422 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m22:39:41.001695 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m22:39:41.001941 [info ] [Thread-4 (]: 21 of 36 START test not_null_dim_date_datekey .................................. [RUN]
[0m22:39:41.002166 [info ] [Thread-2 (]: 22 of 36 START test unique_dim_date_date ....................................... [RUN]
[0m22:39:41.002553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m22:39:41.002890 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m22:39:41.003085 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m22:39:41.003271 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m22:39:41.006006 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m22:39:41.008271 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m22:39:41.008796 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 22:39:41.003393 => 22:39:41.008677
[0m22:39:41.009037 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 22:39:41.006171 => 22:39:41.008919
[0m22:39:41.009214 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m22:39:41.009406 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m22:39:41.010992 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m22:39:41.012416 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m22:39:41.012972 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m22:39:41.013189 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m22:39:41.013398 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:41.013774 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m22:39:41.014316 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:41.014671 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:41.226765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.229735 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 22:39:40.924645 => 22:39:41.229417
[0m22:39:41.230206 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m22:39:41.301894 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.305398 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 22:39:40.952279 => 22:39:41.305078
[0m22:39:41.305966 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m22:39:41.321077 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.324171 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 22:39:41.011152 => 22:39:41.323771
[0m22:39:41.325850 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m22:39:41.325451 [info ] [Thread-1 (]: 19 of 36 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.41s]
[0m22:39:41.327535 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m22:39:41.328299 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m22:39:41.328800 [info ] [Thread-1 (]: 23 of 36 START test unique_dim_date_datekey .................................... [RUN]
[0m22:39:41.329556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m22:39:41.330020 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m22:39:41.335367 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m22:39:41.336487 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 22:39:41.330566 => 22:39:41.336285
[0m22:39:41.336814 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m22:39:41.341309 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m22:39:41.342162 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m22:39:41.342475 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:41.342771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:41.419134 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.421796 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 22:39:41.009535 => 22:39:41.421542
[0m22:39:41.422292 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m22:39:41.471527 [info ] [Thread-3 (]: 20 of 36 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.52s]
[0m22:39:41.472037 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m22:39:41.472373 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m22:39:41.472718 [info ] [Thread-3 (]: 24 of 36 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m22:39:41.473315 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m22:39:41.473613 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m22:39:41.477214 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m22:39:41.477895 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 22:39:41.473796 => 22:39:41.477731
[0m22:39:41.478185 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m22:39:41.480168 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m22:39:41.480846 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m22:39:41.481113 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m22:39:41.481360 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:41.489107 [info ] [Thread-2 (]: 22 of 36 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.49s]
[0m22:39:41.489526 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m22:39:41.489807 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m22:39:41.490104 [info ] [Thread-2 (]: 25 of 36 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m22:39:41.490594 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m22:39:41.490843 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m22:39:41.493894 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m22:39:41.494387 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 22:39:41.491018 => 22:39:41.494249
[0m22:39:41.494613 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m22:39:41.496354 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m22:39:41.497041 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m22:39:41.497289 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:41.497518 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:41.503365 [info ] [Thread-4 (]: 21 of 36 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.50s]
[0m22:39:41.503871 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m22:39:41.504209 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m22:39:41.504550 [info ] [Thread-4 (]: 26 of 36 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m22:39:41.505020 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m22:39:41.505272 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m22:39:41.508016 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m22:39:41.508868 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 22:39:41.505472 => 22:39:41.508729
[0m22:39:41.509085 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m22:39:41.510733 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m22:39:41.511315 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m22:39:41.511538 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m22:39:41.511753 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:41.723594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.726204 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 22:39:41.337004 => 22:39:41.725929
[0m22:39:41.726646 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m22:39:41.795681 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.797011 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.800283 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 22:39:41.478355 => 22:39:41.799938
[0m22:39:41.803662 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 22:39:41.494747 => 22:39:41.803214
[0m22:39:41.804539 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m22:39:41.805140 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m22:39:41.807286 [info ] [Thread-1 (]: 23 of 36 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.48s]
[0m22:39:41.809744 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m22:39:41.810267 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m22:39:41.810758 [info ] [Thread-1 (]: 27 of 36 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m22:39:41.811511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m22:39:41.812011 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m22:39:41.817466 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m22:39:41.819034 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 22:39:41.812525 => 22:39:41.818764
[0m22:39:41.819422 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m22:39:41.821946 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m22:39:41.823040 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m22:39:41.823393 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m22:39:41.823686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:41.840899 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:41.842635 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 22:39:41.509210 => 22:39:41.842443
[0m22:39:41.842968 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m22:39:41.948038 [info ] [Thread-3 (]: 24 of 36 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.47s]
[0m22:39:41.948726 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m22:39:41.949206 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m22:39:41.949686 [info ] [Thread-3 (]: 28 of 36 START test unique_dim_employee_employeeid ............................. [RUN]
[0m22:39:41.950462 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m22:39:41.950859 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m22:39:41.957104 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m22:39:41.957921 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 22:39:41.951091 => 22:39:41.957727
[0m22:39:41.958249 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m22:39:41.960691 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m22:39:41.961543 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m22:39:41.961854 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:41.962138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:41.977152 [info ] [Thread-2 (]: 25 of 36 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.49s]
[0m22:39:41.977654 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m22:39:41.977973 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m22:39:41.978319 [info ] [Thread-2 (]: 29 of 36 START test unique_dim_employee_employeekey ............................ [RUN]
[0m22:39:41.978909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m22:39:41.979218 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m22:39:41.982612 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m22:39:41.983216 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 22:39:41.979386 => 22:39:41.983052
[0m22:39:41.983493 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m22:39:41.985514 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m22:39:41.986271 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m22:39:41.986540 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:41.986792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:41.994243 [info ] [Thread-4 (]: 26 of 36 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.49s]
[0m22:39:41.994655 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m22:39:41.994922 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m22:39:41.995204 [info ] [Thread-4 (]: 30 of 36 START test not_null_dim_product_productid ............................. [RUN]
[0m22:39:41.995675 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m22:39:41.995905 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m22:39:41.998912 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m22:39:41.999407 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 22:39:41.996038 => 22:39:41.999269
[0m22:39:41.999635 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m22:39:42.001363 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m22:39:42.002178 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m22:39:42.002583 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m22:39:42.002864 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:42.208007 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.211009 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 22:39:41.819640 => 22:39:42.210728
[0m22:39:42.211483 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m22:39:42.263574 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.267754 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 22:39:41.958447 => 22:39:42.267384
[0m22:39:42.268786 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m22:39:42.269635 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.273686 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 22:39:41.983661 => 22:39:42.273319
[0m22:39:42.274571 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m22:39:42.298578 [info ] [Thread-1 (]: 27 of 36 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.49s]
[0m22:39:42.299368 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m22:39:42.299822 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m22:39:42.300305 [info ] [Thread-1 (]: 31 of 36 START test not_null_dim_product_productkey ............................ [RUN]
[0m22:39:42.301073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m22:39:42.302055 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.302398 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m22:39:42.304431 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 22:39:41.999771 => 22:39:42.304202
[0m22:39:42.309507 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m22:39:42.309862 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m22:39:42.313095 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 22:39:42.304695 => 22:39:42.312792
[0m22:39:42.313660 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m22:39:42.316437 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m22:39:42.317850 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m22:39:42.318169 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m22:39:42.318459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:42.359153 [info ] [Thread-2 (]: 29 of 36 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.38s]
[0m22:39:42.359714 [info ] [Thread-3 (]: 28 of 36 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.41s]
[0m22:39:42.360261 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m22:39:42.360643 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m22:39:42.360942 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m22:39:42.361277 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m22:39:42.361634 [info ] [Thread-2 (]: 32 of 36 START test unique_dim_product_productid ............................... [RUN]
[0m22:39:42.361913 [info ] [Thread-3 (]: 33 of 36 START test unique_dim_product_productkey .............................. [RUN]
[0m22:39:42.362361 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m22:39:42.362836 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m22:39:42.363140 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m22:39:42.363409 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m22:39:42.366562 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m22:39:42.369230 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m22:39:42.369826 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 22:39:42.363569 => 22:39:42.369665
[0m22:39:42.370112 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 22:39:42.366746 => 22:39:42.369976
[0m22:39:42.370374 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m22:39:42.370610 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m22:39:42.373682 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m22:39:42.375190 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m22:39:42.375886 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m22:39:42.376340 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m22:39:42.376600 [debug] [Thread-2 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:42.376863 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m22:39:42.377106 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:39:42.377301 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:39:42.469260 [info ] [Thread-4 (]: 30 of 36 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.47s]
[0m22:39:42.469853 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m22:39:42.470221 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m22:39:42.470627 [info ] [Thread-4 (]: 34 of 36 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m22:39:42.471037 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m22:39:42.471383 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m22:39:42.471730 [info ] [Thread-4 (]: 35 of 36 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m22:39:42.472088 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m22:39:42.472430 [debug] [Thread-4 (]: Began running node model.northwind.obt_order_fulfillment
[0m22:39:42.472814 [info ] [Thread-4 (]: 36 of 36 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m22:39:42.473424 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now model.northwind.obt_order_fulfillment)
[0m22:39:42.473734 [debug] [Thread-4 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m22:39:42.476722 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m22:39:42.477380 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 22:39:42.473918 => 22:39:42.477213
[0m22:39:42.477650 [debug] [Thread-4 (]: Began executing node model.northwind.obt_order_fulfillment
[0m22:39:42.479833 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m22:39:42.481264 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m22:39:42.481635 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m22:39:42.481950 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:39:42.669586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.671995 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 22:39:42.314336 => 22:39:42.671727
[0m22:39:42.672734 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m22:39:42.764106 [info ] [Thread-1 (]: 31 of 36 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.46s]
[0m22:39:42.765555 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m22:39:42.807721 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.808700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:39:42.811405 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 22:39:42.373834 => 22:39:42.811134
[0m22:39:42.813361 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 22:39:42.370749 => 22:39:42.813133
[0m22:39:42.813813 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m22:39:42.814184 [debug] [Thread-2 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m22:39:43.143765 [info ] [Thread-2 (]: 32 of 36 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.78s]
[0m22:39:43.144905 [info ] [Thread-3 (]: 33 of 36 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.78s]
[0m22:39:43.146193 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m22:39:43.147362 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m22:39:43.233860 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:39:43.236802 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 22:39:42.477814 => 22:39:43.236586
[0m22:39:43.237200 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: Close
[0m22:39:43.316981 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b57d224f-491f-4161-bd46-a0b00e26cae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110262d0>]}
[0m22:39:43.317513 [info ] [Thread-4 (]: 36 of 36 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.84s]
[0m22:39:43.317984 [debug] [Thread-4 (]: Finished running node model.northwind.obt_order_fulfillment
[0m22:39:43.319451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:43.319710 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_product_productkey.f710b87f84' was properly closed.
[0m22:39:43.319918 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productid.cfdf676d85' was properly closed.
[0m22:39:43.320126 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productkey.52e0eda426' was properly closed.
[0m22:39:43.320329 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m22:39:43.320603 [info ] [MainThread]: 
[0m22:39:43.320841 [info ] [MainThread]: Finished running 29 tests, 7 table models in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m22:39:43.323719 [debug] [MainThread]: Command end result
[0m22:39:43.331771 [info ] [MainThread]: 
[0m22:39:43.332052 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:39:43.332248 [info ] [MainThread]: 
[0m22:39:43.332450 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m22:39:43.332658 [info ] [MainThread]: 
[0m22:39:43.332862 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=2 TOTAL=36
[0m22:39:43.334666 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.657896, "process_user_time": 2.795555, "process_kernel_time": 0.289108, "process_mem_max_rss": "146784256", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:43.334999 [debug] [MainThread]: Command `dbt build` failed at 22:39:43.334923 after 8.66 seconds
[0m22:39:43.335242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089fcb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111579c40>]}
[0m22:39:43.335464 [debug] [MainThread]: Flushing usage events
[0m23:28:00.036626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b94770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba6090>]}


============================== 23:28:00.039272 | 29e814b4-b7c1-4523-9177-9cd538d5a18e ==============================
[0m23:28:00.039272 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:28:00.039588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:28:00.224006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c242f0>]}
[0m23:28:00.256936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702300>]}
[0m23:28:00.257405 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:28:00.268802 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:28:00.305189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:28:00.305563 [debug] [MainThread]: Partial parsing: updated file: northwind://models/obt_sales.yml
[0m23:28:00.305758 [debug] [MainThread]: Partial parsing: updated file: northwind://models/obt_sales.sql
[0m23:28:00.384005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095bfec0>]}
[0m23:28:00.392148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10982b950>]}
[0m23:28:00.392377 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m23:28:00.393786 [info ] [MainThread]: 
[0m23:28:00.394170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:28:00.394782 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m23:28:00.400675 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m23:28:00.400860 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m23:28:00.401005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:01.068131 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:28:01.071875 [debug] [ThreadPool]: On list_analytics: Close
[0m23:28:01.277620 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m23:28:01.285527 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m23:28:01.285836 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m23:28:01.286080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:01.557108 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m23:28:01.560774 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m23:28:01.659476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109878b00>]}
[0m23:28:01.660738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:28:01.661182 [info ] [MainThread]: 
[0m23:28:01.664980 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:28:01.665426 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:28:01.665876 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:28:01.666200 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:28:01.666575 [info ] [Thread-1 (]: 1 of 37 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m23:28:01.666983 [info ] [Thread-2 (]: 2 of 37 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m23:28:01.667373 [info ] [Thread-3 (]: 3 of 37 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m23:28:01.667746 [info ] [Thread-4 (]: 4 of 37 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m23:28:01.668901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m23:28:01.669602 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m23:28:01.670234 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m23:28:01.670845 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m23:28:01.671199 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:28:01.671519 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:28:01.671809 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:28:01.672095 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:28:01.688122 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:28:01.724453 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:28:01.726812 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:28:01.729016 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:28:01.731311 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 23:28:01.672300 => 23:28:01.731160
[0m23:28:01.731579 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 23:28:01.688390 => 23:28:01.731432
[0m23:28:01.731808 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 23:28:01.727004 => 23:28:01.731697
[0m23:28:01.732070 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 23:28:01.724757 => 23:28:01.731932
[0m23:28:01.732278 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:28:01.732482 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:28:01.732664 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:28:01.732836 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:28:01.743649 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:28:01.745018 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:28:01.746301 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:28:01.747511 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:28:01.748347 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:28:01.748724 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:28:01.749087 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:28:01.749439 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:28:01.749635 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:28:01.749836 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:01.750026 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:01.750233 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:01.750433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:01.750595 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:28:01.750752 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:28:01.750904 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:28:02.023287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.029445 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 23:28:01.732945 => 23:28:02.029194
[0m23:28:02.029863 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m23:28:02.095785 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.097984 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 23:28:01.746444 => 23:28:02.097722
[0m23:28:02.098402 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m23:28:02.110452 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.112461 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 23:28:01.745154 => 23:28:02.112220
[0m23:28:02.112874 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m23:28:02.137409 [info ] [Thread-1 (]: 1 of 37 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.47s]
[0m23:28:02.138081 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:28:02.138522 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:28:02.139043 [info ] [Thread-1 (]: 5 of 37 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m23:28:02.139870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m23:28:02.140297 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:28:02.144675 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:28:02.147687 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 23:28:02.140521 => 23:28:02.147480
[0m23:28:02.148211 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:28:02.152125 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:28:02.153172 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:28:02.153522 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:02.153846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:02.184092 [info ] [Thread-3 (]: 3 of 37 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.51s]
[0m23:28:02.184590 [info ] [Thread-4 (]: 4 of 37 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.51s]
[0m23:28:02.185026 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:28:02.185322 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:28:02.185562 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:28:02.185855 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:28:02.186187 [info ] [Thread-3 (]: 6 of 37 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m23:28:02.186428 [info ] [Thread-4 (]: 7 of 37 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m23:28:02.186802 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m23:28:02.187145 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m23:28:02.187346 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:28:02.187532 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:28:02.190072 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:28:02.192526 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:28:02.193550 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 23:28:02.187659 => 23:28:02.193403
[0m23:28:02.193804 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 23:28:02.190238 => 23:28:02.193683
[0m23:28:02.193989 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:28:02.194209 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:28:02.195683 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:28:02.197221 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:28:02.198043 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:28:02.198309 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:02.198715 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:28:02.198905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:02.199111 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:02.199622 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:02.225817 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.227804 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 23:28:01.743820 => 23:28:02.227626
[0m23:28:02.228070 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m23:28:02.299628 [info ] [Thread-2 (]: 2 of 37 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.63s]
[0m23:28:02.300059 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:28:02.300335 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:28:02.300708 [info ] [Thread-2 (]: 8 of 37 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m23:28:02.301208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m23:28:02.301453 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:28:02.304729 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:28:02.305258 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 23:28:02.301605 => 23:28:02.305129
[0m23:28:02.305480 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:28:02.307271 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:28:02.308171 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:28:02.308411 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:02.308634 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:02.411721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.414427 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 23:28:02.148692 => 23:28:02.414213
[0m23:28:02.414774 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m23:28:02.467376 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.469243 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 23:28:02.195830 => 23:28:02.469024
[0m23:28:02.469581 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m23:28:02.481329 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.483092 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 23:28:02.194351 => 23:28:02.482893
[0m23:28:02.483399 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m23:28:02.486456 [info ] [Thread-1 (]: 5 of 37 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.35s]
[0m23:28:02.487144 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:28:02.487485 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:28:02.487845 [info ] [Thread-1 (]: 9 of 37 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m23:28:02.488503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m23:28:02.488778 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:28:02.492577 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:28:02.494771 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 23:28:02.488942 => 23:28:02.494614
[0m23:28:02.495031 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:28:02.497000 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:28:02.497752 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:28:02.498027 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:02.498280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:02.549726 [info ] [Thread-4 (]: 7 of 37 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.36s]
[0m23:28:02.550245 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:28:02.550535 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m23:28:02.550918 [info ] [Thread-4 (]: 10 of 37 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m23:28:02.551384 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m23:28:02.551616 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m23:28:02.561943 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m23:28:02.563415 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 23:28:02.551748 => 23:28:02.563250
[0m23:28:02.563980 [info ] [Thread-3 (]: 6 of 37 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.38s]
[0m23:28:02.564493 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m23:28:02.564917 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:28:02.580434 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m23:28:02.581274 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.581569 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m23:28:02.582999 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 23:28:02.305622 => 23:28:02.582857
[0m23:28:02.583282 [info ] [Thread-3 (]: 11 of 37 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m23:28:02.583566 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m23:28:02.583979 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m23:28:02.584373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m23:28:02.585133 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m23:28:02.585539 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m23:28:02.585751 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:02.587557 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m23:28:02.588908 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 23:28:02.585885 => 23:28:02.588787
[0m23:28:02.589125 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m23:28:02.590710 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m23:28:02.591417 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m23:28:02.591602 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m23:28:02.591789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:02.661208 [info ] [Thread-2 (]: 8 of 37 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.36s]
[0m23:28:02.661734 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:28:02.662012 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m23:28:02.662374 [info ] [Thread-2 (]: 12 of 37 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m23:28:02.662793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m23:28:02.662996 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m23:28:02.665811 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m23:28:02.667086 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 23:28:02.663121 => 23:28:02.666935
[0m23:28:02.667307 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m23:28:02.668942 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m23:28:02.669797 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m23:28:02.670032 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m23:28:02.670246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:02.767011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:02.768960 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 23:28:02.495192 => 23:28:02.768777
[0m23:28:02.769299 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m23:28:02.854441 [info ] [Thread-1 (]: 9 of 37 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.37s]
[0m23:28:02.855147 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:28:02.855603 [debug] [Thread-1 (]: Began running node model.northwind.dim_product
[0m23:28:02.856123 [info ] [Thread-1 (]: 13 of 37 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m23:28:02.856909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m23:28:02.857301 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_product
[0m23:28:02.861942 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m23:28:02.863908 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (compile): 23:28:02.857528 => 23:28:02.863720
[0m23:28:02.864223 [debug] [Thread-1 (]: Began executing node model.northwind.dim_product
[0m23:28:02.867146 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m23:28:02.869293 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_product"
[0m23:28:02.869619 [debug] [Thread-1 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m23:28:02.869892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:03.959867 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:03.980953 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 23:28:02.589363 => 23:28:03.980736
[0m23:28:03.981456 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m23:28:04.058772 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:04.062504 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 23:28:02.565087 => 23:28:04.062278
[0m23:28:04.063428 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3e8080>]}
[0m23:28:04.064166 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:04.064600 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m23:28:04.065229 [info ] [Thread-3 (]: 11 of 37 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.48s]
[0m23:28:04.067860 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 23:28:02.667430 => 23:28:04.067656
[0m23:28:04.069385 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m23:28:04.070012 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m23:28:04.070433 [debug] [Thread-3 (]: Began running node model.northwind.fact_sales
[0m23:28:04.071708 [info ] [Thread-3 (]: 14 of 37 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m23:28:04.072863 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m23:28:04.073910 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_sales
[0m23:28:04.080800 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m23:28:04.082142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:04.085185 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (execute): 23:28:02.864696 => 23:28:04.085016
[0m23:28:04.085538 [debug] [Thread-1 (]: On model.northwind.dim_product: Close
[0m23:28:04.086469 [debug] [Thread-3 (]: Timing info for model.northwind.fact_sales (compile): 23:28:04.074732 => 23:28:04.086331
[0m23:28:04.086985 [debug] [Thread-3 (]: Began executing node model.northwind.fact_sales
[0m23:28:04.089419 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m23:28:04.091035 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_sales"
[0m23:28:04.091479 [debug] [Thread-3 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m23:28:04.091847 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:04.161320 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3d3c20>]}
[0m23:28:04.161966 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b279910>]}
[0m23:28:04.162503 [info ] [Thread-2 (]: 12 of 37 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.50s]
[0m23:28:04.162925 [info ] [Thread-4 (]: 10 of 37 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.61s]
[0m23:28:04.163339 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m23:28:04.163844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a5dc0>]}
[0m23:28:04.164246 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m23:28:04.164549 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m23:28:04.165035 [info ] [Thread-1 (]: 13 of 37 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.31s]
[0m23:28:04.165360 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:28:04.165691 [info ] [Thread-2 (]: 15 of 37 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m23:28:04.166166 [debug] [Thread-1 (]: Finished running node model.northwind.dim_product
[0m23:28:04.166410 [info ] [Thread-4 (]: 16 of 37 START test not_null_dim_date_date ..................................... [RUN]
[0m23:28:04.166862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now model.northwind.fact_order_fulfillment)
[0m23:28:04.167148 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:28:04.167586 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m23:28:04.167867 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m23:28:04.168099 [info ] [Thread-1 (]: 17 of 37 START test not_null_dim_date_datekey .................................. [RUN]
[0m23:28:04.168377 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:28:04.172704 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m23:28:04.173224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m23:28:04.177719 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:28:04.178090 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:28:04.180932 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:28:04.181220 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 23:28:04.168555 => 23:28:04.181080
[0m23:28:04.181547 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m23:28:04.181798 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 23:28:04.173395 => 23:28:04.181691
[0m23:28:04.183471 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m23:28:04.183754 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:28:04.184021 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 23:28:04.178344 => 23:28:04.183900
[0m23:28:04.186047 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:28:04.186428 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:28:04.187652 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m23:28:04.190635 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:28:04.190948 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m23:28:04.191509 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:28:04.191727 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:04.191992 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m23:28:04.192372 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:28:04.193043 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:04.193489 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m23:28:04.194222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:04.360148 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b2c6ec-0000-17bf-0009-ec83000220b2
[0m23:28:04.360537 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m23:28:04.360945 [debug] [Thread-3 (]: Timing info for model.northwind.fact_sales (execute): 23:28:04.087201 => 23:28:04.360780
[0m23:28:04.361237 [debug] [Thread-3 (]: On model.northwind.fact_sales: Close
[0m23:28:04.445948 [debug] [Thread-3 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:28:04.446440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b125a0>]}
[0m23:28:04.446998 [error] [Thread-3 (]: 14 of 37 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.37s]
[0m23:28:04.447540 [debug] [Thread-3 (]: Finished running node model.northwind.fact_sales
[0m23:28:04.447910 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:28:04.448418 [info ] [Thread-3 (]: 18 of 37 START test unique_dim_date_date ....................................... [RUN]
[0m23:28:04.449074 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m23:28:04.449451 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:28:04.454017 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:28:04.454709 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 23:28:04.449660 => 23:28:04.454541
[0m23:28:04.454990 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:28:04.457187 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:28:04.457938 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:28:04.458221 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:04.458493 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:04.648712 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:04.649925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:04.654135 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 23:28:04.184341 => 23:28:04.653856
[0m23:28:04.656860 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 23:28:04.187893 => 23:28:04.656593
[0m23:28:04.657407 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m23:28:04.657803 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m23:28:04.767733 [info ] [Thread-4 (]: 16 of 37 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.60s]
[0m23:28:04.769418 [info ] [Thread-1 (]: 17 of 37 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.60s]
[0m23:28:04.770733 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:28:04.771733 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:28:04.772354 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:28:04.773014 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:28:04.773573 [info ] [Thread-4 (]: 19 of 37 START test unique_dim_date_datekey .................................... [RUN]
[0m23:28:04.774147 [info ] [Thread-1 (]: 20 of 37 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m23:28:04.774922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m23:28:04.775580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m23:28:04.775949 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:28:04.776289 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:28:04.781693 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:28:04.785888 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:28:04.786837 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 23:28:04.776517 => 23:28:04.786608
[0m23:28:04.787238 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 23:28:04.782004 => 23:28:04.787036
[0m23:28:04.787632 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:28:04.787950 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:28:04.790105 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:28:04.792188 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:28:04.793149 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:28:04.793621 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:04.794239 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:28:04.794552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:04.794856 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m23:28:04.795946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:04.992934 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:04.997535 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 23:28:04.455159 => 23:28:04.997266
[0m23:28:04.998343 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m23:28:05.088482 [info ] [Thread-3 (]: 18 of 37 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.64s]
[0m23:28:05.089959 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:28:05.090797 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:28:05.091462 [info ] [Thread-3 (]: 21 of 37 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m23:28:05.092488 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m23:28:05.092972 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:28:05.098503 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:28:05.099606 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 23:28:05.093261 => 23:28:05.099377
[0m23:28:05.099989 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:28:05.102680 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:28:05.103822 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:28:05.104185 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m23:28:05.104511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:05.110643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:05.115311 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 23:28:04.181926 => 23:28:05.115108
[0m23:28:05.115685 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m23:28:05.198512 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b45610>]}
[0m23:28:05.199304 [info ] [Thread-2 (]: 15 of 37 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.03s]
[0m23:28:05.199866 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m23:28:05.200256 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:28:05.200684 [info ] [Thread-2 (]: 22 of 37 START test unique_dim_employee_employeeid ............................. [RUN]
[0m23:28:05.201476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m23:28:05.201860 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:28:05.205749 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:28:05.206502 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 23:28:05.202062 => 23:28:05.206326
[0m23:28:05.206790 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:28:05.209134 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:28:05.210002 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:28:05.210284 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:05.210732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:05.389040 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:05.390722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:05.393523 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 23:28:04.788133 => 23:28:05.393211
[0m23:28:05.395442 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 23:28:04.790326 => 23:28:05.395206
[0m23:28:05.395877 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m23:28:05.396256 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m23:28:05.410747 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:05.412858 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 23:28:05.100215 => 23:28:05.412606
[0m23:28:05.413276 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m23:28:05.472279 [info ] [Thread-4 (]: 19 of 37 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.70s]
[0m23:28:05.473121 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:28:05.474142 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:28:05.474682 [info ] [Thread-4 (]: 23 of 37 START test unique_dim_employee_employeekey ............................ [RUN]
[0m23:28:05.475544 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m23:28:05.475965 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:28:05.481138 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:28:05.481875 [info ] [Thread-1 (]: 20 of 37 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.71s]
[0m23:28:05.482530 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:28:05.482961 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:28:05.483350 [info ] [Thread-1 (]: 24 of 37 START test not_null_dim_customer_customerid ........................... [RUN]
[0m23:28:05.483754 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 23:28:05.476207 => 23:28:05.483568
[0m23:28:05.484315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m23:28:05.485006 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:28:05.485535 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:28:05.488459 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:28:05.491980 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:28:05.492734 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 23:28:05.488693 => 23:28:05.492567
[0m23:28:05.493396 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:28:05.493794 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:28:05.494205 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:05.496487 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:28:05.496796 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:05.498127 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:28:05.498436 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m23:28:05.498682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:05.505689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:05.507266 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 23:28:05.206969 => 23:28:05.507096
[0m23:28:05.507787 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m23:28:05.510148 [info ] [Thread-3 (]: 21 of 37 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.42s]
[0m23:28:05.510982 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:28:05.511344 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:28:05.511669 [info ] [Thread-3 (]: 25 of 37 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m23:28:05.512122 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m23:28:05.512361 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:28:05.515357 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:28:05.515852 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 23:28:05.512500 => 23:28:05.515712
[0m23:28:05.516081 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:28:05.517823 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:28:05.518443 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:28:05.518690 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m23:28:05.518916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:05.704841 [info ] [Thread-2 (]: 22 of 37 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.50s]
[0m23:28:05.705598 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:28:05.706909 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:28:05.707707 [info ] [Thread-2 (]: 26 of 37 START test unique_dim_customer_customerid ............................. [RUN]
[0m23:28:05.708660 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m23:28:05.709096 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:28:05.716020 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:28:05.718678 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 23:28:05.710572 => 23:28:05.718476
[0m23:28:05.718984 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:28:05.721168 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:28:05.722606 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:28:05.722886 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:05.723146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:05.820940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:05.822960 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 23:28:05.494477 => 23:28:05.822739
[0m23:28:05.823589 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m23:28:05.824150 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:05.826279 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 23:28:05.516213 => 23:28:05.826110
[0m23:28:05.826763 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m23:28:05.829485 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:05.830976 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 23:28:05.485798 => 23:28:05.830796
[0m23:28:05.831274 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m23:28:05.901567 [info ] [Thread-3 (]: 25 of 37 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.39s]
[0m23:28:05.902641 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:28:05.903315 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:28:05.903767 [info ] [Thread-3 (]: 27 of 37 START test unique_dim_customer_customerkey ............................ [RUN]
[0m23:28:05.904585 [info ] [Thread-4 (]: 23 of 37 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.43s]
[0m23:28:05.905290 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m23:28:05.906031 [info ] [Thread-1 (]: 24 of 37 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.42s]
[0m23:28:05.906526 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:28:05.906835 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:28:05.907236 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:28:05.907579 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:28:05.911507 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:28:05.911890 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:28:05.912241 [info ] [Thread-4 (]: 28 of 37 START test not_null_dim_product_productid ............................. [RUN]
[0m23:28:05.912642 [info ] [Thread-1 (]: 29 of 37 START test not_null_dim_product_productkey ............................ [RUN]
[0m23:28:05.913226 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m23:28:05.913787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m23:28:05.914167 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 23:28:05.907834 => 23:28:05.914002
[0m23:28:05.914452 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:28:05.914711 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:28:05.914971 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:28:05.918314 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:28:05.921558 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:28:05.924457 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:28:05.925302 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 23:28:05.915137 => 23:28:05.925130
[0m23:28:05.925603 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:28:05.925899 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 23:28:05.918772 => 23:28:05.925745
[0m23:28:05.927895 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:28:05.928359 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:28:05.928952 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:28:05.930973 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:28:05.931341 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:05.931850 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:28:05.932119 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:05.932379 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m23:28:05.932815 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:28:05.933421 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:05.933876 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m23:28:05.934425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:06.070581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.072348 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 23:28:05.719260 => 23:28:06.072149
[0m23:28:06.072664 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m23:28:06.160375 [info ] [Thread-2 (]: 26 of 37 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.45s]
[0m23:28:06.161054 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:28:06.161492 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:28:06.161983 [info ] [Thread-2 (]: 30 of 37 START test unique_dim_product_productid ............................... [RUN]
[0m23:28:06.162787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m23:28:06.163188 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:28:06.167727 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:28:06.168518 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 23:28:06.163426 => 23:28:06.168327
[0m23:28:06.168836 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:28:06.173146 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:28:06.174034 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:28:06.174335 [debug] [Thread-2 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:06.174630 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:06.223649 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.225342 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 23:28:05.922695 => 23:28:06.225174
[0m23:28:06.225611 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m23:28:06.227110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.228517 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 23:28:05.929270 => 23:28:06.228358
[0m23:28:06.229032 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m23:28:06.229452 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.231675 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 23:28:05.926109 => 23:28:06.231521
[0m23:28:06.231990 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m23:28:06.308643 [info ] [Thread-1 (]: 29 of 37 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.40s]
[0m23:28:06.310297 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:28:06.309266 [info ] [Thread-3 (]: 27 of 37 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.40s]
[0m23:28:06.309896 [info ] [Thread-4 (]: 28 of 37 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.40s]
[0m23:28:06.310754 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:28:06.311181 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:28:06.311550 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:28:06.311824 [info ] [Thread-1 (]: 31 of 37 START test unique_dim_product_productkey .............................. [RUN]
[0m23:28:06.312161 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:28:06.312498 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:28:06.313013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m23:28:06.313332 [info ] [Thread-3 (]: 32 of 37 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m23:28:06.313649 [info ] [Thread-4 (]: 33 of 37 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m23:28:06.313951 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:28:06.314241 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:28:06.314520 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:28:06.318070 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:28:06.318436 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:28:06.318785 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:28:06.319183 [info ] [Thread-3 (]: 34 of 37 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m23:28:06.319550 [info ] [Thread-4 (]: 35 of 37 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m23:28:06.320183 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m23:28:06.320502 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 23:28:06.314682 => 23:28:06.320350
[0m23:28:06.320920 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m23:28:06.321176 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:28:06.321411 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:28:06.321628 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:28:06.324611 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:28:06.326526 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:28:06.329188 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:28:06.329850 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 23:28:06.321773 => 23:28:06.329688
[0m23:28:06.330367 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:28:06.330623 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:28:06.330878 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 23:28:06.326703 => 23:28:06.330752
[0m23:28:06.331132 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:06.332884 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:28:06.333151 [debug] [Thread-4 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:28:06.333427 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:06.335293 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:28:06.336398 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:28:06.336715 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m23:28:06.336961 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:28:06.337397 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:28:06.337932 [debug] [Thread-4 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:28:06.338370 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:28:06.455874 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.457909 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 23:28:06.169028 => 23:28:06.457724
[0m23:28:06.458244 [debug] [Thread-2 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m23:28:06.539502 [info ] [Thread-2 (]: 30 of 37 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.38s]
[0m23:28:06.540241 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:28:06.616568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.620385 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 23:28:06.324799 => 23:28:06.619956
[0m23:28:06.621497 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m23:28:06.622225 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.624940 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 23:28:06.331301 => 23:28:06.624736
[0m23:28:06.625513 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m23:28:06.629463 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:28:06.631112 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 23:28:06.333663 => 23:28:06.630916
[0m23:28:06.631424 [debug] [Thread-4 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m23:28:06.698730 [info ] [Thread-1 (]: 31 of 37 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.39s]
[0m23:28:06.700066 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:28:06.706859 [info ] [Thread-4 (]: 35 of 37 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.39s]
[0m23:28:06.707710 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:28:06.711062 [info ] [Thread-3 (]: 34 of 37 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.39s]
[0m23:28:06.711731 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:28:06.712800 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m23:28:06.713427 [debug] [Thread-1 (]: Began running node model.northwind.obt_sales
[0m23:28:06.713993 [info ] [Thread-2 (]: 36 of 37 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m23:28:06.714553 [info ] [Thread-1 (]: 37 of 37 START sql table model analytics.northwind_northwind.obt_sales ......... [RUN]
[0m23:28:06.715363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now model.northwind.obt_order_fulfillment)
[0m23:28:06.716032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productkey.52e0eda426, now model.northwind.obt_sales)
[0m23:28:06.716423 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m23:28:06.716786 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_sales
[0m23:28:06.721259 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_sales"
[0m23:28:06.723825 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m23:28:06.724502 [debug] [Thread-1 (]: Timing info for model.northwind.obt_sales (compile): 23:28:06.718189 => 23:28:06.724327
[0m23:28:06.724843 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 23:28:06.716992 => 23:28:06.724669
[0m23:28:06.725123 [debug] [Thread-1 (]: Began executing node model.northwind.obt_sales
[0m23:28:06.725389 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m23:28:06.727684 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_sales"
[0m23:28:06.731428 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m23:28:06.732701 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_sales"
[0m23:28:06.732995 [debug] [Thread-1 (]: On model.northwind.obt_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_sales"} */
create or replace transient table analytics.northwind_northwind.obt_sales
         as
        (with f_order_sales as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.saleskey, f.employeeid, f.customerid, f.orderdate, f.productid, f.orderid, f.quantity, f.extendedpriceamount, f.discountamount, f.soldamount
from f_order_fulfillment as f
left join d_customer on f.customerid = d_customer.customerid
left join d_employee on f.employeeid = d_employee.employeeid
left join d_date on f.orderdate = d_date.date
        );
[0m23:28:06.734097 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m23:28:06.734371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:06.734805 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m23:28:06.735567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:28:06.996347 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c6ec-0000-17c1-0009-ec83000230ca
[0m23:28:06.997037 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'F_ORDER_FULFILLMENT' does not exist or not authorized.
[0m23:28:06.997656 [debug] [Thread-1 (]: Timing info for model.northwind.obt_sales (execute): 23:28:06.725551 => 23:28:06.997413
[0m23:28:06.998085 [debug] [Thread-1 (]: On model.northwind.obt_sales: Close
[0m23:28:07.094807 [debug] [Thread-1 (]: Database Error in model obt_sales (models/obt_sales.sql)
  002003 (42S02): SQL compilation error:
  Object 'F_ORDER_FULFILLMENT' does not exist or not authorized.
  compiled Code at target/run/northwind/models/obt_sales.sql
[0m23:28:07.095458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11589aea0>]}
[0m23:28:07.096101 [error] [Thread-1 (]: 37 of 37 ERROR creating sql table model analytics.northwind_northwind.obt_sales  [[31mERROR[0m in 0.38s]
[0m23:28:07.096727 [debug] [Thread-1 (]: Finished running node model.northwind.obt_sales
[0m23:28:07.416640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:28:07.422776 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 23:28:06.727878 => 23:28:07.422451
[0m23:28:07.423450 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m23:28:07.507794 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e814b4-b7c1-4523-9177-9cd538d5a18e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ddccb0>]}
[0m23:28:07.508986 [info ] [Thread-2 (]: 36 of 37 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.79s]
[0m23:28:07.509928 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m23:28:07.513235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:07.513905 [debug] [MainThread]: Connection 'model.northwind.obt_sales' was properly closed.
[0m23:28:07.514266 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m23:28:07.514613 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m23:28:07.514925 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m23:28:07.515341 [info ] [MainThread]: 
[0m23:28:07.515693 [info ] [MainThread]: Finished running 29 tests, 8 table models in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m23:28:07.520643 [debug] [MainThread]: Command end result
[0m23:28:07.532022 [info ] [MainThread]: 
[0m23:28:07.532439 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m23:28:07.532685 [info ] [MainThread]: 
[0m23:28:07.532924 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:28:07.533145 [info ] [MainThread]: 
[0m23:28:07.533359 [error] [MainThread]:   Database Error in model obt_sales (models/obt_sales.sql)
  002003 (42S02): SQL compilation error:
  Object 'F_ORDER_FULFILLMENT' does not exist or not authorized.
  compiled Code at target/run/northwind/models/obt_sales.sql
[0m23:28:07.533588 [info ] [MainThread]: 
[0m23:28:07.533817 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=2 SKIP=2 TOTAL=37
[0m23:28:07.535674 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.5273714, "process_user_time": 2.668527, "process_kernel_time": 0.248939, "process_mem_max_rss": "146440192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:07.536088 [debug] [MainThread]: Command `dbt build` failed at 23:28:07.535996 after 7.53 seconds
[0m23:28:07.536399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089be570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a3ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b39efc0>]}
[0m23:28:07.536698 [debug] [MainThread]: Flushing usage events
[0m23:29:10.624668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11addd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adfe4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adfe180>]}


============================== 23:29:10.627388 | 1d48cc05-e9c1-4eb5-99a7-8139cd0902d3 ==============================
[0m23:29:10.627388 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:29:10.627744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:29:10.817983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf83ad0>]}
[0m23:29:10.853787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf642f0>]}
[0m23:29:10.854486 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:29:10.866846 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:29:10.902088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:29:10.902519 [debug] [MainThread]: Partial parsing: updated file: northwind://models/obt_sales.sql
[0m23:29:10.982801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c67f140>]}
[0m23:29:10.990173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c50be00>]}
[0m23:29:10.990422 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m23:29:10.991922 [info ] [MainThread]: 
[0m23:29:10.992336 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:29:10.992991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m23:29:10.999111 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m23:29:10.999291 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m23:29:10.999434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:11.603715 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:29:11.607092 [debug] [ThreadPool]: On list_analytics: Close
[0m23:29:11.698641 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m23:29:11.709072 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m23:29:11.709417 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m23:29:11.709694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:12.050857 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m23:29:12.053644 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m23:29:12.142612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c47c0b0>]}
[0m23:29:12.143749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:29:12.144190 [info ] [MainThread]: 
[0m23:29:12.148057 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:29:12.148481 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:29:12.148915 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:29:12.149240 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:29:12.149615 [info ] [Thread-1 (]: 1 of 37 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m23:29:12.150122 [info ] [Thread-2 (]: 2 of 37 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m23:29:12.150571 [info ] [Thread-3 (]: 3 of 37 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m23:29:12.150996 [info ] [Thread-4 (]: 4 of 37 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m23:29:12.152305 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m23:29:12.152725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m23:29:12.153312 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m23:29:12.153893 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m23:29:12.154198 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:29:12.154507 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:29:12.154824 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:29:12.155230 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:29:12.167368 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:29:12.206059 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:29:12.208466 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:29:12.210572 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:29:12.211327 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 23:29:12.208650 => 23:29:12.211162
[0m23:29:12.211577 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 23:29:12.155545 => 23:29:12.211462
[0m23:29:12.211777 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 23:29:12.206360 => 23:29:12.211679
[0m23:29:12.211969 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 23:29:12.167625 => 23:29:12.211870
[0m23:29:12.212163 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:29:12.212343 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:29:12.212517 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:29:12.212688 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:29:12.223563 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:29:12.224935 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:29:12.226274 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:29:12.227462 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:29:12.228124 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:29:12.228560 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:29:12.228905 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:29:12.229084 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.229481 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:29:12.229649 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.229848 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.230024 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:29:12.230200 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:29:12.230365 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:29:12.230506 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:29:12.230848 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:12.485477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.486818 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.495790 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 23:29:12.226401 => 23:29:12.495499
[0m23:29:12.497919 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 23:29:12.223732 => 23:29:12.497714
[0m23:29:12.498498 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.498862 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m23:29:12.499186 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m23:29:12.500768 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 23:29:12.212803 => 23:29:12.500579
[0m23:29:12.503255 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m23:29:12.505429 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.507244 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 23:29:12.225071 => 23:29:12.507064
[0m23:29:12.507723 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m23:29:12.584785 [info ] [Thread-1 (]: 1 of 37 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.43s]
[0m23:29:12.585696 [info ] [Thread-2 (]: 2 of 37 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.43s]
[0m23:29:12.586433 [info ] [Thread-3 (]: 3 of 37 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.43s]
[0m23:29:12.587970 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:29:12.587134 [info ] [Thread-4 (]: 4 of 37 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.43s]
[0m23:29:12.588601 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:29:12.589113 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:29:12.589534 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:29:12.590127 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:29:12.590544 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:29:12.591089 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:29:12.591519 [info ] [Thread-1 (]: 5 of 37 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m23:29:12.591964 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:29:12.592398 [info ] [Thread-2 (]: 6 of 37 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m23:29:12.592763 [info ] [Thread-3 (]: 7 of 37 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m23:29:12.593387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m23:29:12.593746 [info ] [Thread-4 (]: 8 of 37 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m23:29:12.594344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m23:29:12.594875 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m23:29:12.595187 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:29:12.595713 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m23:29:12.596015 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:29:12.596304 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:29:12.597737 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:29:12.601302 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:29:12.604296 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:29:12.608903 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:29:12.611870 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:29:12.612640 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 23:29:12.596499 => 23:29:12.612477
[0m23:29:12.612966 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 23:29:12.598006 => 23:29:12.612792
[0m23:29:12.613237 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 23:29:12.609103 => 23:29:12.613108
[0m23:29:12.613564 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 23:29:12.604558 => 23:29:12.613381
[0m23:29:12.613819 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:29:12.614071 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:29:12.614309 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:29:12.614531 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:29:12.616324 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:29:12.617962 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:29:12.619618 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:29:12.621305 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:29:12.622261 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:29:12.622934 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:29:12.623266 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.623796 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:29:12.624139 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.624391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:12.624828 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:29:12.625070 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.625301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:12.625960 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:12.626397 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:12.626910 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:12.891394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.895649 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 23:29:12.614673 => 23:29:12.895333
[0m23:29:12.896807 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.897570 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m23:29:12.898288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.899527 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 23:29:12.619780 => 23:29:12.899375
[0m23:29:12.901012 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 23:29:12.618113 => 23:29:12.900887
[0m23:29:12.901386 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m23:29:12.901609 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m23:29:12.914820 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:12.915740 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 23:29:12.616488 => 23:29:12.915635
[0m23:29:12.915915 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m23:29:13.019958 [info ] [Thread-3 (]: 7 of 37 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.42s]
[0m23:29:13.021083 [info ] [Thread-4 (]: 8 of 37 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.43s]
[0m23:29:13.023454 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:29:13.022295 [info ] [Thread-1 (]: 5 of 37 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.43s]
[0m23:29:13.024047 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:29:13.024437 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:29:13.024972 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:29:13.025748 [info ] [Thread-2 (]: 6 of 37 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.43s]
[0m23:29:13.026178 [debug] [Thread-4 (]: Began running node model.northwind.dim_date
[0m23:29:13.026625 [info ] [Thread-3 (]: 9 of 37 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m23:29:13.027101 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m23:29:13.027665 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:29:13.028061 [info ] [Thread-4 (]: 10 of 37 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m23:29:13.028672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m23:29:13.029045 [info ] [Thread-1 (]: 11 of 37 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m23:29:13.029438 [debug] [Thread-2 (]: Began running node model.northwind.dim_product
[0m23:29:13.030114 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m23:29:13.030565 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:29:13.031116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m23:29:13.031464 [info ] [Thread-2 (]: 12 of 37 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m23:29:13.031782 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_date
[0m23:29:13.033232 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m23:29:13.033825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_product)
[0m23:29:13.037345 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:29:13.039898 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m23:29:13.051326 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m23:29:13.051566 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_product
[0m23:29:13.055012 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m23:29:13.055404 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (compile): 23:29:13.037612 => 23:29:13.055223
[0m23:29:13.055763 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 23:29:13.031976 => 23:29:13.055576
[0m23:29:13.056105 [debug] [Thread-4 (]: Began executing node model.northwind.dim_date
[0m23:29:13.056389 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 23:29:13.040117 => 23:29:13.056248
[0m23:29:13.056666 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:29:13.063266 [debug] [Thread-2 (]: Timing info for model.northwind.dim_product (compile): 23:29:13.052142 => 23:29:13.063108
[0m23:29:13.072782 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m23:29:13.073055 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m23:29:13.074640 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:29:13.074858 [debug] [Thread-2 (]: Began executing node model.northwind.dim_product
[0m23:29:13.076544 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m23:29:13.078257 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m23:29:13.078719 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_date"
[0m23:29:13.079234 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:29:13.079481 [debug] [Thread-4 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m23:29:13.079765 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:13.080186 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m23:29:13.080595 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_product"
[0m23:29:13.080787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:13.080977 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:13.081179 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m23:29:13.081385 [debug] [Thread-2 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m23:29:13.082594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:13.082817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:13.353384 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:13.357727 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 23:29:13.073211 => 23:29:13.357336
[0m23:29:13.358343 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m23:29:13.439136 [info ] [Thread-3 (]: 9 of 37 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.41s]
[0m23:29:13.440208 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:29:13.440777 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m23:29:13.441482 [info ] [Thread-3 (]: 13 of 37 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m23:29:13.442497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_employee)
[0m23:29:13.442898 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m23:29:13.448375 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m23:29:13.449484 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 23:29:13.443124 => 23:29:13.449251
[0m23:29:13.449882 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m23:29:13.452631 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m23:29:13.454073 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m23:29:13.454472 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m23:29:13.454827 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:13.858457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:13.879291 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 23:29:13.075057 => 23:29:13.879075
[0m23:29:13.879806 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m23:29:13.959876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c6aa4e0>]}
[0m23:29:13.960662 [info ] [Thread-1 (]: 11 of 37 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.93s]
[0m23:29:13.961417 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m23:29:13.961950 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m23:29:13.962684 [info ] [Thread-1 (]: 14 of 37 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m23:29:13.963567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_order_fulfillment)
[0m23:29:13.964025 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m23:29:13.972277 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m23:29:13.973262 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 23:29:13.964272 => 23:29:13.973060
[0m23:29:13.973594 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m23:29:13.976307 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m23:29:13.978277 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m23:29:13.978674 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m23:29:13.979032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:14.460054 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:14.466517 [debug] [Thread-2 (]: Timing info for model.northwind.dim_product (execute): 23:29:13.076795 => 23:29:14.466192
[0m23:29:14.467501 [debug] [Thread-2 (]: On model.northwind.dim_product: Close
[0m23:29:14.487264 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:14.491657 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (execute): 23:29:13.056833 => 23:29:14.491378
[0m23:29:14.492159 [debug] [Thread-4 (]: On model.northwind.dim_date: Close
[0m23:29:14.541509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d378a70>]}
[0m23:29:14.542118 [info ] [Thread-2 (]: 12 of 37 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.51s]
[0m23:29:14.542528 [debug] [Thread-2 (]: Finished running node model.northwind.dim_product
[0m23:29:14.542814 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m23:29:14.543168 [info ] [Thread-2 (]: 15 of 37 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m23:29:14.543782 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now model.northwind.fact_sales)
[0m23:29:14.544042 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m23:29:14.549679 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m23:29:14.550345 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 23:29:14.544194 => 23:29:14.550203
[0m23:29:14.550581 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m23:29:14.552419 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m23:29:14.553710 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m23:29:14.554117 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m23:29:14.554414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:14.564004 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c1c07d0>]}
[0m23:29:14.564401 [info ] [Thread-4 (]: 10 of 37 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.53s]
[0m23:29:14.564760 [debug] [Thread-4 (]: Finished running node model.northwind.dim_date
[0m23:29:14.565013 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:29:14.565299 [info ] [Thread-4 (]: 16 of 37 START test not_null_dim_customer_customerid ........................... [RUN]
[0m23:29:14.565802 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m23:29:14.566051 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:29:14.570419 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:29:14.570941 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 23:29:14.566182 => 23:29:14.570800
[0m23:29:14.571152 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:29:14.572804 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:29:14.573396 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:29:14.573605 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m23:29:14.573797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:14.832248 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c6ed-0000-17c1-0009-ec83000230e6
[0m23:29:14.833044 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m23:29:14.833709 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 23:29:14.550714 => 23:29:14.833444
[0m23:29:14.834160 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m23:29:14.862857 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:14.866386 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 23:29:13.450111 => 23:29:14.866135
[0m23:29:14.866825 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m23:29:14.914962 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:29:14.915474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d68b0e0>]}
[0m23:29:14.916058 [error] [Thread-2 (]: 15 of 37 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.37s]
[0m23:29:14.916677 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m23:29:14.917099 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:29:14.917634 [info ] [Thread-2 (]: 17 of 37 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m23:29:14.918579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m23:29:14.919039 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:29:14.923944 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:29:14.924759 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 23:29:14.919286 => 23:29:14.924571
[0m23:29:14.925090 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:29:14.927446 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:29:14.928160 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:29:14.928445 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m23:29:14.928711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:14.951449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d3791f0>]}
[0m23:29:14.952020 [info ] [Thread-3 (]: 13 of 37 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.51s]
[0m23:29:14.952545 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m23:29:14.952934 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:29:14.953466 [info ] [Thread-3 (]: 18 of 37 START test unique_dim_customer_customerid ............................. [RUN]
[0m23:29:14.954207 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m23:29:14.954567 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:29:14.959672 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:29:14.960547 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 23:29:14.954827 => 23:29:14.960354
[0m23:29:14.960829 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:29:14.962958 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:29:14.963689 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:29:14.963959 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:14.964211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:15.055323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:15.057291 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 23:29:13.973778 => 23:29:15.057138
[0m23:29:15.057576 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m23:29:15.116170 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:15.118032 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 23:29:14.571275 => 23:29:15.117821
[0m23:29:15.118370 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m23:29:15.172100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d67ef90>]}
[0m23:29:15.172762 [info ] [Thread-1 (]: 14 of 37 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.21s]
[0m23:29:15.173367 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m23:29:15.173788 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:29:15.174302 [info ] [Thread-1 (]: 19 of 37 START test unique_dim_customer_customerkey ............................ [RUN]
[0m23:29:15.175002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m23:29:15.175305 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:29:15.179786 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:29:15.180627 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 23:29:15.175488 => 23:29:15.180430
[0m23:29:15.180957 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:29:15.183711 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:29:15.184965 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:29:15.185352 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:15.185648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:15.195868 [info ] [Thread-4 (]: 16 of 37 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.63s]
[0m23:29:15.196402 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:29:15.196725 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:29:15.197062 [info ] [Thread-4 (]: 20 of 37 START test not_null_dim_product_productid ............................. [RUN]
[0m23:29:15.197637 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m23:29:15.197923 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:29:15.201451 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:29:15.201968 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 23:29:15.198096 => 23:29:15.201817
[0m23:29:15.202215 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:29:15.204121 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:29:15.204741 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:29:15.205009 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m23:29:15.205242 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:15.440536 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:15.445016 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 23:29:14.925279 => 23:29:15.444616
[0m23:29:15.445633 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m23:29:15.458604 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.461210 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 23:29:14.960995 => 23:29:15.460913
[0m23:29:15.461693 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m23:29:15.490386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.493525 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 23:29:15.181156 => 23:29:15.493192
[0m23:29:15.494042 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m23:29:15.508469 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.510895 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 23:29:15.202366 => 23:29:15.510610
[0m23:29:15.511439 [debug] [Thread-4 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m23:29:15.519265 [info ] [Thread-2 (]: 17 of 37 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.60s]
[0m23:29:15.519895 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:29:15.520323 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:29:15.520819 [info ] [Thread-2 (]: 21 of 37 START test not_null_dim_product_productkey ............................ [RUN]
[0m23:29:15.521608 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m23:29:15.522008 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:29:15.526781 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:29:15.527666 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 23:29:15.522237 => 23:29:15.527465
[0m23:29:15.527994 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:29:15.530403 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:29:15.531929 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:29:15.532314 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m23:29:15.532697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:15.552027 [info ] [Thread-3 (]: 18 of 37 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.60s]
[0m23:29:15.552517 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:29:15.552826 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:29:15.553177 [info ] [Thread-3 (]: 22 of 37 START test unique_dim_product_productid ............................... [RUN]
[0m23:29:15.553748 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m23:29:15.554033 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:29:15.557487 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:29:15.558071 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 23:29:15.554200 => 23:29:15.557906
[0m23:29:15.558354 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:29:15.562053 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:29:15.562997 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:29:15.563272 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:15.563538 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:15.571218 [info ] [Thread-1 (]: 19 of 37 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.40s]
[0m23:29:15.571622 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:29:15.571874 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:29:15.572118 [info ] [Thread-1 (]: 23 of 37 START test unique_dim_product_productkey .............................. [RUN]
[0m23:29:15.572513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m23:29:15.572724 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:29:15.575638 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:29:15.576082 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 23:29:15.572851 => 23:29:15.575946
[0m23:29:15.576295 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:29:15.577872 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:29:15.578507 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:29:15.578895 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:15.579307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:15.581868 [info ] [Thread-4 (]: 20 of 37 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.38s]
[0m23:29:15.582414 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:29:15.582668 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:29:15.582898 [info ] [Thread-4 (]: 24 of 37 START test not_null_dim_date_date ..................................... [RUN]
[0m23:29:15.583267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m23:29:15.583483 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:29:15.586035 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:29:15.586453 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 23:29:15.583609 => 23:29:15.586338
[0m23:29:15.586641 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:29:15.588144 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:29:15.588675 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:29:15.588896 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m23:29:15.589188 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:15.809460 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.812416 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 23:29:15.528195 => 23:29:15.812137
[0m23:29:15.812858 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m23:29:15.860653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.863866 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 23:29:15.576417 => 23:29:15.863527
[0m23:29:15.864862 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m23:29:15.866675 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.868959 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 23:29:15.558614 => 23:29:15.868728
[0m23:29:15.869384 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m23:29:15.876761 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:15.878695 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 23:29:15.586754 => 23:29:15.878466
[0m23:29:15.879068 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m23:29:15.900822 [info ] [Thread-2 (]: 21 of 37 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.38s]
[0m23:29:15.901456 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:29:15.901882 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:29:15.903018 [info ] [Thread-2 (]: 25 of 37 START test not_null_dim_date_datekey .................................. [RUN]
[0m23:29:15.903849 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m23:29:15.904239 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:29:15.909387 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:29:15.912048 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 23:29:15.904471 => 23:29:15.911830
[0m23:29:15.912409 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:29:15.915005 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:29:15.916515 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:29:15.916864 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m23:29:15.917145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:15.970009 [info ] [Thread-3 (]: 22 of 37 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.42s]
[0m23:29:15.970553 [info ] [Thread-4 (]: 24 of 37 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.39s]
[0m23:29:15.971009 [info ] [Thread-1 (]: 23 of 37 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.40s]
[0m23:29:15.971524 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:29:15.971830 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:29:15.972125 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:29:15.972393 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:29:15.972692 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:29:15.972987 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:29:15.973247 [info ] [Thread-3 (]: 26 of 37 START test unique_dim_date_date ....................................... [RUN]
[0m23:29:15.973503 [info ] [Thread-4 (]: 27 of 37 START test unique_dim_date_datekey .................................... [RUN]
[0m23:29:15.973778 [info ] [Thread-1 (]: 28 of 37 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m23:29:15.974197 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m23:29:15.974580 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m23:29:15.974817 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:29:15.975029 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:29:15.975230 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:29:15.975719 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:29:15.978957 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:29:15.981548 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:29:15.981836 [info ] [Thread-1 (]: 29 of 37 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m23:29:15.982282 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:29:15.982579 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:29:15.982833 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 23:29:15.975998 => 23:29:15.982717
[0m23:29:15.983141 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 23:29:15.979165 => 23:29:15.982992
[0m23:29:15.983350 [info ] [Thread-1 (]: 30 of 37 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m23:29:15.983592 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:29:15.983807 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:29:15.984193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productkey.52e0eda426, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m23:29:15.985857 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:29:15.988908 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:29:15.989137 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:29:15.991795 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:29:15.992260 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:29:15.992718 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:29:15.992923 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:15.993166 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:15.993365 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:15.993559 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 23:29:15.989439 => 23:29:15.993460
[0m23:29:15.993747 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:15.994363 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:29:15.996761 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:29:15.997767 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:29:15.998064 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m23:29:15.998598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:16.215624 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.217775 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 23:29:15.912686 => 23:29:16.217545
[0m23:29:16.218134 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m23:29:16.287991 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.292567 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 23:29:15.986007 => 23:29:16.292112
[0m23:29:16.294266 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m23:29:16.293777 [info ] [Thread-2 (]: 25 of 37 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.39s]
[0m23:29:16.296758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.297622 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:29:16.299742 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 23:29:15.995143 => 23:29:16.299510
[0m23:29:16.300278 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:29:16.300692 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m23:29:16.301591 [info ] [Thread-2 (]: 31 of 37 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m23:29:16.303214 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m23:29:16.303800 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:29:16.308425 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:29:16.309857 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.311532 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 23:29:15.984335 => 23:29:16.311337
[0m23:29:16.311914 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m23:29:16.312263 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 23:29:16.304032 => 23:29:16.312101
[0m23:29:16.313283 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:29:16.315855 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:29:16.316615 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:29:16.316923 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m23:29:16.317251 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:16.382578 [info ] [Thread-4 (]: 27 of 37 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.41s]
[0m23:29:16.383114 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:29:16.383412 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:29:16.383724 [info ] [Thread-4 (]: 32 of 37 START test unique_dim_employee_employeeid ............................. [RUN]
[0m23:29:16.384255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m23:29:16.384516 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:29:16.387906 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:29:16.388685 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 23:29:16.384665 => 23:29:16.388528
[0m23:29:16.388936 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:29:16.390958 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:29:16.391504 [info ] [Thread-3 (]: 26 of 37 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.42s]
[0m23:29:16.392406 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:29:16.392947 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:29:16.393243 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:29:16.393579 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:16.393886 [info ] [Thread-3 (]: 33 of 37 START test unique_dim_employee_employeekey ............................ [RUN]
[0m23:29:16.394435 [info ] [Thread-1 (]: 30 of 37 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.41s]
[0m23:29:16.394806 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:16.395249 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m23:29:16.395576 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:29:16.396203 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:29:16.396672 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:29:16.399396 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:29:16.399681 [info ] [Thread-1 (]: 34 of 37 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m23:29:16.400561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m23:29:16.400827 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:29:16.403550 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:29:16.403959 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 23:29:16.396869 => 23:29:16.403821
[0m23:29:16.404238 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:29:16.407220 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:29:16.407608 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 23:29:16.400986 => 23:29:16.407475
[0m23:29:16.407833 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:29:16.408286 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:29:16.409843 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:29:16.410118 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:16.410420 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:29:16.411423 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:29:16.411876 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m23:29:16.412148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:16.603839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.606107 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 23:29:16.313654 => 23:29:16.605878
[0m23:29:16.606701 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m23:29:16.687165 [info ] [Thread-2 (]: 31 of 37 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.38s]
[0m23:29:16.688474 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:29:16.689267 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:29:16.690020 [info ] [Thread-2 (]: 35 of 37 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m23:29:16.691020 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m23:29:16.691498 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:29:16.696935 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:29:16.697891 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 23:29:16.691776 => 23:29:16.697664
[0m23:29:16.698270 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:29:16.701249 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:29:16.702184 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:29:16.702526 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:29:16.702840 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:29:16.706772 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.707355 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.709198 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 23:29:16.389087 => 23:29:16.708983
[0m23:29:16.711152 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 23:29:16.404406 => 23:29:16.710980
[0m23:29:16.711655 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:16.711957 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m23:29:16.712225 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m23:29:16.713599 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 23:29:16.408456 => 23:29:16.713428
[0m23:29:16.715780 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m23:29:16.789413 [info ] [Thread-3 (]: 33 of 37 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.39s]
[0m23:29:16.789935 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:29:16.798997 [info ] [Thread-1 (]: 34 of 37 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.40s]
[0m23:29:16.799458 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:29:16.809717 [info ] [Thread-4 (]: 32 of 37 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.43s]
[0m23:29:16.810188 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:29:16.810695 [debug] [Thread-3 (]: Began running node model.northwind.obt_sales
[0m23:29:16.811079 [info ] [Thread-3 (]: 36 of 37 SKIP relation northwind_northwind.obt_sales ........................... [[33mSKIP[0m]
[0m23:29:16.811397 [debug] [Thread-3 (]: Finished running node model.northwind.obt_sales
[0m23:29:17.007481 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:29:17.010474 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 23:29:16.698491 => 23:29:17.010148
[0m23:29:17.011030 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m23:29:17.094341 [info ] [Thread-2 (]: 35 of 37 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.40s]
[0m23:29:17.095321 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:29:17.096463 [debug] [Thread-4 (]: Began running node model.northwind.obt_order_fulfillment
[0m23:29:17.096996 [info ] [Thread-4 (]: 37 of 37 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m23:29:17.097819 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m23:29:17.098154 [debug] [Thread-4 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m23:29:17.102395 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m23:29:17.103296 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 23:29:17.098348 => 23:29:17.103057
[0m23:29:17.103708 [debug] [Thread-4 (]: Began executing node model.northwind.obt_order_fulfillment
[0m23:29:17.106677 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m23:29:17.108362 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m23:29:17.108749 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m23:29:17.109113 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:29:17.772875 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:29:17.777707 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 23:29:17.103941 => 23:29:17.777431
[0m23:29:17.778452 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: Close
[0m23:29:17.867339 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d48cc05-e9c1-4eb5-99a7-8139cd0902d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e8a6600>]}
[0m23:29:17.868415 [info ] [Thread-4 (]: 37 of 37 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.77s]
[0m23:29:17.869166 [debug] [Thread-4 (]: Finished running node model.northwind.obt_order_fulfillment
[0m23:29:17.871076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:17.871343 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m23:29:17.871494 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m23:29:17.871628 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m23:29:17.871747 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m23:29:17.871964 [info ] [MainThread]: 
[0m23:29:17.872129 [info ] [MainThread]: Finished running 29 tests, 8 table models in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m23:29:17.874214 [debug] [MainThread]: Command end result
[0m23:29:17.882748 [info ] [MainThread]: 
[0m23:29:17.883030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:29:17.883193 [info ] [MainThread]: 
[0m23:29:17.883524 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:29:17.883773 [info ] [MainThread]: 
[0m23:29:17.883957 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=3 TOTAL=37
[0m23:29:17.887190 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.292357, "process_user_time": 2.700539, "process_kernel_time": 0.277845, "process_mem_max_rss": "142671872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:29:17.887538 [debug] [MainThread]: Command `dbt build` failed at 23:29:17.887473 after 7.29 seconds
[0m23:29:17.887748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adaf680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2a4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bf36ae0>]}
[0m23:29:17.887934 [debug] [MainThread]: Flushing usage events
[0m23:32:07.720721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c30fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4a570>]}


============================== 23:32:07.723315 | a5af9820-52fc-4943-b0ed-890244015f3d ==============================
[0m23:32:07.723315 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:32:07.723616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:32:07.912127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f53f80>]}
[0m23:32:07.945129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d7ccb0>]}
[0m23:32:07.945618 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:32:07.956569 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:32:07.990826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:32:07.991240 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m23:32:08.111865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11125fc50>]}
[0m23:32:08.119059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123c4d0>]}
[0m23:32:08.119277 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m23:32:08.120738 [info ] [MainThread]: 
[0m23:32:08.121129 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:32:08.121743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m23:32:08.127729 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m23:32:08.127910 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m23:32:08.128048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:08.592497 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:32:08.595873 [debug] [ThreadPool]: On list_analytics: Close
[0m23:32:08.687873 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m23:32:08.699121 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m23:32:08.699657 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m23:32:08.699943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:32:08.974654 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m23:32:08.978181 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m23:32:09.072530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111293590>]}
[0m23:32:09.074190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:32:09.074975 [info ] [MainThread]: 
[0m23:32:09.078775 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:32:09.079242 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:32:09.079672 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:32:09.080019 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:32:09.080396 [info ] [Thread-1 (]: 1 of 37 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m23:32:09.080842 [info ] [Thread-2 (]: 2 of 37 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m23:32:09.081298 [info ] [Thread-3 (]: 3 of 37 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m23:32:09.081707 [info ] [Thread-4 (]: 4 of 37 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m23:32:09.082856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m23:32:09.083598 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m23:32:09.084305 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m23:32:09.084983 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m23:32:09.085347 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:32:09.085650 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:32:09.085937 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:32:09.086220 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:32:09.102269 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:32:09.106968 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:32:09.109731 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:32:09.112472 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:32:09.113329 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 23:32:09.102561 => 23:32:09.113133
[0m23:32:09.113665 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 23:32:09.107187 => 23:32:09.113482
[0m23:32:09.113948 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 23:32:09.109938 => 23:32:09.113807
[0m23:32:09.114238 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 23:32:09.086418 => 23:32:09.114098
[0m23:32:09.114472 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:32:09.114708 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:32:09.114938 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:32:09.115162 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:32:09.129353 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:32:09.130975 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:32:09.132451 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:32:09.133934 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:32:09.134630 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:32:09.135071 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:32:09.135322 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.135636 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.136085 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:32:09.136528 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:32:09.136712 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:32:09.136901 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:32:09.137105 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.137332 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:32:09.138535 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:32:09.138769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:09.412445 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.422070 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 23:32:09.115308 => 23:32:09.421808
[0m23:32:09.423174 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.423532 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m23:32:09.424049 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.425627 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 23:32:09.129555 => 23:32:09.425449
[0m23:32:09.427974 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 23:32:09.131137 => 23:32:09.427772
[0m23:32:09.428574 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m23:32:09.428906 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m23:32:09.508406 [info ] [Thread-3 (]: 3 of 37 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.42s]
[0m23:32:09.509245 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:32:09.509840 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:32:09.510461 [info ] [Thread-3 (]: 5 of 37 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m23:32:09.511798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m23:32:09.512206 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:32:09.518407 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:32:09.519597 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 23:32:09.513654 => 23:32:09.519368
[0m23:32:09.519944 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:32:09.522513 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:32:09.523913 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:32:09.524434 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.524828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:09.530686 [info ] [Thread-2 (]: 2 of 37 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.45s]
[0m23:32:09.531280 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:32:09.531663 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:32:09.532047 [info ] [Thread-2 (]: 6 of 37 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m23:32:09.532676 [info ] [Thread-4 (]: 4 of 37 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.45s]
[0m23:32:09.533776 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m23:32:09.534371 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:32:09.534695 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:32:09.535032 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:32:09.539005 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:32:09.539421 [info ] [Thread-4 (]: 7 of 37 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m23:32:09.540020 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m23:32:09.540289 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:32:09.543295 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:32:09.543745 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 23:32:09.535316 => 23:32:09.543585
[0m23:32:09.544042 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:32:09.547572 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:32:09.547877 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 23:32:09.540465 => 23:32:09.547734
[0m23:32:09.548183 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:32:09.549990 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:32:09.550591 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:32:09.550905 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.551851 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:32:09.552216 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:09.552586 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.553323 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:09.578238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.579845 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 23:32:09.132595 => 23:32:09.579667
[0m23:32:09.580178 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m23:32:09.861552 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.865323 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 23:32:09.520137 => 23:32:09.864907
[0m23:32:09.866068 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m23:32:09.922061 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.926200 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 23:32:09.548344 => 23:32:09.925667
[0m23:32:09.926935 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m23:32:09.928270 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:09.932078 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 23:32:09.544247 => 23:32:09.931777
[0m23:32:09.932784 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m23:32:09.942811 [info ] [Thread-3 (]: 5 of 37 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.43s]
[0m23:32:09.944132 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:32:09.944605 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:32:09.945173 [info ] [Thread-3 (]: 8 of 37 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m23:32:09.946033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m23:32:09.946605 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:32:09.951358 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:32:09.952324 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 23:32:09.946897 => 23:32:09.952126
[0m23:32:09.952658 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:32:09.954984 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:32:09.955821 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:32:09.956131 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.956432 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:09.984123 [info ] [Thread-1 (]: 1 of 37 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.90s]
[0m23:32:09.984682 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:32:09.985027 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:32:09.985418 [info ] [Thread-1 (]: 9 of 37 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m23:32:09.986026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m23:32:09.986335 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:32:09.990125 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:32:09.990881 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 23:32:09.986509 => 23:32:09.990699
[0m23:32:09.991170 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:32:09.993151 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:32:09.993884 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:32:09.994153 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:09.994401 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:10.005188 [info ] [Thread-4 (]: 7 of 37 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.47s]
[0m23:32:10.005732 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:32:10.006034 [debug] [Thread-4 (]: Began running node model.northwind.dim_date
[0m23:32:10.006460 [info ] [Thread-4 (]: 10 of 37 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m23:32:10.006994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m23:32:10.007261 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_date
[0m23:32:10.009362 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m23:32:10.009919 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (compile): 23:32:10.007405 => 23:32:10.009776
[0m23:32:10.010142 [debug] [Thread-4 (]: Began executing node model.northwind.dim_date
[0m23:32:10.026251 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m23:32:10.027208 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_date"
[0m23:32:10.027471 [debug] [Thread-4 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m23:32:10.028208 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:10.028024 [info ] [Thread-2 (]: 6 of 37 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.49s]
[0m23:32:10.028987 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:32:10.029438 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m23:32:10.029818 [info ] [Thread-2 (]: 11 of 37 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m23:32:10.030253 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_customer)
[0m23:32:10.030480 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m23:32:10.033955 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m23:32:10.034676 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 23:32:10.030646 => 23:32:10.034548
[0m23:32:10.034880 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m23:32:10.036497 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m23:32:10.037128 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m23:32:10.037324 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m23:32:10.037543 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:10.212408 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:10.214472 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 23:32:09.952848 => 23:32:10.214242
[0m23:32:10.214842 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m23:32:10.255102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:10.257183 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 23:32:09.991337 => 23:32:10.256935
[0m23:32:10.257584 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m23:32:10.296186 [info ] [Thread-3 (]: 8 of 37 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.35s]
[0m23:32:10.296802 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:32:10.297213 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m23:32:10.297660 [info ] [Thread-3 (]: 12 of 37 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m23:32:10.298282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m23:32:10.298749 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m23:32:10.303505 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m23:32:10.304339 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 23:32:10.299023 => 23:32:10.304162
[0m23:32:10.304635 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m23:32:10.306907 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m23:32:10.308210 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m23:32:10.308598 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m23:32:10.308943 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:10.329391 [info ] [Thread-1 (]: 9 of 37 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.34s]
[0m23:32:10.329991 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:32:10.330383 [debug] [Thread-1 (]: Began running node model.northwind.dim_product
[0m23:32:10.330808 [info ] [Thread-1 (]: 13 of 37 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m23:32:10.331415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m23:32:10.331726 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_product
[0m23:32:10.335752 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m23:32:10.336392 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (compile): 23:32:10.331912 => 23:32:10.336227
[0m23:32:10.336686 [debug] [Thread-1 (]: Began executing node model.northwind.dim_product
[0m23:32:10.338835 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m23:32:10.340064 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_product"
[0m23:32:10.340396 [debug] [Thread-1 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m23:32:10.340672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:10.815387 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:10.816718 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:10.837593 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 23:32:10.034992 => 23:32:10.837375
[0m23:32:10.839757 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (execute): 23:32:10.010271 => 23:32:10.839589
[0m23:32:10.840098 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m23:32:10.840367 [debug] [Thread-4 (]: On model.northwind.dim_date: Close
[0m23:32:10.915249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f7410>]}
[0m23:32:10.915926 [info ] [Thread-4 (]: 10 of 37 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.91s]
[0m23:32:10.916552 [debug] [Thread-4 (]: Finished running node model.northwind.dim_date
[0m23:32:10.916981 [debug] [Thread-4 (]: Began running node model.northwind.fact_sales
[0m23:32:10.917505 [info ] [Thread-4 (]: 14 of 37 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m23:32:10.918783 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m23:32:10.919198 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_sales
[0m23:32:10.926372 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m23:32:10.927311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111222ff0>]}
[0m23:32:10.928068 [info ] [Thread-2 (]: 11 of 37 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.90s]
[0m23:32:10.928717 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m23:32:10.929136 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (compile): 23:32:10.919421 => 23:32:10.928934
[0m23:32:10.929551 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m23:32:10.929969 [debug] [Thread-4 (]: Began executing node model.northwind.fact_sales
[0m23:32:10.930361 [info ] [Thread-2 (]: 15 of 37 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m23:32:10.933112 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m23:32:10.933673 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_order_fulfillment)
[0m23:32:10.934080 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m23:32:10.939242 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m23:32:10.940280 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_sales"
[0m23:32:10.940665 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 23:32:10.934281 => 23:32:10.940502
[0m23:32:10.940926 [debug] [Thread-4 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        saleskey,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        orderid,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m23:32:10.941238 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m23:32:10.941452 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:10.943560 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m23:32:10.945805 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m23:32:10.946177 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m23:32:10.946471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:11.229856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:11.235259 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (execute): 23:32:10.336865 => 23:32:11.234937
[0m23:32:11.235958 [debug] [Thread-1 (]: On model.northwind.dim_product: Close
[0m23:32:11.256790 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c6f0-0000-17c1-0009-ec830002312e
[0m23:32:11.257313 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'SALESKEY'
[0m23:32:11.257864 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (execute): 23:32:10.930659 => 23:32:11.257640
[0m23:32:11.258241 [debug] [Thread-4 (]: On model.northwind.fact_sales: Close
[0m23:32:11.336975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e8f20>]}
[0m23:32:11.337975 [info ] [Thread-1 (]: 13 of 37 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.01s]
[0m23:32:11.338654 [debug] [Thread-1 (]: Finished running node model.northwind.dim_product
[0m23:32:11.339101 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:32:11.339796 [info ] [Thread-1 (]: 16 of 37 START test not_null_dim_date_date ..................................... [RUN]
[0m23:32:11.341009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m23:32:11.341423 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:32:11.349451 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:32:11.350985 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 23:32:11.341658 => 23:32:11.350654
[0m23:32:11.351404 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:32:11.354161 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:32:11.356405 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:32:11.356896 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m23:32:11.357611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:11.359064 [debug] [Thread-4 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:32:11.360138 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155f170>]}
[0m23:32:11.360640 [error] [Thread-4 (]: 14 of 37 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.44s]
[0m23:32:11.361097 [debug] [Thread-4 (]: Finished running node model.northwind.fact_sales
[0m23:32:11.361423 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:32:11.362096 [info ] [Thread-4 (]: 17 of 37 START test not_null_dim_date_datekey .................................. [RUN]
[0m23:32:11.362804 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m23:32:11.363070 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:32:11.366534 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:32:11.367079 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 23:32:11.363222 => 23:32:11.366929
[0m23:32:11.367339 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:32:11.369344 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:32:11.369981 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:32:11.370217 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m23:32:11.370441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:11.378270 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:11.380141 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 23:32:10.304807 => 23:32:11.379990
[0m23:32:11.380460 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m23:32:11.470085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113425880>]}
[0m23:32:11.470664 [info ] [Thread-3 (]: 12 of 37 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.17s]
[0m23:32:11.471144 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m23:32:11.471470 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:32:11.471836 [info ] [Thread-3 (]: 18 of 37 START test unique_dim_date_date ....................................... [RUN]
[0m23:32:11.472529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m23:32:11.472813 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:32:11.476086 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:32:11.476638 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 23:32:11.472968 => 23:32:11.476494
[0m23:32:11.476878 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:32:11.478802 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:32:11.479542 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:32:11.479806 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:11.480050 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:11.691038 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:11.692908 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 23:32:11.367488 => 23:32:11.692709
[0m23:32:11.693232 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m23:32:11.783201 [info ] [Thread-4 (]: 17 of 37 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.42s]
[0m23:32:11.784194 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:32:11.784741 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:32:11.785365 [info ] [Thread-4 (]: 19 of 37 START test unique_dim_date_datekey .................................... [RUN]
[0m23:32:11.786389 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m23:32:11.786889 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:32:11.794823 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:32:11.795849 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 23:32:11.787185 => 23:32:11.795651
[0m23:32:11.796187 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:32:11.798655 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:32:11.799580 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:32:11.799921 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:11.800240 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:11.979473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:11.984274 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 23:32:11.351617 => 23:32:11.983889
[0m23:32:11.984880 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m23:32:12.075924 [info ] [Thread-1 (]: 16 of 37 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.73s]
[0m23:32:12.077522 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:32:12.078758 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:32:12.079927 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:12.080470 [info ] [Thread-1 (]: 20 of 37 START test not_null_dim_customer_customerid ........................... [RUN]
[0m23:32:12.083735 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 23:32:10.941576 => 23:32:12.083497
[0m23:32:12.084531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m23:32:12.084952 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m23:32:12.085335 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:32:12.091001 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:32:12.092153 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 23:32:12.086552 => 23:32:12.091937
[0m23:32:12.092489 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:32:12.095042 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:32:12.096126 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:32:12.096448 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m23:32:12.096831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:12.167283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111560080>]}
[0m23:32:12.167802 [info ] [Thread-2 (]: 15 of 37 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.23s]
[0m23:32:12.168259 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m23:32:12.168571 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:32:12.168924 [info ] [Thread-2 (]: 21 of 37 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m23:32:12.169566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m23:32:12.169858 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:32:12.173469 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:32:12.174074 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 23:32:12.170029 => 23:32:12.173906
[0m23:32:12.174355 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:32:12.176228 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:32:12.176858 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:32:12.177115 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m23:32:12.177354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:12.225464 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:12.227100 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 23:32:11.477021 => 23:32:12.226924
[0m23:32:12.227384 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m23:32:12.302509 [info ] [Thread-3 (]: 18 of 37 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.83s]
[0m23:32:12.303072 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:32:12.303440 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:32:12.303858 [info ] [Thread-3 (]: 22 of 37 START test unique_dim_customer_customerid ............................. [RUN]
[0m23:32:12.304549 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m23:32:12.304897 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:32:12.308513 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:32:12.309142 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 23:32:12.305089 => 23:32:12.308978
[0m23:32:12.309420 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:32:12.311543 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:32:12.312324 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:32:12.312622 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:12.312907 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:12.398861 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:12.400633 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 23:32:11.796374 => 23:32:12.400439
[0m23:32:12.400951 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m23:32:12.404473 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:12.405976 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 23:32:12.092680 => 23:32:12.405795
[0m23:32:12.406276 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m23:32:12.476890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:12.478895 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 23:32:12.174519 => 23:32:12.478657
[0m23:32:12.479694 [info ] [Thread-4 (]: 19 of 37 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.69s]
[0m23:32:12.480159 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m23:32:12.480634 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:32:12.481893 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:32:12.482524 [info ] [Thread-4 (]: 23 of 37 START test unique_dim_customer_customerkey ............................ [RUN]
[0m23:32:12.483159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m23:32:12.483471 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:32:12.487379 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:32:12.488570 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 23:32:12.483658 => 23:32:12.488357
[0m23:32:12.488998 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:32:12.492930 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:32:12.493678 [info ] [Thread-1 (]: 20 of 37 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.41s]
[0m23:32:12.494179 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:32:12.494506 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:32:12.494831 [info ] [Thread-1 (]: 24 of 37 START test not_null_dim_product_productid ............................. [RUN]
[0m23:32:12.495466 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:32:12.495979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m23:32:12.496283 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:12.496552 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:32:12.496801 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:12.499773 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:32:12.500921 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 23:32:12.496961 => 23:32:12.500765
[0m23:32:12.501161 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:32:12.502994 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:32:12.503883 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:32:12.504118 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m23:32:12.504330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:12.552751 [info ] [Thread-2 (]: 21 of 37 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.38s]
[0m23:32:12.553252 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:32:12.553520 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:32:12.553808 [info ] [Thread-2 (]: 25 of 37 START test not_null_dim_product_productkey ............................ [RUN]
[0m23:32:12.554280 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m23:32:12.554514 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:32:12.557428 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:32:12.557936 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 23:32:12.554647 => 23:32:12.557805
[0m23:32:12.558145 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:32:12.559824 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:32:12.560415 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:32:12.560641 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m23:32:12.560843 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:12.632839 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:12.634450 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 23:32:12.309595 => 23:32:12.634281
[0m23:32:12.634949 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m23:32:12.735828 [info ] [Thread-3 (]: 22 of 37 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.43s]
[0m23:32:12.736429 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:32:12.736803 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:32:12.737194 [info ] [Thread-3 (]: 26 of 37 START test unique_dim_product_productid ............................... [RUN]
[0m23:32:12.737866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m23:32:12.738204 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:32:12.742203 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:32:12.742837 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 23:32:12.738407 => 23:32:12.742670
[0m23:32:12.743115 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:32:12.745240 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:32:12.746035 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:32:12.746331 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:12.746612 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:12.829501 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:12.831275 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 23:32:12.489252 => 23:32:12.831088
[0m23:32:12.831596 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m23:32:12.842410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:12.843993 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 23:32:12.501302 => 23:32:12.843788
[0m23:32:12.844329 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m23:32:12.952144 [info ] [Thread-1 (]: 24 of 37 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.46s]
[0m23:32:12.953964 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:32:12.954995 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:32:12.961125 [info ] [Thread-4 (]: 23 of 37 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.48s]
[0m23:32:12.962941 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:32:12.963580 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:32:12.961570 [info ] [Thread-1 (]: 27 of 37 START test unique_dim_product_productkey .............................. [RUN]
[0m23:32:12.964427 [info ] [Thread-4 (]: 28 of 37 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m23:32:12.965203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m23:32:12.965599 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:32:12.965905 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:32:12.966235 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:32:12.970938 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:32:12.971381 [info ] [Thread-4 (]: 29 of 37 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m23:32:12.971876 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:32:12.972260 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:32:12.972651 [info ] [Thread-4 (]: 30 of 37 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m23:32:12.973042 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 23:32:12.966534 => 23:32:12.972884
[0m23:32:12.973526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m23:32:12.973800 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:32:12.974052 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:32:12.976202 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:32:12.979558 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:32:12.980522 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:32:12.980880 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 23:32:12.976397 => 23:32:12.980698
[0m23:32:12.981134 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:12.981407 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:32:12.981633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:12.984972 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:32:12.986523 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:32:12.986889 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m23:32:12.987157 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:13.040374 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.041872 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 23:32:12.558270 => 23:32:13.041718
[0m23:32:13.042109 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m23:32:13.136010 [info ] [Thread-2 (]: 25 of 37 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.58s]
[0m23:32:13.136612 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:32:13.136970 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:32:13.137373 [info ] [Thread-2 (]: 31 of 37 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m23:32:13.137950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m23:32:13.138239 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:32:13.141938 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:32:13.142575 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 23:32:13.138407 => 23:32:13.142414
[0m23:32:13.142845 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:32:13.144943 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:32:13.145644 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:32:13.145916 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m23:32:13.146176 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:13.203883 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.207595 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 23:32:12.743279 => 23:32:13.207358
[0m23:32:13.208081 [debug] [Thread-3 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m23:32:13.279449 [info ] [Thread-3 (]: 26 of 37 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.54s]
[0m23:32:13.280026 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:32:13.280391 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:32:13.280774 [info ] [Thread-3 (]: 32 of 37 START test unique_dim_employee_employeeid ............................. [RUN]
[0m23:32:13.281413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m23:32:13.281738 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:32:13.285561 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:32:13.286165 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 23:32:13.281928 => 23:32:13.285997
[0m23:32:13.286441 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:32:13.288536 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:32:13.289337 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:32:13.289633 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:13.289897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:32:13.309559 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.311142 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 23:32:12.974208 => 23:32:13.310973
[0m23:32:13.311415 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m23:32:13.316664 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.318009 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 23:32:12.983259 => 23:32:13.317852
[0m23:32:13.318264 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m23:32:13.383999 [info ] [Thread-1 (]: 27 of 37 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.42s]
[0m23:32:13.384489 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:32:13.384808 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:32:13.385143 [info ] [Thread-1 (]: 33 of 37 START test unique_dim_employee_employeekey ............................ [RUN]
[0m23:32:13.385725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productkey.52e0eda426, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m23:32:13.386014 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:32:13.389481 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:32:13.391401 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 23:32:13.386185 => 23:32:13.391234
[0m23:32:13.391700 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:32:13.393748 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:32:13.394376 [info ] [Thread-4 (]: 30 of 37 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.42s]
[0m23:32:13.395113 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:32:13.395616 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:32:13.396206 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:32:13.396469 [info ] [Thread-4 (]: 34 of 37 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m23:32:13.396815 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:13.397351 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m23:32:13.397609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:13.397845 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:32:13.401363 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:32:13.402196 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 23:32:13.398351 => 23:32:13.402011
[0m23:32:13.402464 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:32:13.404408 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:32:13.405334 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:32:13.405611 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m23:32:13.405840 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:32:13.496099 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.497844 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 23:32:13.143005 => 23:32:13.497664
[0m23:32:13.498202 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m23:32:13.577755 [info ] [Thread-2 (]: 31 of 37 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.44s]
[0m23:32:13.578327 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:32:13.578717 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:32:13.579127 [info ] [Thread-2 (]: 35 of 37 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m23:32:13.579797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m23:32:13.580161 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:32:13.584148 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:32:13.584839 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 23:32:13.580380 => 23:32:13.584664
[0m23:32:13.585117 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:32:13.587240 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:32:13.588105 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:32:13.588416 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:32:13.588700 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:32:13.632796 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.634563 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 23:32:13.286618 => 23:32:13.634365
[0m23:32:13.634875 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m23:32:13.725585 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.727663 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 23:32:13.402615 => 23:32:13.727449
[0m23:32:13.728005 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m23:32:13.734561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.736208 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 23:32:13.391904 => 23:32:13.736007
[0m23:32:13.736842 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m23:32:13.739721 [info ] [Thread-3 (]: 32 of 37 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.46s]
[0m23:32:13.740342 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:32:13.800307 [info ] [Thread-4 (]: 34 of 37 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.40s]
[0m23:32:13.800982 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:32:13.823697 [info ] [Thread-1 (]: 33 of 37 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.44s]
[0m23:32:13.824312 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:32:13.824826 [debug] [Thread-3 (]: Began running node model.northwind.obt_sales
[0m23:32:13.825185 [info ] [Thread-3 (]: 36 of 37 SKIP relation northwind_northwind.obt_sales ........................... [[33mSKIP[0m]
[0m23:32:13.825537 [debug] [Thread-3 (]: Finished running node model.northwind.obt_sales
[0m23:32:13.950978 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:32:13.955847 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 23:32:13.585281 => 23:32:13.955451
[0m23:32:13.956525 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m23:32:14.059733 [info ] [Thread-2 (]: 35 of 37 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.48s]
[0m23:32:14.060776 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:32:14.061862 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m23:32:14.062599 [info ] [Thread-1 (]: 37 of 37 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m23:32:14.063371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now model.northwind.obt_order_fulfillment)
[0m23:32:14.063757 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m23:32:14.068315 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m23:32:14.069311 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 23:32:14.063982 => 23:32:14.069115
[0m23:32:14.069636 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m23:32:14.072367 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m23:32:14.074146 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m23:32:14.074536 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m23:32:14.074894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:32:14.909030 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:32:14.914251 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 23:32:14.069826 => 23:32:14.913959
[0m23:32:14.915168 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m23:32:15.033373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5af9820-52fc-4943-b0ed-890244015f3d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140fee10>]}
[0m23:32:15.034684 [info ] [Thread-1 (]: 37 of 37 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.97s]
[0m23:32:15.036036 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m23:32:15.038692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:15.039182 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m23:32:15.039513 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m23:32:15.039784 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeeid.a3468da3ee' was properly closed.
[0m23:32:15.040046 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m23:32:15.040395 [info ] [MainThread]: 
[0m23:32:15.040718 [info ] [MainThread]: Finished running 29 tests, 8 table models in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m23:32:15.045218 [debug] [MainThread]: Command end result
[0m23:32:15.055898 [info ] [MainThread]: 
[0m23:32:15.056280 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:32:15.056524 [info ] [MainThread]: 
[0m23:32:15.056754 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:32:15.057003 [info ] [MainThread]: 
[0m23:32:15.057313 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=3 TOTAL=37
[0m23:32:15.059281 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.365986, "process_user_time": 2.762692, "process_kernel_time": 0.287052, "process_mem_max_rss": "146767872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:32:15.059675 [debug] [MainThread]: Command `dbt build` failed at 23:32:15.059583 after 7.37 seconds
[0m23:32:15.059960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114020770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11349d6a0>]}
[0m23:32:15.060236 [debug] [MainThread]: Flushing usage events
[0m23:34:43.036804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ddda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dfe630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dfe300>]}


============================== 23:34:43.039518 | 17f43e77-490d-4c58-bb4b-fefa998f5129 ==============================
[0m23:34:43.039518 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:34:43.040018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:34:43.230424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17f43e77-490d-4c58-bb4b-fefa998f5129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113204a0>]}
[0m23:34:43.264344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17f43e77-490d-4c58-bb4b-fefa998f5129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137bcb0>]}
[0m23:34:43.265571 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:34:43.277448 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:34:43.310748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:34:43.311168 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m23:34:43.428980 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.northwind.fact_sales' (models/fact_sales.sql) depends on a source named 'northwind.Order Details' which was not found
[0m23:34:43.430845 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.42871174, "process_user_time": 1.081807, "process_kernel_time": 0.127246, "process_mem_max_rss": "125468672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:34:43.431157 [debug] [MainThread]: Command `dbt build` failed at 23:34:43.431093 after 0.43 seconds
[0m23:34:43.431360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aa84d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e37c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074af2c0>]}
[0m23:34:43.431545 [debug] [MainThread]: Flushing usage events
[0m23:35:09.353187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529e060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ae420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ae180>]}


============================== 23:35:09.355711 | 05ce11e5-0249-4be7-952c-f913c394dc03 ==============================
[0m23:35:09.355711 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:35:09.356015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:35:09.533833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105773470>]}
[0m23:35:09.567569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105718ef0>]}
[0m23:35:09.568700 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:35:09.579756 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:35:09.613669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:09.614218 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m23:35:09.732870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e2660>]}
[0m23:35:09.740289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618a300>]}
[0m23:35:09.740508 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m23:35:09.741960 [info ] [MainThread]: 
[0m23:35:09.742366 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:35:09.743028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m23:35:09.749062 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m23:35:09.749255 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m23:35:09.749399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:10.402808 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:35:10.406166 [debug] [ThreadPool]: On list_analytics: Close
[0m23:35:10.504696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m23:35:10.513880 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m23:35:10.514256 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m23:35:10.514537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:10.869041 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m23:35:10.873368 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m23:35:10.978796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ef230>]}
[0m23:35:10.980457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:10.981266 [info ] [MainThread]: 
[0m23:35:10.985216 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:10.985685 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:10.986116 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:10.986523 [info ] [Thread-1 (]: 1 of 37 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m23:35:10.986990 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:10.987391 [info ] [Thread-2 (]: 2 of 37 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m23:35:10.987797 [info ] [Thread-3 (]: 3 of 37 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m23:35:10.988559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m23:35:10.989317 [info ] [Thread-4 (]: 4 of 37 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m23:35:10.990090 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m23:35:10.990736 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m23:35:10.991080 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:10.991675 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m23:35:10.991981 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:10.992502 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:11.008546 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:35:11.008918 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:11.013770 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:35:11.016596 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:35:11.019508 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:35:11.020077 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 23:35:10.993022 => 23:35:11.019893
[0m23:35:11.020498 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 23:35:11.009111 => 23:35:11.020369
[0m23:35:11.020837 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 23:35:11.014026 => 23:35:11.020708
[0m23:35:11.021073 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:11.021345 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 23:35:11.016893 => 23:35:11.021220
[0m23:35:11.021593 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:11.021849 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:11.036031 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:35:11.036322 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:11.037927 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:35:11.039400 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:35:11.041051 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:35:11.041629 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:35:11.042117 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:35:11.042671 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:35:11.043076 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:35:11.043495 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:35:11.043691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:11.043911 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.044130 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.044351 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.045162 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:35:11.045392 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:35:11.045580 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:35:11.291774 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.299821 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 23:35:11.038098 => 23:35:11.299570
[0m23:35:11.300217 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m23:35:11.319170 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.320983 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 23:35:11.039628 => 23:35:11.320763
[0m23:35:11.321340 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m23:35:11.329316 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.331030 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 23:35:11.036477 => 23:35:11.330824
[0m23:35:11.331640 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m23:35:11.332182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.334618 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 23:35:11.021995 => 23:35:11.334420
[0m23:35:11.335754 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m23:35:11.381393 [info ] [Thread-3 (]: 3 of 37 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.39s]
[0m23:35:11.382060 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:11.382504 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:11.383006 [info ] [Thread-3 (]: 5 of 37 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m23:35:11.383794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m23:35:11.384141 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:11.388542 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:35:11.389385 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 23:35:11.384335 => 23:35:11.389178
[0m23:35:11.389734 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:11.391954 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:35:11.392802 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:35:11.393105 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.393692 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:11.396182 [info ] [Thread-4 (]: 4 of 37 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.40s]
[0m23:35:11.396698 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:11.397448 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:11.397866 [info ] [Thread-4 (]: 6 of 37 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m23:35:11.398395 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m23:35:11.398754 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:11.402190 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:35:11.402716 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 23:35:11.398991 => 23:35:11.402573
[0m23:35:11.402953 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:11.404954 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:35:11.405613 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:35:11.405875 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.406119 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:11.416408 [info ] [Thread-1 (]: 1 of 37 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.43s]
[0m23:35:11.416875 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:11.417163 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:11.417474 [info ] [Thread-1 (]: 7 of 37 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m23:35:11.417997 [info ] [Thread-2 (]: 2 of 37 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.43s]
[0m23:35:11.418544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m23:35:11.418919 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:11.419170 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:11.419431 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:11.422517 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:35:11.422879 [info ] [Thread-2 (]: 8 of 37 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m23:35:11.423509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m23:35:11.423841 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:11.424106 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 23:35:11.419604 => 23:35:11.423979
[0m23:35:11.427130 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:35:11.427479 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:11.429337 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:35:11.429774 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 23:35:11.424441 => 23:35:11.429622
[0m23:35:11.430013 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:11.430452 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:35:11.431970 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:35:11.432226 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.432515 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:11.433241 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:35:11.433805 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.434227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:11.642781 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.645173 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 23:35:11.403118 => 23:35:11.644911
[0m23:35:11.645610 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m23:35:11.651100 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.653055 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 23:35:11.389905 => 23:35:11.652814
[0m23:35:11.653446 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m23:35:11.672165 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.674178 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 23:35:11.430600 => 23:35:11.673939
[0m23:35:11.674831 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m23:35:11.676442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:11.678699 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 23:35:11.427721 => 23:35:11.678465
[0m23:35:11.679839 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m23:35:11.719072 [info ] [Thread-4 (]: 6 of 37 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.32s]
[0m23:35:11.719833 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:11.720277 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:11.720745 [info ] [Thread-4 (]: 9 of 37 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m23:35:11.721543 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m23:35:11.722307 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:11.727494 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:35:11.728289 [info ] [Thread-3 (]: 5 of 37 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.34s]
[0m23:35:11.728969 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:11.729378 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m23:35:11.729809 [info ] [Thread-3 (]: 10 of 37 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m23:35:11.730242 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 23:35:11.722575 => 23:35:11.730017
[0m23:35:11.731059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m23:35:11.731505 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:11.731850 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m23:35:11.734424 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:35:11.737899 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m23:35:11.738945 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:35:11.739548 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:11.739939 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 23:35:11.734670 => 23:35:11.739773
[0m23:35:11.740204 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:11.740501 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m23:35:11.759156 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m23:35:11.760735 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m23:35:11.760991 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m23:35:11.761211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:11.761765 [info ] [Thread-1 (]: 7 of 37 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.34s]
[0m23:35:11.762372 [info ] [Thread-2 (]: 8 of 37 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.34s]
[0m23:35:11.763313 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:11.763628 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:11.763900 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m23:35:11.764398 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m23:35:11.764828 [info ] [Thread-1 (]: 11 of 37 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m23:35:11.765083 [info ] [Thread-2 (]: 12 of 37 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m23:35:11.765484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m23:35:11.765867 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m23:35:11.766095 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m23:35:11.766301 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m23:35:11.769169 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m23:35:11.771643 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m23:35:11.772078 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 23:35:11.766423 => 23:35:11.771959
[0m23:35:11.772316 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 23:35:11.769329 => 23:35:11.772200
[0m23:35:11.772498 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m23:35:11.772696 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m23:35:11.774202 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m23:35:11.775616 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m23:35:11.776190 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m23:35:11.776512 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m23:35:11.777164 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m23:35:11.777334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:11.777545 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m23:35:11.778023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:12.006206 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:12.009191 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 23:35:11.732060 => 23:35:12.008868
[0m23:35:12.009663 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m23:35:12.087591 [info ] [Thread-4 (]: 9 of 37 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.37s]
[0m23:35:12.088520 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:12.088981 [debug] [Thread-4 (]: Began running node model.northwind.dim_product
[0m23:35:12.089581 [info ] [Thread-4 (]: 13 of 37 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m23:35:12.090397 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m23:35:12.090793 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_product
[0m23:35:12.095611 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m23:35:12.096512 [debug] [Thread-4 (]: Timing info for model.northwind.dim_product (compile): 23:35:12.091021 => 23:35:12.096324
[0m23:35:12.096843 [debug] [Thread-4 (]: Began executing node model.northwind.dim_product
[0m23:35:12.099517 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m23:35:12.100505 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_product"
[0m23:35:12.100852 [debug] [Thread-4 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m23:35:12.101178 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:12.827508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:12.848381 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 23:35:11.772809 => 23:35:12.848172
[0m23:35:12.848879 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m23:35:12.960001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031e13d0>]}
[0m23:35:12.961332 [info ] [Thread-1 (]: 11 of 37 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.19s]
[0m23:35:12.962399 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m23:35:12.963090 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m23:35:12.963945 [info ] [Thread-1 (]: 14 of 37 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m23:35:12.964961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_sales)
[0m23:35:12.965410 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m23:35:12.973258 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m23:35:12.974197 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 23:35:12.965674 => 23:35:12.974000
[0m23:35:12.974524 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m23:35:12.977207 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m23:35:12.978985 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m23:35:12.979409 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        saleskey,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        orderid,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Order_Details
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m23:35:12.979762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:13.041671 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:13.044157 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 23:35:11.741427 => 23:35:13.043974
[0m23:35:13.044512 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m23:35:13.140214 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106208620>]}
[0m23:35:13.141008 [info ] [Thread-3 (]: 10 of 37 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.41s]
[0m23:35:13.141658 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m23:35:13.142092 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m23:35:13.142665 [info ] [Thread-3 (]: 15 of 37 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m23:35:13.143398 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_order_fulfillment)
[0m23:35:13.143754 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m23:35:13.149836 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m23:35:13.150571 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 23:35:13.143968 => 23:35:13.150378
[0m23:35:13.150893 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m23:35:13.153915 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m23:35:13.155912 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m23:35:13.156443 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m23:35:13.156792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:13.222054 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:13.222775 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:13.227285 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 23:35:11.774340 => 23:35:13.227058
[0m23:35:13.230129 [debug] [Thread-4 (]: Timing info for model.northwind.dim_product (execute): 23:35:12.097038 => 23:35:13.229947
[0m23:35:13.230532 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m23:35:13.230850 [debug] [Thread-4 (]: On model.northwind.dim_product: Close
[0m23:35:13.309219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0a990>]}
[0m23:35:13.309894 [info ] [Thread-2 (]: 12 of 37 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.54s]
[0m23:35:13.310794 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m23:35:13.312266 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110517fb0>]}
[0m23:35:13.312780 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:13.313457 [info ] [Thread-4 (]: 13 of 37 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.22s]
[0m23:35:13.313999 [info ] [Thread-2 (]: 16 of 37 START test not_null_dim_date_date ..................................... [RUN]
[0m23:35:13.314534 [debug] [Thread-4 (]: Finished running node model.northwind.dim_product
[0m23:35:13.315344 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m23:35:13.316009 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:13.316684 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:13.317259 [info ] [Thread-4 (]: 17 of 37 START test not_null_dim_date_datekey .................................. [RUN]
[0m23:35:13.324125 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:35:13.324966 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m23:35:13.328986 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:13.332417 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:35:13.332858 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 23:35:13.317563 => 23:35:13.332705
[0m23:35:13.333205 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:13.333480 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 23:35:13.329282 => 23:35:13.333349
[0m23:35:13.335399 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:35:13.335724 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:13.337774 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:35:13.338428 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:35:13.338781 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m23:35:13.339263 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:35:13.339489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:13.339743 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m23:35:13.340658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:13.343952 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c6f3-0000-17c1-0009-ec830002316e
[0m23:35:13.344239 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'SALESKEY'
[0m23:35:13.344553 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 23:35:12.974718 => 23:35:13.344425
[0m23:35:13.344782 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m23:35:13.424807 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:35:13.425217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105d43e0>]}
[0m23:35:13.425631 [error] [Thread-1 (]: 14 of 37 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.46s]
[0m23:35:13.426043 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m23:35:13.426327 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:13.426708 [info ] [Thread-1 (]: 18 of 37 START test unique_dim_date_date ....................................... [RUN]
[0m23:35:13.427224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m23:35:13.427563 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:13.430757 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:35:13.431340 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 23:35:13.427778 => 23:35:13.431200
[0m23:35:13.431581 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:13.433421 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:35:13.434137 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:35:13.434375 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:13.434585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:13.793440 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:13.795014 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:13.798371 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 23:35:13.333684 => 23:35:13.797963
[0m23:35:13.800500 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 23:35:13.336071 => 23:35:13.800270
[0m23:35:13.800945 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m23:35:13.801319 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m23:35:13.887845 [info ] [Thread-4 (]: 17 of 37 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.56s]
[0m23:35:13.889187 [info ] [Thread-2 (]: 16 of 37 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.57s]
[0m23:35:13.890201 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:13.890821 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:13.891323 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:13.891836 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:13.892287 [info ] [Thread-4 (]: 19 of 37 START test unique_dim_date_datekey .................................... [RUN]
[0m23:35:13.892706 [info ] [Thread-2 (]: 20 of 37 START test not_null_dim_customer_customerid ........................... [RUN]
[0m23:35:13.893445 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m23:35:13.894089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m23:35:13.894558 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:13.895003 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:13.899907 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:35:13.903680 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:35:13.904488 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 23:35:13.895256 => 23:35:13.904281
[0m23:35:13.904928 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 23:35:13.900177 => 23:35:13.904691
[0m23:35:13.905270 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:13.905548 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:13.907711 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:35:13.909743 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:35:13.910580 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:35:13.910901 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:13.911184 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:13.911711 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:35:13.912554 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m23:35:13.913087 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:14.237899 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:14.242329 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 23:35:13.907900 => 23:35:14.241901
[0m23:35:14.243059 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m23:35:14.274752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:14.278451 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 23:35:13.431743 => 23:35:14.278081
[0m23:35:14.280188 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m23:35:14.285976 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:14.288196 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 23:35:13.905717 => 23:35:14.287942
[0m23:35:14.288599 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m23:35:14.325992 [info ] [Thread-2 (]: 20 of 37 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.43s]
[0m23:35:14.326792 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:14.327314 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:14.327886 [info ] [Thread-2 (]: 21 of 37 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m23:35:14.328708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m23:35:14.329117 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:14.335219 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:35:14.336363 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 23:35:14.329812 => 23:35:14.336152
[0m23:35:14.336705 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:14.339280 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:35:14.340599 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:35:14.341115 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m23:35:14.341481 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:14.372000 [info ] [Thread-1 (]: 18 of 37 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.94s]
[0m23:35:14.372617 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:14.372988 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:14.373384 [info ] [Thread-1 (]: 22 of 37 START test unique_dim_customer_customerid ............................. [RUN]
[0m23:35:14.374015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m23:35:14.374331 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:14.378492 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:35:14.379233 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 23:35:14.374518 => 23:35:14.379057
[0m23:35:14.379519 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:14.381725 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:35:14.382528 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:35:14.382930 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:14.383205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:14.385951 [info ] [Thread-4 (]: 19 of 37 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.49s]
[0m23:35:14.386689 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:14.387257 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:14.387599 [info ] [Thread-4 (]: 23 of 37 START test unique_dim_customer_customerkey ............................ [RUN]
[0m23:35:14.388134 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m23:35:14.388412 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:14.391658 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:35:14.392227 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 23:35:14.388581 => 23:35:14.392078
[0m23:35:14.392470 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:14.395957 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:35:14.396638 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:35:14.396899 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:14.397137 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:14.433517 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:14.435443 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 23:35:13.151082 => 23:35:14.435318
[0m23:35:14.435683 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m23:35:14.505946 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b44530>]}
[0m23:35:14.506903 [info ] [Thread-3 (]: 15 of 37 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.36s]
[0m23:35:14.507347 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m23:35:14.507637 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:14.508004 [info ] [Thread-3 (]: 24 of 37 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m23:35:14.508500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m23:35:14.508747 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:14.511982 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:35:14.512580 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 23:35:14.508891 => 23:35:14.512427
[0m23:35:14.512837 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:14.514662 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:35:14.515271 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:35:14.515506 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m23:35:14.515732 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:14.643398 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:14.645454 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 23:35:14.336902 => 23:35:14.645229
[0m23:35:14.645837 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m23:35:14.683817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:14.685913 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 23:35:14.379686 => 23:35:14.685663
[0m23:35:14.686315 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m23:35:14.701913 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:14.703908 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 23:35:14.392614 => 23:35:14.703662
[0m23:35:14.704305 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m23:35:14.772005 [info ] [Thread-2 (]: 21 of 37 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.44s]
[0m23:35:14.773243 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:14.773819 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:14.774436 [info ] [Thread-2 (]: 25 of 37 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m23:35:14.775376 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m23:35:14.775846 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:14.781275 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:35:14.783106 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 23:35:14.776125 => 23:35:14.782821
[0m23:35:14.783544 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:14.786618 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:35:14.788058 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:35:14.788434 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m23:35:14.788760 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:14.799542 [info ] [Thread-1 (]: 22 of 37 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.43s]
[0m23:35:14.800134 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:14.800523 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:14.800936 [info ] [Thread-1 (]: 26 of 37 START test unique_dim_employee_employeeid ............................. [RUN]
[0m23:35:14.801575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m23:35:14.801897 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:14.805367 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:35:14.805930 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 23:35:14.802067 => 23:35:14.805766
[0m23:35:14.806200 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:14.808274 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:35:14.809054 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:35:14.809345 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:14.809615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:14.825623 [info ] [Thread-4 (]: 23 of 37 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.44s]
[0m23:35:14.826082 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:14.826350 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:14.826645 [info ] [Thread-4 (]: 27 of 37 START test unique_dim_employee_employeekey ............................ [RUN]
[0m23:35:14.827135 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m23:35:14.827382 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:14.830329 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:35:14.830887 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 23:35:14.827522 => 23:35:14.830752
[0m23:35:14.831128 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:14.832824 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:35:14.833509 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:35:14.833750 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:14.833968 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:14.850706 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:14.851981 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 23:35:14.512981 => 23:35:14.851845
[0m23:35:14.852201 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m23:35:14.929135 [info ] [Thread-3 (]: 24 of 37 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.42s]
[0m23:35:14.929582 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:14.929849 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:14.930135 [info ] [Thread-3 (]: 28 of 37 START test not_null_dim_product_productid ............................. [RUN]
[0m23:35:14.930632 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m23:35:14.930867 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:14.933700 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:35:14.934187 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 23:35:14.931006 => 23:35:14.934063
[0m23:35:14.934393 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:14.935979 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:35:14.936535 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:35:14.936753 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m23:35:14.936959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:15.102026 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.104513 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 23:35:14.783969 => 23:35:15.104238
[0m23:35:15.104974 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m23:35:15.107351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.109115 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 23:35:14.806366 => 23:35:15.108909
[0m23:35:15.109512 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m23:35:15.131443 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.133189 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 23:35:14.831267 => 23:35:15.132982
[0m23:35:15.133518 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m23:35:15.185359 [info ] [Thread-1 (]: 26 of 37 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.38s]
[0m23:35:15.186183 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:15.187155 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:15.187695 [info ] [Thread-1 (]: 29 of 37 START test not_null_dim_product_productkey ............................ [RUN]
[0m23:35:15.188492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m23:35:15.188989 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:15.194212 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:35:15.195040 [info ] [Thread-2 (]: 25 of 37 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.42s]
[0m23:35:15.195667 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:15.196090 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:15.196876 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 23:35:15.189262 => 23:35:15.196689
[0m23:35:15.196512 [info ] [Thread-2 (]: 30 of 37 START test unique_dim_product_productid ............................... [RUN]
[0m23:35:15.197505 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:15.198177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m23:35:15.200950 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:35:15.201287 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:15.204680 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:35:15.205907 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:35:15.206457 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m23:35:15.206757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:15.207076 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 23:35:15.201548 => 23:35:15.206903
[0m23:35:15.207707 [info ] [Thread-4 (]: 27 of 37 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.38s]
[0m23:35:15.208702 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:15.209165 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:15.211143 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:35:15.211506 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:15.212201 [info ] [Thread-4 (]: 31 of 37 START test unique_dim_product_productkey .............................. [RUN]
[0m23:35:15.212697 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m23:35:15.213234 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:35:15.213514 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:15.213786 [debug] [Thread-2 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:15.216784 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:35:15.217052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:15.218115 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 23:35:15.213971 => 23:35:15.217968
[0m23:35:15.218379 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:15.220101 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:35:15.221078 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:35:15.221352 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:15.221587 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:15.232633 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.234063 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 23:35:14.934511 => 23:35:15.233913
[0m23:35:15.234320 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m23:35:15.339521 [info ] [Thread-3 (]: 28 of 37 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.41s]
[0m23:35:15.343548 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:15.343903 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:35:15.344235 [info ] [Thread-3 (]: 32 of 37 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m23:35:15.344588 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:35:15.344875 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:35:15.345169 [info ] [Thread-3 (]: 33 of 37 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m23:35:15.345455 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:35:15.345740 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:15.346027 [info ] [Thread-3 (]: 34 of 37 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m23:35:15.346558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m23:35:15.346807 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:15.351115 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:35:15.351699 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 23:35:15.346947 => 23:35:15.351544
[0m23:35:15.351932 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:15.353682 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:35:15.354301 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:35:15.354546 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m23:35:15.354764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:15.496134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.498208 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 23:35:15.198415 => 23:35:15.497987
[0m23:35:15.498567 [debug] [Thread-1 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m23:35:15.506751 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.508413 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 23:35:15.209332 => 23:35:15.508217
[0m23:35:15.508734 [debug] [Thread-2 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m23:35:15.552993 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.555676 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 23:35:15.218516 => 23:35:15.555437
[0m23:35:15.556112 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m23:35:15.600433 [info ] [Thread-2 (]: 30 of 37 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.40s]
[0m23:35:15.601184 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:15.601726 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:15.603116 [info ] [Thread-2 (]: 35 of 37 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m23:35:15.603993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m23:35:15.604475 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:15.609936 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:35:15.611046 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 23:35:15.605018 => 23:35:15.610797
[0m23:35:15.611424 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:15.614052 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:35:15.615330 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:35:15.615680 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:15.615999 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:15.616730 [info ] [Thread-1 (]: 29 of 37 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.43s]
[0m23:35:15.618069 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:15.618522 [debug] [Thread-1 (]: Began running node model.northwind.obt_sales
[0m23:35:15.618918 [info ] [Thread-1 (]: 36 of 37 SKIP relation northwind_northwind.obt_sales ........................... [[33mSKIP[0m]
[0m23:35:15.619253 [debug] [Thread-1 (]: Finished running node model.northwind.obt_sales
[0m23:35:15.653401 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.655181 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 23:35:15.352069 => 23:35:15.654996
[0m23:35:15.655488 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m23:35:15.658593 [info ] [Thread-4 (]: 31 of 37 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.45s]
[0m23:35:15.659232 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:15.743502 [info ] [Thread-3 (]: 34 of 37 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.40s]
[0m23:35:15.744092 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:15.940214 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:15.944856 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 23:35:15.611610 => 23:35:15.944449
[0m23:35:15.945750 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m23:35:16.034152 [info ] [Thread-2 (]: 35 of 37 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.43s]
[0m23:35:16.034976 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:16.035868 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m23:35:16.036481 [info ] [Thread-1 (]: 37 of 37 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m23:35:16.037249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now model.northwind.obt_order_fulfillment)
[0m23:35:16.037630 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m23:35:16.041647 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m23:35:16.042544 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 23:35:16.037850 => 23:35:16.042350
[0m23:35:16.042883 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m23:35:16.045308 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m23:35:16.046755 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m23:35:16.047107 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m23:35:16.047434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:16.876075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:16.882512 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 23:35:16.043075 => 23:35:16.882191
[0m23:35:16.883332 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m23:35:16.969332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05ce11e5-0249-4be7-952c-f913c394dc03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112afcb90>]}
[0m23:35:16.970570 [info ] [Thread-1 (]: 37 of 37 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.93s]
[0m23:35:16.971447 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m23:35:16.974576 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:16.975201 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m23:35:16.975568 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m23:35:16.975893 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m23:35:16.976202 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productkey.52e0eda426' was properly closed.
[0m23:35:16.976702 [info ] [MainThread]: 
[0m23:35:16.977110 [info ] [MainThread]: Finished running 29 tests, 8 table models in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m23:35:16.981549 [debug] [MainThread]: Command end result
[0m23:35:16.993650 [info ] [MainThread]: 
[0m23:35:16.994026 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:35:16.994272 [info ] [MainThread]: 
[0m23:35:16.994509 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:35:16.994769 [info ] [MainThread]: 
[0m23:35:16.995015 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=3 TOTAL=37
[0m23:35:16.997183 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.6701527, "process_user_time": 2.743586, "process_kernel_time": 0.246779, "process_mem_max_rss": "147357696", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:35:16.997580 [debug] [MainThread]: Command `dbt build` failed at 23:35:16.997494 after 7.67 seconds
[0m23:35:16.997874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105159af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e2a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7fdd0>]}
[0m23:35:16.998153 [debug] [MainThread]: Flushing usage events
[0m23:35:53.209337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ad6570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aee450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aee1b0>]}


============================== 23:35:53.211971 | b5e5e5c4-79f9-4fb7-b146-ebfc312859ed ==============================
[0m23:35:53.211971 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:35:53.212285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:35:53.397373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aee030>]}
[0m23:35:53.430137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109110cb0>]}
[0m23:35:53.431231 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:35:53.443172 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:35:53.477335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:35:53.477709 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m23:35:53.595724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109952d50>]}
[0m23:35:53.602831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10987faa0>]}
[0m23:35:53.603042 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m23:35:53.604475 [info ] [MainThread]: 
[0m23:35:53.604851 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:35:53.605464 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m23:35:53.611497 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m23:35:53.611688 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m23:35:53.611836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:35:54.100988 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m23:35:54.104464 [debug] [ThreadPool]: On list_analytics: Close
[0m23:35:54.211378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m23:35:54.220053 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m23:35:54.220380 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m23:35:54.220633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:35:54.556533 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m23:35:54.560758 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m23:35:54.649526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cd7f0>]}
[0m23:35:54.650939 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:35:54.651392 [info ] [MainThread]: 
[0m23:35:54.655009 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:54.655517 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:54.655926 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:54.656330 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:54.656740 [info ] [Thread-1 (]: 1 of 37 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m23:35:54.657215 [info ] [Thread-2 (]: 2 of 37 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m23:35:54.657677 [info ] [Thread-3 (]: 3 of 37 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m23:35:54.658102 [info ] [Thread-4 (]: 4 of 37 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m23:35:54.659306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m23:35:54.660111 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m23:35:54.660771 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m23:35:54.661383 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m23:35:54.661729 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:54.662051 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:54.662348 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:54.662638 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:54.677471 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:35:54.681934 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:35:54.684648 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:35:54.687196 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:35:54.688025 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 23:35:54.662841 => 23:35:54.687781
[0m23:35:54.688447 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 23:35:54.677725 => 23:35:54.688233
[0m23:35:54.688902 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 23:35:54.682144 => 23:35:54.688731
[0m23:35:54.689219 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:54.689494 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:54.689777 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 23:35:54.684840 => 23:35:54.689626
[0m23:35:54.690036 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:54.704244 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:35:54.705816 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:35:54.706066 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:54.707530 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:35:54.709224 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:35:54.709756 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:35:54.710189 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:35:54.710477 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:35:54.710917 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:35:54.711109 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:54.711334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:54.711703 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:35:54.711911 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:54.712108 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:35:54.712674 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:54.713055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:35:54.713510 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:35:54.967786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:54.975848 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 23:35:54.690198 => 23:35:54.975548
[0m23:35:54.976324 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m23:35:54.981031 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:54.983226 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 23:35:54.706202 => 23:35:54.983014
[0m23:35:54.983830 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:54.984174 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m23:35:54.985910 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 23:35:54.707818 => 23:35:54.985708
[0m23:35:54.987065 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m23:35:54.997929 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:54.999617 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 23:35:54.704431 => 23:35:54.999419
[0m23:35:54.999952 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m23:35:55.055388 [info ] [Thread-1 (]: 1 of 37 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.40s]
[0m23:35:55.056063 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:35:55.056510 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:55.057000 [info ] [Thread-1 (]: 5 of 37 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m23:35:55.057879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m23:35:55.058341 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:55.063107 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:35:55.063904 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 23:35:55.058578 => 23:35:55.063711
[0m23:35:55.064225 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:55.066643 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:35:55.067886 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:35:55.068253 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:55.068581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:55.069528 [info ] [Thread-4 (]: 4 of 37 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.41s]
[0m23:35:55.071165 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:35:55.071519 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:55.071978 [info ] [Thread-4 (]: 6 of 37 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m23:35:55.072663 [info ] [Thread-3 (]: 3 of 37 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.41s]
[0m23:35:55.073274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m23:35:55.073905 [info ] [Thread-2 (]: 2 of 37 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.41s]
[0m23:35:55.074689 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:35:55.074980 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:55.075379 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:35:55.075736 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:55.079155 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:35:55.079508 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:55.079862 [info ] [Thread-3 (]: 7 of 37 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m23:35:55.080203 [info ] [Thread-2 (]: 8 of 37 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m23:35:55.080758 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m23:35:55.081243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m23:35:55.081530 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 23:35:55.075978 => 23:35:55.081391
[0m23:35:55.081768 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:55.081986 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:55.082206 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:55.085144 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:35:55.089009 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:35:55.090760 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:35:55.091298 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 23:35:55.082347 => 23:35:55.091155
[0m23:35:55.091563 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 23:35:55.085340 => 23:35:55.091442
[0m23:35:55.091792 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:55.092256 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:35:55.092487 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:55.094140 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:35:55.094378 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:55.095984 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:35:55.096269 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:55.096778 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:35:55.097415 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:55.097858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:55.098279 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:35:55.098985 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:55.099220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:55.314193 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:55.316493 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 23:35:55.064416 => 23:35:55.316239
[0m23:35:55.316903 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m23:35:55.343893 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:55.344667 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:55.347023 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 23:35:55.092632 => 23:35:55.346755
[0m23:35:55.349105 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 23:35:55.094531 => 23:35:55.348883
[0m23:35:55.349690 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:55.350706 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m23:35:55.351122 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m23:35:55.352959 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 23:35:55.089218 => 23:35:55.352739
[0m23:35:55.356121 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m23:35:55.396965 [info ] [Thread-1 (]: 5 of 37 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.34s]
[0m23:35:55.397617 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:35:55.398061 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:55.398561 [info ] [Thread-1 (]: 9 of 37 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m23:35:55.399431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m23:35:55.399803 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:55.404457 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:35:55.405276 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 23:35:55.400017 => 23:35:55.405074
[0m23:35:55.405604 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:55.408139 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:35:55.409076 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:35:55.409380 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:55.409657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:55.429349 [info ] [Thread-2 (]: 8 of 37 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.35s]
[0m23:35:55.430003 [info ] [Thread-3 (]: 7 of 37 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.35s]
[0m23:35:55.430576 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:35:55.430952 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:35:55.431272 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m23:35:55.431633 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m23:35:55.432069 [info ] [Thread-2 (]: 10 of 37 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m23:35:55.432411 [info ] [Thread-3 (]: 11 of 37 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m23:35:55.432981 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m23:35:55.433520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m23:35:55.433814 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m23:35:55.434087 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m23:35:55.437626 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m23:35:55.439720 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m23:35:55.440938 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 23:35:55.434254 => 23:35:55.440768
[0m23:35:55.441264 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 23:35:55.437874 => 23:35:55.441095
[0m23:35:55.441543 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m23:35:55.442095 [info ] [Thread-4 (]: 6 of 37 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.37s]
[0m23:35:55.442406 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m23:35:55.459981 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m23:35:55.460425 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:35:55.462064 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m23:35:55.462387 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m23:35:55.462804 [info ] [Thread-4 (]: 12 of 37 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m23:35:55.463279 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m23:35:55.463828 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_employee)
[0m23:35:55.464191 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m23:35:55.464712 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m23:35:55.464889 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m23:35:55.465093 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:55.465320 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m23:35:55.468072 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m23:35:55.468669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:55.469587 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 23:35:55.465464 => 23:35:55.469459
[0m23:35:55.469807 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m23:35:55.471333 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m23:35:55.472819 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m23:35:55.473068 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m23:35:55.473276 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:55.671497 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:55.673892 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 23:35:55.405797 => 23:35:55.673626
[0m23:35:55.674323 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m23:35:55.785130 [info ] [Thread-1 (]: 9 of 37 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.39s]
[0m23:35:55.786196 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:35:55.786667 [debug] [Thread-1 (]: Began running node model.northwind.dim_product
[0m23:35:55.787421 [info ] [Thread-1 (]: 13 of 37 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m23:35:55.788497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m23:35:55.788915 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_product
[0m23:35:55.794057 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m23:35:55.794947 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (compile): 23:35:55.789149 => 23:35:55.794746
[0m23:35:55.795264 [debug] [Thread-1 (]: Began executing node model.northwind.dim_product
[0m23:35:55.797982 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m23:35:55.799037 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_product"
[0m23:35:55.799391 [debug] [Thread-1 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m23:35:55.799723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:56.216567 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:56.238926 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 23:35:55.442565 => 23:35:56.238732
[0m23:35:56.239403 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m23:35:56.244939 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:56.247201 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 23:35:55.460601 => 23:35:56.247044
[0m23:35:56.247489 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m23:35:56.308223 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:56.310779 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 23:35:55.469930 => 23:35:56.310577
[0m23:35:56.311142 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m23:35:56.321863 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7ed50>]}
[0m23:35:56.322490 [info ] [Thread-2 (]: 10 of 37 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.89s]
[0m23:35:56.323049 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m23:35:56.323418 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m23:35:56.323891 [info ] [Thread-2 (]: 14 of 37 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m23:35:56.324714 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m23:35:56.325080 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m23:35:56.331713 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m23:35:56.332518 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 23:35:56.325289 => 23:35:56.332353
[0m23:35:56.332802 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m23:35:56.336612 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m23:35:56.338119 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m23:35:56.338469 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        orderid,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Order_Details
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m23:35:56.338779 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:56.351441 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd0b90>]}
[0m23:35:56.351895 [info ] [Thread-3 (]: 11 of 37 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.92s]
[0m23:35:56.352334 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m23:35:56.352617 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m23:35:56.353004 [info ] [Thread-3 (]: 15 of 37 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m23:35:56.353501 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_order_fulfillment)
[0m23:35:56.353734 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m23:35:56.357888 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m23:35:56.358408 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 23:35:56.353869 => 23:35:56.358257
[0m23:35:56.358654 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m23:35:56.360644 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m23:35:56.362321 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m23:35:56.362640 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m23:35:56.362933 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:56.402428 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109760890>]}
[0m23:35:56.402809 [info ] [Thread-4 (]: 12 of 37 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.94s]
[0m23:35:56.403142 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m23:35:56.403373 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:56.403667 [info ] [Thread-4 (]: 16 of 37 START test not_null_dim_customer_customerid ........................... [RUN]
[0m23:35:56.404104 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m23:35:56.404353 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:56.408365 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:35:56.408800 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 23:35:56.404493 => 23:35:56.408679
[0m23:35:56.408999 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:56.410492 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:35:56.411003 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:35:56.411202 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m23:35:56.411384 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:56.615730 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c6f3-0000-17bf-0009-ec83000221d2
[0m23:35:56.616267 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 31
invalid identifier 'EMPLOYEEID'
[0m23:35:56.616830 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 23:35:56.332963 => 23:35:56.616606
[0m23:35:56.617221 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m23:35:56.708576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:56.710321 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:56.715253 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (execute): 23:35:55.795456 => 23:35:56.714815
[0m23:35:56.720033 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 23:35:56.409110 => 23:35:56.719757
[0m23:35:56.720538 [debug] [Thread-1 (]: On model.northwind.dim_product: Close
[0m23:35:56.720981 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m23:35:56.726039 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 31
  invalid identifier 'EMPLOYEEID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:35:56.726636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a897c0>]}
[0m23:35:56.727451 [error] [Thread-2 (]: 14 of 37 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.40s]
[0m23:35:56.728268 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m23:35:56.728938 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:56.729596 [info ] [Thread-2 (]: 17 of 37 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m23:35:56.730293 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m23:35:56.730610 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:56.735026 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:35:56.735731 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 23:35:56.730795 => 23:35:56.735567
[0m23:35:56.736014 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:56.738247 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:35:56.739006 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:35:56.739295 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m23:35:56.739563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:56.798493 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1db50>]}
[0m23:35:56.799017 [info ] [Thread-1 (]: 13 of 37 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 1.01s]
[0m23:35:56.799486 [debug] [Thread-1 (]: Finished running node model.northwind.dim_product
[0m23:35:56.799791 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:56.800152 [info ] [Thread-1 (]: 18 of 37 START test unique_dim_customer_customerid ............................. [RUN]
[0m23:35:56.800646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m23:35:56.800898 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:56.803965 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:35:56.804792 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 23:35:56.801041 => 23:35:56.804588
[0m23:35:56.805096 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:56.807641 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:35:56.808349 [info ] [Thread-4 (]: 16 of 37 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.40s]
[0m23:35:56.808866 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:35:56.809155 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:56.809446 [info ] [Thread-4 (]: 19 of 37 START test unique_dim_customer_customerkey ............................ [RUN]
[0m23:35:56.810019 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:35:56.810474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m23:35:56.810751 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:56.810999 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:56.811219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:56.815477 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:35:56.816548 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 23:35:56.811367 => 23:35:56.816411
[0m23:35:56.816749 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:56.818514 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:35:56.819404 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:35:56.819629 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:56.819839 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:57.017901 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:57.020630 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 23:35:56.736182 => 23:35:57.020364
[0m23:35:57.021052 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m23:35:57.102850 [info ] [Thread-2 (]: 17 of 37 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.37s]
[0m23:35:57.104067 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:35:57.104496 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:57.104911 [info ] [Thread-2 (]: 20 of 37 START test not_null_dim_date_date ..................................... [RUN]
[0m23:35:57.105488 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m23:35:57.105750 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:57.109237 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:35:57.109899 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 23:35:57.105909 => 23:35:57.109728
[0m23:35:57.110168 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:57.112537 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:35:57.113564 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:35:57.113916 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m23:35:57.114158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:57.129446 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:57.131459 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 23:35:56.358797 => 23:35:57.131311
[0m23:35:57.131729 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m23:35:57.220625 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a7d460>]}
[0m23:35:57.221223 [info ] [Thread-3 (]: 15 of 37 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 0.87s]
[0m23:35:57.221598 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m23:35:57.221863 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:57.222224 [info ] [Thread-3 (]: 21 of 37 START test not_null_dim_date_datekey .................................. [RUN]
[0m23:35:57.222698 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m23:35:57.222899 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:57.226053 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:35:57.226598 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 23:35:57.223029 => 23:35:57.226469
[0m23:35:57.226805 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:57.228357 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:35:57.229196 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:35:57.231871 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m23:35:57.232566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:57.399137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:57.401518 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 23:35:56.805270 => 23:35:57.401258
[0m23:35:57.401927 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m23:35:57.481331 [info ] [Thread-1 (]: 18 of 37 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.68s]
[0m23:35:57.482859 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:35:57.483660 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:57.484388 [info ] [Thread-1 (]: 22 of 37 START test unique_dim_date_date ....................................... [RUN]
[0m23:35:57.485454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m23:35:57.485943 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:57.491396 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:35:57.492251 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 23:35:57.486227 => 23:35:57.492018
[0m23:35:57.492633 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:57.495252 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:35:57.496184 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:35:57.496520 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:57.496838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:57.550314 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:57.552184 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 23:35:56.816870 => 23:35:57.551990
[0m23:35:57.552485 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m23:35:57.630787 [info ] [Thread-4 (]: 19 of 37 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.82s]
[0m23:35:57.631434 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:35:57.631813 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:57.632229 [info ] [Thread-4 (]: 23 of 37 START test unique_dim_date_datekey .................................... [RUN]
[0m23:35:57.632906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m23:35:57.633236 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:57.637606 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:35:57.638416 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 23:35:57.633429 => 23:35:57.638209
[0m23:35:57.638752 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:57.642735 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:35:57.643573 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:35:57.643899 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:57.644178 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:57.686315 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:57.687857 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 23:35:57.110326 => 23:35:57.687699
[0m23:35:57.688112 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m23:35:57.763552 [info ] [Thread-2 (]: 20 of 37 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.66s]
[0m23:35:57.764988 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:35:57.765416 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:57.765840 [info ] [Thread-2 (]: 24 of 37 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m23:35:57.766496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m23:35:57.766829 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:57.770713 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:35:57.771426 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 23:35:57.767030 => 23:35:57.771245
[0m23:35:57.771712 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:57.773876 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:35:57.774656 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:35:57.774949 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m23:35:57.775194 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:57.802395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:57.804006 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 23:35:57.226927 => 23:35:57.803826
[0m23:35:57.804405 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m23:35:57.826708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:57.828020 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 23:35:57.492855 => 23:35:57.827865
[0m23:35:57.828272 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m23:35:57.876420 [info ] [Thread-3 (]: 21 of 37 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.65s]
[0m23:35:57.876884 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:35:57.877189 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:57.877533 [info ] [Thread-3 (]: 25 of 37 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m23:35:57.878099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m23:35:57.878379 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:57.881915 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:35:57.882498 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 23:35:57.878539 => 23:35:57.882343
[0m23:35:57.882749 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:57.884602 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:35:57.885259 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:35:57.885515 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m23:35:57.885749 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:57.903293 [info ] [Thread-1 (]: 22 of 37 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.42s]
[0m23:35:57.903730 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:35:57.904001 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:57.904287 [info ] [Thread-1 (]: 26 of 37 START test unique_dim_employee_employeeid ............................. [RUN]
[0m23:35:57.904788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m23:35:57.905037 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:57.907949 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:35:57.908432 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 23:35:57.905181 => 23:35:57.908298
[0m23:35:57.908650 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:57.910393 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:35:57.911097 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:35:57.911354 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:57.911582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:57.922981 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:57.924266 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 23:35:57.638945 => 23:35:57.924132
[0m23:35:57.924553 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m23:35:58.016670 [info ] [Thread-4 (]: 23 of 37 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.38s]
[0m23:35:58.017146 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:35:58.017443 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:58.017778 [info ] [Thread-4 (]: 27 of 37 START test unique_dim_employee_employeekey ............................ [RUN]
[0m23:35:58.018309 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m23:35:58.018560 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:58.021688 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:35:58.025532 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 23:35:58.018712 => 23:35:58.025392
[0m23:35:58.025758 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:58.027525 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:35:58.028167 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:35:58.028415 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:58.028648 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:58.096873 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.098812 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 23:35:57.771879 => 23:35:58.098623
[0m23:35:58.099172 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m23:35:58.154913 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.156477 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 23:35:57.882892 => 23:35:58.156291
[0m23:35:58.156786 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m23:35:58.170802 [info ] [Thread-2 (]: 24 of 37 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.40s]
[0m23:35:58.171359 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:35:58.171725 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:35:58.172124 [info ] [Thread-2 (]: 28 of 37 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m23:35:58.172511 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:35:58.172828 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:35:58.173144 [info ] [Thread-2 (]: 29 of 37 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m23:35:58.173458 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:35:58.173733 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:58.174038 [info ] [Thread-2 (]: 30 of 37 START test not_null_dim_product_productid ............................. [RUN]
[0m23:35:58.174604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m23:35:58.174881 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:58.180182 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:35:58.180838 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 23:35:58.175049 => 23:35:58.180680
[0m23:35:58.181100 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:58.183082 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:35:58.183755 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:35:58.184031 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m23:35:58.184287 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:58.227786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.229220 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 23:35:57.908788 => 23:35:58.229064
[0m23:35:58.229743 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m23:35:58.231277 [info ] [Thread-3 (]: 25 of 37 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.35s]
[0m23:35:58.231652 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:35:58.231951 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:58.232336 [info ] [Thread-3 (]: 31 of 37 START test not_null_dim_product_productkey ............................ [RUN]
[0m23:35:58.232886 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m23:35:58.233200 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:58.236134 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:35:58.236641 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 23:35:58.233406 => 23:35:58.236517
[0m23:35:58.236853 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:58.238483 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:35:58.239099 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:35:58.239317 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m23:35:58.239520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:58.298639 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.300088 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 23:35:58.025889 => 23:35:58.299926
[0m23:35:58.300337 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m23:35:58.308996 [info ] [Thread-1 (]: 26 of 37 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.40s]
[0m23:35:58.309388 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:35:58.309649 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:58.309961 [info ] [Thread-1 (]: 32 of 37 START test unique_dim_product_productid ............................... [RUN]
[0m23:35:58.310441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m23:35:58.310678 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:58.313424 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:35:58.313892 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 23:35:58.310818 => 23:35:58.313759
[0m23:35:58.314108 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:58.315712 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:35:58.316307 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:35:58.316536 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:58.316747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:58.385274 [info ] [Thread-4 (]: 27 of 37 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.37s]
[0m23:35:58.385722 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:35:58.385992 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:58.386339 [info ] [Thread-4 (]: 33 of 37 START test unique_dim_product_productkey .............................. [RUN]
[0m23:35:58.386817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m23:35:58.387044 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:58.389905 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:35:58.390394 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 23:35:58.387178 => 23:35:58.390266
[0m23:35:58.390606 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:58.392305 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:35:58.392921 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:35:58.393152 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:58.393363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:35:58.483138 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.484907 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 23:35:58.181244 => 23:35:58.484717
[0m23:35:58.485234 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m23:35:58.569618 [info ] [Thread-2 (]: 30 of 37 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.40s]
[0m23:35:58.570289 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:35:58.570724 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:58.571197 [info ] [Thread-2 (]: 34 of 37 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m23:35:58.571995 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m23:35:58.572701 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:58.573351 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.577969 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:35:58.579769 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 23:35:58.236974 => 23:35:58.579558
[0m23:35:58.580239 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m23:35:58.581558 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 23:35:58.573602 => 23:35:58.581399
[0m23:35:58.582043 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:58.584208 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:35:58.585271 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:35:58.585583 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m23:35:58.585860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:35:58.595573 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.597139 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 23:35:58.314236 => 23:35:58.596959
[0m23:35:58.597660 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m23:35:58.654833 [info ] [Thread-3 (]: 31 of 37 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.42s]
[0m23:35:58.655289 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:35:58.655580 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:58.655895 [info ] [Thread-3 (]: 35 of 37 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m23:35:58.657178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m23:35:58.657467 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:58.662467 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:35:58.663072 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 23:35:58.657633 => 23:35:58.662918
[0m23:35:58.663323 [debug] [Thread-3 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:58.665294 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:35:58.666001 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:35:58.666260 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:35:58.666512 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:35:58.674007 [info ] [Thread-1 (]: 32 of 37 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.36s]
[0m23:35:58.674394 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:35:58.674654 [debug] [Thread-1 (]: Began running node model.northwind.obt_sales
[0m23:35:58.674969 [info ] [Thread-1 (]: 36 of 37 SKIP relation northwind_northwind.obt_sales ........................... [[33mSKIP[0m]
[0m23:35:58.675275 [debug] [Thread-1 (]: Finished running node model.northwind.obt_sales
[0m23:35:58.688587 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.690044 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 23:35:58.390727 => 23:35:58.689875
[0m23:35:58.690315 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m23:35:58.768711 [info ] [Thread-4 (]: 33 of 37 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.38s]
[0m23:35:58.769193 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:35:58.895870 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.900315 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 23:35:58.582245 => 23:35:58.899917
[0m23:35:58.901016 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m23:35:58.972766 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:35:58.977229 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 23:35:58.663472 => 23:35:58.976821
[0m23:35:58.978063 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m23:35:58.999882 [info ] [Thread-2 (]: 34 of 37 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.43s]
[0m23:35:59.000823 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:35:59.058853 [info ] [Thread-3 (]: 35 of 37 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.40s]
[0m23:35:59.060079 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:35:59.061585 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m23:35:59.062389 [info ] [Thread-1 (]: 37 of 37 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m23:35:59.063350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now model.northwind.obt_order_fulfillment)
[0m23:35:59.063846 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m23:35:59.068816 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m23:35:59.069908 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 23:35:59.064133 => 23:35:59.069665
[0m23:35:59.070294 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m23:35:59.073033 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m23:35:59.074795 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m23:35:59.075222 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m23:35:59.075598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:35:59.734520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:35:59.739131 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 23:35:59.070518 => 23:35:59.738801
[0m23:35:59.739887 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m23:35:59.828203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5e5e5c4-79f9-4fb7-b146-ebfc312859ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd2e40>]}
[0m23:35:59.829310 [info ] [Thread-1 (]: 37 of 37 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.77s]
[0m23:35:59.830476 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m23:35:59.833055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:35:59.833584 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m23:35:59.833955 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m23:35:59.834286 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m23:35:59.834602 [debug] [MainThread]: Connection 'test.northwind.unique_dim_product_productkey.52e0eda426' was properly closed.
[0m23:35:59.835056 [info ] [MainThread]: 
[0m23:35:59.835471 [info ] [MainThread]: Finished running 29 tests, 8 table models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m23:35:59.840067 [debug] [MainThread]: Command end result
[0m23:35:59.850314 [info ] [MainThread]: 
[0m23:35:59.850652 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:35:59.850897 [info ] [MainThread]: 
[0m23:35:59.851163 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 31
  invalid identifier 'EMPLOYEEID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:35:59.851422 [info ] [MainThread]: 
[0m23:35:59.851669 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=3 TOTAL=37
[0m23:35:59.853695 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.6723676, "process_user_time": 2.653939, "process_kernel_time": 0.267729, "process_mem_max_rss": "147947520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:35:59.854151 [debug] [MainThread]: Command `dbt build` failed at 23:35:59.854052 after 6.67 seconds
[0m23:35:59.854480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aee4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b01760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957c0b0>]}
[0m23:35:59.854782 [debug] [MainThread]: Flushing usage events
[0m23:36:14.033130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190aff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190fe270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190fe000>]}


============================== 23:36:14.035745 | 4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b ==============================
[0m23:36:14.035745 [info ] [MainThread]: Running with dbt=1.7.9
[0m23:36:14.036046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m23:36:14.218643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199f3f50>]}
[0m23:36:14.254816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190fdee0>]}
[0m23:36:14.256057 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m23:36:14.267663 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m23:36:14.302994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:36:14.303440 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m23:36:14.430294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab17110>]}
[0m23:36:14.437573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119e2b050>]}
[0m23:36:14.437816 [info ] [MainThread]: Found 29 tests, 8 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m23:36:14.439268 [info ] [MainThread]: 
[0m23:36:14.439643 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:36:14.440289 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m23:36:14.446485 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m23:36:14.446681 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m23:36:14.446830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:15.025408 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m23:36:15.029801 [debug] [ThreadPool]: On list_analytics: Close
[0m23:36:15.118766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m23:36:15.135738 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m23:36:15.136342 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m23:36:15.136749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:15.434320 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m23:36:15.438239 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m23:36:15.527474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a166ea0>]}
[0m23:36:15.529560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:36:15.530635 [info ] [MainThread]: 
[0m23:36:15.535686 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:36:15.536430 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:36:15.537224 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:36:15.538654 [info ] [Thread-1 (]: 1 of 37 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m23:36:15.539759 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:36:15.540469 [info ] [Thread-2 (]: 2 of 37 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m23:36:15.541160 [info ] [Thread-3 (]: 3 of 37 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m23:36:15.542422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m23:36:15.543687 [info ] [Thread-4 (]: 4 of 37 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m23:36:15.545165 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m23:36:15.546798 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m23:36:15.547632 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:36:15.548938 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m23:36:15.549590 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:36:15.550122 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:36:15.569022 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:36:15.569451 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:36:15.574894 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:36:15.577900 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:36:15.580985 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:36:15.581535 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 23:36:15.550432 => 23:36:15.581350
[0m23:36:15.582043 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:36:15.582341 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 23:36:15.569702 => 23:36:15.582206
[0m23:36:15.582650 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 23:36:15.575121 => 23:36:15.582528
[0m23:36:15.589194 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 23:36:15.578213 => 23:36:15.589047
[0m23:36:15.597574 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:36:15.597829 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:36:15.598060 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:36:15.598256 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:36:15.599779 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:36:15.601292 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:36:15.602818 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:36:15.603313 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m23:36:15.603847 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m23:36:15.604076 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m23:36:15.604463 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m23:36:15.604671 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:15.605048 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m23:36:15.605243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:15.605451 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:15.605635 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:36:15.605816 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:15.606376 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:36:15.607092 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:36:15.880553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:15.898766 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 23:36:15.582774 => 23:36:15.898329
[0m23:36:15.900587 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m23:36:15.960322 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:15.961823 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:15.963076 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:15.967347 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 23:36:15.598445 => 23:36:15.966708
[0m23:36:15.970866 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 23:36:15.599930 => 23:36:15.970489
[0m23:36:15.973361 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 23:36:15.601469 => 23:36:15.973102
[0m23:36:15.974069 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m23:36:15.974606 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m23:36:15.975551 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m23:36:15.984425 [info ] [Thread-1 (]: 1 of 37 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.44s]
[0m23:36:15.985169 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m23:36:15.985624 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:36:15.986126 [info ] [Thread-1 (]: 5 of 37 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m23:36:15.986904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m23:36:15.987292 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:36:15.991794 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:36:15.992685 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 23:36:15.987514 => 23:36:15.992489
[0m23:36:15.993076 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:36:15.995961 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:36:15.997252 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m23:36:15.997589 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:15.997892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:16.050245 [info ] [Thread-2 (]: 2 of 37 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.51s]
[0m23:36:16.051262 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m23:36:16.051746 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:36:16.052384 [info ] [Thread-2 (]: 6 of 37 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m23:36:16.053182 [info ] [Thread-3 (]: 3 of 37 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.51s]
[0m23:36:16.053809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m23:36:16.054256 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m23:36:16.054523 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:36:16.054821 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:36:16.058503 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:36:16.058851 [info ] [Thread-3 (]: 7 of 37 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m23:36:16.059481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m23:36:16.059822 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:36:16.060148 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 23:36:16.055028 => 23:36:16.059997
[0m23:36:16.063352 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:36:16.063700 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:36:16.066843 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:36:16.067586 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 23:36:16.060320 => 23:36:16.067443
[0m23:36:16.067860 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:36:16.068325 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m23:36:16.070055 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:36:16.070574 [info ] [Thread-4 (]: 4 of 37 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.52s]
[0m23:36:16.070869 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:16.071275 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m23:36:16.071527 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:16.071785 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:36:16.072201 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m23:36:16.072886 [info ] [Thread-4 (]: 8 of 37 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m23:36:16.073334 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:16.073767 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m23:36:16.073978 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:16.074178 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:36:16.077297 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:36:16.077853 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 23:36:16.074893 => 23:36:16.077727
[0m23:36:16.078046 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:36:16.079521 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:36:16.080321 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m23:36:16.080527 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:16.080717 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:16.252757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:16.254374 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 23:36:15.993272 => 23:36:16.254057
[0m23:36:16.254880 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m23:36:16.326304 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:16.327599 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:16.329276 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 23:36:16.078163 => 23:36:16.329090
[0m23:36:16.331104 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 23:36:16.063939 => 23:36:16.330915
[0m23:36:16.331537 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m23:36:16.331844 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m23:36:16.332899 [info ] [Thread-1 (]: 5 of 37 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.35s]
[0m23:36:16.333809 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m23:36:16.334274 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:36:16.334655 [info ] [Thread-1 (]: 9 of 37 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m23:36:16.335109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m23:36:16.335400 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:36:16.338558 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:36:16.339313 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 23:36:16.335946 => 23:36:16.339170
[0m23:36:16.339523 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:36:16.340959 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:36:16.341468 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m23:36:16.341651 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:16.341822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:16.343205 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:16.344374 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 23:36:16.068495 => 23:36:16.344256
[0m23:36:16.344731 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m23:36:16.424344 [info ] [Thread-3 (]: 7 of 37 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.36s]
[0m23:36:16.426172 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m23:36:16.425588 [info ] [Thread-2 (]: 6 of 37 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.37s]
[0m23:36:16.427026 [info ] [Thread-4 (]: 8 of 37 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.35s]
[0m23:36:16.427712 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m23:36:16.428509 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m23:36:16.429137 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m23:36:16.429656 [info ] [Thread-3 (]: 10 of 37 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m23:36:16.430023 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m23:36:16.430324 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m23:36:16.430749 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m23:36:16.431005 [info ] [Thread-2 (]: 11 of 37 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m23:36:16.431227 [info ] [Thread-4 (]: 12 of 37 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m23:36:16.431468 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m23:36:16.431813 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_customer)
[0m23:36:16.432133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m23:36:16.435121 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m23:36:16.435336 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m23:36:16.435507 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m23:36:16.438988 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m23:36:16.441218 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m23:36:16.441782 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 23:36:16.432262 => 23:36:16.441589
[0m23:36:16.442133 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m23:36:16.442392 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 23:36:16.435684 => 23:36:16.442287
[0m23:36:16.459515 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 23:36:16.439230 => 23:36:16.459353
[0m23:36:16.459931 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m23:36:16.460360 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m23:36:16.462796 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m23:36:16.464415 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m23:36:16.466172 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m23:36:16.466636 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m23:36:16.467008 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m23:36:16.467442 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m23:36:16.467627 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:16.467853 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m23:36:16.468416 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m23:36:16.469084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:16.469475 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m23:36:16.470020 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:16.602810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:16.604659 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 23:36:16.339636 => 23:36:16.604463
[0m23:36:16.604994 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m23:36:16.696008 [info ] [Thread-1 (]: 9 of 37 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.36s]
[0m23:36:16.696750 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m23:36:16.697215 [debug] [Thread-1 (]: Began running node model.northwind.dim_product
[0m23:36:16.697728 [info ] [Thread-1 (]: 13 of 37 START sql table model analytics.northwind_northwind.dim_product ....... [RUN]
[0m23:36:16.698414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_product)
[0m23:36:16.698763 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_product
[0m23:36:16.703314 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_product"
[0m23:36:16.704128 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (compile): 23:36:16.698965 => 23:36:16.703950
[0m23:36:16.704433 [debug] [Thread-1 (]: Began executing node model.northwind.dim_product
[0m23:36:16.707123 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_product"
[0m23:36:16.708088 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_product"
[0m23:36:16.708424 [debug] [Thread-1 (]: On model.northwind.dim_product: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_product"} */
create or replace transient table analytics.northwind_northwind.dim_product
         as
        (with stg_products as (
    select * from raw.northwind.Products
)
select 
    md5(cast(coalesce(cast(stg_products.productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as productkey, 
        stg_products.*
    from stg_products
        );
[0m23:36:16.708735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:16.990406 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:17.025369 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 23:36:16.463141 => 23:36:17.025105
[0m23:36:17.025953 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m23:36:17.119571 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a03f620>]}
[0m23:36:17.120663 [info ] [Thread-2 (]: 11 of 37 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.69s]
[0m23:36:17.121461 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m23:36:17.122066 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m23:36:17.122854 [info ] [Thread-2 (]: 14 of 37 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m23:36:17.123759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m23:36:17.124228 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m23:36:17.135603 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m23:36:17.137144 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 23:36:17.124509 => 23:36:17.136734
[0m23:36:17.138015 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m23:36:17.143279 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m23:36:17.144909 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m23:36:17.145262 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        saleskey,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        orderid,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Order_Details
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m23:36:17.145535 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:17.443659 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c6f4-0000-17bf-0009-ec830002222e
[0m23:36:17.445196 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'SALESKEY'
[0m23:36:17.446652 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 23:36:17.138619 => 23:36:17.446154
[0m23:36:17.447804 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m23:36:17.451848 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:17.457058 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 23:36:16.442496 => 23:36:17.456750
[0m23:36:17.457780 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m23:36:17.547828 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2a8c20>]}
[0m23:36:17.549451 [info ] [Thread-3 (]: 10 of 37 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.12s]
[0m23:36:17.550722 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m23:36:17.552238 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m23:36:17.556050 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:36:17.557455 [info ] [Thread-3 (]: 15 of 37 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m23:36:17.559759 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:17.560466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b274920>]}
[0m23:36:17.562417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_order_fulfillment)
[0m23:36:17.567817 [debug] [Thread-1 (]: Timing info for model.northwind.dim_product (execute): 23:36:16.704620 => 23:36:17.567533
[0m23:36:17.569466 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m23:36:17.568932 [error] [Thread-2 (]: 14 of 37 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.44s]
[0m23:36:17.570169 [debug] [Thread-1 (]: On model.northwind.dim_product: Close
[0m23:36:17.577235 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m23:36:17.577551 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m23:36:17.578472 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:36:17.579597 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 23:36:17.570489 => 23:36:17.579389
[0m23:36:17.579103 [info ] [Thread-2 (]: 16 of 37 START test not_null_dim_customer_customerid ........................... [RUN]
[0m23:36:17.579975 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m23:36:17.580406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m23:36:17.582115 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m23:36:17.582351 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:36:17.589099 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:36:17.590608 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m23:36:17.590930 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m23:36:17.591273 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 23:36:17.583032 => 23:36:17.591117
[0m23:36:17.591513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:17.591724 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:36:17.594015 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:36:17.594601 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m23:36:17.594819 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m23:36:17.595038 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:17.670023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab31eb0>]}
[0m23:36:17.670486 [info ] [Thread-1 (]: 13 of 37 OK created sql table model analytics.northwind_northwind.dim_product .. [[32mSUCCESS 1[0m in 0.97s]
[0m23:36:17.670817 [debug] [Thread-1 (]: Finished running node model.northwind.dim_product
[0m23:36:17.671037 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:36:17.671289 [info ] [Thread-1 (]: 17 of 37 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m23:36:17.671731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_product, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m23:36:17.671913 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:36:17.674383 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:36:17.674864 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 23:36:17.672022 => 23:36:17.674760
[0m23:36:17.675045 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:36:17.676323 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:36:17.676775 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m23:36:17.676945 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m23:36:17.677113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:17.731518 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:17.732940 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 23:36:16.464626 => 23:36:17.732838
[0m23:36:17.733131 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m23:36:17.804753 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac9610>]}
[0m23:36:17.805192 [info ] [Thread-4 (]: 12 of 37 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.37s]
[0m23:36:17.805587 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m23:36:17.805866 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:36:17.806167 [info ] [Thread-4 (]: 18 of 37 START test unique_dim_customer_customerid ............................. [RUN]
[0m23:36:17.806699 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m23:36:17.806926 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:36:17.809904 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:36:17.810428 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 23:36:17.807059 => 23:36:17.810290
[0m23:36:17.810650 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:36:17.812470 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:36:17.813239 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m23:36:17.813509 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:17.813744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:17.911341 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:17.915311 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 23:36:17.592468 => 23:36:17.915077
[0m23:36:17.915680 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m23:36:17.985908 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:17.989521 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 23:36:17.675152 => 23:36:17.989126
[0m23:36:17.990683 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m23:36:17.994791 [info ] [Thread-2 (]: 16 of 37 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.41s]
[0m23:36:17.995803 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m23:36:17.996457 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:36:17.997046 [info ] [Thread-2 (]: 19 of 37 START test unique_dim_customer_customerkey ............................ [RUN]
[0m23:36:17.998008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m23:36:17.998523 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:36:18.003761 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:36:18.006375 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 23:36:17.998801 => 23:36:18.006132
[0m23:36:18.006774 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:36:18.009472 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:36:18.010783 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m23:36:18.011200 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:18.011629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:18.065475 [info ] [Thread-1 (]: 17 of 37 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.39s]
[0m23:36:18.066173 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m23:36:18.066558 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:36:18.066989 [info ] [Thread-1 (]: 20 of 37 START test not_null_dim_date_date ..................................... [RUN]
[0m23:36:18.067697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m23:36:18.068037 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:36:18.072295 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:36:18.073031 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 23:36:18.068241 => 23:36:18.072849
[0m23:36:18.073313 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:36:18.075612 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:36:18.076329 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m23:36:18.076613 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m23:36:18.076885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:18.111799 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:18.113526 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 23:36:17.810784 => 23:36:18.113338
[0m23:36:18.113826 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m23:36:18.189542 [info ] [Thread-4 (]: 18 of 37 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.38s]
[0m23:36:18.190514 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m23:36:18.195593 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:36:18.196762 [info ] [Thread-4 (]: 21 of 37 START test not_null_dim_date_datekey .................................. [RUN]
[0m23:36:18.197702 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m23:36:18.198184 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:36:18.202897 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:36:18.203636 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 23:36:18.198449 => 23:36:18.203439
[0m23:36:18.203966 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:36:18.206396 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:36:18.207233 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m23:36:18.207578 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m23:36:18.207892 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:18.726314 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:18.728686 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:18.730330 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:18.735794 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 23:36:18.204160 => 23:36:18.735204
[0m23:36:18.739794 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 23:36:18.073481 => 23:36:18.739228
[0m23:36:18.743013 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 23:36:18.007011 => 23:36:18.742704
[0m23:36:18.743651 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m23:36:18.744158 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m23:36:18.744725 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m23:36:18.791382 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:18.796505 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 23:36:17.580554 => 23:36:18.796202
[0m23:36:18.797091 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m23:36:18.833106 [info ] [Thread-4 (]: 21 of 37 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.64s]
[0m23:36:18.835709 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m23:36:18.836395 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:36:18.837320 [info ] [Thread-4 (]: 22 of 37 START test unique_dim_date_date ....................................... [RUN]
[0m23:36:18.838352 [info ] [Thread-1 (]: 20 of 37 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.77s]
[0m23:36:18.839455 [info ] [Thread-2 (]: 19 of 37 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.84s]
[0m23:36:18.840461 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m23:36:18.841106 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m23:36:18.841696 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m23:36:18.842114 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:36:18.842577 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:36:18.843120 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:36:18.848870 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:36:18.849340 [info ] [Thread-1 (]: 23 of 37 START test unique_dim_date_datekey .................................... [RUN]
[0m23:36:18.849899 [info ] [Thread-2 (]: 24 of 37 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m23:36:18.850778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m23:36:18.851177 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m23:36:18.851505 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:36:18.851895 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 23:36:18.843480 => 23:36:18.851676
[0m23:36:18.852291 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:36:18.856109 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:36:18.856480 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:36:18.856890 [info ] [Thread-2 (]: 25 of 37 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m23:36:18.859348 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:36:18.859715 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m23:36:18.860037 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 23:36:18.852549 => 23:36:18.859874
[0m23:36:18.860423 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:36:18.860752 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:36:18.861059 [info ] [Thread-2 (]: 26 of 37 START test not_null_dim_product_productid ............................. [RUN]
[0m23:36:18.861652 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m23:36:18.865453 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:36:18.866028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_dim_product_productid.51449dfe6f)
[0m23:36:18.866339 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:18.866678 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:36:18.866930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:18.869984 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:36:18.870520 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m23:36:18.871535 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:18.871842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:18.872134 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (compile): 23:36:18.867090 => 23:36:18.871968
[0m23:36:18.873272 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:36:18.875302 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:36:18.876167 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_product_productid.51449dfe6f"
[0m23:36:18.876412 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productid.51449dfe6f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productid
from analytics.northwind_northwind.dim_product
where productid is null



      
    ) dbt_internal_test
[0m23:36:18.876639 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:18.897572 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11abf3ec0>]}
[0m23:36:18.898044 [info ] [Thread-3 (]: 15 of 37 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.34s]
[0m23:36:18.898548 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m23:36:18.899091 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:36:18.899394 [info ] [Thread-3 (]: 27 of 37 START test not_null_dim_product_productkey ............................ [RUN]
[0m23:36:18.899935 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_product_productkey.f710b87f84)
[0m23:36:18.900244 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:36:18.903367 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:36:18.904160 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (compile): 23:36:18.900431 => 23:36:18.904010
[0m23:36:18.904411 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:36:18.906241 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:36:18.906829 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_product_productkey.f710b87f84"
[0m23:36:18.907158 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_product_productkey.f710b87f84"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select productkey
from analytics.northwind_northwind.dim_product
where productkey is null



      
    ) dbt_internal_test
[0m23:36:18.907378 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:19.159720 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.162031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.167384 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 23:36:18.857238 => 23:36:19.166760
[0m23:36:19.172059 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 23:36:18.861847 => 23:36:19.171443
[0m23:36:19.173438 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m23:36:19.174633 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m23:36:19.177755 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.183568 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_product_productid.51449dfe6f (execute): 23:36:18.873650 => 23:36:19.183214
[0m23:36:19.184606 [debug] [Thread-2 (]: On test.northwind.not_null_dim_product_productid.51449dfe6f: Close
[0m23:36:19.228356 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.232373 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_product_productkey.f710b87f84 (execute): 23:36:18.904558 => 23:36:19.231988
[0m23:36:19.233093 [debug] [Thread-3 (]: On test.northwind.not_null_dim_product_productkey.f710b87f84: Close
[0m23:36:19.266658 [info ] [Thread-4 (]: 22 of 37 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.43s]
[0m23:36:19.270718 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m23:36:19.271728 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:36:19.272453 [info ] [Thread-4 (]: 28 of 37 START test unique_dim_product_productid ............................... [RUN]
[0m23:36:19.274068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_product_productid.cfdf676d85)
[0m23:36:19.275411 [info ] [Thread-1 (]: 23 of 37 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.42s]
[0m23:36:19.276818 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:36:19.278086 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m23:36:19.279277 [info ] [Thread-2 (]: 26 of 37 PASS not_null_dim_product_productid ................................... [[32mPASS[0m in 0.41s]
[0m23:36:19.282797 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:36:19.286529 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:36:19.287113 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_product_productid.51449dfe6f
[0m23:36:19.287537 [info ] [Thread-1 (]: 29 of 37 START test unique_dim_product_productkey .............................. [RUN]
[0m23:36:19.288538 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:36:19.289514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_product_productkey.52e0eda426)
[0m23:36:19.290568 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (compile): 23:36:19.279858 => 23:36:19.290319
[0m23:36:19.290112 [info ] [Thread-2 (]: 30 of 37 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m23:36:19.291038 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:36:19.291409 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:36:19.292010 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productid.51449dfe6f, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m23:36:19.296079 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:36:19.298633 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:36:19.299014 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:36:19.302551 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:36:19.303093 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (compile): 23:36:19.292224 => 23:36:19.302923
[0m23:36:19.303709 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_product_productid.cfdf676d85"
[0m23:36:19.304053 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:36:19.304365 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productid.cfdf676d85"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productid is not null
group by productid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:19.304684 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 23:36:19.299475 => 23:36:19.304536
[0m23:36:19.306774 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:36:19.307089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:19.307396 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:36:19.311333 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:36:19.312129 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_product_productkey.52e0eda426"
[0m23:36:19.312539 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_product_productkey.52e0eda426"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    productkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_product
where productkey is not null
group by productkey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:19.312844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:19.313290 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m23:36:19.314460 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m23:36:19.314752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:19.323302 [info ] [Thread-3 (]: 27 of 37 PASS not_null_dim_product_productkey .................................. [[32mPASS[0m in 0.42s]
[0m23:36:19.323681 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_product_productkey.f710b87f84
[0m23:36:19.323930 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:36:19.324169 [info ] [Thread-3 (]: 31 of 37 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m23:36:19.324566 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_product_productkey.f710b87f84, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m23:36:19.324784 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:36:19.327599 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:36:19.328043 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 23:36:19.324915 => 23:36:19.327908
[0m23:36:19.328257 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:36:19.329954 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:36:19.330521 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m23:36:19.330756 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m23:36:19.330978 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:19.591586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.599553 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_product_productkey.52e0eda426 (execute): 23:36:19.304857 => 23:36:19.598778
[0m23:36:19.601236 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.602090 [debug] [Thread-1 (]: On test.northwind.unique_dim_product_productkey.52e0eda426: Close
[0m23:36:19.607528 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_product_productid.cfdf676d85 (execute): 23:36:19.296338 => 23:36:19.606409
[0m23:36:19.609776 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.613699 [debug] [Thread-4 (]: On test.northwind.unique_dim_product_productid.cfdf676d85: Close
[0m23:36:19.614870 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:19.618044 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 23:36:19.328389 => 23:36:19.617711
[0m23:36:19.622947 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 23:36:19.308106 => 23:36:19.622535
[0m23:36:19.624093 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m23:36:19.624766 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m23:36:19.700557 [info ] [Thread-4 (]: 28 of 37 PASS unique_dim_product_productid ..................................... [[32mPASS[0m in 0.43s]
[0m23:36:19.702111 [info ] [Thread-1 (]: 29 of 37 PASS unique_dim_product_productkey .................................... [[32mPASS[0m in 0.41s]
[0m23:36:19.703531 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_product_productid.cfdf676d85
[0m23:36:19.704647 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_product_productkey.52e0eda426
[0m23:36:19.705426 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:36:19.706139 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:36:19.706734 [info ] [Thread-4 (]: 32 of 37 START test unique_dim_employee_employeeid ............................. [RUN]
[0m23:36:19.707629 [info ] [Thread-1 (]: 33 of 37 START test unique_dim_employee_employeekey ............................ [RUN]
[0m23:36:19.709363 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productid.cfdf676d85, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m23:36:19.710400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_product_productkey.52e0eda426, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m23:36:19.710988 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:36:19.711455 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:36:19.719339 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:36:19.714545 [info ] [Thread-2 (]: 30 of 37 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.42s]
[0m23:36:19.723840 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:36:19.724866 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m23:36:19.725500 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:36:19.726015 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 23:36:19.714781 => 23:36:19.725752
[0m23:36:19.726919 [info ] [Thread-3 (]: 31 of 37 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.40s]
[0m23:36:19.727263 [info ] [Thread-2 (]: 34 of 37 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m23:36:19.727868 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 23:36:19.712012 => 23:36:19.727619
[0m23:36:19.728197 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:36:19.728683 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m23:36:19.729303 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m23:36:19.729636 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:36:19.732571 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:36:19.732959 [debug] [Thread-3 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:36:19.733308 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:36:19.735600 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:36:19.736015 [info ] [Thread-3 (]: 35 of 37 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m23:36:19.739742 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:36:19.740421 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m23:36:19.741004 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m23:36:19.741388 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:19.741973 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m23:36:19.742191 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:36:19.742431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:19.742690 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 23:36:19.736283 => 23:36:19.742556
[0m23:36:19.742959 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:19.745964 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:36:19.746740 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:36:19.747248 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:36:19.749313 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:36:19.750219 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 23:36:19.743156 => 23:36:19.750083
[0m23:36:19.750839 [debug] [Thread-3 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:36:19.751287 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m23:36:19.754250 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:36:19.754775 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m23:36:19.755254 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:19.756203 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m23:36:19.756502 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m23:36:19.756719 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:36:20.064874 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:20.066019 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:20.069450 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 23:36:19.747547 => 23:36:20.069063
[0m23:36:20.073135 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 23:36:19.733531 => 23:36:20.072800
[0m23:36:20.073746 [debug] [Thread-2 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m23:36:20.074258 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m23:36:20.083645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:20.086634 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 23:36:19.729834 => 23:36:20.086233
[0m23:36:20.090049 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m23:36:20.091627 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m23:36:20.095466 [debug] [Thread-3 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 23:36:19.751458 => 23:36:20.095064
[0m23:36:20.096237 [debug] [Thread-3 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m23:36:20.161377 [info ] [Thread-2 (]: 34 of 37 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.43s]
[0m23:36:20.163763 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m23:36:20.168180 [info ] [Thread-4 (]: 32 of 37 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.46s]
[0m23:36:20.169216 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m23:36:20.175373 [info ] [Thread-1 (]: 33 of 37 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.47s]
[0m23:36:20.176283 [info ] [Thread-3 (]: 35 of 37 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.44s]
[0m23:36:20.177165 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m23:36:20.177750 [debug] [Thread-3 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m23:36:20.178692 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m23:36:20.179108 [debug] [Thread-4 (]: Began running node model.northwind.obt_sales
[0m23:36:20.179671 [info ] [Thread-2 (]: 36 of 37 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m23:36:20.180185 [info ] [Thread-4 (]: 37 of 37 SKIP relation northwind_northwind.obt_sales ........................... [[33mSKIP[0m]
[0m23:36:20.180949 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now model.northwind.obt_order_fulfillment)
[0m23:36:20.181379 [debug] [Thread-4 (]: Finished running node model.northwind.obt_sales
[0m23:36:20.181764 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m23:36:20.186046 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m23:36:20.186777 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 23:36:20.182091 => 23:36:20.186586
[0m23:36:20.187093 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m23:36:20.189703 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m23:36:20.191459 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m23:36:20.191848 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m23:36:20.192217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:36:20.976318 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m23:36:20.985573 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 23:36:20.187298 => 23:36:20.984914
[0m23:36:20.987285 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m23:36:21.096038 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bf53c1d-0f46-4129-9e7a-9c13ce0eec9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a044980>]}
[0m23:36:21.098772 [info ] [Thread-2 (]: 36 of 37 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.91s]
[0m23:36:21.100548 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m23:36:21.104837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:21.106273 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m23:36:21.107279 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m23:36:21.108075 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m23:36:21.108660 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeeid.a3468da3ee' was properly closed.
[0m23:36:21.109487 [info ] [MainThread]: 
[0m23:36:21.110182 [info ] [MainThread]: Finished running 29 tests, 8 table models in 0 hours 0 minutes and 6.67 seconds (6.67s).
[0m23:36:21.119220 [debug] [MainThread]: Command end result
[0m23:36:21.132786 [info ] [MainThread]: 
[0m23:36:21.133257 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:36:21.133601 [info ] [MainThread]: 
[0m23:36:21.133902 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m23:36:21.134188 [info ] [MainThread]: 
[0m23:36:21.134459 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=1 SKIP=3 TOTAL=37
[0m23:36:21.136899 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 7.130231, "process_user_time": 3.035921, "process_kernel_time": 0.298731, "process_mem_max_rss": "144179200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:36:21.137491 [debug] [MainThread]: Command `dbt build` failed at 23:36:21.137366 after 7.13 seconds
[0m23:36:21.137887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190fe270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2b9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a12b320>]}
[0m23:36:21.138242 [debug] [MainThread]: Flushing usage events
