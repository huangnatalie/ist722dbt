[0m14:40:01.430951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d29bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2bd70>]}


============================== 14:40:01.433510 | 08298e21-5932-4a00-b841-a4b5b314f955 ==============================
[0m14:40:01.433510 [info ] [MainThread]: Running with dbt=1.7.9
[0m14:40:01.433803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:40:01.434084 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/Users/nataliehuang/.dbt')}
[0m14:40:01.434236 [info ] [MainThread]: Creating dbt configuration folder at 
[0m14:40:21.686557 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m14:40:21.698038 [info ] [MainThread]: 
Your new dbt project "UnitF" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m14:40:21.698628 [info ] [MainThread]: Setting up your profile.
[0m14:43:01.230392 [info ] [MainThread]: Profile UnitF written to /Users/nataliehuang/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m14:43:01.282752 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 179.8651, "process_user_time": 0.860062, "process_kernel_time": 0.154288, "process_mem_max_rss": "109379584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:43:01.284074 [debug] [MainThread]: Command `dbt init` succeeded at 14:43:01.283812 after 179.87 seconds
[0m14:43:01.285086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b79760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108834b60>]}
[0m14:43:01.286030 [debug] [MainThread]: Flushing usage events
[0m15:03:24.792396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eedd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eeffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f140e0>]}


============================== 15:03:24.795268 | a7783046-807c-4024-b143-7b35aab98d45 ==============================
[0m15:03:24.795268 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:03:24.795603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug --config-dir', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:03:24.795890 [info ] [MainThread]: To view your profiles.yml file, run:

open /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:03:24.797090 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.0189955, "process_user_time": 0.739302, "process_kernel_time": 0.102227, "process_mem_max_rss": "93798400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:03:24.797363 [debug] [MainThread]: Command `dbt debug` succeeded at 15:03:24.797302 after 0.02 seconds
[0m15:03:24.797524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c27770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eefa70>]}
[0m15:03:24.797685 [debug] [MainThread]: Flushing usage events
[0m15:07:46.007474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089af2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ad2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b45f70>]}


============================== 15:07:46.010132 | f0ff5426-93ae-4c4a-b8f8-0d6e01e2fa49 ==============================
[0m15:07:46.010132 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:07:46.010462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:46.010769 [info ] [MainThread]: dbt version: 1.7.9
[0m15:07:46.010911 [info ] [MainThread]: python version: 3.12.2
[0m15:07:46.011049 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:07:46.011187 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:07:46.012774 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:07:46.012933 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:07:46.013067 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:07:46.043878 [info ] [MainThread]: Configuration:
[0m15:07:46.044101 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m15:07:46.044259 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:07:46.044396 [info ] [MainThread]: Required dependencies:
[0m15:07:46.044552 [debug] [MainThread]: Executing "git --help"
[0m15:07:46.055224 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:07:46.055692 [debug] [MainThread]: STDERR: "b''"
[0m15:07:46.055892 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:07:46.056038 [info ] [MainThread]: Connection test skipped since no profile was found
[0m15:07:46.056174 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:07:46.056296 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Could not find profile named 'UnitF'


[0m15:07:46.057778 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07865229, "process_user_time": 0.788835, "process_kernel_time": 0.101611, "process_mem_max_rss": "95682560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:07:46.058158 [debug] [MainThread]: Command `dbt debug` failed at 15:07:46.058086 after 0.08 seconds
[0m15:07:46.058429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adcb110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093ba570>]}
[0m15:07:46.058675 [debug] [MainThread]: Flushing usage events
[0m15:08:44.839692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104815b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046fac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104845ca0>]}


============================== 15:08:44.842531 | 283de101-c1f3-40ed-8c97-ddfc67e3b440 ==============================
[0m15:08:44.842531 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:08:44.842858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:44.843178 [info ] [MainThread]: dbt version: 1.7.9
[0m15:08:44.843323 [info ] [MainThread]: python version: 3.12.2
[0m15:08:44.843452 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:08:44.843571 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:08:44.993362 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:08:44.993621 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:08:44.993787 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:08:44.994178 [info ] [MainThread]: adapter type: snowflake
[0m15:08:44.994360 [info ] [MainThread]: adapter version: 1.7.2
[0m15:08:45.024385 [info ] [MainThread]: Configuration:
[0m15:08:45.024634 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:08:45.024786 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:08:45.024924 [info ] [MainThread]: Required dependencies:
[0m15:08:45.025112 [debug] [MainThread]: Executing "git --help"
[0m15:08:45.037949 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:08:45.038491 [debug] [MainThread]: STDERR: "b''"
[0m15:08:45.038680 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:08:45.038848 [info ] [MainThread]: Connection:
[0m15:08:45.039033 [info ] [MainThread]:   account: eua414323
[0m15:08:45.039158 [info ] [MainThread]:   user: nhuangsyr
[0m15:08:45.039288 [info ] [MainThread]:   database: northwind
[0m15:08:45.039401 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:08:45.039515 [info ] [MainThread]:   role: accountadmin
[0m15:08:45.039630 [info ] [MainThread]:   schema: northwind
[0m15:08:45.039742 [info ] [MainThread]:   authenticator: None
[0m15:08:45.039852 [info ] [MainThread]:   private_key_path: None
[0m15:08:45.039965 [info ] [MainThread]:   oauth_client_id: None
[0m15:08:45.040075 [info ] [MainThread]:   query_tag: None
[0m15:08:45.040186 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:08:45.040299 [info ] [MainThread]:   host: None
[0m15:08:45.040409 [info ] [MainThread]:   port: None
[0m15:08:45.040517 [info ] [MainThread]:   proxy_host: None
[0m15:08:45.040626 [info ] [MainThread]:   proxy_port: None
[0m15:08:45.040733 [info ] [MainThread]:   protocol: None
[0m15:08:45.040842 [info ] [MainThread]:   connect_retries: 1
[0m15:08:45.040948 [info ] [MainThread]:   connect_timeout: None
[0m15:08:45.041056 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:08:45.041168 [info ] [MainThread]:   retry_all: False
[0m15:08:45.041278 [info ] [MainThread]:   insecure_mode: False
[0m15:08:45.041385 [info ] [MainThread]:   reuse_connections: None
[0m15:08:45.041605 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:08:45.076272 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:08:45.077101 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:08:45.077254 [debug] [MainThread]: On debug: select 1 as id
[0m15:08:45.077396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:08:45.661069 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m15:08:45.661414 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m15:08:45.661656 [debug] [MainThread]: On debug: No close available on handle
[0m15:08:45.661915 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:08:45.662141 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:08:45.662344 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB. Verify the account name is correct: eua414323.snowflakecomputing.com:443. HTTP 403: Forbidden

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:08:45.663967 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.85116214, "process_user_time": 0.980456, "process_kernel_time": 0.144336, "process_mem_max_rss": "121192448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:08:45.664366 [debug] [MainThread]: Command `dbt debug` failed at 15:08:45.664277 after 0.85 seconds
[0m15:08:45.664596 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:08:45.664825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105174c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051741a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509d2e0>]}
[0m15:08:45.665098 [debug] [MainThread]: Flushing usage events
[0m15:09:14.327981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11add2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adf1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adf1ca0>]}


============================== 15:09:14.330681 | 3440051d-1571-4d19-b187-9b2a07cfd6e6 ==============================
[0m15:09:14.330681 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:09:14.331000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:14.331296 [info ] [MainThread]: dbt version: 1.7.9
[0m15:09:14.331439 [info ] [MainThread]: python version: 3.12.2
[0m15:09:14.331562 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:09:14.331682 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:09:14.476835 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:09:14.477082 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:09:14.477239 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:09:14.477615 [info ] [MainThread]: adapter type: snowflake
[0m15:09:14.477794 [info ] [MainThread]: adapter version: 1.7.2
[0m15:09:14.507818 [info ] [MainThread]: Configuration:
[0m15:09:14.508039 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:14.508196 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:14.508329 [info ] [MainThread]: Required dependencies:
[0m15:09:14.508498 [debug] [MainThread]: Executing "git --help"
[0m15:09:14.519690 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:14.520161 [debug] [MainThread]: STDERR: "b''"
[0m15:09:14.520327 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:14.520480 [info ] [MainThread]: Connection:
[0m15:09:14.520658 [info ] [MainThread]:   account: eua41432
[0m15:09:14.520788 [info ] [MainThread]:   user: nhuangsyr
[0m15:09:14.520912 [info ] [MainThread]:   database: northwind
[0m15:09:14.521041 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:09:14.521163 [info ] [MainThread]:   role: accountadmin
[0m15:09:14.521281 [info ] [MainThread]:   schema: northwind
[0m15:09:14.521405 [info ] [MainThread]:   authenticator: None
[0m15:09:14.521522 [info ] [MainThread]:   private_key_path: None
[0m15:09:14.521640 [info ] [MainThread]:   oauth_client_id: None
[0m15:09:14.521760 [info ] [MainThread]:   query_tag: None
[0m15:09:14.521874 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:09:14.521991 [info ] [MainThread]:   host: None
[0m15:09:14.522103 [info ] [MainThread]:   port: None
[0m15:09:14.522225 [info ] [MainThread]:   proxy_host: None
[0m15:09:14.522346 [info ] [MainThread]:   proxy_port: None
[0m15:09:14.522464 [info ] [MainThread]:   protocol: None
[0m15:09:14.522573 [info ] [MainThread]:   connect_retries: 1
[0m15:09:14.522690 [info ] [MainThread]:   connect_timeout: None
[0m15:09:14.522800 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:09:14.522915 [info ] [MainThread]:   retry_all: False
[0m15:09:14.523028 [info ] [MainThread]:   insecure_mode: False
[0m15:09:14.523137 [info ] [MainThread]:   reuse_connections: None
[0m15:09:14.523366 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:09:14.527145 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:09:14.527858 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:09:14.528004 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:14.528129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:14.960362 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m15:09:14.960877 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m15:09:14.961206 [debug] [MainThread]: On debug: No close available on handle
[0m15:09:14.961546 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:09:14.961834 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:09:14.962099 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB. Verify the account name is correct: eua41432.snowflakecomputing.com:443. HTTP 403: Forbidden

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:09:14.963881 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.66554, "process_user_time": 0.934442, "process_kernel_time": 0.139809, "process_mem_max_rss": "121274368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:14.964422 [debug] [MainThread]: Command `dbt debug` failed at 15:09:14.964305 after 0.67 seconds
[0m15:09:14.964728 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:14.965027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11afddf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aecabd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b034530>]}
[0m15:09:14.965390 [debug] [MainThread]: Flushing usage events
[0m15:09:55.962096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c0b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f01be0>]}


============================== 15:09:55.964626 | d3b77e82-1762-4957-833f-74eb5c6e35d9 ==============================
[0m15:09:55.964626 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:09:55.964960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:09:55.965264 [info ] [MainThread]: dbt version: 1.7.9
[0m15:09:55.965407 [info ] [MainThread]: python version: 3.12.2
[0m15:09:55.965534 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:09:55.965652 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:09:56.119963 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:09:56.120212 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:09:56.120368 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:09:56.120730 [info ] [MainThread]: adapter type: snowflake
[0m15:09:56.120915 [info ] [MainThread]: adapter version: 1.7.2
[0m15:09:56.151417 [info ] [MainThread]: Configuration:
[0m15:09:56.151635 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:09:56.151785 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:09:56.151923 [info ] [MainThread]: Required dependencies:
[0m15:09:56.152099 [debug] [MainThread]: Executing "git --help"
[0m15:09:56.163108 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:09:56.163579 [debug] [MainThread]: STDERR: "b''"
[0m15:09:56.163751 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:09:56.163910 [info ] [MainThread]: Connection:
[0m15:09:56.164080 [info ] [MainThread]:   account: eua41432.east-us-2.azure
[0m15:09:56.164221 [info ] [MainThread]:   user: nhuangsyr
[0m15:09:56.164343 [info ] [MainThread]:   database: northwind
[0m15:09:56.164470 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:09:56.164602 [info ] [MainThread]:   role: accountadmin
[0m15:09:56.164718 [info ] [MainThread]:   schema: northwind
[0m15:09:56.164842 [info ] [MainThread]:   authenticator: None
[0m15:09:56.164967 [info ] [MainThread]:   private_key_path: None
[0m15:09:56.165085 [info ] [MainThread]:   oauth_client_id: None
[0m15:09:56.165207 [info ] [MainThread]:   query_tag: None
[0m15:09:56.165323 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:09:56.165455 [info ] [MainThread]:   host: None
[0m15:09:56.165589 [info ] [MainThread]:   port: None
[0m15:09:56.165703 [info ] [MainThread]:   proxy_host: None
[0m15:09:56.165809 [info ] [MainThread]:   proxy_port: None
[0m15:09:56.165916 [info ] [MainThread]:   protocol: None
[0m15:09:56.166027 [info ] [MainThread]:   connect_retries: 1
[0m15:09:56.166152 [info ] [MainThread]:   connect_timeout: None
[0m15:09:56.166266 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:09:56.166393 [info ] [MainThread]:   retry_all: False
[0m15:09:56.166507 [info ] [MainThread]:   insecure_mode: False
[0m15:09:56.166624 [info ] [MainThread]:   reuse_connections: None
[0m15:09:56.166874 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:09:56.170438 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:09:56.171202 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:09:56.171355 [debug] [MainThread]: On debug: select 1 as id
[0m15:09:56.171489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:56.773396 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m15:09:56.773987 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m15:09:56.774365 [debug] [MainThread]: On debug: No close available on handle
[0m15:09:56.774760 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:09:56.775103 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:09:56.775400 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: eua41432.east-us-2.azure.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:09:56.777984 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.8437415, "process_user_time": 0.976791, "process_kernel_time": 0.144934, "process_mem_max_rss": "121896960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:09:56.778739 [debug] [MainThread]: Command `dbt debug` failed at 15:09:56.778580 after 0.84 seconds
[0m15:09:56.779112 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:09:56.779437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a5c3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128aaa20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f2c080>]}
[0m15:09:56.779870 [debug] [MainThread]: Flushing usage events
[0m15:11:36.761055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f60c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f5d90>]}


============================== 15:11:36.763650 | de0bedd2-9dc1-4de5-a376-637c59f66ae5 ==============================
[0m15:11:36.763650 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:11:36.763967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:11:36.764264 [info ] [MainThread]: dbt version: 1.7.9
[0m15:11:36.764407 [info ] [MainThread]: python version: 3.12.2
[0m15:11:36.764542 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3.12
[0m15:11:36.764669 [info ] [MainThread]: os info: macOS-14.1.1-arm64-arm-64bit
[0m15:11:36.917661 [info ] [MainThread]: Using profiles dir at /Users/nataliehuang/Desktop/ist722dbt/northwind
[0m15:11:36.917921 [info ] [MainThread]: Using profiles.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/profiles.yml
[0m15:11:36.918093 [info ] [MainThread]: Using dbt_project.yml file at /Users/nataliehuang/Desktop/ist722dbt/northwind/dbt_project.yml
[0m15:11:36.918482 [info ] [MainThread]: adapter type: snowflake
[0m15:11:36.918670 [info ] [MainThread]: adapter version: 1.7.2
[0m15:11:36.949164 [info ] [MainThread]: Configuration:
[0m15:11:36.949390 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:11:36.949547 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:11:36.949680 [info ] [MainThread]: Required dependencies:
[0m15:11:36.949860 [debug] [MainThread]: Executing "git --help"
[0m15:11:36.961099 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:11:36.961623 [debug] [MainThread]: STDERR: "b''"
[0m15:11:36.961812 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:11:36.961974 [info ] [MainThread]: Connection:
[0m15:11:36.962155 [info ] [MainThread]:   account: eua41432.east-us-2.azure
[0m15:11:36.962289 [info ] [MainThread]:   user: nhuangsyr
[0m15:11:36.962408 [info ] [MainThread]:   database: northwind
[0m15:11:36.962528 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m15:11:36.962651 [info ] [MainThread]:   role: accountadmin
[0m15:11:36.962768 [info ] [MainThread]:   schema: northwind
[0m15:11:36.962890 [info ] [MainThread]:   authenticator: None
[0m15:11:36.963008 [info ] [MainThread]:   private_key_path: None
[0m15:11:36.963133 [info ] [MainThread]:   oauth_client_id: None
[0m15:11:36.963244 [info ] [MainThread]:   query_tag: None
[0m15:11:36.963362 [info ] [MainThread]:   client_session_keep_alive: False
[0m15:11:36.963483 [info ] [MainThread]:   host: None
[0m15:11:36.963598 [info ] [MainThread]:   port: None
[0m15:11:36.963712 [info ] [MainThread]:   proxy_host: None
[0m15:11:36.963836 [info ] [MainThread]:   proxy_port: None
[0m15:11:36.963953 [info ] [MainThread]:   protocol: None
[0m15:11:36.964068 [info ] [MainThread]:   connect_retries: 1
[0m15:11:36.964186 [info ] [MainThread]:   connect_timeout: None
[0m15:11:36.964309 [info ] [MainThread]:   retry_on_database_errors: False
[0m15:11:36.964421 [info ] [MainThread]:   retry_all: False
[0m15:11:36.964534 [info ] [MainThread]:   insecure_mode: False
[0m15:11:36.964649 [info ] [MainThread]:   reuse_connections: None
[0m15:11:36.964880 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:11:36.968904 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m15:11:36.969576 [debug] [MainThread]: Using snowflake connection "debug"
[0m15:11:36.969709 [debug] [MainThread]: On debug: select 1 as id
[0m15:11:36.969835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:37.492053 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:11:37.495869 [debug] [MainThread]: On debug: Close
[0m15:11:37.584291 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:11:37.584780 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:11:37.586783 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.85425776, "process_user_time": 0.931503, "process_kernel_time": 0.139759, "process_mem_max_rss": "120668160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:11:37.587333 [debug] [MainThread]: Command `dbt debug` succeeded at 15:11:37.587219 after 0.85 seconds
[0m15:11:37.587605 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:11:37.587849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f36690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eaacf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10594d160>]}
[0m15:11:37.588139 [debug] [MainThread]: Flushing usage events
[0m15:14:58.582703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cde300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d02270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d01f40>]}


============================== 15:14:58.585229 | 69c160b7-c58b-4606-812e-a67452568762 ==============================
[0m15:14:58.585229 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:14:58.585544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:58.784814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '69c160b7-c58b-4606-812e-a67452568762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113013aa0>]}
[0m15:14:58.819125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '69c160b7-c58b-4606-812e-a67452568762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f3530>]}
[0m15:14:58.819636 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:14:58.824405 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:14:58.826074 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.2713018, "process_user_time": 0.916861, "process_kernel_time": 0.128785, "process_mem_max_rss": "113623040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:14:58.826515 [debug] [MainThread]: Command `dbt build` failed at 15:14:58.826440 after 0.27 seconds
[0m15:14:58.826845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d021b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113907020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113904380>]}
[0m15:14:58.827062 [debug] [MainThread]: Flushing usage events
[0m15:18:06.962341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e6060>]}


============================== 15:18:06.965312 | b001ae3b-6a80-4ef7-8aab-79f849717c62 ==============================
[0m15:18:06.965312 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:06.965672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:07.009791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b001ae3b-6a80-4ef7-8aab-79f849717c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678fe60>]}
[0m15:18:07.011811 [debug] [MainThread]: Set downloads directory='/var/folders/0t/7f6xygd17692gzp2hdyh_0r80000gn/T/dbt-downloads-ei75_c_u'
[0m15:18:07.012061 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:18:07.942024 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:18:07.943702 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:18:08.009109 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:18:08.015446 [info ] [MainThread]: Updating lock file in file path: /Users/nataliehuang/Desktop/ist722dbt/northwind/package-lock.yml
[0m15:18:08.017430 [debug] [MainThread]: Set downloads directory='/var/folders/0t/7f6xygd17692gzp2hdyh_0r80000gn/T/dbt-downloads-petikxvr'
[0m15:18:08.019383 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:18:08.184127 [info ] [MainThread]: Installed from version 1.1.1
[0m15:18:08.184407 [info ] [MainThread]: Up to date!
[0m15:18:08.184645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b001ae3b-6a80-4ef7-8aab-79f849717c62', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f9dc0>]}
[0m15:18:08.186405 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.2576764, "process_user_time": 0.886741, "process_kernel_time": 0.143376, "process_mem_max_rss": "99287040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:08.186769 [debug] [MainThread]: Command `dbt deps` succeeded at 15:18:08.186692 after 1.26 seconds
[0m15:18:08.186970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106358e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064f6570>]}
[0m15:18:08.187164 [debug] [MainThread]: Flushing usage events
[0m15:18:14.848993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104de2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fe390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104fe0f0>]}


============================== 15:18:14.851667 | 493a32e8-0e0a-41b8-b191-90ec8846f471 ==============================
[0m15:18:14.851667 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:18:14.851989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:18:15.038208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120f2db0>]}
[0m15:18:15.071348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110530a70>]}
[0m15:18:15.072450 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:18:15.083656 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:18:15.084165 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:18:15.084349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105303b0>]}
[0m15:18:15.599246 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind
[0m15:18:15.601611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11253c950>]}
[0m15:18:15.606874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112559310>]}
[0m15:18:15.607107 [info ] [MainThread]: Found 1 test, 1 source, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m15:18:15.607817 [info ] [MainThread]: 
[0m15:18:15.608194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:18:15.608415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '493a32e8-0e0a-41b8-b191-90ec8846f471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122c2e40>]}
[0m15:18:15.608761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:18:15.608903 [info ] [MainThread]: 
[0m15:18:15.610313 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:15.610576 [info ] [Thread-1 (]: 1 of 1 START test source_unique_conformed_DateDimension_DateKey ................ [RUN]
[0m15:18:15.610970 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m15:18:15.611154 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:15.617643 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:18:15.618234 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 15:18:15.611269 => 15:18:15.618119
[0m15:18:15.618414 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:15.629726 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:18:15.630561 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:18:15.630752 [debug] [Thread-1 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:18:15.630925 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:18:17.038976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:18:17.048986 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 15:18:15.618519 => 15:18:17.048586
[0m15:18:17.049537 [debug] [Thread-1 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m15:18:17.122705 [info ] [Thread-1 (]: 1 of 1 PASS source_unique_conformed_DateDimension_DateKey ...................... [[32mPASS[0m in 1.51s]
[0m15:18:17.123568 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:18:17.125549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:18:17.125864 [debug] [MainThread]: Connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b' was properly closed.
[0m15:18:17.126169 [info ] [MainThread]: 
[0m15:18:17.126487 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m15:18:17.127194 [debug] [MainThread]: Command end result
[0m15:18:17.135949 [info ] [MainThread]: 
[0m15:18:17.136361 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:18:17.136651 [info ] [MainThread]: 
[0m15:18:17.136941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:18:17.138619 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.3181357, "process_user_time": 1.487342, "process_kernel_time": 0.137114, "process_mem_max_rss": "128565248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:18:17.139128 [debug] [MainThread]: Command `dbt build` succeeded at 15:18:17.139023 after 2.32 seconds
[0m15:18:17.139444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102c9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125efce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a34050>]}
[0m15:18:17.139736 [debug] [MainThread]: Flushing usage events
[0m15:24:04.308728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe21b0>]}


============================== 15:24:04.311404 | 4977d9e1-6aeb-4eb5-aad2-57a5535219a7 ==============================
[0m15:24:04.311404 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:24:04.311734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:24:04.513837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4977d9e1-6aeb-4eb5-aad2-57a5535219a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583d7f0>]}
[0m15:24:04.547070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4977d9e1-6aeb-4eb5-aad2-57a5535219a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dee5a0>]}
[0m15:24:04.547547 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:24:04.559541 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:24:04.567751 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading northwind: sources.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |           - name: OrderID
    53 |             tests:
    54 |               - unique
    55 |       -name: Order Details
    56 |         tests:
    57 |         - dbt_utils_unique_combination_of_columns:
    58 |             combination_of_columns:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 20, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 55, column 7
[0m15:24:04.569130 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.28913835, "process_user_time": 0.927121, "process_kernel_time": 0.139595, "process_mem_max_rss": "117276672", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:24:04.569473 [debug] [MainThread]: Command `dbt build` failed at 15:24:04.569404 after 0.29 seconds
[0m15:24:04.569710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599cdd0>]}
[0m15:24:04.569911 [debug] [MainThread]: Flushing usage events
[0m15:25:08.940677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ae2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fe420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fe0c0>]}


============================== 15:25:08.943150 | f4702d11-9658-485d-940c-045170fdc81b ==============================
[0m15:25:08.943150 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:25:08.943480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m15:25:09.140147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4702d11-9658-485d-940c-045170fdc81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062702f0>]}
[0m15:25:09.173717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4702d11-9658-485d-940c-045170fdc81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106723cb0>]}
[0m15:25:09.174258 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:25:09.185927 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:25:09.194086 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading northwind: sources.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |           - name: OrderID
    53 |             tests:
    54 |               - unique
    55 |       -name: Order Details
    56 |         tests:
    57 |         - dbt_utils_unique_combination_of_columns:
    58 |             combination_of_columns:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 20, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 55, column 7
[0m15:25:09.195417 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.28131813, "process_user_time": 0.933104, "process_kernel_time": 0.138174, "process_mem_max_rss": "117440512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:25:09.195736 [debug] [MainThread]: Command `dbt build` failed at 15:25:09.195669 after 0.28 seconds
[0m15:25:09.195946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbf020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6c380>]}
[0m15:25:09.196131 [debug] [MainThread]: Flushing usage events
[0m15:26:45.967513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e25d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fe3c0>]}


============================== 15:26:45.970155 | 899b1a10-d21d-457d-8943-55421390637b ==============================
[0m15:26:45.970155 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:26:45.970471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:26:46.166955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '899b1a10-d21d-457d-8943-55421390637b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a013ad0>]}
[0m15:26:46.200126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '899b1a10-d21d-457d-8943-55421390637b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a203110>]}
[0m15:26:46.200610 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:26:46.211144 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:26:46.219293 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading northwind: sources.yml - Runtime Error
    Syntax error near line 55
    ------------------------------
    52 |           - name: OrderId
    53 |             tests:
    54 |               - unique
    55 |       -name: Order_Details
    56 |         tests:
    57 |         - dbt_utils_unique_combination_of_columns:
    58 |             combination_of_columns:
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 20, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 55, column 7
[0m15:26:46.220705 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 0.28236014, "process_user_time": 0.923443, "process_kernel_time": 0.133873, "process_mem_max_rss": "115933184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:26:46.221064 [debug] [MainThread]: Command `dbt build` failed at 15:26:46.220990 after 0.28 seconds
[0m15:26:46.221293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109247230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2330b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04ad20>]}
[0m15:26:46.221488 [debug] [MainThread]: Flushing usage events
[0m15:41:41.487873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f01790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f01070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f221e0>]}


============================== 15:41:41.490446 | 14b39030-2fcd-4d5f-a61f-fa6e02ddd98b ==============================
[0m15:41:41.490446 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:41:41.490761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:41:41.705740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055de4b0>]}
[0m15:41:41.739306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051944a0>]}
[0m15:41:41.739822 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:41:41.750961 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:41:41.784169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:41:41.784548 [debug] [MainThread]: Partial parsing: updated file: northwind://models/sources.yml
[0m15:41:41.870599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.northwind
[0m15:41:41.873305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f54530>]}
[0m15:41:41.879216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597d220>]}
[0m15:41:41.879445 [info ] [MainThread]: Found 9 tests, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m15:41:41.880381 [info ] [MainThread]: 
[0m15:41:41.880746 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:41:41.880960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14b39030-2fcd-4d5f-a61f-fa6e02ddd98b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c668d0>]}
[0m15:41:41.881273 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:41.881430 [info ] [MainThread]: 
[0m15:41:41.882862 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:41:41.883055 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:41.883237 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:41.883389 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:41.883580 [info ] [Thread-1 (]: 1 of 9 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m15:41:41.883781 [info ] [Thread-2 (]: 2 of 9 START test source_unique_conformed_DateDimension_DateKey ................ [RUN]
[0m15:41:41.883962 [info ] [Thread-3 (]: 3 of 9 START test source_unique_northwind_Categories_CategoryId ................ [RUN]
[0m15:41:41.884139 [info ] [Thread-4 (]: 4 of 9 START test source_unique_northwind_Customers_CustomerId ................. [RUN]
[0m15:41:41.884503 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf'
[0m15:41:41.884821 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m15:41:41.885119 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m15:41:41.885573 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m15:41:41.885773 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:41:41.885958 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:41.886118 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:41.886309 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:41.893234 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:41:41.895176 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:41:41.897130 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:41:41.897720 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 15:41:41.886452 => 15:41:41.897597
[0m15:41:41.897940 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 15:41:41.890358 => 15:41:41.897822
[0m15:41:41.898213 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 15:41:41.893397 => 15:41:41.898085
[0m15:41:41.899202 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:41.899388 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 15:41:41.895319 => 15:41:41.899300
[0m15:41:41.899621 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:41.911622 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:41:41.911811 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:41.913188 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:41:41.914532 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:41:41.915258 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:41:41.915672 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:41:41.915856 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.916109 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.916467 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:41:41.916694 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:41:41.916895 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:41.917083 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.919134 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:41.920615 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:41:41.920894 [error] [Thread-1 (]: 1 of 9 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.04s]
[0m15:41:41.921162 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:41:41.921361 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:41.921606 [info ] [Thread-1 (]: 5 of 9 START test source_unique_northwind_Employees_EmployeeId ................. [RUN]
[0m15:41:41.921951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m15:41:41.922319 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:41.924438 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:41:41.924780 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 15:41:41.922439 => 15:41:41.924679
[0m15:41:41.924948 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:41.926160 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:41:41.926609 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:41:41.926781 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:41.926942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:41:43.916995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:41:43.928623 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 15:41:41.925043 => 15:41:43.928249
[0m15:41:43.929211 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m15:41:43.995899 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:41:43.997659 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 15:41:41.913385 => 15:41:43.997472
[0m15:41:43.997947 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m15:41:44.048342 [info ] [Thread-1 (]: 5 of 9 PASS source_unique_northwind_Employees_EmployeeId ....................... [[32mPASS[0m in 2.13s]
[0m15:41:44.048899 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:41:44.049249 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:44.049601 [info ] [Thread-1 (]: 6 of 9 START test source_unique_northwind_Orders_OrderId ....................... [RUN]
[0m15:41:44.050191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m15:41:44.050487 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:44.054353 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:41:44.055790 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 15:41:44.050647 => 15:41:44.055607
[0m15:41:44.056066 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:44.058201 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:41:44.059199 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:41:44.059576 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.059879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:44.125680 [info ] [Thread-4 (]: 4 of 9 PASS source_unique_northwind_Customers_CustomerId ....................... [[32mPASS[0m in 2.24s]
[0m15:41:44.126235 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:41:44.126516 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:44.126814 [info ] [Thread-4 (]: 7 of 9 START test source_unique_northwind_Products_ProductId ................... [RUN]
[0m15:41:44.127327 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m15:41:44.127565 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:44.132018 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:41:44.132799 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 15:41:44.127704 => 15:41:44.132651
[0m15:41:44.133035 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:44.134762 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:41:44.135385 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:41:44.135606 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.135811 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:41:44.292621 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m15:41:44.297441 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 15:41:41.911939 => 15:41:44.297251
[0m15:41:44.297811 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m15:41:44.408728 [info ] [Thread-3 (]: 3 of 9 PASS source_unique_northwind_Categories_CategoryId ...................... [[32mPASS[0m in 2.52s]
[0m15:41:44.409291 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:41:44.409626 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:44.410015 [info ] [Thread-3 (]: 8 of 9 START test source_unique_northwind_Shippers_ShipperID ................... [RUN]
[0m15:41:44.410696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m15:41:44.411021 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:44.414515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:41:44.415190 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 15:41:44.411190 => 15:41:44.415030
[0m15:41:44.415452 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:44.417400 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:41:44.418140 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:41:44.418405 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.418649 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:41:44.497934 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m15:41:44.499682 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 15:41:41.899724 => 15:41:44.499499
[0m15:41:44.499970 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m15:41:44.607472 [info ] [Thread-2 (]: 2 of 9 PASS source_unique_conformed_DateDimension_DateKey ...................... [[32mPASS[0m in 2.72s]
[0m15:41:44.608235 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:41:44.608669 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:44.609098 [info ] [Thread-2 (]: 9 of 9 START test source_unique_northwind_Suppliers_SupplierId ................. [RUN]
[0m15:41:44.609789 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m15:41:44.610131 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:44.614543 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:41:44.615337 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 15:41:44.610326 => 15:41:44.615139
[0m15:41:44.615658 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:44.617925 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:41:44.618744 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:41:44.619042 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:41:44.619316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:41:44.978531 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:44.981197 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 15:41:44.133162 => 15:41:44.980922
[0m15:41:44.981619 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m15:41:45.098330 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:45.102751 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 15:41:44.056222 => 15:41:45.102321
[0m15:41:45.104112 [info ] [Thread-4 (]: 7 of 9 PASS source_unique_northwind_Products_ProductId ......................... [[32mPASS[0m in 0.98s]
[0m15:41:45.104864 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m15:41:45.105600 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:41:45.210914 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:45.213503 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 15:41:44.415601 => 15:41:45.213247
[0m15:41:45.214337 [info ] [Thread-1 (]: 6 of 9 PASS source_unique_northwind_Orders_OrderId ............................. [[32mPASS[0m in 1.16s]
[0m15:41:45.214793 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m15:41:45.215248 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:41:45.248068 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:41:45.249930 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 15:41:44.615844 => 15:41:45.249729
[0m15:41:45.250246 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m15:41:45.398043 [info ] [Thread-3 (]: 8 of 9 PASS source_unique_northwind_Shippers_ShipperID ......................... [[32mPASS[0m in 0.99s]
[0m15:41:45.398582 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:41:45.451975 [info ] [Thread-2 (]: 9 of 9 PASS source_unique_northwind_Suppliers_SupplierId ....................... [[32mPASS[0m in 0.84s]
[0m15:41:45.452527 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:41:45.453862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:45.454098 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7' was properly closed.
[0m15:41:45.454265 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b' was properly closed.
[0m15:41:45.454412 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1' was properly closed.
[0m15:41:45.454552 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45' was properly closed.
[0m15:41:45.454734 [info ] [MainThread]: 
[0m15:41:45.454914 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m15:41:45.455782 [debug] [MainThread]: Command end result
[0m15:41:45.462798 [info ] [MainThread]: 
[0m15:41:45.463076 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:45.463261 [info ] [MainThread]: 
[0m15:41:45.463430 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:41:45.463600 [info ] [MainThread]: 
[0m15:41:45.463774 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:41:45.465543 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.00876, "process_user_time": 1.633943, "process_kernel_time": 0.235274, "process_mem_max_rss": "140591104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:41:45.466062 [debug] [MainThread]: Command `dbt build` failed at 15:41:45.465975 after 4.01 seconds
[0m15:41:45.466333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d2c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28500>]}
[0m15:41:45.466566 [debug] [MainThread]: Flushing usage events
[0m15:57:43.363760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094ddc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fe330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fe090>]}


============================== 15:57:43.366557 | 23bc53e3-988a-4ae6-8602-8027d2b270ce ==============================
[0m15:57:43.366557 [info ] [MainThread]: Running with dbt=1.7.9
[0m15:57:43.366887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:57:43.557644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094fe390>]}
[0m15:57:43.590876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8d4500>]}
[0m15:57:43.591353 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m15:57:43.603749 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m15:57:43.641073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m15:57:43.641443 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_date.yml
[0m15:57:43.641605 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_date.sql
[0m15:57:43.755909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd9c5f0>]}
[0m15:57:43.761826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc83860>]}
[0m15:57:43.762053 [info ] [MainThread]: Found 13 tests, 1 model, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m15:57:43.763149 [info ] [MainThread]: 
[0m15:57:43.763525 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:57:43.764031 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m15:57:43.770049 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m15:57:43.770243 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m15:57:43.770384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:44.720417 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m15:57:44.723759 [debug] [ThreadPool]: On list_analytics: Close
[0m15:57:45.014571 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_northwind_northwind)
[0m15:57:45.016362 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "northwind_northwind"
"
[0m15:57:45.023129 [debug] [ThreadPool]: Using snowflake connection "create_analytics_northwind_northwind"
[0m15:57:45.023598 [debug] [ThreadPool]: On create_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "create_analytics_northwind_northwind"} */
create schema if not exists analytics.northwind_northwind
[0m15:57:45.023949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:45.629325 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:57:45.631639 [debug] [ThreadPool]: On create_analytics_northwind_northwind: Close
[0m15:57:45.759691 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_northwind_northwind, now list_analytics_northwind_northwind)
[0m15:57:45.767310 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m15:57:45.767537 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m15:57:45.767694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:46.180791 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m15:57:46.182826 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m15:57:46.297397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd1e930>]}
[0m15:57:46.299415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:57:46.300076 [info ] [MainThread]: 
[0m15:57:46.361627 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:57:46.361931 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:46.363077 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:46.363297 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:46.363579 [info ] [Thread-1 (]: 1 of 14 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m15:57:46.363848 [info ] [Thread-2 (]: 2 of 14 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m15:57:46.364078 [info ] [Thread-3 (]: 3 of 14 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m15:57:46.364361 [info ] [Thread-4 (]: 4 of 14 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m15:57:46.364857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf)
[0m15:57:46.365278 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m15:57:46.365663 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m15:57:46.366028 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m15:57:46.366231 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:57:46.366416 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:46.366586 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:46.366757 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:46.377293 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:57:46.379632 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:57:46.381817 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:57:46.382326 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 15:57:46.366875 => 15:57:46.382192
[0m15:57:46.383446 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 15:57:46.374011 => 15:57:46.383297
[0m15:57:46.383798 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 15:57:46.377533 => 15:57:46.383645
[0m15:57:46.384039 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:46.384497 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 15:57:46.379817 => 15:57:46.384211
[0m15:57:46.384795 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:46.395755 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:57:46.396057 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:46.397423 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:57:46.398820 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:57:46.399310 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m15:57:46.399844 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m15:57:46.400041 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.400393 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m15:57:46.400598 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.400798 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:57:46.401010 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.401319 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:46.401863 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:46.403926 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:57:46.404384 [error] [Thread-1 (]: 1 of 14 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.04s]
[0m15:57:46.404951 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m15:57:46.405283 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:46.405609 [info ] [Thread-1 (]: 5 of 14 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m15:57:46.405941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m15:57:46.406159 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:46.408939 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:57:46.409332 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 15:57:46.406298 => 15:57:46.409214
[0m15:57:46.409506 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:46.410765 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:57:46.411237 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m15:57:46.411431 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:46.411601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:46.849437 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.861422 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 15:57:46.397675 => 15:57:46.861082
[0m15:57:46.862013 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m15:57:46.864839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.866864 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 15:57:46.384971 => 15:57:46.866649
[0m15:57:46.867324 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m15:57:46.869918 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.871903 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 15:57:46.396224 => 15:57:46.871685
[0m15:57:46.872350 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m15:57:46.873996 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:46.875791 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 15:57:46.409603 => 15:57:46.875612
[0m15:57:46.876138 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m15:57:47.055892 [info ] [Thread-2 (]: 2 of 14 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.69s]
[0m15:57:47.057414 [info ] [Thread-1 (]: 5 of 14 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.65s]
[0m15:57:47.058583 [info ] [Thread-4 (]: 4 of 14 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.69s]
[0m15:57:47.059539 [info ] [Thread-3 (]: 3 of 14 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.69s]
[0m15:57:47.060822 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m15:57:47.061404 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m15:57:47.061916 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m15:57:47.062392 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m15:57:47.062894 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.063774 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.064467 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.064968 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.065433 [info ] [Thread-2 (]: 6 of 14 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m15:57:47.065886 [info ] [Thread-1 (]: 7 of 14 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m15:57:47.066312 [info ] [Thread-4 (]: 8 of 14 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m15:57:47.066705 [info ] [Thread-3 (]: 9 of 14 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m15:57:47.067310 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m15:57:47.067860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m15:57:47.068400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m15:57:47.068922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m15:57:47.069278 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.069613 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.069926 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.070232 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.075505 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:57:47.078718 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:57:47.082115 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:57:47.085310 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:57:47.086131 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 15:57:47.082412 => 15:57:47.085930
[0m15:57:47.086472 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 15:57:47.071764 => 15:57:47.086291
[0m15:57:47.086764 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 15:57:47.075761 => 15:57:47.086619
[0m15:57:47.087068 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 15:57:47.070439 => 15:57:47.086918
[0m15:57:47.087317 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.087600 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.087890 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.088147 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.090213 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:57:47.092037 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:57:47.093770 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:57:47.095449 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:57:47.096311 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m15:57:47.096945 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m15:57:47.097205 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.097757 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m15:57:47.098020 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.098531 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m15:57:47.098789 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:57:47.099040 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.099274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:47.099508 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m15:57:47.100172 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:47.100908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:57:47.436905 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.439428 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 15:57:47.090387 => 15:57:47.439188
[0m15:57:47.439814 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m15:57:47.450093 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.451834 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 15:57:47.088313 => 15:57:47.451627
[0m15:57:47.452176 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m15:57:47.458766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.459368 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m15:57:47.461205 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 15:57:47.093928 => 15:57:47.460984
[0m15:57:47.462816 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 15:57:47.092210 => 15:57:47.462643
[0m15:57:47.463161 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m15:57:47.463441 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m15:57:47.638958 [info ] [Thread-2 (]: 6 of 14 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.57s]
[0m15:57:47.640265 [info ] [Thread-3 (]: 9 of 14 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.57s]
[0m15:57:47.641281 [info ] [Thread-4 (]: 8 of 14 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.57s]
[0m15:57:47.642352 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m15:57:47.642967 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m15:57:47.643482 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m15:57:47.644717 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m15:57:47.644287 [info ] [Thread-1 (]: 7 of 14 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.58s]
[0m15:57:47.645547 [info ] [Thread-2 (]: 10 of 14 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m15:57:47.646125 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m15:57:47.646898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m15:57:47.647476 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m15:57:47.653333 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m15:57:47.654336 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 15:57:47.647731 => 15:57:47.654121
[0m15:57:47.654700 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m15:57:47.674059 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m15:57:47.674881 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m15:57:47.675136 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    datofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m15:57:47.675366 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:57:48.102267 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c529-0000-17c7-0009-ec830002001e
[0m15:57:48.103090 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'DATOFWEEK'
[0m15:57:48.103773 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 15:57:47.654901 => 15:57:48.103504
[0m15:57:48.104231 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m15:57:48.228647 [debug] [Thread-2 (]: Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m15:57:48.229594 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23bc53e3-988a-4ae6-8602-8027d2b270ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a5b20>]}
[0m15:57:48.230385 [error] [Thread-2 (]: 10 of 14 ERROR creating sql table model analytics.northwind_northwind.dim_date . [[31mERROR[0m in 0.58s]
[0m15:57:48.231139 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m15:57:48.232305 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m15:57:48.232739 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m15:57:48.233187 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m15:57:48.233626 [info ] [Thread-3 (]: 11 of 14 SKIP test not_null_dim_date_date ...................................... [[33mSKIP[0m]
[0m15:57:48.234073 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m15:57:48.234526 [info ] [Thread-4 (]: 12 of 14 SKIP test not_null_dim_date_datekey ................................... [[33mSKIP[0m]
[0m15:57:48.234976 [info ] [Thread-1 (]: 13 of 14 SKIP test unique_dim_date_date ........................................ [[33mSKIP[0m]
[0m15:57:48.235405 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m15:57:48.235775 [info ] [Thread-2 (]: 14 of 14 SKIP test unique_dim_date_datekey ..................................... [[33mSKIP[0m]
[0m15:57:48.236204 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m15:57:48.236572 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m15:57:48.237029 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m15:57:48.238878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:48.239174 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45' was properly closed.
[0m15:57:48.239449 [debug] [MainThread]: Connection 'model.northwind.dim_date' was properly closed.
[0m15:57:48.239677 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b' was properly closed.
[0m15:57:48.239909 [debug] [MainThread]: Connection 'test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1' was properly closed.
[0m15:57:48.240239 [info ] [MainThread]: 
[0m15:57:48.240518 [info ] [MainThread]: Finished running 13 tests, 1 table model in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m15:57:48.242002 [debug] [MainThread]: Command end result
[0m15:57:48.250158 [info ] [MainThread]: 
[0m15:57:48.250492 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:57:48.250727 [info ] [MainThread]: 
[0m15:57:48.250965 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:57:48.251196 [info ] [MainThread]: 
[0m15:57:48.251419 [error] [MainThread]:   Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m15:57:48.251650 [info ] [MainThread]: 
[0m15:57:48.251881 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=2 SKIP=4 TOTAL=14
[0m15:57:48.253505 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.9194803, "process_user_time": 1.790067, "process_kernel_time": 0.228605, "process_mem_max_rss": "142524416", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:57:48.253897 [debug] [MainThread]: Command `dbt build` failed at 15:57:48.253810 after 4.92 seconds
[0m15:57:48.254183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d2c2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf48830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e844f50>]}
[0m15:57:48.254456 [debug] [MainThread]: Flushing usage events
[0m16:04:54.528075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10314e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10509b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583a090>]}


============================== 16:04:54.530716 | f9894226-d999-4952-8cca-e0ea80466301 ==============================
[0m16:04:54.530716 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:04:54.531013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:04:54.730686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e78980>]}
[0m16:04:54.766159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066945f0>]}
[0m16:04:54.766825 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:04:54.780140 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:04:54.823411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:04:54.823810 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_customer.yml
[0m16:04:54.823989 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_customer.sql
[0m16:04:54.949404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e7080>]}
[0m16:04:54.957417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106870590>]}
[0m16:04:54.957687 [info ] [MainThread]: Found 17 tests, 2 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:04:54.958951 [info ] [MainThread]: 
[0m16:04:54.959349 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:04:54.959900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:04:54.966334 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:04:54.966523 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:04:54.966666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:56.018147 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:04:56.021737 [debug] [ThreadPool]: On list_analytics: Close
[0m16:04:56.192326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:04:56.205191 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:04:56.205654 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:04:56.205934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:56.940930 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m16:04:56.944372 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:04:57.070866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077889b0>]}
[0m16:04:57.072759 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:57.073433 [info ] [MainThread]: 
[0m16:04:57.077976 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:04:57.078470 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.078912 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.079325 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.079744 [info ] [Thread-1 (]: 1 of 19 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:04:57.080494 [info ] [Thread-2 (]: 2 of 19 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:04:57.081146 [info ] [Thread-3 (]: 3 of 19 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:04:57.081571 [info ] [Thread-4 (]: 4 of 19 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:04:57.082358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf)
[0m16:04:57.083131 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:04:57.083793 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:04:57.084390 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:04:57.084726 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:04:57.085051 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.085336 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.085620 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.101706 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:04:57.104835 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:04:57.107762 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:04:57.108425 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 16:04:57.085818 => 16:04:57.108231
[0m16:04:57.109571 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:04:57.101975 => 16:04:57.109429
[0m16:04:57.109864 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:04:57.096869 => 16:04:57.109705
[0m16:04:57.110120 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:04:57.105062 => 16:04:57.109999
[0m16:04:57.110439 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.110665 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.110916 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.124624 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:04:57.126237 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:04:57.127854 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:04:57.128637 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:04:57.128987 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.129426 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:04:57.129838 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:04:57.130088 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:04:57.130305 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.130691 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.131116 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:04:57.131731 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:04:57.133781 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:04:57.134142 [error] [Thread-1 (]: 1 of 19 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.05s]
[0m16:04:57.134980 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:04:57.135208 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.135449 [info ] [Thread-1 (]: 5 of 19 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:04:57.135808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:04:57.135996 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.139173 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:04:57.139587 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:04:57.136137 => 16:04:57.139456
[0m16:04:57.139788 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.141291 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:04:57.141827 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:04:57.142028 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.142212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:57.557468 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.569016 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:04:57.111071 => 16:04:57.568659
[0m16:04:57.570717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.571364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.571975 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:57.572319 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:04:57.574105 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:04:57.124799 => 16:04:57.573906
[0m16:04:57.575714 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:04:57.139903 => 16:04:57.575525
[0m16:04:57.577284 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:04:57.126452 => 16:04:57.577088
[0m16:04:57.578516 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:04:57.579195 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:04:57.579570 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:04:57.689278 [info ] [Thread-3 (]: 3 of 19 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.61s]
[0m16:04:57.690719 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:04:57.691583 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:57.692632 [info ] [Thread-3 (]: 6 of 19 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:04:57.693629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:04:57.694106 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:57.700623 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:04:57.696279 [info ] [Thread-1 (]: 5 of 19 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.56s]
[0m16:04:57.701851 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:04:57.702399 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:57.704191 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:04:57.694836 => 16:04:57.703991
[0m16:04:57.705289 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:57.703398 [info ] [Thread-2 (]: 2 of 19 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.62s]
[0m16:04:57.708250 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:04:57.703800 [info ] [Thread-1 (]: 7 of 19 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:04:57.708819 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:04:57.705007 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.62s]
[0m16:04:57.709527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:04:57.709963 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:57.710735 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:04:57.711198 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:04:57.711517 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:57.711822 [info ] [Thread-2 (]: 8 of 19 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:04:57.712209 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.712618 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:57.716346 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:04:57.716906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:04:57.717193 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:04:57.717484 [info ] [Thread-4 (]: 9 of 19 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:04:57.717846 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:57.719018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:04:57.719311 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:04:57.712899 => 16:04:57.719171
[0m16:04:57.722328 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:04:57.722630 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:57.723072 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:57.726308 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:04:57.728294 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:04:57.728600 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:04:57.719505 => 16:04:57.728465
[0m16:04:57.728940 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:57.730629 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:04:57.730964 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:04:57.723467 => 16:04:57.730832
[0m16:04:57.731439 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:04:57.731703 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:57.731958 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.732401 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:04:57.735116 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:04:57.735399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:57.735648 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.736296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:57.736900 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:04:57.737756 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:57.738091 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:58.157938 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.162764 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:04:57.732545 => 16:04:58.162309
[0m16:04:58.164133 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.164580 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:04:58.167490 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:04:57.705595 => 16:04:58.167115
[0m16:04:58.169416 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:04:58.172292 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.174616 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:04:57.729118 => 16:04:58.174340
[0m16:04:58.175415 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:04:58.179913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:04:58.181631 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:04:57.726554 => 16:04:58.181428
[0m16:04:58.181962 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:04:58.287359 [info ] [Thread-4 (]: 9 of 19 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.57s]
[0m16:04:58.289681 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.58s]
[0m16:04:58.290609 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:04:58.292931 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:04:58.291664 [info ] [Thread-3 (]: 6 of 19 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:04:58.292457 [info ] [Thread-2 (]: 8 of 19 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.58s]
[0m16:04:58.293638 [debug] [Thread-4 (]: Began running node model.northwind.dim_date
[0m16:04:58.294160 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:04:58.294746 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:04:58.295230 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:04:58.295688 [info ] [Thread-4 (]: 10 of 19 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:04:58.296138 [info ] [Thread-1 (]: 11 of 19 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:04:58.297001 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_date)
[0m16:04:58.297634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m16:04:58.297991 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_date
[0m16:04:58.298371 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:04:58.302053 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:04:58.305768 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:04:58.307490 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (compile): 16:04:58.298630 => 16:04:58.307311
[0m16:04:58.307822 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:04:58.302324 => 16:04:58.307653
[0m16:04:58.308080 [debug] [Thread-4 (]: Began executing node model.northwind.dim_date
[0m16:04:58.308330 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:04:58.326670 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:04:58.328565 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:04:58.329302 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:04:58.329570 [debug] [Thread-4 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    datofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:04:58.329808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:58.330292 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:04:58.331173 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:04:58.331410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:58.790184 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c530-0000-17c7-0009-ec830002008e
[0m16:04:58.790961 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 4
invalid identifier 'DATOFWEEK'
[0m16:04:58.791663 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (execute): 16:04:58.308487 => 16:04:58.791387
[0m16:04:58.792133 [debug] [Thread-4 (]: On model.northwind.dim_date: Close
[0m16:04:58.908603 [debug] [Thread-4 (]: Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m16:04:58.909313 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ede80>]}
[0m16:04:58.910046 [error] [Thread-4 (]: 10 of 19 ERROR creating sql table model analytics.northwind_northwind.dim_date . [[31mERROR[0m in 0.61s]
[0m16:04:58.910793 [debug] [Thread-4 (]: Finished running node model.northwind.dim_date
[0m16:04:58.911440 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:04:58.911870 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:04:58.912315 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:04:58.912672 [info ] [Thread-3 (]: 12 of 19 SKIP test not_null_dim_date_date ...................................... [[33mSKIP[0m]
[0m16:04:58.913109 [info ] [Thread-2 (]: 13 of 19 SKIP test not_null_dim_date_datekey ................................... [[33mSKIP[0m]
[0m16:04:58.913557 [info ] [Thread-4 (]: 14 of 19 SKIP test unique_dim_date_date ........................................ [[33mSKIP[0m]
[0m16:04:58.914030 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:04:58.914419 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:04:58.914795 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:04:58.915174 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:04:58.915748 [info ] [Thread-3 (]: 15 of 19 SKIP test unique_dim_date_datekey ..................................... [[33mSKIP[0m]
[0m16:04:58.916152 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:04:59.366246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:04:59.382564 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:04:58.326884 => 16:04:59.382379
[0m16:04:59.382910 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:04:59.568503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9894226-d999-4952-8cca-e0ea80466301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f58e90>]}
[0m16:04:59.570038 [info ] [Thread-1 (]: 11 of 19 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.27s]
[0m16:04:59.571070 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:04:59.572243 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:04:59.572834 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:04:59.573337 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:04:59.573753 [info ] [Thread-2 (]: 16 of 19 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:04:59.574285 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:04:59.574712 [info ] [Thread-4 (]: 17 of 19 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:04:59.575248 [info ] [Thread-3 (]: 18 of 19 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:04:59.576073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:04:59.576479 [info ] [Thread-1 (]: 19 of 19 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:04:59.577165 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:04:59.577799 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:04:59.578207 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:04:59.578809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:04:59.579160 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:04:59.579578 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:04:59.580762 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:04:59.591425 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:04:59.592517 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:04:59.597382 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:04:59.600161 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:04:59.601118 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:04:59.579800 => 16:04:59.600845
[0m16:04:59.601581 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:04:59.587314 => 16:04:59.601366
[0m16:04:59.601973 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:04:59.592825 => 16:04:59.601759
[0m16:04:59.602303 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:04:59.602655 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:04:59.597601 => 16:04:59.602490
[0m16:04:59.602946 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:04:59.603216 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:04:59.605481 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:04:59.605748 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:04:59.607610 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:04:59.609435 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:04:59.611352 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:04:59.612016 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:04:59.612467 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:04:59.612908 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:04:59.613128 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:04:59.613415 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:04:59.613877 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:04:59.614125 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:59.614356 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:04:59.614552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:04:59.614763 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:04:59.614971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:04:59.616318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:05:00.176521 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.182376 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:04:59.605914 => 16:05:00.181899
[0m16:05:00.183128 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:05:00.185960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.188845 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:04:59.603380 => 16:05:00.188583
[0m16:05:00.189418 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:05:00.311535 [info ] [Thread-4 (]: 17 of 19 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.73s]
[0m16:05:00.313435 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:05:00.317447 [info ] [Thread-2 (]: 16 of 19 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.74s]
[0m16:05:00.318289 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:05:00.687925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.689265 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:05:00.693370 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:04:59.609695 => 16:05:00.692957
[0m16:05:00.696752 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:04:59.607780 => 16:05:00.696321
[0m16:05:00.697386 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:05:00.697816 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:05:00.825228 [info ] [Thread-3 (]: 18 of 19 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.25s]
[0m16:05:00.827651 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:05:00.876495 [info ] [Thread-1 (]: 19 of 19 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.30s]
[0m16:05:00.877087 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:05:00.878523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:00.878798 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerkey.183274e37c' was properly closed.
[0m16:05:00.879002 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_customer_customerid.4d829c4322' was properly closed.
[0m16:05:00.879188 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerid.04913d3698' was properly closed.
[0m16:05:00.879361 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_customer_customerkey.904a936983' was properly closed.
[0m16:05:00.879593 [info ] [MainThread]: 
[0m16:05:00.879812 [info ] [MainThread]: Finished running 17 tests, 2 table models in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m16:05:00.881344 [debug] [MainThread]: Command end result
[0m16:05:00.890608 [info ] [MainThread]: 
[0m16:05:00.891450 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:05:00.891996 [info ] [MainThread]: 
[0m16:05:00.892476 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:05:00.892734 [info ] [MainThread]: 
[0m16:05:00.892927 [error] [MainThread]:   Database Error in model dim_date (models/dim_date.sql)
  000904 (42000): SQL compilation error: error line 10 at position 4
  invalid identifier 'DATOFWEEK'
  compiled Code at target/run/northwind/models/dim_date.sql
[0m16:05:00.893118 [info ] [MainThread]: 
[0m16:05:00.893316 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=2 SKIP=4 TOTAL=19
[0m16:05:00.895067 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.398954, "process_user_time": 2.030513, "process_kernel_time": 0.238578, "process_mem_max_rss": "141967360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:05:00.895453 [debug] [MainThread]: Command `dbt build` failed at 16:05:00.895376 after 6.40 seconds
[0m16:05:00.895697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106af57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10314e2d0>]}
[0m16:05:00.895959 [debug] [MainThread]: Flushing usage events
[0m16:07:02.434640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d2270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f6390>]}


============================== 16:07:02.437451 | 101a2a02-c055-4e74-9c14-98cd8fd1886c ==============================
[0m16:07:02.437451 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:07:02.437792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:07:02.630590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fed0d0>]}
[0m16:07:02.664199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112932b70>]}
[0m16:07:02.664774 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:07:02.676819 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:07:02.714060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:07:02.714473 [debug] [MainThread]: Partial parsing: updated file: northwind://models/sources.yml
[0m16:07:02.714696 [debug] [MainThread]: Partial parsing: updated file: northwind://models/dim_date.sql
[0m16:07:02.827280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146a83b0>]}
[0m16:07:02.834236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11359a570>]}
[0m16:07:02.834445 [info ] [MainThread]: Found 17 tests, 2 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:07:02.835531 [info ] [MainThread]: 
[0m16:07:02.835919 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:02.836437 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:07:02.842571 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:07:02.842759 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:07:02.842897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:03.919848 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:07:03.923162 [debug] [ThreadPool]: On list_analytics: Close
[0m16:07:04.066217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:07:04.077733 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:07:04.078294 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:07:04.078626 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:04.580679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:04.583753 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:07:04.706726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077c860>]}
[0m16:07:04.708084 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:04.708509 [info ] [MainThread]: 
[0m16:07:04.712455 [debug] [Thread-1 (]: Began running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:07:04.713031 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:04.713493 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:04.713916 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:04.714338 [info ] [Thread-1 (]: 1 of 19 START test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:07:04.714837 [info ] [Thread-2 (]: 2 of 19 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:07:04.715305 [info ] [Thread-3 (]: 3 of 19 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:07:04.715722 [info ] [Thread-4 (]: 4 of 19 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:07:04.718275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf)
[0m16:07:04.718981 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:07:04.719608 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:07:04.720217 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:07:04.720760 [debug] [Thread-1 (]: Began compiling node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:07:04.721226 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:04.721551 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:04.721869 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:04.775326 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:04.777621 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:04.778124 [debug] [Thread-1 (]: Timing info for test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf (compile): 16:07:04.722095 => 16:07:04.777969
[0m16:07:04.780334 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:04.781698 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:07:04.775590 => 16:07:04.781522
[0m16:07:04.781964 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:07:04.771722 => 16:07:04.781834
[0m16:07:04.782237 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:04.782519 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:07:04.778288 => 16:07:04.782402
[0m16:07:04.782693 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:04.793720 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:04.793966 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:04.795400 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:04.796815 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:04.797335 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:04.797830 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:04.798129 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.798351 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.798689 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:04.798886 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:04.799081 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:04.799321 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.800786 [debug] [Thread-1 (]: Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:07:04.801106 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:04.801386 [error] [Thread-1 (]: 1 of 19 ERROR source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[31mERROR[0m in 0.09s]
[0m16:07:04.801872 [debug] [Thread-1 (]: Finished running node test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf
[0m16:07:04.802202 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:04.802451 [info ] [Thread-1 (]: 5 of 19 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:07:04.802798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.c7be588bdf, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:07:04.803042 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:04.805792 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:04.806115 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:07:04.803799 => 16:07:04.806012
[0m16:07:04.806363 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:04.808419 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:04.808907 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:04.809094 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:04.809262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:05.284719 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:05.297444 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:07:04.794150 => 16:07:05.297082
[0m16:07:05.299493 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:07:05.476912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:05.479173 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:05.483483 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:07:04.782856 => 16:07:05.483044
[0m16:07:05.486724 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:07:04.795639 => 16:07:05.486399
[0m16:07:05.487515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:05.487912 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:07:05.488317 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:07:05.490712 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:07:04.806497 => 16:07:05.490472
[0m16:07:05.493866 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:07:05.494869 [info ] [Thread-2 (]: 2 of 19 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.78s]
[0m16:07:05.496243 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:05.496975 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:05.498224 [info ] [Thread-2 (]: 6 of 19 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:07:05.499364 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:07:05.499744 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:05.504017 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:05.504752 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:07:05.499934 => 16:07:05.504587
[0m16:07:05.505034 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:05.507146 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:05.508377 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:05.508677 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.508957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:05.604202 [info ] [Thread-1 (]: 5 of 19 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.80s]
[0m16:07:05.604818 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.88s]
[0m16:07:05.605382 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:05.605736 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:05.606030 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:05.606361 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:05.606749 [info ] [Thread-1 (]: 7 of 19 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:07:05.607061 [info ] [Thread-4 (]: 8 of 19 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:07:05.607570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:07:05.608028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:07:05.608291 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:05.608518 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:05.611573 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:05.614280 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:05.615176 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:07:05.611757 => 16:07:05.614982
[0m16:07:05.615476 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:07:05.608662 => 16:07:05.615340
[0m16:07:05.615699 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:05.616191 [info ] [Thread-3 (]: 3 of 19 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.90s]
[0m16:07:05.616459 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:05.618230 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:05.618596 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:05.620226 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:05.620565 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:05.621250 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:05.621524 [info ] [Thread-3 (]: 9 of 19 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:07:05.621839 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.622303 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:05.622690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:07:05.622908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:05.623125 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.623351 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:05.623876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:05.626556 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:05.627653 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:07:05.624020 => 16:07:05.627520
[0m16:07:05.627873 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:05.629389 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:05.630573 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:05.630811 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:05.631039 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:05.913921 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:05.921439 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:07:05.505200 => 16:07:05.921095
[0m16:07:05.922136 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:07:06.008782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:06.010566 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:06.014544 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:07:05.618743 => 16:07:06.014213
[0m16:07:06.015532 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:06.018590 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:07:05.627989 => 16:07:06.018141
[0m16:07:06.019340 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:07:06.021445 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:07:05.616600 => 16:07:06.021194
[0m16:07:06.021842 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:07:06.023306 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:07:06.044465 [info ] [Thread-2 (]: 6 of 19 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.55s]
[0m16:07:06.045050 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:06.045441 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:07:06.045920 [info ] [Thread-2 (]: 10 of 19 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:07:06.046591 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:07:06.046921 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:07:06.050251 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:07:06.051117 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:07:06.047111 => 16:07:06.050938
[0m16:07:06.051424 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:07:06.070356 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:07:06.071136 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:07:06.071402 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:07:06.071637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:06.138645 [info ] [Thread-3 (]: 9 of 19 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.52s]
[0m16:07:06.139221 [info ] [Thread-4 (]: 8 of 19 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.53s]
[0m16:07:06.139698 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:06.140004 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:06.140265 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m16:07:06.140641 [info ] [Thread-3 (]: 11 of 19 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:07:06.141097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.dim_customer)
[0m16:07:06.141321 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m16:07:06.150954 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:07:06.151905 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 16:07:06.141454 => 16:07:06.151713
[0m16:07:06.152163 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m16:07:06.154306 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:07:06.155478 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:07:06.155743 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:07:06.155968 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:06.158960 [info ] [Thread-1 (]: 7 of 19 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.55s]
[0m16:07:06.159314 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:07.030719 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:07.032418 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:07.055386 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 16:07:06.152306 => 16:07:07.055179
[0m16:07:07.057364 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:07:06.051581 => 16:07:07.057196
[0m16:07:07.057700 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m16:07:07.057969 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:07:07.178963 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d53e90>]}
[0m16:07:07.180000 [info ] [Thread-3 (]: 11 of 19 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.04s]
[0m16:07:07.180741 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m16:07:07.181993 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.182666 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:07.183198 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:07.183782 [info ] [Thread-4 (]: 12 of 19 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:07:07.184299 [info ] [Thread-1 (]: 13 of 19 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:07:07.184774 [info ] [Thread-3 (]: 14 of 19 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:07:07.186078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:07:07.186922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:07:07.187562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:07:07.187936 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:07.188267 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.188592 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:07.195822 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:07.199659 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:07.202782 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:07.203521 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:07:07.188800 => 16:07:07.203333
[0m16:07:07.203870 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:07:07.196158 => 16:07:07.203696
[0m16:07:07.204172 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:07.204503 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.204851 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:07:07.199880 => 16:07:07.204659
[0m16:07:07.207074 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:07.210263 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:07.210531 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:07.212542 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:07.213182 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:07.213655 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:07.213931 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:07:07.214437 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:07.214980 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:07:07.215274 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:07.215552 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:07.215817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:07.216709 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:07.217205 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '101a2a02-c055-4e74-9c14-98cd8fd1886c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136475c0>]}
[0m16:07:07.218598 [info ] [Thread-2 (]: 10 of 19 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.17s]
[0m16:07:07.219305 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:07:07.219588 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:07.220256 [info ] [Thread-2 (]: 15 of 19 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:07:07.220993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:07:07.221215 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:07.223970 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:07.224439 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:07:07.221343 => 16:07:07.224303
[0m16:07:07.224649 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:07.226408 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:07.227017 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:07.227243 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:07.227455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:07.669296 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:07.674433 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:07:07.207282 => 16:07:07.674122
[0m16:07:07.675428 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:07:07.801099 [info ] [Thread-4 (]: 12 of 19 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.62s]
[0m16:07:07.802361 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:07.802945 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:07.803490 [info ] [Thread-4 (]: 16 of 19 START test not_null_dim_date_date ..................................... [RUN]
[0m16:07:07.804389 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:07:07.805331 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:07.811507 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:07.812667 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:07:07.805668 => 16:07:07.812424
[0m16:07:07.813075 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:07.816030 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:07.817091 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:07.817443 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:07:07.817752 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:08.074696 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.077869 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:07:07.210830 => 16:07:08.077606
[0m16:07:08.078302 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:07:08.198076 [info ] [Thread-3 (]: 14 of 19 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.01s]
[0m16:07:08.199184 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:08.199810 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:08.200362 [info ] [Thread-3 (]: 17 of 19 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:07:08.201225 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:07:08.201888 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:08.208422 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:08.209579 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:07:08.202541 => 16:07:08.209344
[0m16:07:08.209981 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:08.212934 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:08.213948 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:08.214325 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:07:08.214669 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:08.220093 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.220790 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.222867 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:07:07.224772 => 16:07:08.222627
[0m16:07:08.224436 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:07:07.205044 => 16:07:08.224270
[0m16:07:08.224740 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:07:08.225010 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:07:08.337896 [info ] [Thread-1 (]: 13 of 19 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 1.15s]
[0m16:07:08.338602 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:08.339034 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:08.339378 [info ] [Thread-1 (]: 18 of 19 START test unique_dim_date_date ....................................... [RUN]
[0m16:07:08.340068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:07:08.340448 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:08.346543 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:08.347681 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:07:08.340656 => 16:07:08.347497
[0m16:07:08.348066 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:08.350436 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:08.351110 [info ] [Thread-2 (]: 15 of 19 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.13s]
[0m16:07:08.351662 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:08.351960 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:08.352295 [info ] [Thread-2 (]: 19 of 19 START test unique_dim_date_datekey .................................... [RUN]
[0m16:07:08.352804 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:07:08.353068 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:08.353660 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:08.356836 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:08.357136 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:08.357446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:08.358250 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:07:08.353820 => 16:07:08.358099
[0m16:07:08.358705 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:08.360557 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:08.361554 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:08.361821 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:08.362056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:08.530887 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:08.535420 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:07:07.813313 => 16:07:08.535130
[0m16:07:08.536361 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:07:08.656111 [info ] [Thread-4 (]: 16 of 19 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.85s]
[0m16:07:08.657346 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:08.670852 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:08.673321 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:07:08.210290 => 16:07:08.673064
[0m16:07:08.673720 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:07:08.795363 [info ] [Thread-3 (]: 17 of 19 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.59s]
[0m16:07:08.796069 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:09.164906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:09.171653 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:07:08.348249 => 16:07:09.170974
[0m16:07:09.172223 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:07:09.184027 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:09.186468 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:07:08.358879 => 16:07:09.186210
[0m16:07:09.186880 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:07:09.284065 [info ] [Thread-1 (]: 18 of 19 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.94s]
[0m16:07:09.285279 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:09.318880 [info ] [Thread-2 (]: 19 of 19 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.97s]
[0m16:07:09.319654 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:09.321540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:09.321855 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_date.dd069a8d31' was properly closed.
[0m16:07:09.322083 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:07:09.322279 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_datekey.1af65c721b' was properly closed.
[0m16:07:09.322462 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_date.78f11e7735' was properly closed.
[0m16:07:09.322747 [info ] [MainThread]: 
[0m16:07:09.323002 [info ] [MainThread]: Finished running 17 tests, 2 table models in 0 hours 0 minutes and 6.49 seconds (6.49s).
[0m16:07:09.324932 [debug] [MainThread]: Command end result
[0m16:07:09.332757 [info ] [MainThread]: 
[0m16:07:09.333022 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:07:09.333208 [info ] [MainThread]: 
[0m16:07:09.333396 [error] [MainThread]:   Compilation Error in test source_dbt_utils_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId (models/sources.yml)
  'test_dbt_utils_unique_combination_of_columns' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m16:07:09.333595 [info ] [MainThread]: 
[0m16:07:09.333782 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 TOTAL=19
[0m16:07:09.335401 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 6.929038, "process_user_time": 2.196352, "process_kernel_time": 0.260168, "process_mem_max_rss": "147750912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:07:09.335787 [debug] [MainThread]: Command `dbt build` failed at 16:07:09.335703 after 6.93 seconds
[0m16:07:09.336046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128d3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115deebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b694f0>]}
[0m16:07:09.336287 [debug] [MainThread]: Flushing usage events
[0m16:07:36.016371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e3c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e090>]}


============================== 16:07:36.018890 | b7b2e8b9-35b8-4e6a-97cc-273cc4243c66 ==============================
[0m16:07:36.018890 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:07:36.019205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:07:36.200640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baa2d0>]}
[0m16:07:36.239854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ad670>]}
[0m16:07:36.240695 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:07:36.252338 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:07:36.286392 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:07:36.286942 [debug] [MainThread]: Partial parsing: updated file: northwind://models/sources.yml
[0m16:07:36.457972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108904e90>]}
[0m16:07:36.494447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088baed0>]}
[0m16:07:36.494739 [info ] [MainThread]: Found 17 tests, 2 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:07:36.495909 [info ] [MainThread]: 
[0m16:07:36.496305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:07:36.496862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:07:36.503035 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:07:36.503228 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:07:36.503381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:37.476860 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:07:37.480257 [debug] [ThreadPool]: On list_analytics: Close
[0m16:07:37.598265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:07:37.609935 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:07:37.610318 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:07:37.610597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:38.221799 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:07:38.225412 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:07:38.484328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759c800>]}
[0m16:07:38.485927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:38.486868 [info ] [MainThread]: 
[0m16:07:38.490935 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:38.491412 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:38.491816 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:38.492228 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:38.492628 [info ] [Thread-1 (]: 1 of 19 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:07:38.493071 [info ] [Thread-2 (]: 2 of 19 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:07:38.493468 [info ] [Thread-3 (]: 3 of 19 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:07:38.493845 [info ] [Thread-4 (]: 4 of 19 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:07:38.495458 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:07:38.495911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:07:38.496662 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:07:38.497357 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:07:38.497723 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:38.498027 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:38.498318 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:38.498690 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:38.509268 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:38.513217 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:07:38.516098 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:38.519029 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:38.520071 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:07:38.499261 => 16:07:38.519856
[0m16:07:38.520430 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:07:38.509578 => 16:07:38.520261
[0m16:07:38.520718 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:07:38.513458 => 16:07:38.520579
[0m16:07:38.520990 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:38.521317 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:07:38.516302 => 16:07:38.521130
[0m16:07:38.521594 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:38.521838 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:38.535974 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:38.536271 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:38.537897 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:07:38.539355 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:38.541860 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:38.542485 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:07:38.542933 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:38.543385 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:07:38.543832 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:07:38.544230 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:07:38.544423 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:07:38.544641 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:38.544876 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:07:38.545095 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:38.545678 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:07:38.546055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:38.546267 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:07:39.018689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.031507 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:07:38.521986 => 16:07:39.031165
[0m16:07:39.032802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.033463 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:07:39.035730 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:07:38.536426 => 16:07:39.035514
[0m16:07:39.037197 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:07:39.080496 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:39.082553 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:07:38.538054 => 16:07:39.082310
[0m16:07:39.082956 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:07:39.110570 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:39.113003 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:07:38.539561 => 16:07:39.112718
[0m16:07:39.113462 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:07:39.152157 [info ] [Thread-2 (]: 2 of 19 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.66s]
[0m16:07:39.153992 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:07:39.153266 [info ] [Thread-1 (]: 1 of 19 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.66s]
[0m16:07:39.154532 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.155241 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:07:39.155655 [info ] [Thread-2 (]: 5 of 19 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:07:39.156114 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.156846 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:07:39.157245 [info ] [Thread-1 (]: 6 of 19 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:07:39.157636 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.158305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:07:39.159580 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.163734 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:39.167677 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:39.169408 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:07:39.158558 => 16:07:39.169205
[0m16:07:39.169740 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.170096 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:07:39.164006 => 16:07:39.169903
[0m16:07:39.172332 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:39.172990 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.175406 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:39.176432 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:07:39.176998 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:07:39.177260 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.177555 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.177820 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:39.178041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:39.214602 [info ] [Thread-3 (]: 3 of 19 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.72s]
[0m16:07:39.215180 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:07:39.215510 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.215889 [info ] [Thread-3 (]: 7 of 19 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:07:39.216485 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:07:39.216783 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.220369 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:39.221169 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:07:39.216963 => 16:07:39.221023
[0m16:07:39.221411 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.223494 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:39.224264 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:07:39.224604 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.224979 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:39.231724 [info ] [Thread-4 (]: 4 of 19 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.73s]
[0m16:07:39.232137 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:07:39.232407 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.232787 [info ] [Thread-4 (]: 8 of 19 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:07:39.233214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:07:39.233441 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.236362 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:39.236822 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:07:39.233575 => 16:07:39.236692
[0m16:07:39.237034 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.239693 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:39.240339 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:07:39.240640 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.240887 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:39.553432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.554802 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.558815 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:07:39.173356 => 16:07:39.558480
[0m16:07:39.561827 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:07:39.170343 => 16:07:39.561389
[0m16:07:39.562945 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:07:39.564569 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:07:39.657559 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.658779 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:39.662418 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:07:39.221610 => 16:07:39.662132
[0m16:07:39.665313 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:07:39.237165 => 16:07:39.664899
[0m16:07:39.665966 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:07:39.666457 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:07:39.679975 [info ] [Thread-1 (]: 6 of 19 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.52s]
[0m16:07:39.680648 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:07:39.681095 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:39.681571 [info ] [Thread-1 (]: 9 of 19 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:07:39.682361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:07:39.682760 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:39.687578 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:39.688498 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:07:39.682998 => 16:07:39.688299
[0m16:07:39.688827 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:39.691403 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:39.692223 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:07:39.692532 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:39.692812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:39.712141 [info ] [Thread-2 (]: 5 of 19 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.56s]
[0m16:07:39.712690 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:07:39.713018 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:07:39.713391 [info ] [Thread-2 (]: 10 of 19 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:07:39.713947 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_date)
[0m16:07:39.714242 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:07:39.716710 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:07:39.717277 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:07:39.714400 => 16:07:39.717118
[0m16:07:39.717535 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:07:39.735545 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:07:39.737037 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:07:39.737291 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:07:39.737574 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:39.793062 [info ] [Thread-4 (]: 8 of 19 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.56s]
[0m16:07:39.793691 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:07:39.793988 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m16:07:39.794286 [info ] [Thread-4 (]: 11 of 19 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:07:39.794673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:07:39.794865 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m16:07:39.795315 [info ] [Thread-3 (]: 7 of 19 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.58s]
[0m16:07:39.797929 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:07:39.798271 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:07:39.798719 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 16:07:39.795483 => 16:07:39.798604
[0m16:07:39.798912 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m16:07:39.800530 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:07:39.801104 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:07:39.801300 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:07:39.801492 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:40.064744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:07:40.066591 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:07:39.689022 => 16:07:40.066373
[0m16:07:40.066935 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:07:40.183063 [info ] [Thread-1 (]: 9 of 19 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.50s]
[0m16:07:40.184240 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:07:40.511889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:40.512913 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:40.533114 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:07:39.717691 => 16:07:40.532911
[0m16:07:40.535360 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 16:07:39.799026 => 16:07:40.535190
[0m16:07:40.535787 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:07:40.536060 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m16:07:40.652359 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099764b0>]}
[0m16:07:40.653587 [info ] [Thread-4 (]: 11 of 19 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.86s]
[0m16:07:40.654478 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m16:07:40.655276 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:40.655763 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:40.656264 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:40.656695 [info ] [Thread-3 (]: 12 of 19 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:07:40.657692 [info ] [Thread-1 (]: 13 of 19 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:07:40.658363 [info ] [Thread-4 (]: 14 of 19 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:07:40.659339 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:07:40.660092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:07:40.661292 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:40.661939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:07:40.662772 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b2e8b9-35b8-4e6a-97cc-273cc4243c66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ee240>]}
[0m16:07:40.663193 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:40.671831 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:40.672238 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:40.672703 [info ] [Thread-2 (]: 10 of 19 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.95s]
[0m16:07:40.676056 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:40.679506 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:40.679964 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:07:40.680503 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:40.681028 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:07:40.663431 => 16:07:40.680781
[0m16:07:40.681762 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:07:40.672941 => 16:07:40.681593
[0m16:07:40.681342 [info ] [Thread-2 (]: 15 of 19 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:07:40.682145 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:07:40.676396 => 16:07:40.682012
[0m16:07:40.682369 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:40.682602 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:40.683065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:07:40.683316 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:40.685436 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:40.691450 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:40.691776 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:40.693835 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:40.697283 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:40.697966 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:07:40.698507 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:07:40.698819 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:07:40.699346 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:07:40.699647 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:07:40.699917 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:40.700190 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:07:40.694237 => 16:07:40.700053
[0m16:07:40.700446 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:40.700674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:40.701382 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:40.701843 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:40.704214 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:40.705969 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:07:40.706225 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:40.706441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:41.361437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.362756 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.366728 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:07:40.689559 => 16:07:41.366174
[0m16:07:41.369830 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:07:40.683460 => 16:07:41.369420
[0m16:07:41.370420 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:07:41.370821 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:07:41.563286 [info ] [Thread-1 (]: 13 of 19 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.90s]
[0m16:07:41.564644 [info ] [Thread-3 (]: 12 of 19 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.91s]
[0m16:07:41.565890 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:07:41.566540 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:07:41.567083 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:41.567751 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:41.568337 [info ] [Thread-1 (]: 16 of 19 START test not_null_dim_date_date ..................................... [RUN]
[0m16:07:41.568810 [info ] [Thread-3 (]: 17 of 19 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:07:41.569760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:07:41.570489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:07:41.570847 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:41.571176 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:41.578135 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:41.583776 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:41.584966 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:07:41.571383 => 16:07:41.584742
[0m16:07:41.585385 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:07:41.573423 => 16:07:41.585163
[0m16:07:41.585785 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:41.586091 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:41.588479 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:41.590532 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:41.591333 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:07:41.591723 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:07:41.592039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:41.592521 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:07:41.593293 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:07:41.593809 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:07:41.811179 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.814223 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:07:40.691938 => 16:07:41.813879
[0m16:07:41.815113 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:07:41.817077 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:41.819484 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:07:40.702383 => 16:07:41.819234
[0m16:07:41.819930 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:07:41.947105 [info ] [Thread-2 (]: 15 of 19 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.26s]
[0m16:07:41.948264 [info ] [Thread-4 (]: 14 of 19 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.29s]
[0m16:07:41.949611 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:07:41.950436 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:07:41.951002 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:41.951687 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:41.952276 [info ] [Thread-2 (]: 18 of 19 START test unique_dim_date_date ....................................... [RUN]
[0m16:07:41.952924 [info ] [Thread-4 (]: 19 of 19 START test unique_dim_date_datekey .................................... [RUN]
[0m16:07:41.953988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:07:41.954806 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:07:41.955196 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:41.955537 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:41.961078 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:41.964939 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:41.965790 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:07:41.961391 => 16:07:41.965538
[0m16:07:41.966220 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:07:41.955755 => 16:07:41.966028
[0m16:07:41.966521 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:41.966835 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:41.969273 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:41.971284 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:41.972137 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:07:41.972437 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:41.973063 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:07:41.973351 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:07:41.973687 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:07:41.974728 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:07:42.201039 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.204377 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:07:41.588693 => 16:07:42.204013
[0m16:07:42.204914 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:07:42.207371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.209743 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:07:41.586265 => 16:07:42.209503
[0m16:07:42.210185 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:07:42.331082 [info ] [Thread-3 (]: 17 of 19 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.76s]
[0m16:07:42.332596 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:07:42.335866 [info ] [Thread-1 (]: 16 of 19 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.77s]
[0m16:07:42.336943 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:07:42.608348 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.613624 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:07:41.969468 => 16:07:42.613233
[0m16:07:42.614277 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:07:42.644593 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:07:42.648903 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:07:41.967043 => 16:07:42.648558
[0m16:07:42.649509 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:07:42.778988 [info ] [Thread-2 (]: 18 of 19 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.83s]
[0m16:07:42.780050 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:07:42.794229 [info ] [Thread-4 (]: 19 of 19 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.84s]
[0m16:07:42.795083 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:07:42.797158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:42.797516 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_date.78f11e7735' was properly closed.
[0m16:07:42.797779 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_date.dd069a8d31' was properly closed.
[0m16:07:42.798011 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_datekey.1af65c721b' was properly closed.
[0m16:07:42.798234 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:07:42.798564 [info ] [MainThread]: 
[0m16:07:42.798865 [info ] [MainThread]: Finished running 17 tests, 2 table models in 0 hours 0 minutes and 6.30 seconds (6.30s).
[0m16:07:42.801117 [debug] [MainThread]: Command end result
[0m16:07:42.810200 [info ] [MainThread]: 
[0m16:07:42.810508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:42.810823 [info ] [MainThread]: 
[0m16:07:42.811163 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m16:07:42.813605 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.823697, "process_user_time": 2.308323, "process_kernel_time": 0.244481, "process_mem_max_rss": "145129472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:07:42.813967 [debug] [MainThread]: Command `dbt build` succeeded at 16:07:42.813885 after 6.82 seconds
[0m16:07:42.814212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108865b20>]}
[0m16:07:42.814456 [debug] [MainThread]: Flushing usage events
[0m16:09:57.671928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f2450>]}


============================== 16:09:57.674506 | 397d648b-4626-4f06-9f0e-548a053f3e95 ==============================
[0m16:09:57.674506 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:09:57.674836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'version_check': 'True', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:09:57.875215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da98e0>]}
[0m16:09:57.912968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053309b0>]}
[0m16:09:57.913712 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:09:57.927001 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:09:57.965753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:09:57.966148 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_employee.sql
[0m16:09:57.966332 [debug] [MainThread]: Partial parsing: added file: northwind://models/dim_employee.yml
[0m16:09:58.091887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc6f30>]}
[0m16:09:58.099938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca2030>]}
[0m16:09:58.100197 [info ] [MainThread]: Found 21 tests, 3 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:09:58.101507 [info ] [MainThread]: 
[0m16:09:58.101910 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:09:58.102472 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:09:58.108807 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:09:58.109055 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:09:58.109223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:09:59.052760 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:09:59.056473 [debug] [ThreadPool]: On list_analytics: Close
[0m16:09:59.175669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:09:59.228321 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:09:59.228696 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:09:59.228893 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:09:59.731479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m16:09:59.734516 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:09:59.848513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f08530>]}
[0m16:09:59.850235 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:09:59.850808 [info ] [MainThread]: 
[0m16:09:59.854484 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:09:59.855122 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:09:59.855618 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:09:59.855975 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:09:59.856373 [info ] [Thread-1 (]: 1 of 24 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:09:59.856848 [info ] [Thread-2 (]: 2 of 24 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:09:59.857277 [info ] [Thread-3 (]: 3 of 24 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:09:59.857665 [info ] [Thread-4 (]: 4 of 24 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:09:59.858913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:09:59.859686 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:09:59.860420 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:09:59.861115 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:09:59.861495 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:09:59.861851 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:09:59.862187 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:09:59.862525 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:09:59.878330 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:09:59.882960 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:09:59.885815 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:09:59.888465 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:09:59.889199 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:09:59.883179 => 16:09:59.889005
[0m16:09:59.889532 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:09:59.862751 => 16:09:59.889378
[0m16:09:59.889784 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:09:59.890077 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:09:59.886018 => 16:09:59.889944
[0m16:09:59.890331 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:09:59.890577 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:09:59.878607 => 16:09:59.890453
[0m16:09:59.903533 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:09:59.903793 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:09:59.905376 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:09:59.905619 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:09:59.908143 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:09:59.908702 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:09:59.910184 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:09:59.910663 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:09:59.910901 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:59.911372 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:09:59.911605 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:09:59.911833 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:09:59.912040 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:59.912428 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:09:59.912610 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:09:59.913137 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:09:59.913516 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:09:59.914582 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:10:00.330122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.331027 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.331820 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.341766 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:09:59.908861 => 16:10:00.341413
[0m16:10:00.344368 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:09:59.905824 => 16:10:00.344080
[0m16:10:00.345142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.347343 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:09:59.890720 => 16:10:00.347045
[0m16:10:00.347809 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:10:00.348194 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:10:00.349953 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:09:59.903947 => 16:10:00.349746
[0m16:10:00.350297 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:10:00.352869 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:10:00.515793 [info ] [Thread-1 (]: 1 of 24 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.66s]
[0m16:10:00.516739 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:10:00.517254 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:00.517796 [info ] [Thread-1 (]: 5 of 24 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:10:00.518687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:10:00.519632 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:00.523357 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:10:00.523982 [info ] [Thread-3 (]: 3 of 24 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.66s]
[0m16:10:00.524904 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:10:00.525417 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:00.525792 [info ] [Thread-3 (]: 6 of 24 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:10:00.526304 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:10:00.526644 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:10:00.519952 => 16:10:00.526469
[0m16:10:00.527667 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:00.527397 [info ] [Thread-4 (]: 4 of 24 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.67s]
[0m16:10:00.527996 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:00.530875 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:10:00.531233 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:10:00.532797 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:10:00.533132 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:00.533784 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:10:00.528159 => 16:10:00.533489
[0m16:10:00.534155 [info ] [Thread-4 (]: 7 of 24 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:10:00.534601 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:00.535090 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:10:00.535531 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:10:00.537452 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:10:00.537822 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.538122 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:00.538406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:00.540905 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:10:00.541523 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:10:00.542179 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.542434 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:00.542655 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:10:00.538567 => 16:10:00.542545
[0m16:10:00.543099 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:00.544671 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:10:00.545859 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:10:00.546236 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.546699 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:00.622783 [info ] [Thread-2 (]: 2 of 24 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.76s]
[0m16:10:00.623594 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:10:00.623885 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:00.624184 [info ] [Thread-2 (]: 8 of 24 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:10:00.624586 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:10:00.624769 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:00.628051 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:10:00.628538 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:10:00.624867 => 16:10:00.628426
[0m16:10:00.628710 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:00.630340 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:10:00.630843 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:10:00.631042 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:00.631219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:00.942478 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.946003 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:10:00.535689 => 16:10:00.945697
[0m16:10:00.946667 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:10:00.954145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.955080 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.955778 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:00.958387 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:10:00.531364 => 16:10:00.958073
[0m16:10:00.959695 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:10:00.628810 => 16:10:00.959557
[0m16:10:00.960655 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:10:00.543380 => 16:10:00.960541
[0m16:10:00.960876 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:10:00.961099 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:10:00.961368 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:10:01.152772 [info ] [Thread-3 (]: 6 of 24 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.63s]
[0m16:10:01.153614 [info ] [Thread-1 (]: 5 of 24 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.64s]
[0m16:10:01.154244 [info ] [Thread-2 (]: 8 of 24 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.53s]
[0m16:10:01.154791 [info ] [Thread-4 (]: 7 of 24 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.62s]
[0m16:10:01.155535 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:10:01.155941 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:10:01.156320 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:10:01.156684 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:10:01.157017 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:01.157423 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:10:01.157867 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:10:01.158214 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:10:01.158558 [info ] [Thread-3 (]: 9 of 24 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:10:01.158876 [info ] [Thread-1 (]: 10 of 24 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:10:01.159157 [info ] [Thread-2 (]: 11 of 24 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:10:01.159431 [info ] [Thread-4 (]: 12 of 24 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:10:01.159970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:10:01.160469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m16:10:01.160913 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m16:10:01.161324 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:10:01.161584 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:01.161827 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:10:01.162054 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:10:01.162291 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:10:01.166461 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:10:01.168779 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:10:01.172211 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:10:01.175627 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:10:01.177685 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:10:01.166757 => 16:10:01.177476
[0m16:10:01.178047 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:10:01.162445 => 16:10:01.177884
[0m16:10:01.178417 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:10:01.163440 => 16:10:01.178218
[0m16:10:01.178730 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:10:01.179073 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:10:01.172470 => 16:10:01.178917
[0m16:10:01.179391 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:01.179698 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:10:01.197250 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:10:01.197529 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:10:01.199201 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:10:01.200806 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:10:01.202537 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:10:01.203151 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:10:01.203623 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:10:01.203963 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:10:01.204389 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:10:01.205068 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:10:01.205285 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:01.205504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:01.205711 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:10:01.205947 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:10:01.206172 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:01.206715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:01.206915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:01.669480 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:01.671356 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:10:01.197693 => 16:10:01.671169
[0m16:10:01.671658 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:10:01.789575 [info ] [Thread-3 (]: 9 of 24 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.63s]
[0m16:10:01.790391 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:10:02.238387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:02.260355 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:10:01.199368 => 16:10:02.260133
[0m16:10:02.260864 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:10:02.380262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e56960>]}
[0m16:10:02.381368 [info ] [Thread-1 (]: 10 of 24 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.22s]
[0m16:10:02.382171 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:10:02.383118 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.383960 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.384651 [info ] [Thread-3 (]: 13 of 24 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:10:02.385203 [info ] [Thread-1 (]: 14 of 24 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:10:02.386214 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:10:02.387117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:10:02.387616 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.388045 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.400510 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:10:02.401119 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:10:02.401846 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:10:02.388289 => 16:10:02.401667
[0m16:10:02.402133 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.402494 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:10:02.388969 => 16:10:02.402303
[0m16:10:02.404859 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:10:02.405212 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.407573 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:10:02.408270 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:10:02.408618 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:10:02.409148 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:10:02.409397 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:02.409669 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:10:02.410367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:02.579449 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:02.582381 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:10:01.179889 => 16:10:02.582157
[0m16:10:02.582778 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:10:02.766869 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:10:02.771933 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:10:01.201044 => 16:10:02.771628
[0m16:10:02.772588 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:10:02.780413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39af0>]}
[0m16:10:02.781180 [info ] [Thread-2 (]: 11 of 24 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.62s]
[0m16:10:02.781806 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:10:02.782234 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:02.782737 [info ] [Thread-2 (]: 15 of 24 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:10:02.783670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:10:02.784069 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:02.788799 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:10:02.789618 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:10:02.784299 => 16:10:02.789429
[0m16:10:02.789924 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:02.792420 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:10:02.793379 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:10:02.793711 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:02.793988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:02.862103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:02.863980 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:10:02.405466 => 16:10:02.863781
[0m16:10:02.864306 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:10:02.875162 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:02.876659 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:10:02.402659 => 16:10:02.876481
[0m16:10:02.876963 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:10:02.888028 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '397d648b-4626-4f06-9f0e-548a053f3e95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e277a0>]}
[0m16:10:02.888517 [info ] [Thread-4 (]: 12 of 24 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.73s]
[0m16:10:02.888974 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:10:02.889292 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:02.889675 [info ] [Thread-4 (]: 16 of 24 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:10:02.890396 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:10:02.890652 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:02.894010 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:10:02.894633 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:10:02.890798 => 16:10:02.894483
[0m16:10:02.894875 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:02.896860 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:10:02.897599 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:10:02.897856 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:02.898099 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:02.969394 [info ] [Thread-1 (]: 14 of 24 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.58s]
[0m16:10:02.969882 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:10:02.970146 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:02.970439 [info ] [Thread-1 (]: 17 of 24 START test not_null_dim_date_date ..................................... [RUN]
[0m16:10:02.970952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:10:02.971195 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:02.974185 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:10:02.975701 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:10:02.971331 => 16:10:02.975566
[0m16:10:02.975904 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:02.977569 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:10:02.978139 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:10:02.978360 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:10:02.978574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:02.989924 [info ] [Thread-3 (]: 13 of 24 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.60s]
[0m16:10:02.990436 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:10:02.990717 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:02.991013 [info ] [Thread-3 (]: 18 of 24 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:10:02.991521 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:10:02.991759 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:02.994850 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:10:02.995411 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:10:02.991889 => 16:10:02.995275
[0m16:10:02.995621 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:02.997203 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:10:02.997753 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:10:02.997960 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:10:02.998152 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:03.346637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.351202 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:10:02.790103 => 16:10:03.350735
[0m16:10:03.351936 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:10:03.469396 [info ] [Thread-2 (]: 15 of 24 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.69s]
[0m16:10:03.470824 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:10:03.471662 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:03.472360 [info ] [Thread-2 (]: 19 of 24 START test unique_dim_date_date ....................................... [RUN]
[0m16:10:03.473466 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:10:03.473956 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:03.479525 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:10:03.480652 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:10:03.474236 => 16:10:03.480421
[0m16:10:03.481040 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:03.483737 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:10:03.484739 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:10:03.485158 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:03.485497 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:03.546990 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.548675 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:10:02.895025 => 16:10:03.548494
[0m16:10:03.549009 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:10:03.665885 [info ] [Thread-4 (]: 16 of 24 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.78s]
[0m16:10:03.667543 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:10:03.668154 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:03.668624 [info ] [Thread-4 (]: 20 of 24 START test unique_dim_date_datekey .................................... [RUN]
[0m16:10:03.669378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:10:03.669749 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:03.674412 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:10:03.675248 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:10:03.669972 => 16:10:03.675056
[0m16:10:03.675571 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:03.678062 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:10:03.679080 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:10:03.679431 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:03.679729 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:03.885756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.888825 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:10:02.976035 => 16:10:03.888492
[0m16:10:03.889366 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:10:03.891701 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:03.894062 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:10:03.481259 => 16:10:03.893831
[0m16:10:03.894577 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:10:03.896588 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:03.899373 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:10:02.995736 => 16:10:03.899118
[0m16:10:03.900469 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:10:04.021966 [info ] [Thread-3 (]: 18 of 24 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.03s]
[0m16:10:04.022958 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:10:04.024321 [info ] [Thread-2 (]: 19 of 24 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.55s]
[0m16:10:04.025844 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.025307 [info ] [Thread-1 (]: 17 of 24 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 1.05s]
[0m16:10:04.026604 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:10:04.027014 [info ] [Thread-3 (]: 21 of 24 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:10:04.027601 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:10:04.028013 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.028826 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:10:04.029378 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.029813 [info ] [Thread-2 (]: 22 of 24 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:10:04.030236 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.030577 [info ] [Thread-1 (]: 23 of 24 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:10:04.031196 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:10:04.038263 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:10:04.038825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:10:04.039116 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.039501 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.042952 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:10:04.046273 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:10:04.046793 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:10:04.031414 => 16:10:04.046626
[0m16:10:04.047110 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.049184 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:10:04.049621 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:10:04.043184 => 16:10:04.049475
[0m16:10:04.050262 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.050686 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:10:04.039724 => 16:10:04.050497
[0m16:10:04.053466 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:10:04.054132 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:10:04.054467 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.055053 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:10:04.057046 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:10:04.057594 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:10:04.057944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:10:04.058461 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:04.059444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:10:04.059873 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:10:04.060548 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:10:04.061053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:10:04.294447 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:04.313868 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:10:03.675759 => 16:10:04.313546
[0m16:10:04.315646 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:10:04.432916 [info ] [Thread-4 (]: 20 of 24 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.76s]
[0m16:10:04.433855 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:10:04.434385 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.434986 [info ] [Thread-4 (]: 24 of 24 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:10:04.435856 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:10:04.436250 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.441305 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:10:04.442198 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:10:04.436475 => 16:10:04.442001
[0m16:10:04.442525 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.445070 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:10:04.446131 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:10:04.446485 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:10:04.446801 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:10:04.554174 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:04.554909 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:04.557137 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:10:04.047312 => 16:10:04.556904
[0m16:10:04.558812 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:10:04.055298 => 16:10:04.558617
[0m16:10:04.559195 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:10:04.559531 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:10:04.562843 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:10:04.564472 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:10:04.051630 => 16:10:04.564277
[0m16:10:04.564901 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:10:04.678609 [info ] [Thread-2 (]: 22 of 24 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.65s]
[0m16:10:04.680933 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:10:04.679700 [info ] [Thread-3 (]: 21 of 24 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.65s]
[0m16:10:04.682136 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:10:04.683882 [info ] [Thread-1 (]: 23 of 24 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.65s]
[0m16:10:04.684468 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:10:04.820009 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:10:04.823497 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:10:04.442710 => 16:10:04.823133
[0m16:10:04.824039 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:10:04.946975 [info ] [Thread-4 (]: 24 of 24 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.51s]
[0m16:10:04.948094 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:10:04.951318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:04.951978 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeeid.a3468da3ee' was properly closed.
[0m16:10:04.952352 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_employee_employeekey.59d58b8331' was properly closed.
[0m16:10:04.952686 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_employee_employeeid.47069b1dff' was properly closed.
[0m16:10:04.953015 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:10:04.953437 [info ] [MainThread]: 
[0m16:10:04.953852 [info ] [MainThread]: Finished running 21 tests, 3 table models in 0 hours 0 minutes and 6.85 seconds (6.85s).
[0m16:10:04.957345 [debug] [MainThread]: Command end result
[0m16:10:04.970647 [info ] [MainThread]: 
[0m16:10:04.971075 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:04.971361 [info ] [MainThread]: 
[0m16:10:04.971639 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m16:10:04.973566 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 7.330577, "process_user_time": 2.464758, "process_kernel_time": 0.28495, "process_mem_max_rss": "144162816", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:10:04.973998 [debug] [MainThread]: Command `dbt build` succeeded at 16:10:04.973904 after 7.33 seconds
[0m16:10:04.974285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10037b770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105978b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104def230>]}
[0m16:10:04.974559 [debug] [MainThread]: Flushing usage events
[0m16:11:04.858355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a2d0>]}


============================== 16:11:04.860844 | 5c5b5c32-4373-49ef-861a-7700ac801094 ==============================
[0m16:11:04.860844 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:11:04.861143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:05.051379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10739a690>]}
[0m16:11:05.084129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727f080>]}
[0m16:11:05.084599 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:11:05.096136 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:11:05.130198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:11:05.130542 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_order_fulfillment.yml
[0m16:11:05.130711 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_order_fulfillment.sql
[0m16:11:05.249192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10795d160>]}
[0m16:11:05.256414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107907b30>]}
[0m16:11:05.256643 [info ] [MainThread]: Found 23 tests, 4 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:11:05.257889 [info ] [MainThread]: 
[0m16:11:05.258283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:05.258868 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:11:05.264918 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:11:05.265117 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:11:05.265266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:06.161922 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:11:06.164885 [debug] [ThreadPool]: On list_analytics: Close
[0m16:11:06.289732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:11:06.343028 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:11:06.343371 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:11:06.343559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:07.073530 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m16:11:07.077499 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:11:07.265531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fc590>]}
[0m16:11:07.266720 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:07.267118 [info ] [MainThread]: 
[0m16:11:07.270835 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:07.271344 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.271818 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:07.272224 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.272641 [info ] [Thread-1 (]: 1 of 27 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:11:07.273113 [info ] [Thread-2 (]: 2 of 27 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:11:07.273536 [info ] [Thread-3 (]: 3 of 27 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:11:07.273947 [info ] [Thread-4 (]: 4 of 27 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:11:07.275114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:11:07.275744 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:11:07.276367 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:11:07.276963 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:11:07.277335 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:07.277710 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.278036 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:07.278332 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.293950 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:11:07.298832 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:11:07.301683 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:11:07.304312 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:11:07.305438 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:11:07.278563 => 16:11:07.305168
[0m16:11:07.305800 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:07.306165 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:11:07.299083 => 16:11:07.305958
[0m16:11:07.306468 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:11:07.301876 => 16:11:07.306320
[0m16:11:07.306817 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:11:07.294249 => 16:11:07.306624
[0m16:11:07.321336 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:11:07.321684 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:07.321924 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.322137 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.323920 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:11:07.326552 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:11:07.328008 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:11:07.328524 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:11:07.328982 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:11:07.329391 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:11:07.329774 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:11:07.329997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:07.330379 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:11:07.330584 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.330812 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.331439 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.331837 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:07.332047 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:07.332247 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:07.840061 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.841420 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.850053 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:11:07.326709 => 16:11:07.849735
[0m16:11:07.851943 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:11:07.324111 => 16:11:07.851741
[0m16:11:07.852344 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:11:07.852696 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:11:07.863525 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.865729 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:11:07.322363 => 16:11:07.865481
[0m16:11:07.866123 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:11:07.867668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:07.869433 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:11:07.306971 => 16:11:07.869248
[0m16:11:07.869785 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:11:07.967822 [info ] [Thread-4 (]: 4 of 27 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.69s]
[0m16:11:07.968314 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:11:07.968605 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:07.968935 [info ] [Thread-4 (]: 5 of 27 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:11:07.969482 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:11:07.969721 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:07.972983 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:11:07.973555 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:11:07.969854 => 16:11:07.973412
[0m16:11:07.973797 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:07.975598 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:11:07.976259 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:11:07.976493 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.976705 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:07.981521 [info ] [Thread-2 (]: 2 of 27 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.71s]
[0m16:11:07.981892 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:11:07.982153 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:07.982439 [info ] [Thread-2 (]: 6 of 27 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:11:07.982816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:11:07.983032 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:07.985676 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:11:07.986120 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:11:07.983155 => 16:11:07.985992
[0m16:11:07.986333 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:07.987923 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:11:07.988449 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:11:07.988658 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:07.988850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:08.000220 [info ] [Thread-1 (]: 1 of 27 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.73s]
[0m16:11:08.000611 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:11:08.000852 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.001143 [info ] [Thread-1 (]: 7 of 27 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:11:08.001574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:11:08.001795 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.004314 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:11:08.004775 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:11:08.001919 => 16:11:08.004646
[0m16:11:08.004982 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.006516 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:11:08.007071 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:11:08.007280 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:08.007465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:08.010994 [info ] [Thread-3 (]: 3 of 27 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.73s]
[0m16:11:08.011353 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:11:08.011596 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.011818 [info ] [Thread-3 (]: 8 of 27 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:11:08.012166 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:11:08.012353 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.014790 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:11:08.015227 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:11:08.012462 => 16:11:08.015112
[0m16:11:08.015416 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.017843 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:11:08.018449 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:11:08.018681 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:08.018889 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:08.346857 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.351306 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:11:07.973933 => 16:11:08.350869
[0m16:11:08.352001 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:11:08.437481 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.442327 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:11:08.015525 => 16:11:08.441918
[0m16:11:08.444047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.444547 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:11:08.445660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.448750 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:11:07.986455 => 16:11:08.448421
[0m16:11:08.452309 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:11:08.005098 => 16:11:08.452034
[0m16:11:08.453078 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:11:08.453532 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:11:08.482380 [info ] [Thread-4 (]: 5 of 27 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.51s]
[0m16:11:08.483053 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:11:08.483572 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:08.484133 [info ] [Thread-4 (]: 9 of 27 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:11:08.484986 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:11:08.485396 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:08.490359 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:11:08.492569 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:11:08.485627 => 16:11:08.492357
[0m16:11:08.492894 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:08.495527 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:11:08.496694 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:11:08.497007 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:08.497289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:08.564529 [info ] [Thread-1 (]: 7 of 27 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.56s]
[0m16:11:08.565071 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:11:08.565411 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:11:08.565804 [info ] [Thread-1 (]: 10 of 27 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:11:08.566386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m16:11:08.566685 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:11:08.569901 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:11:08.571313 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:11:08.566859 => 16:11:08.571158
[0m16:11:08.571560 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:11:08.588164 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:11:08.589583 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:11:08.589854 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:11:08.590612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:08.590402 [info ] [Thread-2 (]: 6 of 27 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.61s]
[0m16:11:08.591338 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:11:08.591783 [debug] [Thread-2 (]: Began running node model.northwind.dim_date
[0m16:11:08.592084 [info ] [Thread-2 (]: 11 of 27 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:11:08.592479 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:11:08.592682 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_date
[0m16:11:08.594323 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:11:08.595024 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (compile): 16:11:08.592800 => 16:11:08.594909
[0m16:11:08.595214 [debug] [Thread-2 (]: Began executing node model.northwind.dim_date
[0m16:11:08.596776 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:11:08.597366 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:11:08.597574 [debug] [Thread-2 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:11:08.597766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:08.835573 [info ] [Thread-3 (]: 8 of 27 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.82s]
[0m16:11:08.836386 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:11:08.836849 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m16:11:08.837392 [info ] [Thread-3 (]: 12 of 27 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:11:08.838266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m16:11:08.838718 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m16:11:08.843492 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:11:08.844306 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 16:11:08.838964 => 16:11:08.844118
[0m16:11:08.844615 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m16:11:08.849066 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:11:08.850259 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:11:08.850586 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:11:08.850902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:08.880981 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:08.882893 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:11:08.493076 => 16:11:08.882704
[0m16:11:08.883213 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:11:08.999484 [info ] [Thread-4 (]: 9 of 27 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.51s]
[0m16:11:09.000189 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:11:09.000640 [debug] [Thread-4 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:11:09.001094 [info ] [Thread-4 (]: 13 of 27 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:11:09.001760 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:11:09.002089 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:11:09.007669 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:11:09.008294 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:11:09.002273 => 16:11:09.008125
[0m16:11:09.008566 [debug] [Thread-4 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:11:09.010742 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:11:09.012502 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:11:09.012871 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:11:09.013206 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:09.310394 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:09.332467 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:11:08.571705 => 16:11:09.332219
[0m16:11:09.333193 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:11:09.525740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cda030>]}
[0m16:11:09.526895 [info ] [Thread-1 (]: 10 of 27 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.96s]
[0m16:11:09.527603 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:11:09.528385 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:09.528932 [info ] [Thread-1 (]: 14 of 27 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:11:09.529779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:11:09.530189 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:09.534741 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:11:09.535655 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:09.537353 [debug] [Thread-2 (]: Timing info for model.northwind.dim_date (execute): 16:11:08.595334 => 16:11:09.537236
[0m16:11:09.537613 [debug] [Thread-2 (]: On model.northwind.dim_date: Close
[0m16:11:09.538325 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:11:09.530489 => 16:11:09.538189
[0m16:11:09.538717 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:09.540284 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:11:09.541040 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:11:09.541265 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:11:09.541494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:09.664981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1a570>]}
[0m16:11:09.665870 [info ] [Thread-2 (]: 11 of 27 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.07s]
[0m16:11:09.666771 [debug] [Thread-2 (]: Finished running node model.northwind.dim_date
[0m16:11:09.667270 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:09.667916 [info ] [Thread-2 (]: 15 of 27 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:11:09.668741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:11:09.669060 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:09.671546 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:11:09.672006 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:11:09.669190 => 16:11:09.671896
[0m16:11:09.672177 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:09.673560 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:11:09.674018 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:11:09.674191 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:11:09.674350 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:10.436556 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:10.439577 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:11:09.538876 => 16:11:10.439266
[0m16:11:10.440085 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:11:10.443171 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:10.445277 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:11:09.672276 => 16:11:10.445070
[0m16:11:10.445612 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:11:10.536556 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:11:10.540694 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 16:11:08.844798 => 16:11:10.540406
[0m16:11:10.541317 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m16:11:10.568550 [info ] [Thread-2 (]: 15 of 27 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.90s]
[0m16:11:10.569602 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:11:10.570104 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:10.570680 [info ] [Thread-2 (]: 16 of 27 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:11:10.571646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:11:10.572685 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:10.576318 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:11:10.576888 [info ] [Thread-1 (]: 14 of 27 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 1.05s]
[0m16:11:10.577392 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:11:10.577720 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:10.578028 [info ] [Thread-1 (]: 17 of 27 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:11:10.578318 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:11:10.573069 => 16:11:10.578186
[0m16:11:10.578669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:11:10.578899 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:10.579110 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:10.581838 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:11:10.584099 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:11:10.584713 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:11:10.584956 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:11:10.581995 => 16:11:10.584840
[0m16:11:10.585137 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:10.585399 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:10.585709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:10.587372 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:11:10.589040 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:11:10.589423 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:10.589672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:10.648235 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef16390>]}
[0m16:11:10.648661 [info ] [Thread-3 (]: 12 of 27 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.81s]
[0m16:11:10.648973 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m16:11:10.649180 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:10.649424 [info ] [Thread-3 (]: 18 of 27 START test not_null_dim_date_date ..................................... [RUN]
[0m16:11:10.649895 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:11:10.650124 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:10.652469 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:11:10.652886 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:11:10.650231 => 16:11:10.652782
[0m16:11:10.653057 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:10.654338 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:11:10.654770 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:11:10.654939 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:11:10.655099 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:10.889122 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:11:10.896645 [debug] [Thread-4 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:11:09.008720 => 16:11:10.896484
[0m16:11:10.897767 [debug] [Thread-4 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:11:11.046048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.049696 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:11:10.585909 => 16:11:11.049333
[0m16:11:11.051131 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c5b5c32-4373-49ef-861a-7700ac801094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d34e90>]}
[0m16:11:11.051983 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:11:11.052697 [info ] [Thread-4 (]: 13 of 27 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 2.05s]
[0m16:11:11.054067 [debug] [Thread-4 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:11:11.054780 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.055302 [info ] [Thread-4 (]: 19 of 27 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:11:11.055935 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:11:11.056276 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.061563 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:11:11.062877 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:11:11.056589 => 16:11:11.062658
[0m16:11:11.063194 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.065815 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:11:11.066782 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:11:11.067145 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:11:11.067461 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:11.101168 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:11.103813 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:11:10.579235 => 16:11:11.103553
[0m16:11:11.104241 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:11:11.168203 [info ] [Thread-1 (]: 17 of 27 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.59s]
[0m16:11:11.168909 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:11:11.169317 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.169731 [info ] [Thread-1 (]: 20 of 27 START test unique_dim_date_date ....................................... [RUN]
[0m16:11:11.170405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:11:11.170718 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.174684 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:11:11.175455 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:11:11.170898 => 16:11:11.175271
[0m16:11:11.175746 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.177888 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:11:11.178677 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:11:11.178937 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.179177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:11.209064 [info ] [Thread-2 (]: 16 of 27 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.64s]
[0m16:11:11.209567 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:11:11.209880 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.210228 [info ] [Thread-2 (]: 21 of 27 START test unique_dim_date_datekey .................................... [RUN]
[0m16:11:11.210783 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:11:11.211061 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.216075 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:11:11.216577 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:11:11.211226 => 16:11:11.216433
[0m16:11:11.216814 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.218646 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:11:11.219325 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:11:11.219584 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.219822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:11.280977 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:11:11.282363 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:11:10.653155 => 16:11:11.282220
[0m16:11:11.282591 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:11:11.466294 [info ] [Thread-3 (]: 18 of 27 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.82s]
[0m16:11:11.467219 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:11:11.467717 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:11.468270 [info ] [Thread-3 (]: 22 of 27 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:11:11.468989 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:11:11.469346 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:11.474557 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:11:11.475673 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:11:11.469561 => 16:11:11.475417
[0m16:11:11.476060 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:11.478516 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:11:11.479396 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:11:11.479707 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:11:11.479987 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:11.523722 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.525690 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:11:11.063372 => 16:11:11.525470
[0m16:11:11.526074 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:11:11.641789 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.644223 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:11:11.175916 => 16:11:11.643973
[0m16:11:11.645562 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:11:11.645163 [info ] [Thread-4 (]: 19 of 27 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.59s]
[0m16:11:11.647224 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:11:11.647982 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:11.648488 [info ] [Thread-4 (]: 23 of 27 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:11:11.649628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:11:11.654853 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:11.658539 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:11:11.660095 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:11:11.655152 => 16:11:11.659817
[0m16:11:11.660485 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:11.663141 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:11:11.663889 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:11:11.664187 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:11:11.664490 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:11.688504 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.690437 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:11:11.216955 => 16:11:11.690241
[0m16:11:11.690746 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:11:11.766260 [info ] [Thread-1 (]: 20 of 27 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.60s]
[0m16:11:11.766793 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:11:11.767125 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:11.767479 [info ] [Thread-1 (]: 24 of 27 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:11:11.768082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:11:11.768372 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:11.772143 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:11:11.772805 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:11:11.768552 => 16:11:11.772634
[0m16:11:11.773167 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:11.775400 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:11:11.776222 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:11:11.776496 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.776759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:11.803709 [info ] [Thread-2 (]: 21 of 27 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.59s]
[0m16:11:11.804217 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:11:11.804529 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:11.804856 [info ] [Thread-2 (]: 25 of 27 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:11:11.805368 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:11:11.805609 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:11.808660 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:11:11.809172 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:11:11.805752 => 16:11:11.809027
[0m16:11:11.809411 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:11.812707 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:11:11.813425 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:11:11.813683 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:11.813924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:11.923179 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:11.925264 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:11:11.476279 => 16:11:11.925025
[0m16:11:11.925783 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:11:12.039917 [info ] [Thread-3 (]: 22 of 27 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.57s]
[0m16:11:12.040607 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:11:12.041047 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.041514 [info ] [Thread-3 (]: 26 of 27 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:11:12.042262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:11:12.042641 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.047204 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:11:12.048066 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:11:12.042869 => 16:11:12.047873
[0m16:11:12.048386 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.050899 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:11:12.055764 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:11:12.056130 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:11:12.056402 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:12.141669 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.145542 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:11:11.660700 => 16:11:12.145357
[0m16:11:12.146113 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:11:12.189099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.191154 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:11:11.773374 => 16:11:12.190905
[0m16:11:12.191532 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:11:12.248399 [info ] [Thread-4 (]: 23 of 27 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.60s]
[0m16:11:12.248948 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:11:12.249275 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.249614 [info ] [Thread-4 (]: 27 of 27 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:11:12.250194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:11:12.250546 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.255077 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:11:12.255830 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:11:12.250774 => 16:11:12.255636
[0m16:11:12.256159 [debug] [Thread-4 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.258589 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:11:12.259753 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.261685 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:11:11.809560 => 16:11:12.261467
[0m16:11:12.262013 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:11:12.262646 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:11:12.263669 [debug] [Thread-4 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:11:12.264198 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:12.323735 [info ] [Thread-1 (]: 24 of 27 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.56s]
[0m16:11:12.324246 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:11:12.454262 [info ] [Thread-2 (]: 25 of 27 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.65s]
[0m16:11:12.455509 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:11:12.501224 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.503790 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:11:12.048592 => 16:11:12.503532
[0m16:11:12.504325 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:11:12.624351 [info ] [Thread-3 (]: 26 of 27 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.58s]
[0m16:11:12.625556 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:11:12.722281 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:11:12.726708 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:11:12.256352 => 16:11:12.726257
[0m16:11:12.727396 [debug] [Thread-4 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:11:12.845734 [info ] [Thread-4 (]: 27 of 27 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:11:12.847721 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:11:12.850375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:12.850828 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeeid.a3468da3ee' was properly closed.
[0m16:11:12.851157 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:11:12.851415 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:11:12.851669 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:11:12.852023 [info ] [MainThread]: 
[0m16:11:12.852363 [info ] [MainThread]: Finished running 23 tests, 4 table models in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m16:11:12.855847 [debug] [MainThread]: Command end result
[0m16:11:12.869473 [info ] [MainThread]: 
[0m16:11:12.869916 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:12.870193 [info ] [MainThread]: 
[0m16:11:12.870458 [info ] [MainThread]: Done. PASS=27 WARN=0 ERROR=0 SKIP=0 TOTAL=27
[0m16:11:12.872215 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.041116, "process_user_time": 2.478925, "process_kernel_time": 0.262149, "process_mem_max_rss": "144326656", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:11:12.872561 [debug] [MainThread]: Command `dbt build` succeeded at 16:11:12.872490 after 8.04 seconds
[0m16:11:12.873013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c6a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3a870>]}
[0m16:11:12.873262 [debug] [MainThread]: Flushing usage events
[0m16:12:01.676042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e22030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eedf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102063f0>]}


============================== 16:12:01.678567 | 9d50b7b7-5a17-4b0a-9486-2f521da28a94 ==============================
[0m16:12:01.678567 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:12:01.678877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:12:01.869989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109ed0d0>]}
[0m16:12:01.902955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e94560>]}
[0m16:12:01.903420 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:12:01.915481 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:12:01.949921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m16:12:01.950227 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_order_fulfillment.sql
[0m16:12:01.950401 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_order_fulfillment.yml
[0m16:12:02.027588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111187470>]}
[0m16:12:02.034953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f20650>]}
[0m16:12:02.035171 [info ] [MainThread]: Found 23 tests, 5 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:12:02.036452 [info ] [MainThread]: 
[0m16:12:02.036824 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:02.037421 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:12:02.043433 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:12:02.043612 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:12:02.043757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:02.815453 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:12:02.819261 [debug] [ThreadPool]: On list_analytics: Close
[0m16:12:02.955725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:12:02.965909 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:12:02.966324 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:12:02.966610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:12:03.411632 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m16:12:03.415858 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:12:03.535241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd8c80>]}
[0m16:12:03.536725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:12:03.537614 [info ] [MainThread]: 
[0m16:12:03.541236 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:03.541708 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:03.542133 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:03.542524 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:03.542920 [info ] [Thread-1 (]: 1 of 28 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:12:03.543344 [info ] [Thread-2 (]: 2 of 28 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:12:03.543748 [info ] [Thread-3 (]: 3 of 28 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:12:03.544259 [info ] [Thread-4 (]: 4 of 28 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:12:03.545124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:12:03.546221 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:12:03.546887 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:12:03.547473 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:12:03.547792 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:03.548088 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:03.548372 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:03.548651 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:03.564170 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:12:03.568768 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:12:03.572671 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:12:03.605543 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:12:03.607840 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:12:03.564443 => 16:12:03.607702
[0m16:12:03.608084 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:03.608361 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:12:03.572873 => 16:12:03.608220
[0m16:12:03.608588 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:12:03.548852 => 16:12:03.608476
[0m16:12:03.608788 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:12:03.568993 => 16:12:03.608688
[0m16:12:03.619710 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:12:03.619967 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:03.620179 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:03.620369 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:03.621789 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:12:03.623186 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:12:03.623581 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:12:03.624833 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:12:03.625121 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:03.625570 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:12:03.625782 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:12:03.625998 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:03.626354 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:12:03.626693 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:12:03.627181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:12:03.627393 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:03.627771 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:12:03.628203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:12:03.628584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.091451 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.103712 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:12:03.620554 => 16:12:04.103381
[0m16:12:04.104948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.105387 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:12:04.107510 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:12:03.608912 => 16:12:04.107272
[0m16:12:04.108727 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:12:04.279910 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:04.280974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:04.284364 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:12:03.623708 => 16:12:04.283989
[0m16:12:04.286040 [info ] [Thread-2 (]: 2 of 28 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.74s]
[0m16:12:04.287205 [info ] [Thread-4 (]: 4 of 28 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.74s]
[0m16:12:04.289843 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:12:03.621943 => 16:12:04.289559
[0m16:12:04.290288 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:12:04.290841 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:12:04.291336 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:12:04.291707 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:12:04.293220 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.294234 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.295614 [info ] [Thread-2 (]: 5 of 28 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:12:04.296201 [info ] [Thread-4 (]: 6 of 28 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:12:04.296943 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:12:04.297850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:12:04.298710 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.299511 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.304450 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:12:04.307980 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:12:04.308778 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:12:04.299757 => 16:12:04.308582
[0m16:12:04.309138 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:12:04.300620 => 16:12:04.308961
[0m16:12:04.309406 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.309681 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.311873 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:12:04.315106 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:12:04.315902 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:12:04.316424 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:12:04.316720 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.317015 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.317279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:04.317507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:04.409810 [info ] [Thread-3 (]: 3 of 28 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.86s]
[0m16:12:04.410341 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:12:04.410661 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.411253 [info ] [Thread-3 (]: 7 of 28 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:12:04.411814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:12:04.412126 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.415506 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:12:04.416102 [info ] [Thread-1 (]: 1 of 28 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.87s]
[0m16:12:04.416641 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:12:04.416992 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.417303 [info ] [Thread-1 (]: 8 of 28 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:12:04.417645 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:12:04.412287 => 16:12:04.417482
[0m16:12:04.418094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:12:04.418364 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.418603 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.420680 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:12:04.423394 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:12:04.424077 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:12:04.424372 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:12:04.420865 => 16:12:04.424227
[0m16:12:04.424603 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.424846 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.425052 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:04.426771 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:12:04.427958 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:12:04.428201 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.428421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.667583 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.671409 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:12:04.309852 => 16:12:04.670952
[0m16:12:04.672060 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:12:04.674702 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.676863 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:12:04.312094 => 16:12:04.676607
[0m16:12:04.677349 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:12:04.804255 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.810182 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:12:04.418753 => 16:12:04.809764
[0m16:12:04.811671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:04.812216 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:12:04.814929 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:12:04.425192 => 16:12:04.814679
[0m16:12:04.817113 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:12:04.875865 [info ] [Thread-2 (]: 5 of 28 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.58s]
[0m16:12:04.877331 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:12:04.877947 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:04.879186 [info ] [Thread-2 (]: 9 of 28 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:12:04.880302 [info ] [Thread-4 (]: 6 of 28 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.58s]
[0m16:12:04.882306 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:12:04.882935 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:12:04.883330 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:04.883767 [debug] [Thread-4 (]: Began running node model.northwind.dim_date
[0m16:12:04.886131 [info ] [Thread-4 (]: 10 of 28 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:12:04.890311 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:12:04.891049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:12:04.893515 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_date
[0m16:12:04.896707 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:12:04.897392 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:12:04.884082 => 16:12:04.897146
[0m16:12:04.897773 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:04.898163 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (compile): 16:12:04.893804 => 16:12:04.897931
[0m16:12:04.900737 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:12:04.901158 [debug] [Thread-4 (]: Began executing node model.northwind.dim_date
[0m16:12:04.919769 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:12:04.920358 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:12:04.920733 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:04.921001 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:04.921646 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:12:04.922105 [debug] [Thread-4 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:12:04.922512 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:04.939256 [info ] [Thread-1 (]: 8 of 28 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.52s]
[0m16:12:04.939808 [info ] [Thread-3 (]: 7 of 28 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.53s]
[0m16:12:04.940316 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:12:04.940658 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:12:04.940936 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:12:04.941305 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m16:12:04.941631 [info ] [Thread-1 (]: 11 of 28 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:12:04.941924 [info ] [Thread-3 (]: 12 of 28 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:12:04.942335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:12:04.942710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:12:04.942928 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:12:04.943126 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m16:12:04.953132 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:12:04.955659 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:12:04.956619 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:12:04.943255 => 16:12:04.956464
[0m16:12:04.956887 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 16:12:04.953351 => 16:12:04.956760
[0m16:12:04.957088 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:12:04.957283 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m16:12:04.958795 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:12:04.960198 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:12:04.960728 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:12:04.960934 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:12:04.961670 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:12:04.961887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:04.962109 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:12:04.962659 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:05.333316 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:05.338958 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:12:04.898377 => 16:12:05.338548
[0m16:12:05.339731 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:12:05.458733 [info ] [Thread-2 (]: 9 of 28 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.58s]
[0m16:12:05.459233 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:12:05.459508 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:12:05.459847 [info ] [Thread-2 (]: 13 of 28 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:12:05.460289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:12:05.460514 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:12:05.464163 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:12:05.464905 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:12:05.460637 => 16:12:05.464738
[0m16:12:05.465141 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:12:05.466855 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:12:05.468201 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:12:05.468466 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:12:05.468709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:05.850517 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:05.873247 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 16:12:04.958929 => 16:12:05.873021
[0m16:12:05.873747 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m16:12:05.992624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11334e930>]}
[0m16:12:05.993726 [info ] [Thread-3 (]: 12 of 28 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.05s]
[0m16:12:05.994517 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m16:12:05.995794 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:05.996409 [info ] [Thread-3 (]: 14 of 28 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:12:05.997366 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:12:05.997825 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:06.005648 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:12:06.006680 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:12:05.998099 => 16:12:06.006449
[0m16:12:06.007064 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:06.011497 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:12:06.012648 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:12:06.012977 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:12:06.013277 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:06.055247 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:06.055951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:06.059058 [debug] [Thread-4 (]: Timing info for model.northwind.dim_date (execute): 16:12:04.901516 => 16:12:06.058858
[0m16:12:06.061206 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:12:04.957401 => 16:12:06.061030
[0m16:12:06.061677 [debug] [Thread-4 (]: On model.northwind.dim_date: Close
[0m16:12:06.062232 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:12:06.175081 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111184770>]}
[0m16:12:06.175722 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111227b60>]}
[0m16:12:06.176231 [info ] [Thread-1 (]: 11 of 28 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.23s]
[0m16:12:06.177067 [info ] [Thread-4 (]: 10 of 28 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.28s]
[0m16:12:06.177774 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:12:06.178352 [debug] [Thread-4 (]: Finished running node model.northwind.dim_date
[0m16:12:06.178792 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:06.179345 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:06.179811 [info ] [Thread-1 (]: 15 of 28 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:12:06.180149 [info ] [Thread-4 (]: 16 of 28 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:12:06.180694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:12:06.181172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:12:06.181437 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:06.181658 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:06.184968 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:12:06.187825 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:12:06.188443 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:12:06.185197 => 16:12:06.188287
[0m16:12:06.188755 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:12:06.181823 => 16:12:06.188606
[0m16:12:06.188986 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:06.189227 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:06.190953 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:12:06.192606 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:12:06.193425 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:12:06.193871 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:12:06.194224 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:06.197752 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:12:06.198109 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:06.198397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:06.769694 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:06.772812 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:12:06.007274 => 16:12:06.772410
[0m16:12:06.773396 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:12:06.963566 [info ] [Thread-3 (]: 14 of 28 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.97s]
[0m16:12:06.964470 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:12:06.964955 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:06.965492 [info ] [Thread-3 (]: 17 of 28 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:12:06.966372 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:12:06.966805 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:06.971766 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:12:06.972627 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:12:06.967056 => 16:12:06.972417
[0m16:12:06.972973 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:06.975570 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:12:06.976533 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:12:06.976887 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:06.977207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:07.108414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:07.111110 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:12:06.191109 => 16:12:07.110823
[0m16:12:07.111600 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:12:07.113785 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:07.116171 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:12:06.189376 => 16:12:07.115943
[0m16:12:07.116601 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:12:07.236230 [info ] [Thread-1 (]: 15 of 28 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 1.06s]
[0m16:12:07.237707 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:12:07.238223 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:07.238777 [info ] [Thread-1 (]: 18 of 28 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:12:07.239695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:12:07.240105 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:07.240952 [info ] [Thread-4 (]: 16 of 28 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 1.06s]
[0m16:12:07.246057 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:12:07.246620 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:12:07.247095 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:07.247500 [info ] [Thread-4 (]: 19 of 28 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:12:07.248115 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:12:07.248435 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:07.252190 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:12:07.252574 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:12:07.241291 => 16:12:07.252385
[0m16:12:07.252934 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:07.256774 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:12:07.257247 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:12:07.248667 => 16:12:07.257077
[0m16:12:07.257563 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:07.259563 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:12:07.260113 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:12:07.261584 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:12:07.262114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:07.262623 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:12:07.263283 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:12:07.263792 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:07.422408 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.425252 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:12:06.973173 => 16:12:07.424935
[0m16:12:07.425910 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:12:07.428883 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:12:07.431634 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:12:05.465270 => 16:12:07.431402
[0m16:12:07.432135 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:12:07.560590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c65310>]}
[0m16:12:07.561947 [info ] [Thread-2 (]: 13 of 28 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 2.10s]
[0m16:12:07.563057 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:12:07.563626 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:07.564313 [info ] [Thread-2 (]: 20 of 28 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:12:07.565274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:12:07.565707 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:07.571127 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:12:07.575213 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:12:07.565975 => 16:12:07.574948
[0m16:12:07.575974 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:07.578793 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:12:07.581054 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:12:07.581391 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:07.582348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:07.582087 [info ] [Thread-3 (]: 17 of 28 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.62s]
[0m16:12:07.583215 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:12:07.583761 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:07.584121 [info ] [Thread-3 (]: 21 of 28 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:12:07.584657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:12:07.584942 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:07.588506 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:12:07.589332 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:12:07.585135 => 16:12:07.589183
[0m16:12:07.589575 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:07.591417 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:12:07.592149 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:12:07.592406 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:07.592663 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:07.714201 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.716397 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:12:07.257745 => 16:12:07.716184
[0m16:12:07.716787 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:12:07.718234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.720304 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:12:07.253119 => 16:12:07.720072
[0m16:12:07.720726 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:12:07.969243 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:07.973538 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:12:07.576288 => 16:12:07.973158
[0m16:12:07.974133 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:12:08.088879 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.092109 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:12:07.589719 => 16:12:08.091795
[0m16:12:08.093704 [info ] [Thread-1 (]: 18 of 28 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.85s]
[0m16:12:08.094906 [info ] [Thread-2 (]: 20 of 28 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.53s]
[0m16:12:08.096679 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:12:08.096191 [info ] [Thread-4 (]: 19 of 28 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.85s]
[0m16:12:08.097345 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:12:08.097856 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:12:08.099392 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:12:08.100160 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.100715 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.101207 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.101650 [info ] [Thread-1 (]: 22 of 28 START test not_null_dim_date_date ..................................... [RUN]
[0m16:12:08.102502 [info ] [Thread-2 (]: 23 of 28 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:12:08.103013 [info ] [Thread-4 (]: 24 of 28 START test unique_dim_date_date ....................................... [RUN]
[0m16:12:08.103669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:12:08.104318 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:12:08.104841 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:12:08.105151 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.105428 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.105700 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.110890 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:12:08.114188 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:12:08.117347 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:12:08.118216 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:12:08.107080 => 16:12:08.118013
[0m16:12:08.118522 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:12:08.105900 => 16:12:08.118388
[0m16:12:08.118844 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.119172 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:12:08.114448 => 16:12:08.119011
[0m16:12:08.119442 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.122799 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:12:08.123087 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.124869 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:12:08.126777 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:12:08.127390 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:12:08.127925 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:12:08.128158 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:12:08.128657 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:12:08.128864 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:12:08.129105 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:08.129328 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:08.129553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:08.130238 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:08.210377 [info ] [Thread-3 (]: 21 of 28 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.63s]
[0m16:12:08.210809 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:12:08.211067 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:08.211357 [info ] [Thread-3 (]: 25 of 28 START test unique_dim_date_datekey .................................... [RUN]
[0m16:12:08.211835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:12:08.212061 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:08.214868 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:12:08.215380 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:12:08.212194 => 16:12:08.215243
[0m16:12:08.215611 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:08.217413 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:12:08.218086 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:12:08.218342 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:08.218566 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:12:08.613447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.619016 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:12:08.123248 => 16:12:08.618572
[0m16:12:08.620431 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.620887 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:12:08.624148 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:12:08.119597 => 16:12:08.623755
[0m16:12:08.626018 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:12:08.637544 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:08.639735 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:12:08.125116 => 16:12:08.639489
[0m16:12:08.640143 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:12:08.701419 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:12:08.705696 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:12:08.215742 => 16:12:08.705302
[0m16:12:08.706377 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:12:08.750833 [info ] [Thread-4 (]: 24 of 28 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.65s]
[0m16:12:08.751809 [info ] [Thread-1 (]: 22 of 28 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.65s]
[0m16:12:08.752738 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:12:08.754011 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:12:08.754695 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:08.755406 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:08.756021 [info ] [Thread-4 (]: 26 of 28 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:12:08.757574 [info ] [Thread-1 (]: 27 of 28 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:12:08.758870 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:12:08.759673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:12:08.760649 [info ] [Thread-2 (]: 23 of 28 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.66s]
[0m16:12:08.761478 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:08.762507 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:08.763265 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:12:08.769487 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:12:08.772223 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:12:08.773045 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:12:08.763580 => 16:12:08.772862
[0m16:12:08.773409 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:12:08.765767 => 16:12:08.773232
[0m16:12:08.773678 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:08.773965 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:08.776241 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:12:08.778431 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:12:08.779242 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:12:08.779832 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:12:08.780160 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:12:08.780485 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:12:08.780746 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:12:08.780963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:12:08.818500 [info ] [Thread-3 (]: 25 of 28 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.61s]
[0m16:12:08.819027 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:12:09.319615 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:09.321090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:09.324757 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:12:08.774139 => 16:12:09.324325
[0m16:12:09.326979 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:12:08.776439 => 16:12:09.326740
[0m16:12:09.327435 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:12:09.327809 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:12:09.523117 [info ] [Thread-1 (]: 27 of 28 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.76s]
[0m16:12:09.524148 [info ] [Thread-4 (]: 26 of 28 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.77s]
[0m16:12:09.525077 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:12:09.525736 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:12:09.526479 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:12:09.526847 [info ] [Thread-2 (]: 28 of 28 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:12:09.527325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now model.northwind.obt_order_fulfillment)
[0m16:12:09.527536 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:12:09.531565 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:12:09.532260 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:12:09.527654 => 16:12:09.532132
[0m16:12:09.532463 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:12:09.534172 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:12:09.535213 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:12:09.535450 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:12:09.535670 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:12:10.344277 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:12:10.350995 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:12:09.532586 => 16:12:10.350651
[0m16:12:10.351662 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:12:10.459636 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d50b7b7-5a17-4b0a-9486-2f521da28a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114928fb0>]}
[0m16:12:10.460135 [info ] [Thread-2 (]: 28 of 28 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 0.93s]
[0m16:12:10.460507 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:12:10.461703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:10.461880 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:12:10.462025 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:12:10.462159 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:12:10.462297 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:12:10.462516 [info ] [MainThread]: 
[0m16:12:10.462691 [info ] [MainThread]: Finished running 23 tests, 5 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m16:12:10.464605 [debug] [MainThread]: Command end result
[0m16:12:10.471796 [info ] [MainThread]: 
[0m16:12:10.472073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:10.472249 [info ] [MainThread]: 
[0m16:12:10.472417 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 TOTAL=28
[0m16:12:10.473901 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.829991, "process_user_time": 2.659895, "process_kernel_time": 0.294405, "process_mem_max_rss": "145031168", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:12:10.474264 [debug] [MainThread]: Command `dbt build` succeeded at 16:12:10.474191 after 8.83 seconds
[0m16:12:10.474484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c33320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c683e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c68aa0>]}
[0m16:12:10.474690 [debug] [MainThread]: Flushing usage events
[0m16:41:30.614391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a8b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a63770>]}


============================== 16:41:30.617020 | ee250c41-e48a-433b-8602-e97d8d43fdaa ==============================
[0m16:41:30.617020 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:41:30.617349 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m16:41:30.833851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f24b0>]}
[0m16:41:30.867359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ab470>]}
[0m16:41:30.867872 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:41:30.879777 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:41:30.923216 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m16:41:30.923663 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_sales.yml
[0m16:41:30.923851 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_sales.yml
[0m16:41:30.923995 [debug] [MainThread]: Partial parsing: added file: northwind://models/obt_sales.sql
[0m16:41:30.924132 [debug] [MainThread]: Partial parsing: added file: northwind://models/fact_sales.sql
[0m16:41:31.046993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107034ad0>]}
[0m16:41:31.053883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c287a0>]}
[0m16:41:31.054093 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:41:31.055415 [info ] [MainThread]: 
[0m16:41:31.055807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:31.056436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:41:31.062389 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:41:31.062572 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:41:31.062711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:33.495919 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.0 seconds
[0m16:41:33.498504 [debug] [ThreadPool]: On list_analytics: Close
[0m16:41:33.710383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:41:33.720782 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:41:33.721123 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:41:33.721392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:34.323636 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:41:34.327630 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:41:34.454658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107035610>]}
[0m16:41:34.455930 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:34.456322 [info ] [MainThread]: 
[0m16:41:34.460068 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:34.460540 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:34.460942 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:34.461344 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:34.461728 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:41:34.462144 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:41:34.462529 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:41:34.462892 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:41:34.464073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:41:34.464844 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:41:34.465530 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:41:34.466166 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:41:34.466518 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:34.466833 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:34.467124 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:34.467411 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:34.482193 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:41:34.486820 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:41:34.489610 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:41:34.493296 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:41:34.493993 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:41:34.482468 => 16:41:34.493836
[0m16:41:34.494330 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:41:34.467607 => 16:41:34.494134
[0m16:41:34.494684 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:41:34.487077 => 16:41:34.494506
[0m16:41:34.494950 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:34.495200 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:34.495492 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:41:34.489800 => 16:41:34.495344
[0m16:41:34.495710 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:34.508648 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:41:34.510168 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:41:34.510383 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:34.511794 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:41:34.513510 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:41:34.513963 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:41:34.514423 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:41:34.514736 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:34.515196 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:41:34.515459 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:41:34.515874 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:41:34.516066 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:34.516266 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:34.516472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:34.516666 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:34.517206 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:34.517941 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:34.883122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:34.884294 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:34.895395 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:41:34.508785 => 16:41:34.895006
[0m16:41:34.897639 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:41:34.512076 => 16:41:34.897397
[0m16:41:34.898099 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:41:34.898482 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:41:35.069025 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.61s]
[0m16:41:35.070143 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:41:35.070701 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.071396 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:41:35.072446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:41:35.072946 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.077996 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:41:35.079040 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:41:35.073217 => 16:41:35.078801
[0m16:41:35.079396 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.081975 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:41:35.082978 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:41:35.083340 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.083671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:35.228064 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.76s]
[0m16:41:35.228913 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:41:35.229357 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:35.229939 [info ] [Thread-4 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:41:35.230750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:41:35.231119 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:35.235908 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:41:35.236734 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:41:35.231335 => 16:41:35.236531
[0m16:41:35.237052 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:35.241095 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:41:35.242010 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:41:35.242346 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.242623 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:35.250766 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:35.252841 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:41:34.495852 => 16:41:35.252652
[0m16:41:35.256253 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:41:35.263948 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:35.265457 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:41:34.510507 => 16:41:35.265284
[0m16:41:35.265743 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:41:35.415164 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.95s]
[0m16:41:35.416026 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:41:35.416555 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.417135 [info ] [Thread-3 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:41:35.417902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:41:35.418289 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.423177 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:41:35.423950 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:41:35.418512 => 16:41:35.423753
[0m16:41:35.424274 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.426738 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:41:35.427795 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.429691 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:41:35.079588 => 16:41:35.429466
[0m16:41:35.430090 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:41:35.431503 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:41:35.432038 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.432386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:35.591612 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.52s]
[0m16:41:35.592511 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:41:35.593055 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:35.593747 [info ] [Thread-1 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:41:35.594720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:41:35.595166 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:35.600083 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:41:35.600931 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:41:35.595396 => 16:41:35.600702
[0m16:41:35.601265 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:35.603792 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:41:35.604793 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:41:35.605157 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.605483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:35.669180 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 1.20s]
[0m16:41:35.669714 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:41:35.670010 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:35.670321 [info ] [Thread-2 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:41:35.670887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:41:35.671131 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:35.674308 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:41:35.674869 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:41:35.671273 => 16:41:35.674720
[0m16:41:35.675123 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:35.677030 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:41:35.678063 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:41:35.678306 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:35.678537 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:35.812828 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.814843 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:41:35.424458 => 16:41:35.814614
[0m16:41:35.815210 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:41:35.947725 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:35.952714 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:41:35.237234 => 16:41:35.952289
[0m16:41:35.953347 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:41:35.957392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:35.959915 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:41:35.601445 => 16:41:35.959644
[0m16:41:35.960904 [info ] [Thread-3 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.54s]
[0m16:41:35.961564 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:41:35.962232 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:41:35.963583 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m16:41:35.964274 [info ] [Thread-3 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:41:35.964973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_customer)
[0m16:41:35.965310 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m16:41:35.969202 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:41:35.970400 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 16:41:35.965537 => 16:41:35.970207
[0m16:41:35.970680 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m16:41:35.989760 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:41:35.990534 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:41:35.990768 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:41:35.990984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:36.117066 [info ] [Thread-4 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.89s]
[0m16:41:36.117835 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:41:36.118285 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:41:36.118867 [info ] [Thread-4 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:41:36.119660 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_employee)
[0m16:41:36.120093 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:41:36.124710 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:41:36.125442 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:41:36.120333 => 16:41:36.125248
[0m16:41:36.125758 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:41:36.128246 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:41:36.129658 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:41:36.130048 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:41:36.130391 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:36.170188 [info ] [Thread-1 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.58s]
[0m16:41:36.170788 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:41:36.171155 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:41:36.171575 [info ] [Thread-1 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:41:36.172201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_date)
[0m16:41:36.172613 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:41:36.175471 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:41:36.176238 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:41:36.172869 => 16:41:36.175991
[0m16:41:36.176557 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:41:36.178745 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:41:36.179639 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:41:36.179985 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:41:36.180573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:36.488114 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:36.492703 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:41:35.675264 => 16:41:36.492390
[0m16:41:36.493363 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:41:36.692047 [info ] [Thread-2 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 1.02s]
[0m16:41:36.693216 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:41:36.693812 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m16:41:36.694549 [info ] [Thread-2 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:41:36.695562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_sales)
[0m16:41:36.696051 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m16:41:36.704492 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:41:36.705484 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 16:41:36.696338 => 16:41:36.705271
[0m16:41:36.705841 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m16:41:36.708509 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:41:36.710265 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:41:36.710651 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(ProductID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        Quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid;
[0m16:41:36.710972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:37.171893 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c555-0000-17c7-0009-ec83000201b2
[0m16:41:37.172667 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 37 at position 55 unexpected ';'.
[0m16:41:37.173330 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 16:41:36.706038 => 16:41:37.173067
[0m16:41:37.173802 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m16:41:37.298588 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 55 unexpected ';'.
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:41:37.299335 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198b3b90>]}
[0m16:41:37.299974 [error] [Thread-2 (]: 13 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.60s]
[0m16:41:37.300581 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m16:41:37.301009 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:41:37.301630 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:41:37.302415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now model.northwind.fact_order_fulfillment)
[0m16:41:37.302806 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:41:37.308485 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:41:37.309599 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:41:37.303011 => 16:41:37.309337
[0m16:41:37.309979 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:41:37.314384 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:41:37.316224 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:41:37.316622 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:41:37.316965 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:37.597286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:37.619856 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:41:36.176734 => 16:41:37.619621
[0m16:41:37.620366 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:41:37.687689 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:37.691426 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:41:36.125936 => 16:41:37.691134
[0m16:41:37.691908 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:41:37.931222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d09970>]}
[0m16:41:37.932298 [info ] [Thread-1 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.76s]
[0m16:41:37.933378 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:41:37.934272 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:41:37.935023 [info ] [Thread-1 (]: 15 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:41:37.935857 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:41:37.936383 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:41:37.936902 [info ] [Thread-1 (]: 16 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:41:37.937334 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:41:37.937718 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:37.938114 [info ] [Thread-1 (]: 17 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:41:37.938903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:41:37.939271 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:37.947193 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:41:37.948126 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:41:37.939491 => 16:41:37.947883
[0m16:41:37.948464 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:37.950880 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:41:37.951574 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:41:37.951857 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:41:37.952123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:38.048338 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ca3f0>]}
[0m16:41:38.049007 [info ] [Thread-4 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.93s]
[0m16:41:38.049533 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:41:38.049893 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:38.050310 [info ] [Thread-4 (]: 18 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:41:38.051066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:41:38.051359 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:38.055144 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:41:38.055836 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:41:38.051524 => 16:41:38.055666
[0m16:41:38.056120 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:38.058298 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:41:38.059094 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:41:38.059378 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:41:38.059922 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:38.098448 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:38.100688 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 16:41:35.970863 => 16:41:38.100520
[0m16:41:38.100993 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m16:41:38.293735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e3020>]}
[0m16:41:38.295075 [info ] [Thread-3 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 2.33s]
[0m16:41:38.296136 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m16:41:38.296692 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:38.297375 [info ] [Thread-3 (]: 19 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:41:38.298450 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:41:38.299021 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:38.304340 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:41:38.305440 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:41:38.299335 => 16:41:38.305081
[0m16:41:38.305959 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:38.308802 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:41:38.310011 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:41:38.310438 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:38.310869 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:38.525924 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:38.533550 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:41:37.310186 => 16:41:38.533142
[0m16:41:38.534283 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:41:38.748095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198c95e0>]}
[0m16:41:38.749258 [info ] [Thread-2 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.45s]
[0m16:41:38.750552 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:41:38.751228 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:38.751919 [info ] [Thread-2 (]: 20 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:41:38.753018 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:41:38.753547 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:38.758913 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:41:38.760073 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:41:38.753789 => 16:41:38.759870
[0m16:41:38.760408 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:38.765414 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:41:38.766799 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:41:38.767209 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:38.767530 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:39.567154 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:39.572972 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:41:38.306198 => 16:41:39.572587
[0m16:41:39.573662 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:41:39.616547 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:39.617676 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:41:39.620892 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:41:38.056284 => 16:41:39.620576
[0m16:41:39.623496 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:41:37.948652 => 16:41:39.623216
[0m16:41:39.623987 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:41:39.624442 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:41:39.692827 [info ] [Thread-3 (]: 19 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.39s]
[0m16:41:39.694131 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:41:39.695029 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:39.695736 [info ] [Thread-3 (]: 21 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:41:39.696832 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:41:39.697329 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:39.702759 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:41:39.703772 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:41:39.697607 => 16:41:39.703568
[0m16:41:39.704084 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:39.706634 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:41:39.707557 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:41:39.707892 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:41:39.708210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:39.787251 [info ] [Thread-4 (]: 18 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.74s]
[0m16:41:39.787878 [info ] [Thread-1 (]: 17 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 1.85s]
[0m16:41:39.788464 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:41:39.788840 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:41:39.789129 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:39.789452 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:39.789767 [info ] [Thread-4 (]: 22 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:41:39.790072 [info ] [Thread-1 (]: 23 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:41:39.790542 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:41:39.790960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:41:39.791200 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:39.791423 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:39.794543 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:41:39.797238 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:41:39.797828 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:41:39.791564 => 16:41:39.797683
[0m16:41:39.798132 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:41:39.794736 => 16:41:39.797969
[0m16:41:39.798381 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:39.798610 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:39.800343 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:41:39.801959 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:41:39.802526 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:41:39.802761 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:41:39.802984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:39.803417 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:41:39.804064 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:39.804494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:39.993677 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:39.995765 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:41:38.760608 => 16:41:39.995543
[0m16:41:39.996134 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:41:40.162805 [info ] [Thread-2 (]: 20 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 1.41s]
[0m16:41:40.164124 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:41:40.164716 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.165426 [info ] [Thread-2 (]: 24 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:41:40.166124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:41:40.166403 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.170042 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:41:40.170957 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:40.172814 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:41:39.704273 => 16:41:40.172612
[0m16:41:40.173165 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:41:40.173531 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:41:40.166556 => 16:41:40.173335
[0m16:41:40.174630 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.177238 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:41:40.178162 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:41:40.178492 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:40.178849 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:40.412909 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:40.414268 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:40.417075 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:41:39.798749 => 16:41:40.416763
[0m16:41:40.419061 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:41:39.800498 => 16:41:40.418827
[0m16:41:40.419508 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:41:40.419879 [debug] [Thread-1 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:41:40.426055 [info ] [Thread-3 (]: 21 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.73s]
[0m16:41:40.426988 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:41:40.427700 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:40.428242 [info ] [Thread-3 (]: 25 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:41:40.428944 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:41:40.429276 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:40.435679 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:41:40.436384 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:41:40.429468 => 16:41:40.436206
[0m16:41:40.436668 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:40.439005 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:41:40.439862 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:41:40.440198 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:41:40.440472 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:40.639371 [info ] [Thread-1 (]: 23 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.85s]
[0m16:41:40.640252 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:41:40.640785 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:40.641316 [info ] [Thread-1 (]: 26 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:41:40.642088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:41:40.642477 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:40.647439 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:41:40.649111 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:41:40.642735 => 16:41:40.648905
[0m16:41:40.649440 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:40.651979 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:41:40.653492 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:41:40.653900 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:41:40.654219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:40.709734 [info ] [Thread-4 (]: 22 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.92s]
[0m16:41:40.710252 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:41:40.710566 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:40.710919 [info ] [Thread-4 (]: 27 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:41:40.711511 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:41:40.711807 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:40.715375 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:41:40.716030 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:41:40.711981 => 16:41:40.715866
[0m16:41:40.716393 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:40.718450 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:41:40.719190 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:41:40.719464 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:40.719723 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:40.729793 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:40.731341 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:41:40.175152 => 16:41:40.731163
[0m16:41:40.731616 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:41:40.914074 [info ] [Thread-2 (]: 24 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.75s]
[0m16:41:40.914855 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:41:40.915303 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:40.915795 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:41:40.916604 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:41:40.917000 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:40.921567 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:41:40.922417 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:41:40.917239 => 16:41:40.922217
[0m16:41:40.922782 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:40.925347 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:41:40.926353 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:41:40.926750 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:40.927045 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:41.105764 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:41.109138 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:41:40.436843 => 16:41:41.108874
[0m16:41:41.109628 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:41:41.228696 [info ] [Thread-3 (]: 25 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.80s]
[0m16:41:41.229893 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:41:41.230600 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:41.231357 [info ] [Thread-3 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:41:41.232307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:41:41.232714 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:41.238498 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:41:41.239707 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:41:41.232951 => 16:41:41.239455
[0m16:41:41.240112 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:41.245163 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:41:41.246455 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:41:41.246873 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:41:41.247223 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:41.358268 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:41.359670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:41.363219 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:41:40.716620 => 16:41:41.362861
[0m16:41:41.366331 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:41:40.649631 => 16:41:41.365964
[0m16:41:41.366974 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:41:41.367489 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:41:41.383302 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:41:41.385012 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:41:40.923012 => 16:41:41.384833
[0m16:41:41.385315 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:41:41.491987 [info ] [Thread-1 (]: 26 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.85s]
[0m16:41:41.492871 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:41:41.493454 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:41.494058 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:41:41.495051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:41:41.495543 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:41.501997 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:41:41.507868 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:41:41.496437 => 16:41:41.507620
[0m16:41:41.508224 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:41.510699 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:41:41.511595 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:41:41.511895 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:41.512172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:41.608324 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.69s]
[0m16:41:41.608931 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:41:41.629752 [info ] [Thread-4 (]: 27 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.92s]
[0m16:41:41.630319 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:41:42.233636 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:42.234916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:41:42.238740 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:41:41.240334 => 16:41:42.238410
[0m16:41:42.241989 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:41:41.508408 => 16:41:42.241545
[0m16:41:42.242811 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:41:42.243351 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:41:42.412461 [info ] [Thread-3 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 1.18s]
[0m16:41:42.413879 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:41:42.464506 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.97s]
[0m16:41:42.465387 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:41:42.466344 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:41:42.466948 [info ] [Thread-2 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:41:42.467731 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now model.northwind.obt_order_fulfillment)
[0m16:41:42.468120 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:41:42.472708 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:41:42.473744 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:41:42.468340 => 16:41:42.473548
[0m16:41:42.474073 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:41:42.476798 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:41:42.478592 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:41:42.478988 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:41:42.479379 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:41:45.095347 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m16:41:45.101345 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:41:42.474260 => 16:41:45.101077
[0m16:41:45.102139 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:41:45.235229 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee250c41-e48a-433b-8602-e97d8d43fdaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c6dc40>]}
[0m16:41:45.236519 [info ] [Thread-2 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 2.77s]
[0m16:41:45.237427 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:41:45.240003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:45.240582 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:41:45.240884 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:41:45.241160 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:41:45.241432 [debug] [MainThread]: Connection 'test.northwind.unique_dim_customer_customerid.04913d3698' was properly closed.
[0m16:41:45.241815 [info ] [MainThread]: 
[0m16:41:45.242153 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 14.19 seconds (14.19s).
[0m16:41:45.245457 [debug] [MainThread]: Command end result
[0m16:41:45.255100 [info ] [MainThread]: 
[0m16:41:45.255510 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:45.255755 [info ] [MainThread]: 
[0m16:41:45.255992 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  001003 (42000): SQL compilation error:
  syntax error line 37 at position 55 unexpected ';'.
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:41:45.256252 [info ] [MainThread]: 
[0m16:41:45.256501 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:41:45.258520 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 14.67319, "process_user_time": 2.915022, "process_kernel_time": 0.319221, "process_mem_max_rss": "148111360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:45.258909 [debug] [MainThread]: Command `dbt build` failed at 16:41:45.258828 after 14.67 seconds
[0m16:41:45.259172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104caf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119c60290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119bbee70>]}
[0m16:41:45.259434 [debug] [MainThread]: Flushing usage events
[0m16:42:08.564500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087b3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087c20c0>]}


============================== 16:42:08.567339 | d7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00 ==============================
[0m16:42:08.567339 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:42:08.567683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:42:08.752741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cebb30>]}
[0m16:42:08.788586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8e1b0>]}
[0m16:42:08.789802 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:42:08.801725 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:42:08.836802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:42:08.837251 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:42:08.957724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960ac30>]}
[0m16:42:08.964703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109425d90>]}
[0m16:42:08.964923 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:42:08.966231 [info ] [MainThread]: 
[0m16:42:08.966601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:42:08.967195 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:42:08.973390 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:42:08.973599 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:42:08.973821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:09.871613 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:42:09.875308 [debug] [ThreadPool]: On list_analytics: Close
[0m16:42:10.000989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:42:10.012097 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:42:10.012669 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:42:10.012984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:11.333650 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:42:11.337715 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:42:11.831492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960a6c0>]}
[0m16:42:11.833028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:11.833509 [info ] [MainThread]: 
[0m16:42:11.838273 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:11.839012 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:11.839447 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:11.839847 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:11.840397 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:42:11.840961 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:42:11.841420 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:42:11.841844 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:42:11.843237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:42:11.844028 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:42:11.844780 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:42:11.845490 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:42:11.845854 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:11.846172 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:11.846470 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:11.846763 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:11.862955 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:42:11.867760 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:42:11.870586 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:42:11.873223 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:42:11.874133 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:42:11.868002 => 16:42:11.873877
[0m16:42:11.874510 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:42:11.847196 => 16:42:11.874317
[0m16:42:11.874836 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:42:11.863206 => 16:42:11.874702
[0m16:42:11.875119 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:11.875457 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:42:11.870785 => 16:42:11.875262
[0m16:42:11.875733 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:11.875980 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:11.890171 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:42:11.890444 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:11.892050 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:42:11.893510 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:42:11.895126 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:42:11.895785 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:42:11.896260 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:42:11.896500 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:11.896788 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:42:11.897223 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:42:11.897414 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:42:11.897785 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:42:11.897969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:11.898169 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:11.898806 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:11.899653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:42:11.899888 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:42:12.508700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:12.514317 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:42:11.890598 => 16:42:12.514139
[0m16:42:12.514605 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:42:12.990680 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 1.15s]
[0m16:42:12.992310 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:42:12.993157 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:12.993963 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:42:12.994814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:42:12.995164 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:12.999838 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:42:13.000702 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:42:12.995361 => 16:42:13.000524
[0m16:42:13.000984 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:13.003242 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:42:13.004124 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:42:13.004443 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:13.004727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:13.947803 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:13.953516 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:42:11.893720 => 16:42:13.953105
[0m16:42:13.954156 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:42:14.179269 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:14.184897 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:42:11.876130 => 16:42:14.184592
[0m16:42:14.185746 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:42:14.372065 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 2.53s]
[0m16:42:14.373607 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:42:14.374383 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:14.375219 [info ] [Thread-4 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:42:14.376311 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:42:14.376797 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:14.382475 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:42:14.383499 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:42:14.377072 => 16:42:14.383268
[0m16:42:14.383911 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:14.388395 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:42:14.389596 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:42:14.389989 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:14.390363 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:14.427105 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 2.58s]
[0m16:42:14.427831 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:42:14.428222 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:14.428653 [info ] [Thread-3 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:42:14.429376 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:42:14.429725 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:14.433814 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:42:14.434474 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:42:14.429927 => 16:42:14.434296
[0m16:42:14.434780 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:14.436912 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:42:14.438011 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:42:14.438321 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:14.438603 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:14.581041 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:14.583079 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:42:13.001160 => 16:42:14.582853
[0m16:42:14.583456 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:42:15.231272 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:15.235763 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:42:14.384134 => 16:42:15.235393
[0m16:42:15.236333 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:42:15.447747 [info ] [Thread-4 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 1.07s]
[0m16:42:15.448893 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:42:15.449499 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:15.451006 [info ] [Thread-4 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:42:15.452213 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:42:15.453179 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:42:15.455504 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:42:11.892205 => 16:42:15.455251
[0m16:42:15.455927 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:15.456327 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:42:15.462097 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:42:15.464689 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:42:15.456559 => 16:42:15.464340
[0m16:42:15.465137 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:15.468033 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:42:15.468773 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 2.47s]
[0m16:42:15.469508 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:42:15.470179 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:15.471121 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:42:15.471440 [info ] [Thread-1 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:42:15.471839 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:15.472417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:42:15.472713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:15.472974 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:15.477239 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:42:15.478067 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:42:15.473640 => 16:42:15.477888
[0m16:42:15.478320 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:15.480225 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:42:15.481293 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:42:15.481576 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:15.481875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:15.800386 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 3.96s]
[0m16:42:15.801717 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:42:15.802385 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m16:42:15.803261 [info ] [Thread-2 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:42:15.804200 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now model.northwind.dim_customer)
[0m16:42:15.804651 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m16:42:15.810075 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:42:15.811150 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 16:42:15.805307 => 16:42:15.810934
[0m16:42:15.811506 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m16:42:15.832427 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:42:15.833281 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:42:15.833561 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:42:15.833811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:15.957531 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:15.959407 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:42:15.465468 => 16:42:15.959206
[0m16:42:15.959859 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:42:16.217394 [info ] [Thread-4 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.76s]
[0m16:42:16.218487 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:42:16.219047 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:42:16.219716 [info ] [Thread-4 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:42:16.220673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m16:42:16.221082 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:42:16.227895 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:42:16.228836 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:42:16.221314 => 16:42:16.228646
[0m16:42:16.229153 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:42:16.232051 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:42:16.233488 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:42:16.233842 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:42:16.234151 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:16.237166 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:16.238841 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:42:14.434964 => 16:42:16.238637
[0m16:42:16.239546 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:42:16.469073 [info ] [Thread-3 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 2.04s]
[0m16:42:16.471114 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:42:16.471823 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m16:42:16.472464 [info ] [Thread-3 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:42:16.473282 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m16:42:16.473676 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m16:42:16.477229 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:42:16.478208 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 16:42:16.473904 => 16:42:16.477993
[0m16:42:16.478587 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m16:42:16.481405 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:42:16.482463 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:42:16.482798 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:42:16.483110 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:16.547744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.549483 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:42:15.478466 => 16:42:16.549289
[0m16:42:16.549797 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:42:16.640375 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:16.661454 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 16:42:15.811701 => 16:42:16.661276
[0m16:42:16.664907 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m16:42:16.778822 [info ] [Thread-1 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 1.31s]
[0m16:42:16.780348 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:42:16.781195 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:42:16.781952 [info ] [Thread-1 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:42:16.783021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:42:16.783513 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:42:16.790470 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:42:16.791505 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:42:16.783801 => 16:42:16.791314
[0m16:42:16.791843 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:42:16.794588 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:42:16.796884 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:42:16.797321 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:42:16.797725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:16.873045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109096e40>]}
[0m16:42:16.873656 [info ] [Thread-2 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.07s]
[0m16:42:16.874133 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m16:42:16.874488 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m16:42:16.874940 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:42:16.875559 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:42:16.875883 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m16:42:16.881483 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:42:16.882028 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 16:42:16.876062 => 16:42:16.881889
[0m16:42:16.882275 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m16:42:16.884242 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:42:16.885555 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:42:16.885862 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(ProductID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        Quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:42:16.886145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:17.064198 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.067363 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:42:16.229342 => 16:42:17.067133
[0m16:42:17.067746 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:42:17.196917 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6d69c0>]}
[0m16:42:17.198715 [info ] [Thread-4 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.98s]
[0m16:42:17.200407 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:42:17.201332 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:17.201982 [info ] [Thread-4 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:42:17.203018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:42:17.204060 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:17.213080 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:42:17.216370 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:42:17.204689 => 16:42:17.216073
[0m16:42:17.216868 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:17.219741 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:42:17.221144 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:42:17.221563 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:42:17.221985 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:17.321267 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b2c556-0000-17a6-0009-ec83000211e2
[0m16:42:17.321680 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:42:17.322089 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 16:42:16.882418 => 16:42:17.321923
[0m16:42:17.322369 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m16:42:17.533097 [debug] [Thread-2 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:42:17.533492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094270e0>]}
[0m16:42:17.533842 [error] [Thread-2 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.66s]
[0m16:42:17.534175 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m16:42:17.534413 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:17.534738 [info ] [Thread-2 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:42:17.535150 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:42:17.535341 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:17.538033 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:42:17.538478 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:42:17.535456 => 16:42:17.538359
[0m16:42:17.538667 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:17.540140 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:42:17.540653 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:42:17.540850 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:42:17.541033 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:17.814475 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:17.819954 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:42:17.217088 => 16:42:17.819544
[0m16:42:17.820686 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:42:18.099298 [info ] [Thread-4 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.90s]
[0m16:42:18.100538 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:42:18.101513 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:18.102358 [info ] [Thread-4 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:42:18.103452 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:42:18.103950 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:18.109315 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:42:18.110349 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:42:18.104225 => 16:42:18.110110
[0m16:42:18.110727 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:18.113725 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:42:18.114910 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:42:18.115324 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:18.115679 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:18.376558 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:18.381985 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:42:17.538776 => 16:42:18.381638
[0m16:42:18.382816 [debug] [Thread-2 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:42:18.408152 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:18.412908 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:42:16.792048 => 16:42:18.412523
[0m16:42:18.413537 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:42:18.565469 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:18.570118 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 16:42:16.478799 => 16:42:18.569819
[0m16:42:18.570739 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m16:42:18.573806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f53d0>]}
[0m16:42:18.574804 [info ] [Thread-2 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 1.04s]
[0m16:42:18.575486 [info ] [Thread-1 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.79s]
[0m16:42:18.576424 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:42:18.577135 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:42:18.577707 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:18.578192 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:18.578781 [info ] [Thread-2 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:42:18.579181 [info ] [Thread-1 (]: 19 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:42:18.579793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:42:18.580337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:42:18.580653 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:18.580966 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:18.585720 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:42:18.589589 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:42:18.590334 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:42:18.581167 => 16:42:18.590138
[0m16:42:18.590670 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:42:18.586019 => 16:42:18.590499
[0m16:42:18.590951 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:18.591269 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:18.594952 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:42:18.596868 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:42:18.597744 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:42:18.598264 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:42:18.598558 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:18.598837 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:42:18.599102 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:18.599333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:18.755520 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb2a2a0>]}
[0m16:42:18.756195 [info ] [Thread-3 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 2.28s]
[0m16:42:18.756785 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m16:42:18.757194 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:18.757712 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:42:18.758491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:42:18.758908 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:18.763565 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:42:18.771662 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:42:18.759138 => 16:42:18.771438
[0m16:42:18.773135 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:18.775485 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:42:18.776236 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:42:18.776546 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:42:18.776787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:19.085883 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.091670 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:42:18.110924 => 16:42:19.091332
[0m16:42:19.092196 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:42:19.330628 [info ] [Thread-4 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 1.23s]
[0m16:42:19.331907 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:42:19.332479 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:19.333059 [info ] [Thread-4 (]: 21 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:42:19.333957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:42:19.334373 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:19.337983 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:42:19.338628 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:42:19.334560 => 16:42:19.338459
[0m16:42:19.338886 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:19.341714 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:42:19.343068 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:42:19.343403 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:19.343668 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:19.941405 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.943136 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.944001 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:19.946794 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:42:18.591475 => 16:42:19.946523
[0m16:42:19.948807 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:42:18.773468 => 16:42:19.948579
[0m16:42:19.950700 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:42:18.595135 => 16:42:19.950466
[0m16:42:19.951125 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:42:19.951494 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:42:19.951851 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:42:20.138895 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 1.38s]
[0m16:42:20.140038 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:42:20.140578 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:20.141053 [info ] [Thread-3 (]: 22 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:42:20.141629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:42:20.141894 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:20.145436 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:42:20.146002 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:42:20.142048 => 16:42:20.145850
[0m16:42:20.146248 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:20.148201 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:42:20.148918 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:42:20.149185 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:20.149429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:20.196295 [info ] [Thread-1 (]: 19 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 1.62s]
[0m16:42:20.197002 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:42:20.197439 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:42:20.197938 [info ] [Thread-1 (]: 23 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:42:20.198405 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:42:20.198809 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:42:20.199244 [info ] [Thread-1 (]: 24 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:42:20.199662 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:42:20.200014 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:20.200362 [info ] [Thread-1 (]: 25 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:42:20.200964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:42:20.201286 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:20.205482 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:42:20.206158 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:42:20.201482 => 16:42:20.205987
[0m16:42:20.206444 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:20.210495 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:42:20.211391 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:42:20.211794 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:42:20.212140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:20.228024 [info ] [Thread-2 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 1.65s]
[0m16:42:20.228538 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:42:20.228869 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:20.229240 [info ] [Thread-2 (]: 26 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:42:20.229822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:42:20.230126 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:20.233732 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:42:20.234303 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:42:20.230294 => 16:42:20.234144
[0m16:42:20.234567 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:20.236514 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:42:20.237251 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:42:20.237523 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:20.237768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:20.283720 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:20.285224 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:42:19.339034 => 16:42:20.285075
[0m16:42:20.285506 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:42:20.460455 [info ] [Thread-4 (]: 21 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 1.13s]
[0m16:42:20.461357 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:42:20.461900 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:20.462491 [info ] [Thread-4 (]: 27 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:42:20.463336 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:42:20.463724 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:20.468836 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:42:20.469763 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:42:20.463949 => 16:42:20.469539
[0m16:42:20.470134 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:20.472713 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:42:20.473541 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:42:20.473888 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:42:20.474215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:20.799572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:20.804132 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:42:20.206614 => 16:42:20.803749
[0m16:42:20.804713 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:42:20.961997 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:42:20.967124 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:42:20.146391 => 16:42:20.966845
[0m16:42:20.967970 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:42:21.184328 [info ] [Thread-1 (]: 25 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.98s]
[0m16:42:21.185519 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:42:21.186018 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:21.186564 [info ] [Thread-1 (]: 28 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:42:21.187398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:42:21.187802 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:21.192966 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:42:21.193891 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:42:21.188031 => 16:42:21.193697
[0m16:42:21.194215 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:21.197129 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:42:21.198305 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:42:21.198671 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:42:21.199042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:21.316042 [info ] [Thread-3 (]: 22 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 1.17s]
[0m16:42:21.316875 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:42:21.317329 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:21.317817 [info ] [Thread-3 (]: 29 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:42:21.318562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeekey.e313069a83, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:42:21.318913 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:21.323386 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:42:21.324261 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:42:21.319127 => 16:42:21.324055
[0m16:42:21.324590 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:21.326992 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:42:21.327886 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:42:21.328240 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:21.328540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:21.611731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:42:21.615997 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:42:21.194411 => 16:42:21.615588
[0m16:42:21.616770 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:42:22.653773 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:22.654637 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:42:22.655639 [info ] [Thread-1 (]: 28 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 1.47s]
[0m16:42:22.657908 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:42:20.470359 => 16:42:22.657670
[0m16:42:22.659601 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:42:20.234714 => 16:42:22.659391
[0m16:42:22.660094 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:42:22.660428 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:42:22.660736 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:42:22.661095 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:22.663799 [info ] [Thread-1 (]: 30 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:42:22.664600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:42:22.664983 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:22.670939 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:42:22.672404 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:42:22.665168 => 16:42:22.672217
[0m16:42:22.672691 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:22.674621 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:42:22.675317 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:42:22.675576 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:22.675822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:22.854305 [info ] [Thread-2 (]: 26 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 2.62s]
[0m16:42:22.855130 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:42:26.964518 [info ] [Thread-4 (]: 27 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 6.50s]
[0m16:42:26.966307 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:42:27.104092 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m16:42:27.108763 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:42:21.324779 => 16:42:27.108294
[0m16:42:27.109649 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:42:28.854885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m16:42:28.859042 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:42:22.672841 => 16:42:28.858538
[0m16:42:28.859786 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:42:29.121140 [info ] [Thread-1 (]: 30 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 6.46s]
[0m16:42:29.122532 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:42:29.863153 [info ] [Thread-3 (]: 29 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 8.54s]
[0m16:42:29.864701 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:42:29.865862 [debug] [Thread-2 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:42:29.866631 [info ] [Thread-2 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:42:29.867720 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now model.northwind.obt_order_fulfillment)
[0m16:42:29.868235 [debug] [Thread-2 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:42:29.873219 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:42:29.874255 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:42:29.868531 => 16:42:29.874016
[0m16:42:29.874639 [debug] [Thread-2 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:42:29.877463 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:42:29.879115 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:42:29.879538 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:42:29.879906 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:33.474863 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m16:42:33.481045 [debug] [Thread-2 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:42:29.874861 => 16:42:33.480710
[0m16:42:33.481753 [debug] [Thread-2 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:42:34.284971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d5a0e9-043f-44a7-9ac0-2f2e5ca4ec00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10950a480>]}
[0m16:42:34.286000 [info ] [Thread-2 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 4.42s]
[0m16:42:34.286657 [debug] [Thread-2 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:42:34.288640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:34.288974 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_datekey.d14b9b9f02' was properly closed.
[0m16:42:34.289229 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:42:34.289457 [debug] [MainThread]: Connection 'test.northwind.unique_dim_date_date.dd069a8d31' was properly closed.
[0m16:42:34.289681 [debug] [MainThread]: Connection 'test.northwind.not_null_dim_date_date.78f11e7735' was properly closed.
[0m16:42:34.290002 [info ] [MainThread]: 
[0m16:42:34.290301 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 25.32 seconds (25.32s).
[0m16:42:34.293544 [debug] [MainThread]: Command end result
[0m16:42:34.302655 [info ] [MainThread]: 
[0m16:42:34.303043 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:42:34.303285 [info ] [MainThread]: 
[0m16:42:34.303523 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:42:34.303775 [info ] [MainThread]: 
[0m16:42:34.303995 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:42:34.305734 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 25.780346, "process_user_time": 3.029697, "process_kernel_time": 0.307656, "process_mem_max_rss": "143982592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:42:34.306163 [debug] [MainThread]: Command `dbt build` failed at 16:42:34.306068 after 25.78 seconds
[0m16:42:34.306451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109727050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a674b60>]}
[0m16:42:34.306719 [debug] [MainThread]: Flushing usage events
[0m16:43:42.024918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ae8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0e2a0>]}


============================== 16:43:42.027617 | 78ed5dce-c510-43c1-8d2d-35dc5b867962 ==============================
[0m16:43:42.027617 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:43:42.027927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:42.210422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153f3170>]}
[0m16:43:42.245012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e55430>]}
[0m16:43:42.246261 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:43:42.258245 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:43:42.293091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:42.293536 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:43:42.413281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b8cd10>]}
[0m16:43:42.420246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158252e0>]}
[0m16:43:42.420467 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:43:42.421791 [info ] [MainThread]: 
[0m16:43:42.422157 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:42.422751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:43:42.428870 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:43:42.429094 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:43:42.429243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:43.328828 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:43:43.331981 [debug] [ThreadPool]: On list_analytics: Close
[0m16:43:43.465365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:43:43.476270 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:43:43.476685 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:43:43.477020 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:43.986174 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:43:43.991430 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:43:44.176317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115153ec0>]}
[0m16:43:44.177727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:44.178195 [info ] [MainThread]: 
[0m16:43:44.182831 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.183420 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.183881 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.184332 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.184758 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:43:44.185228 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:43:44.185637 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:43:44.186031 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:43:44.187269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:43:44.188063 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:43:44.188772 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:43:44.189358 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:43:44.189693 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.190001 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.190285 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.190568 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.206512 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:43:44.211236 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:43:44.214101 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:43:44.217065 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:43:44.217928 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:43:44.190767 => 16:43:44.217720
[0m16:43:44.218308 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:43:44.211479 => 16:43:44.218156
[0m16:43:44.218586 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.218902 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:43:44.206775 => 16:43:44.218761
[0m16:43:44.219169 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.219416 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:43:44.214339 => 16:43:44.219291
[0m16:43:44.233549 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:43:44.233848 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.235445 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:43:44.235696 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.237234 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:43:44.238909 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:43:44.239380 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:43:44.239824 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:43:44.240113 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:43:44.240568 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:43:44.240760 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.240972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.241331 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:43:44.241537 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.241743 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:43:44.242338 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.242745 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:44.243218 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:44.785492 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.800417 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:43:44.237472 => 16:43:44.800055
[0m16:43:44.801187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.801839 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.802501 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:44.802977 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:43:44.805054 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:43:44.219557 => 16:43:44.804847
[0m16:43:44.806665 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:43:44.234017 => 16:43:44.806478
[0m16:43:44.808215 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:43:44.235912 => 16:43:44.808025
[0m16:43:44.809427 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:43:44.810047 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:43:44.810424 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:43:44.927020 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.74s]
[0m16:43:44.928471 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:43:44.929881 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.74s]
[0m16:43:44.931092 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:44.932167 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:43:44.932733 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:43:44.933367 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:44.934261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:43:44.934763 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:43:44.935183 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:44.935855 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:43:44.936740 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.75s]
[0m16:43:44.937595 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.75s]
[0m16:43:44.942561 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:43:44.943055 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:44.943543 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:43:44.943970 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:43:44.947836 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:43:44.948281 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:44.948674 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:43:44.937876 => 16:43:44.948509
[0m16:43:44.949073 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:44.949537 [info ] [Thread-4 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:43:44.949886 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:44.950227 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:43:44.944272 => 16:43:44.950055
[0m16:43:44.950511 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:43:44.951163 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:43:44.953481 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:43:44.953809 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:44.954307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:43:44.954582 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:44.956968 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:43:44.957758 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:43:44.958054 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:44.962689 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:43:44.963038 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.965864 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:43:44.966460 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:43:44.966712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:44.967048 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:43:44.958260 => 16:43:44.966899
[0m16:43:44.967311 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.968182 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:43:44.963241 => 16:43:44.968056
[0m16:43:44.968607 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:44.968875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:44.969112 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:44.970917 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:43:44.973479 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:43:44.974487 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:43:44.974973 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:43:44.975295 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.975866 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:44.976110 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:44.976336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:45.423997 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.425360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.429237 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:43:44.969252 => 16:43:45.428604
[0m16:43:45.432538 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:43:44.951418 => 16:43:45.432160
[0m16:43:45.433562 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:43:45.434608 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.435296 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:45.435736 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:43:45.438763 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:43:44.971801 => 16:43:45.438524
[0m16:43:45.440838 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:43:44.954811 => 16:43:45.440632
[0m16:43:45.442076 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:43:45.442682 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:43:45.559807 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.61s]
[0m16:43:45.561712 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.63s]
[0m16:43:45.562715 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:43:45.563460 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:43:45.564028 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:45.564701 [debug] [Thread-1 (]: Began running node model.northwind.dim_customer
[0m16:43:45.565389 [info ] [Thread-2 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:43:45.566037 [info ] [Thread-1 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:43:45.566816 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:43:45.567513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_customer)
[0m16:43:45.568345 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:45.568739 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_customer
[0m16:43:45.572375 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.64s]
[0m16:43:45.577070 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:43:45.579627 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:43:45.580147 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:43:45.580688 [debug] [Thread-3 (]: Began running node model.northwind.dim_date
[0m16:43:45.581153 [info ] [Thread-3 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:43:45.581818 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:43:45.582201 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_date
[0m16:43:45.582903 [info ] [Thread-4 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.63s]
[0m16:43:45.583290 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:43:45.569012 => 16:43:45.583114
[0m16:43:45.585811 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:43:45.586155 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (compile): 16:43:45.573120 => 16:43:45.585998
[0m16:43:45.586544 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:43:45.586825 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:45.587149 [debug] [Thread-1 (]: Began executing node model.northwind.dim_customer
[0m16:43:45.587473 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:43:45.587844 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (compile): 16:43:45.583479 => 16:43:45.587716
[0m16:43:45.589768 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:43:45.607972 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:43:45.608329 [info ] [Thread-4 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:43:45.608594 [debug] [Thread-3 (]: Began executing node model.northwind.dim_date
[0m16:43:45.609172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:43:45.610983 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:43:45.611470 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:43:45.611906 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:43:45.612113 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:43:45.612386 [debug] [Thread-1 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:43:45.612639 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:45.615063 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:43:45.615489 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:43:45.615703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:45.615933 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:45.616209 [debug] [Thread-3 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:43:45.617367 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:43:45.612781 => 16:43:45.617243
[0m16:43:45.617711 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:45.617963 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:43:45.619968 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:43:45.621303 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:43:45.621545 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:43:45.621745 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:46.051286 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:46.052843 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:43:45.587973 => 16:43:46.052677
[0m16:43:46.053110 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:43:46.155697 [info ] [Thread-2 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.59s]
[0m16:43:46.156271 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:43:46.156648 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:43:46.157102 [info ] [Thread-2 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:43:46.157798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:43:46.158138 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:43:46.164145 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:43:46.164982 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:43:46.158328 => 16:43:46.164808
[0m16:43:46.165276 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:43:46.167775 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:43:46.170028 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:43:46.170425 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:43:46.170774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:46.293916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.308842 [debug] [Thread-1 (]: Timing info for model.northwind.dim_customer (execute): 16:43:45.589947 => 16:43:46.308674
[0m16:43:46.309154 [debug] [Thread-1 (]: On model.northwind.dim_customer: Close
[0m16:43:46.421709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157eef60>]}
[0m16:43:46.422372 [info ] [Thread-1 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.85s]
[0m16:43:46.422987 [debug] [Thread-1 (]: Finished running node model.northwind.dim_customer
[0m16:43:46.423418 [debug] [Thread-1 (]: Began running node model.northwind.fact_sales
[0m16:43:46.424010 [info ] [Thread-1 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:43:46.424799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:43:46.425248 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_sales
[0m16:43:46.432334 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:43:46.433112 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (compile): 16:43:46.425491 => 16:43:46.432920
[0m16:43:46.433429 [debug] [Thread-1 (]: Began executing node model.northwind.fact_sales
[0m16:43:46.437406 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:43:46.438938 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:43:46.439294 [debug] [Thread-1 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(ProductID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:43:46.439617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:46.547564 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.549957 [debug] [Thread-3 (]: Timing info for model.northwind.dim_date (execute): 16:43:45.609396 => 16:43:46.549775
[0m16:43:46.550272 [debug] [Thread-3 (]: On model.northwind.dim_date: Close
[0m16:43:46.793894 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:46.800060 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:43:45.618462 => 16:43:46.799797
[0m16:43:46.800580 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:43:46.866641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11669e9f0>]}
[0m16:43:46.867677 [info ] [Thread-3 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.28s]
[0m16:43:46.868462 [debug] [Thread-3 (]: Finished running node model.northwind.dim_date
[0m16:43:46.869500 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:46.870328 [info ] [Thread-3 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:43:46.871302 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:43:46.871746 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:46.880199 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:43:46.881370 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:43:46.872020 => 16:43:46.881085
[0m16:43:46.881748 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:46.884497 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:43:46.885426 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:43:46.885771 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:43:46.886082 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:46.903567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11765d340>]}
[0m16:43:46.904183 [info ] [Thread-4 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.29s]
[0m16:43:46.904809 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:43:46.905257 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:46.905684 [info ] [Thread-4 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:43:46.906324 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:43:46.906701 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:46.910360 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:43:46.910960 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:43:46.906876 => 16:43:46.910805
[0m16:43:46.911276 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:46.913389 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:43:46.914089 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:43:46.914431 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:43:46.914744 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:46.915591 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2c557-0000-17a6-0009-ec8300021226
[0m16:43:46.916063 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:43:46.916414 [debug] [Thread-1 (]: Timing info for model.northwind.fact_sales (execute): 16:43:46.433624 => 16:43:46.916281
[0m16:43:46.916645 [debug] [Thread-1 (]: On model.northwind.fact_sales: Close
[0m16:43:47.033483 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:43:47.033900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167954f0>]}
[0m16:43:47.034306 [error] [Thread-1 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.61s]
[0m16:43:47.034702 [debug] [Thread-1 (]: Finished running node model.northwind.fact_sales
[0m16:43:47.034980 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.035319 [info ] [Thread-1 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:43:47.035867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:43:47.036103 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.039215 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:43:47.039737 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:43:47.036245 => 16:43:47.039594
[0m16:43:47.039977 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.041931 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:43:47.042663 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:43:47.042927 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.043144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.141439 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.143558 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:43:46.165438 => 16:43:47.143396
[0m16:43:47.143865 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:43:47.322924 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167710a0>]}
[0m16:43:47.324490 [info ] [Thread-2 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.17s]
[0m16:43:47.325507 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:43:47.326051 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.326602 [info ] [Thread-2 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:43:47.327384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:43:47.327771 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.332873 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:43:47.333864 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:43:47.327993 => 16:43:47.333660
[0m16:43:47.334200 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.336707 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:43:47.337677 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:43:47.338022 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.338333 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:47.411868 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.415450 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:43:46.881961 => 16:43:47.415245
[0m16:43:47.416071 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:43:47.416583 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.418799 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:43:46.911519 => 16:43:47.418624
[0m16:43:47.419339 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:43:47.473047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:47.474789 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:43:47.040156 => 16:43:47.474583
[0m16:43:47.475179 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:43:47.534213 [info ] [Thread-4 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.63s]
[0m16:43:47.535145 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:43:47.535592 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:47.536059 [info ] [Thread-4 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:43:47.536823 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:43:47.537202 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:47.541674 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:43:47.542423 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:43:47.537423 => 16:43:47.542234
[0m16:43:47.542738 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:47.545137 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:43:47.546432 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:43:47.546795 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:43:47.547727 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:47.547456 [info ] [Thread-3 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.68s]
[0m16:43:47.548666 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:43:47.549191 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:47.549547 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:43:47.550092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:43:47.550425 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:47.554024 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:43:47.554841 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:43:47.550776 => 16:43:47.554655
[0m16:43:47.555130 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:47.557070 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:43:47.557753 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:43:47.558024 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:43:47.558264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:47.588511 [info ] [Thread-1 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.55s]
[0m16:43:47.589060 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:43:47.589379 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:47.589696 [info ] [Thread-1 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:43:47.590216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:43:47.590489 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:47.593613 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:43:47.594261 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:43:47.590637 => 16:43:47.594119
[0m16:43:47.594519 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:47.596512 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:43:47.597481 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:43:47.597953 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.598246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:47.852012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:47.855848 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:43:47.334391 => 16:43:47.855510
[0m16:43:47.856574 [debug] [Thread-2 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:43:47.973246 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:47.974663 [info ] [Thread-2 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.65s]
[0m16:43:47.978261 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:43:47.542923 => 16:43:47.977845
[0m16:43:47.979023 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:43:47.979434 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:43:47.979887 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:47.981508 [info ] [Thread-2 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:43:47.982724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:43:47.983238 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:47.988390 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:43:47.991384 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:43:47.983486 => 16:43:47.991147
[0m16:43:47.991766 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:47.994281 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:43:47.995569 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:43:47.995907 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:47.996202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:48.097748 [info ] [Thread-4 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.56s]
[0m16:43:48.098421 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:43:48.098803 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.099211 [info ] [Thread-4 (]: 23 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:43:48.099869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:43:48.100198 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.103997 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:43:48.104708 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:43:48.100391 => 16:43:48.104534
[0m16:43:48.104989 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.108726 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:43:48.109498 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:43:48.109770 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:43:48.110021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:48.179728 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.181477 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:43:47.555285 => 16:43:48.181289
[0m16:43:48.181752 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:43:48.182979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.184354 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:43:47.594756 => 16:43:48.184195
[0m16:43:48.184613 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:43:48.376046 [info ] [Thread-1 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.79s]
[0m16:43:48.377012 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.83s]
[0m16:43:48.378068 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:43:48.378597 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:43:48.379036 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.379578 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.380049 [info ] [Thread-1 (]: 24 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:43:48.380460 [info ] [Thread-3 (]: 25 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:43:48.381153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:43:48.381768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:43:48.382134 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.382507 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.387253 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:43:48.390942 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:43:48.391702 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:43:48.382759 => 16:43:48.391523
[0m16:43:48.392079 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:43:48.387544 => 16:43:48.391892
[0m16:43:48.392358 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.392641 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.394765 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:43:48.396764 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:43:48.397504 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:43:48.397825 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:43:48.398445 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:43:48.398699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:48.398980 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:48.399715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:48.491798 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:48.493452 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:43:47.991964 => 16:43:48.493268
[0m16:43:48.493750 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:43:48.602054 [info ] [Thread-2 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.62s]
[0m16:43:48.602809 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:43:48.603260 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:48.603743 [info ] [Thread-2 (]: 26 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:43:48.604584 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:43:48.605005 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:48.609789 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:43:48.610621 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:43:48.605234 => 16:43:48.610418
[0m16:43:48.610939 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:48.613398 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:43:48.614368 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:43:48.614746 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:48.615063 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:48.649561 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:48.651646 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:43:48.105145 => 16:43:48.651436
[0m16:43:48.651986 [debug] [Thread-4 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:43:48.756870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:48.759057 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:43:48.392813 => 16:43:48.758808
[0m16:43:48.759921 [info ] [Thread-4 (]: 23 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.66s]
[0m16:43:48.760428 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:43:48.760966 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:43:48.762356 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:43:48.763115 [info ] [Thread-4 (]: 27 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:43:48.763660 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:43:48.764064 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:43:48.764490 [info ] [Thread-4 (]: 28 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:43:48.764992 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:43:48.765602 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:48.766076 [info ] [Thread-4 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:43:48.766756 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:43:48.767095 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:48.771540 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:43:48.772275 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:43:48.767291 => 16:43:48.772093
[0m16:43:48.772577 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:48.774860 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:43:48.775643 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:43:48.775938 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:43:48.776210 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:48.777368 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:48.779090 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:43:48.394966 => 16:43:48.778916
[0m16:43:48.779444 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:43:48.953022 [info ] [Thread-1 (]: 24 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.57s]
[0m16:43:48.953976 [info ] [Thread-3 (]: 25 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.57s]
[0m16:43:48.954771 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:43:48.955207 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:43:48.955584 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:48.956047 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:43:48.956651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:43:48.956971 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:48.963855 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:43:48.964936 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:43:48.957160 => 16:43:48.964725
[0m16:43:48.965262 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:48.967760 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:43:48.968782 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:43:48.969098 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:48.969379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:49.010953 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:49.013094 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:43:48.611125 => 16:43:49.012863
[0m16:43:49.013680 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:43:49.134493 [info ] [Thread-2 (]: 26 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.53s]
[0m16:43:49.135327 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:43:49.297338 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:49.300999 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:43:48.772745 => 16:43:49.300677
[0m16:43:49.301549 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:43:49.415160 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:43:49.419025 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:43:48.965437 => 16:43:49.418540
[0m16:43:49.419848 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:43:49.481272 [info ] [Thread-4 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.71s]
[0m16:43:49.482246 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:43:49.545164 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.59s]
[0m16:43:49.546188 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:43:49.547162 [debug] [Thread-3 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:43:49.547769 [info ] [Thread-3 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:43:49.548526 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:43:49.548902 [debug] [Thread-3 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:43:49.553654 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:43:49.554681 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:43:49.549124 => 16:43:49.554475
[0m16:43:49.555025 [debug] [Thread-3 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:43:49.557761 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:43:49.559407 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:43:49.559795 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:43:49.560155 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:50.513634 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:43:50.518954 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:43:49.555227 => 16:43:50.518681
[0m16:43:50.519500 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:43:50.632104 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ed5dce-c510-43c1-8d2d-35dc5b867962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1167e47d0>]}
[0m16:43:50.633211 [info ] [Thread-3 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.08s]
[0m16:43:50.634005 [debug] [Thread-3 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:43:50.637005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:50.637682 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:43:50.638053 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:43:50.638394 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:43:50.638704 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:43:50.639203 [info ] [MainThread]: 
[0m16:43:50.639630 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.22 seconds (8.22s).
[0m16:43:50.643475 [debug] [MainThread]: Command end result
[0m16:43:50.654636 [info ] [MainThread]: 
[0m16:43:50.654958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:50.655181 [info ] [MainThread]: 
[0m16:43:50.655403 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:43:50.655651 [info ] [MainThread]: 
[0m16:43:50.655880 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:43:50.657952 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.659736, "process_user_time": 2.78211, "process_kernel_time": 0.284469, "process_mem_max_rss": "149569536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:43:50.658340 [debug] [MainThread]: Command `dbt build` failed at 16:43:50.658254 after 8.66 seconds
[0m16:43:50.658617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12246bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122495b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1153c9580>]}
[0m16:43:50.658886 [debug] [MainThread]: Flushing usage events
[0m16:44:43.361386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d56c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7d5b0>]}


============================== 16:44:43.364228 | 25e70b54-e0a4-4c62-9bbf-1dd6772e0209 ==============================
[0m16:44:43.364228 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:44:43.364558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:44:43.562760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f102f0>]}
[0m16:44:43.599775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075ce6f0>]}
[0m16:44:43.600484 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:44:43.613624 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:44:43.650511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:44:43.650999 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:44:43.773757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782ba70>]}
[0m16:44:43.780987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078eb710>]}
[0m16:44:43.781235 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:44:43.782659 [info ] [MainThread]: 
[0m16:44:43.783078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:44:43.783710 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:44:43.789886 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:44:43.790103 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:44:43.790248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:44.860740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:44:44.863963 [debug] [ThreadPool]: On list_analytics: Close
[0m16:44:45.125335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:44:45.133434 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:44:45.133782 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:44:45.134050 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:45.669698 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:44:45.672072 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:44:45.783284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d56600>]}
[0m16:44:45.784220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:44:45.784650 [info ] [MainThread]: 
[0m16:44:45.787863 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:45.788309 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:45.788954 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:45.788650 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:44:45.789331 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:45.789686 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:44:45.790045 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:44:45.791159 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:44:45.790696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:44:45.792086 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:44:45.792691 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:44:45.793635 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:44:45.794086 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:45.794405 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:45.794673 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:45.794943 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:45.809099 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:44:45.813610 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:44:45.816196 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:44:45.818672 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:44:45.819534 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:44:45.809347 => 16:44:45.819284
[0m16:44:45.819921 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:44:45.795119 => 16:44:45.819720
[0m16:44:45.820205 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:44:45.813823 => 16:44:45.820072
[0m16:44:45.820463 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:45.820714 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:44:45.816369 => 16:44:45.820579
[0m16:44:45.820931 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:45.821137 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:45.835427 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:44:45.835714 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:45.837231 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:44:45.838657 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:44:45.840251 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:44:45.840828 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:44:45.841199 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:45.841657 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:44:45.841874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:44:45.842166 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:44:45.842621 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:44:45.843397 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:44:45.843708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:45.844102 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:45.844366 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:45.844820 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:44:45.845179 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:44:46.263046 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.264232 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.273934 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:44:45.837374 => 16:44:46.273597
[0m16:44:46.274948 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.276828 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:44:45.838861 => 16:44:46.276617
[0m16:44:46.277385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.277778 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:44:46.279498 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:44:45.821276 => 16:44:46.279304
[0m16:44:46.279840 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:44:46.281405 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:44:45.835857 => 16:44:46.281215
[0m16:44:46.282665 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:44:46.284050 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:44:46.384954 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.59s]
[0m16:44:46.385495 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:44:46.385750 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.386063 [info ] [Thread-4 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:44:46.386420 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:44:46.386599 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.389717 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:44:46.390422 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:44:46.386704 => 16:44:46.390287
[0m16:44:46.390636 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.392395 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:44:46.393021 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:44:46.393227 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.393414 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:46.396328 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.60s]
[0m16:44:46.396772 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.61s]
[0m16:44:46.397157 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.61s]
[0m16:44:46.397664 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:44:46.397991 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:44:46.398236 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:44:46.398446 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.398691 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.398924 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.399187 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:44:46.399408 [info ] [Thread-1 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:44:46.399595 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:44:46.399925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:44:46.400220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:44:46.400505 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:44:46.400676 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.400830 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.400990 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.403559 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:44:46.406937 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:44:46.409238 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:44:46.409896 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:44:46.407152 => 16:44:46.409723
[0m16:44:46.410181 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:44:46.401088 => 16:44:46.410030
[0m16:44:46.410457 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:44:46.403742 => 16:44:46.410310
[0m16:44:46.410642 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.410818 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.411002 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.412574 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:44:46.414034 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:44:46.415583 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:44:46.416224 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:44:46.416590 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:44:46.416928 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:44:46.417137 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.417337 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.417541 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.417713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:46.417861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:46.418011 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:46.766047 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.768079 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:44:46.390750 => 16:44:46.767869
[0m16:44:46.768404 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:44:46.775751 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.777291 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:44:46.412709 => 16:44:46.777119
[0m16:44:46.777571 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:44:46.812750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.814693 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:44:46.414192 => 16:44:46.814501
[0m16:44:46.815004 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:44:46.832065 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:46.833723 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:44:46.411102 => 16:44:46.833538
[0m16:44:46.834079 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:44:46.877309 [info ] [Thread-4 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.49s]
[0m16:44:46.877886 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:44:46.878262 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:46.878714 [info ] [Thread-4 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:44:46.879315 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:44:46.879643 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:46.884279 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:44:46.885064 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:44:46.879841 => 16:44:46.884867
[0m16:44:46.885362 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:46.888175 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:44:46.889067 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:44:46.889427 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:46.889849 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:46.892978 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.49s]
[0m16:44:46.893501 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:44:46.893823 [debug] [Thread-3 (]: Began running node model.northwind.dim_customer
[0m16:44:46.894202 [info ] [Thread-3 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:44:46.894700 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_customer)
[0m16:44:46.894968 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_customer
[0m16:44:46.898164 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:44:46.898768 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (compile): 16:44:46.895110 => 16:44:46.898621
[0m16:44:46.899007 [debug] [Thread-3 (]: Began executing node model.northwind.dim_customer
[0m16:44:46.916373 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:44:46.917124 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:44:46.917348 [debug] [Thread-3 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:44:46.917554 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:46.923733 [info ] [Thread-1 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.52s]
[0m16:44:46.924130 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:44:46.924375 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:44:46.924699 [info ] [Thread-1 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:44:46.925062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_date)
[0m16:44:46.925245 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:44:46.927035 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:44:46.927458 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:44:46.925355 => 16:44:46.927346
[0m16:44:46.927635 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:44:46.929214 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:44:46.929799 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:44:46.930000 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:44:46.930188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:46.951856 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.55s]
[0m16:44:46.952258 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:44:46.952487 [debug] [Thread-2 (]: Began running node model.northwind.dim_employee
[0m16:44:46.952798 [info ] [Thread-2 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:44:46.953166 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_employee)
[0m16:44:46.953345 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_employee
[0m16:44:46.956040 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:44:46.956512 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (compile): 16:44:46.953453 => 16:44:46.956401
[0m16:44:46.956700 [debug] [Thread-2 (]: Began executing node model.northwind.dim_employee
[0m16:44:46.958242 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:44:46.959137 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:44:46.959360 [debug] [Thread-2 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:44:46.959567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:47.319511 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:47.324341 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:44:46.886053 => 16:44:47.323919
[0m16:44:47.325037 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:44:47.468584 [info ] [Thread-4 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.59s]
[0m16:44:47.470259 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:44:47.471040 [debug] [Thread-4 (]: Began running node model.northwind.fact_sales
[0m16:44:47.471804 [info ] [Thread-4 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:44:47.472912 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_sales)
[0m16:44:47.473354 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_sales
[0m16:44:47.481924 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:44:47.482811 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (compile): 16:44:47.473582 => 16:44:47.482611
[0m16:44:47.483146 [debug] [Thread-4 (]: Began executing node model.northwind.fact_sales
[0m16:44:47.485838 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:44:47.487511 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:44:47.487912 [debug] [Thread-4 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:44:47.488436 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:47.615131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:47.617047 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:47.639834 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:44:46.927748 => 16:44:47.639636
[0m16:44:47.641979 [debug] [Thread-3 (]: Timing info for model.northwind.dim_customer (execute): 16:44:46.899148 => 16:44:47.641817
[0m16:44:47.642296 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:44:47.642569 [debug] [Thread-3 (]: On model.northwind.dim_customer: Close
[0m16:44:47.751124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078815e0>]}
[0m16:44:47.752231 [info ] [Thread-1 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.83s]
[0m16:44:47.753063 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:44:47.753618 [debug] [Thread-1 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:44:47.754274 [info ] [Thread-1 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:44:47.755409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now model.northwind.fact_order_fulfillment)
[0m16:44:47.756470 [debug] [Thread-1 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:44:47.767660 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:44:47.768521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba192b0>]}
[0m16:44:47.769931 [info ] [Thread-3 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.87s]
[0m16:44:47.770503 [debug] [Thread-3 (]: Finished running node model.northwind.dim_customer
[0m16:44:47.770887 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:47.771277 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:44:47.757492 => 16:44:47.771069
[0m16:44:47.771649 [info ] [Thread-3 (]: 15 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:44:47.772057 [debug] [Thread-1 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:44:47.772556 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:44:47.776846 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:44:47.777163 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:47.782536 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:44:47.784128 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:44:47.784528 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:44:47.784921 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:44:47.777427 => 16:44:47.784779
[0m16:44:47.785135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:47.785361 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:47.787688 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:44:47.788556 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:44:47.788854 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:44:47.789094 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:47.977335 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c558-0000-17c7-0009-ec830002027a
[0m16:44:47.977818 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:44:47.978283 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (execute): 16:44:47.483368 => 16:44:47.978099
[0m16:44:47.978580 [debug] [Thread-4 (]: On model.northwind.fact_sales: Close
[0m16:44:48.265097 [debug] [Thread-4 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:44:48.265819 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9f410>]}
[0m16:44:48.266462 [error] [Thread-4 (]: 13 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.79s]
[0m16:44:48.267093 [debug] [Thread-4 (]: Finished running node model.northwind.fact_sales
[0m16:44:48.267533 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.268130 [info ] [Thread-4 (]: 16 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:44:48.268995 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:44:48.269449 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.274448 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:44:48.275291 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:44:48.269683 => 16:44:48.275092
[0m16:44:48.275603 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.278112 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:44:48.279069 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:44:48.279863 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:44:48.280181 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:48.286249 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:48.288505 [debug] [Thread-2 (]: Timing info for model.northwind.dim_employee (execute): 16:44:46.956806 => 16:44:48.288345
[0m16:44:48.288843 [debug] [Thread-2 (]: On model.northwind.dim_employee: Close
[0m16:44:48.412444 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba4a300>]}
[0m16:44:48.413158 [info ] [Thread-2 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 1.46s]
[0m16:44:48.413767 [debug] [Thread-2 (]: Finished running node model.northwind.dim_employee
[0m16:44:48.414201 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:48.414569 [info ] [Thread-2 (]: 17 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:44:48.415423 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:44:48.415802 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:48.420291 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:44:48.421052 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:44:48.416013 => 16:44:48.420857
[0m16:44:48.421364 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:48.423534 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:44:48.424333 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:44:48.424627 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:48.424905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:48.428513 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:48.430270 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:44:47.785923 => 16:44:48.430073
[0m16:44:48.430584 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:44:48.533404 [info ] [Thread-3 (]: 15 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.76s]
[0m16:44:48.533960 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:44:48.534277 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:48.534626 [info ] [Thread-3 (]: 18 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:44:48.535205 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:44:48.535490 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:48.539108 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:44:48.539700 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:44:48.535654 => 16:44:48.539541
[0m16:44:48.539969 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:48.542088 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:44:48.544176 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:44:48.544503 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:48.544757 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:48.664266 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:48.674763 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:44:48.275787 => 16:44:48.674433
[0m16:44:48.675987 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:44:48.800125 [info ] [Thread-4 (]: 16 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.53s]
[0m16:44:48.801546 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:44:48.802244 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:48.803056 [info ] [Thread-4 (]: 19 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:44:48.809014 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:44:48.809460 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:48.817042 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:44:48.817917 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:44:48.810389 => 16:44:48.817701
[0m16:44:48.818229 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:48.820678 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:44:48.821426 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:44:48.821715 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:44:48.821989 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:48.847063 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:48.849407 [debug] [Thread-1 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:44:47.772732 => 16:44:48.849227
[0m16:44:48.849735 [debug] [Thread-1 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:44:48.952579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f4b30>]}
[0m16:44:48.953222 [info ] [Thread-1 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.20s]
[0m16:44:48.953822 [debug] [Thread-1 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:44:48.954242 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:48.954742 [info ] [Thread-1 (]: 20 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:44:48.955511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:44:48.955976 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:48.960292 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:44:48.961067 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:44:48.956243 => 16:44:48.960879
[0m16:44:48.961391 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:48.963849 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:44:48.964629 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:44:48.965353 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:44:48.965686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:49.184443 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.188652 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:44:48.540126 => 16:44:49.188041
[0m16:44:49.189376 [debug] [Thread-3 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:44:49.304669 [info ] [Thread-3 (]: 18 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.77s]
[0m16:44:49.305696 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:44:49.306264 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.306814 [info ] [Thread-3 (]: 21 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:44:49.308105 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:44:49.308885 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.314494 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:44:49.315840 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:49.318031 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:44:48.818406 => 16:44:49.317811
[0m16:44:49.318452 [debug] [Thread-4 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:44:49.319738 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:44:49.309194 => 16:44:49.319527
[0m16:44:49.320398 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.323161 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:44:49.324606 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:44:49.325042 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:49.325426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:49.326794 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.328632 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:44:48.421548 => 16:44:49.328430
[0m16:44:49.330026 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:44:49.434615 [info ] [Thread-4 (]: 19 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.63s]
[0m16:44:49.435236 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:44:49.435600 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:49.435995 [info ] [Thread-4 (]: 22 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:44:49.436655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:44:49.436982 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:49.441115 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:44:49.441803 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:44:49.437171 => 16:44:49.441615
[0m16:44:49.442085 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:49.444284 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:44:49.445680 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:44:49.446099 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:49.446406 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:49.447158 [info ] [Thread-2 (]: 17 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 1.03s]
[0m16:44:49.448438 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:44:49.448795 [debug] [Thread-2 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:44:49.449111 [info ] [Thread-2 (]: 23 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:44:49.449399 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:44:49.449671 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:44:49.450001 [info ] [Thread-2 (]: 24 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:44:49.450490 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:44:49.450902 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:49.451147 [info ] [Thread-2 (]: 25 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:44:49.451607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:44:49.451830 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:49.455123 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:44:49.455738 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:44:49.451980 => 16:44:49.455583
[0m16:44:49.455990 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:49.457919 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:44:49.458609 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:44:49.458853 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:44:49.459142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:49.709577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.725161 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:44:48.961588 => 16:44:49.724838
[0m16:44:49.725828 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:44:49.830207 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:49.833314 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:44:49.320658 => 16:44:49.832967
[0m16:44:49.833919 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:44:49.844977 [info ] [Thread-1 (]: 20 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.89s]
[0m16:44:49.845963 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:44:49.846525 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:49.847046 [info ] [Thread-1 (]: 26 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:44:49.847844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:44:49.848231 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:49.853314 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:44:49.855576 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:44:49.848480 => 16:44:49.855364
[0m16:44:49.855996 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:49.858570 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:44:49.859914 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:44:49.860293 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:44:49.860646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:49.951384 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:49.953483 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:44:49.456129 => 16:44:49.953270
[0m16:44:49.954250 [info ] [Thread-3 (]: 21 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.65s]
[0m16:44:49.954678 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:44:49.955128 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:44:49.956315 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:49.956853 [info ] [Thread-3 (]: 27 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:44:49.957497 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:44:49.957824 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:49.961515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:44:49.962404 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:44:49.958053 => 16:44:49.962233
[0m16:44:49.962707 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:49.964785 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:44:49.965540 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:44:49.965797 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:49.966034 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:50.003586 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:50.005314 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:44:49.442245 => 16:44:50.005131
[0m16:44:50.005628 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:44:50.066683 [info ] [Thread-2 (]: 25 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.62s]
[0m16:44:50.067159 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:44:50.067478 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.067847 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:44:50.068415 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:44:50.068676 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.072017 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:44:50.072696 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:44:50.068823 => 16:44:50.072523
[0m16:44:50.072949 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.074939 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:44:50.075686 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:44:50.075950 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:50.076195 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:44:50.128490 [info ] [Thread-4 (]: 22 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.69s]
[0m16:44:50.129770 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:44:50.133983 [debug] [Thread-4 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.134488 [info ] [Thread-4 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:44:50.134994 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:44:50.138996 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.142512 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:44:50.143129 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:44:50.139325 => 16:44:50.142985
[0m16:44:50.143363 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.145136 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:44:50.145710 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:44:50.145937 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:44:50.146237 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:44:50.266019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.268599 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:44:49.856206 => 16:44:50.268331
[0m16:44:50.269031 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:44:50.401626 [info ] [Thread-1 (]: 26 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.55s]
[0m16:44:50.402457 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:44:50.402901 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:50.403397 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:44:50.404401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:44:50.409227 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:50.414529 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:44:50.415464 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:44:50.410178 => 16:44:50.415242
[0m16:44:50.415811 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:50.419652 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:44:50.420467 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:44:50.420763 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:50.421041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:50.429502 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.431156 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:44:49.962880 => 16:44:50.430966
[0m16:44:50.431460 [debug] [Thread-3 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:44:50.520640 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.522390 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:44:50.073098 => 16:44:50.522189
[0m16:44:50.522731 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:44:50.553087 [info ] [Thread-3 (]: 27 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.60s]
[0m16:44:50.553738 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:44:50.638730 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.57s]
[0m16:44:50.639999 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:44:50.640932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.643229 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:44:50.143499 => 16:44:50.642958
[0m16:44:50.643660 [debug] [Thread-4 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:44:50.824608 [info ] [Thread-4 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.69s]
[0m16:44:50.825741 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:44:50.881657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:44:50.886041 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:44:50.415996 => 16:44:50.885621
[0m16:44:50.886691 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:44:50.999653 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:44:51.001030 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:44:51.002371 [debug] [Thread-3 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:44:51.003101 [info ] [Thread-3 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:44:51.004177 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:44:51.004677 [debug] [Thread-3 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:44:51.009441 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:44:51.010518 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:44:51.004965 => 16:44:51.010289
[0m16:44:51.010898 [debug] [Thread-3 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:44:51.013810 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:44:51.015631 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:44:51.016024 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:44:51.016386 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:44:51.847546 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:44:51.853322 [debug] [Thread-3 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:44:51.011116 => 16:44:51.852980
[0m16:44:51.854056 [debug] [Thread-3 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:44:52.009436 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25e70b54-e0a4-4c62-9bbf-1dd6772e0209', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba40ec0>]}
[0m16:44:52.010677 [info ] [Thread-3 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.01s]
[0m16:44:52.012051 [debug] [Thread-3 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:44:52.014682 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:52.015168 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:44:52.015564 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:44:52.015885 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:44:52.016206 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:44:52.016638 [info ] [MainThread]: 
[0m16:44:52.017007 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m16:44:52.020892 [debug] [MainThread]: Command end result
[0m16:44:52.030874 [info ] [MainThread]: 
[0m16:44:52.031204 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:44:52.031438 [info ] [MainThread]: 
[0m16:44:52.031669 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:44:52.031917 [info ] [MainThread]: 
[0m16:44:52.032150 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:44:52.034036 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.699287, "process_user_time": 2.648442, "process_kernel_time": 0.285021, "process_mem_max_rss": "148504576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:44:52.034469 [debug] [MainThread]: Command `dbt build` failed at 16:44:52.034377 after 8.70 seconds
[0m16:44:52.034767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d48650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd68bf0>]}
[0m16:44:52.035066 [debug] [MainThread]: Flushing usage events
[0m16:48:23.394920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10688d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059f7770>]}


============================== 16:48:23.397504 | e7443b2f-8709-4486-ae8b-a379519fab73 ==============================
[0m16:48:23.397504 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:48:23.397823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:48:23.575785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069182f0>]}
[0m16:48:23.608611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3800>]}
[0m16:48:23.609706 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:48:23.621085 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:48:23.657173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:23.657606 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:48:23.777952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107568b90>]}
[0m16:48:23.785783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074fdb50>]}
[0m16:48:23.786020 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:48:23.787405 [info ] [MainThread]: 
[0m16:48:23.787784 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:23.788393 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:48:23.794429 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:48:23.794604 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:48:23.794743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:24.751582 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:48:24.754537 [debug] [ThreadPool]: On list_analytics: Close
[0m16:48:24.894563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:48:24.905729 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:48:24.906234 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:48:24.906522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:25.566862 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:48:25.571593 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:48:25.789334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e2780>]}
[0m16:48:25.790613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:25.790980 [info ] [MainThread]: 
[0m16:48:25.794478 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:25.794862 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:25.795213 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:25.795536 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:25.795856 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:48:25.796202 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:48:25.796687 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:48:25.797080 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:48:25.798107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:48:25.798703 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:48:25.799235 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:48:25.799754 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:48:25.800034 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:25.800303 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:25.800552 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:25.800830 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:25.813630 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:25.817861 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:25.820301 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:25.822669 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:25.823551 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:48:25.801044 => 16:48:25.823376
[0m16:48:25.823929 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:48:25.813888 => 16:48:25.823753
[0m16:48:25.824233 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:25.824502 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:48:25.820479 => 16:48:25.824381
[0m16:48:25.824799 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:48:25.818065 => 16:48:25.824622
[0m16:48:25.825068 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:25.838385 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:25.838651 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:25.838864 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:25.840350 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:25.841805 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:25.843235 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:25.843717 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:25.844134 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:48:25.844553 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:25.844788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:25.845011 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:25.845417 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:25.845778 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:25.846310 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:25.846686 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:25.846937 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:25.847347 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:25.847658 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:26.242833 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.245199 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.246165 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.257412 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:48:25.838995 => 16:48:26.257055
[0m16:48:26.258204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.260426 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:48:25.841965 => 16:48:26.260222
[0m16:48:26.262046 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:48:25.840556 => 16:48:26.261855
[0m16:48:26.262413 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:48:26.263952 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:48:25.825224 => 16:48:26.263748
[0m16:48:26.264286 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:48:26.264594 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:48:26.265871 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:48:26.385103 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.59s]
[0m16:48:26.386627 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:26.387228 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:26.387940 [info ] [Thread-3 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:48:26.389384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:48:26.390611 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.59s]
[0m16:48:26.391311 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:26.391989 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:26.397930 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:26.398526 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:26.399731 [info ] [Thread-1 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:48:26.400559 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.60s]
[0m16:48:26.402091 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:48:26.392774 => 16:48:26.401833
[0m16:48:26.401360 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.60s]
[0m16:48:26.402789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:48:26.403280 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:26.403610 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:26.404033 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:26.404335 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:26.404675 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:26.407387 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:26.407821 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:26.411716 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:26.412112 [info ] [Thread-4 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:48:26.412562 [info ] [Thread-2 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:48:26.413234 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:48:26.413841 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:26.414355 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:48:26.414667 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:48:26.408132 => 16:48:26.414514
[0m16:48:26.414919 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:26.415202 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.415494 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:26.415777 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:26.418906 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:26.419252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:26.423501 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:26.425249 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:26.426560 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:48:26.415941 => 16:48:26.426338
[0m16:48:26.427182 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:48:26.419427 => 16:48:26.426834
[0m16:48:26.427476 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:26.427993 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:26.428276 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:26.430298 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:26.430761 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.432526 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:26.432920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:26.433712 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:26.434417 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.434927 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:26.435207 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:26.435455 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:26.436590 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:26.883927 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.886526 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.887640 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.888495 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:26.892289 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:48:26.430950 => 16:48:26.891795
[0m16:48:26.895306 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:48:26.404999 => 16:48:26.895008
[0m16:48:26.897317 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:48:26.423679 => 16:48:26.897041
[0m16:48:26.899229 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:48:26.428608 => 16:48:26.898996
[0m16:48:26.899658 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:48:26.900031 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:48:26.900393 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:48:26.900730 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:48:27.022246 [info ] [Thread-3 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.63s]
[0m16:48:27.023618 [info ] [Thread-2 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.61s]
[0m16:48:27.025125 [info ] [Thread-1 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.62s]
[0m16:48:27.027064 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:27.027765 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:27.028334 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:27.029142 [info ] [Thread-4 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.62s]
[0m16:48:27.029742 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.030347 [debug] [Thread-2 (]: Began running node model.northwind.dim_customer
[0m16:48:27.030969 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:48:27.031748 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:27.032723 [info ] [Thread-3 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:48:27.033283 [info ] [Thread-2 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:48:27.037363 [info ] [Thread-1 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:48:27.037854 [debug] [Thread-4 (]: Began running node model.northwind.dim_employee
[0m16:48:27.038681 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:48:27.039259 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:48:27.039884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_date)
[0m16:48:27.040304 [info ] [Thread-4 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:48:27.040704 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.041017 [debug] [Thread-2 (]: Began compiling node model.northwind.dim_customer
[0m16:48:27.041307 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:48:27.041886 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now model.northwind.dim_employee)
[0m16:48:27.046089 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:48:27.048231 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:48:27.051562 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:27.051868 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_employee
[0m16:48:27.054641 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:48:27.055049 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:48:27.046336 => 16:48:27.054940
[0m16:48:27.055265 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (compile): 16:48:27.042922 => 16:48:27.055161
[0m16:48:27.055446 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:48:27.042123 => 16:48:27.055357
[0m16:48:27.055615 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:48:27.055788 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (compile): 16:48:27.052400 => 16:48:27.055700
[0m16:48:27.055960 [debug] [Thread-2 (]: Began executing node model.northwind.dim_customer
[0m16:48:27.056131 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.072183 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:48:27.072504 [debug] [Thread-4 (]: Began executing node model.northwind.dim_employee
[0m16:48:27.074285 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:48:27.077021 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:27.078671 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:48:27.079280 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:48:27.079618 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:48:27.080071 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:48:27.080555 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:27.080768 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:27.081004 [debug] [Thread-2 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:48:27.081695 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:48:27.081908 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:27.082515 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:27.083079 [debug] [Thread-4 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:48:27.083369 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:27.083858 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:27.538096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:27.540955 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:48:27.074483 => 16:48:27.540682
[0m16:48:27.541415 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:48:27.661982 [info ] [Thread-3 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.62s]
[0m16:48:27.663086 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:27.663667 [debug] [Thread-3 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:48:27.664394 [info ] [Thread-3 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:48:27.665454 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:48:27.665855 [debug] [Thread-3 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:48:27.672850 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:48:27.673915 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:48:27.666101 => 16:48:27.673704
[0m16:48:27.674260 [debug] [Thread-3 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:48:27.677109 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:48:27.679177 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:48:27.679570 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:48:27.679915 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:28.335977 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:28.357728 [debug] [Thread-2 (]: Timing info for model.northwind.dim_customer (execute): 16:48:27.072659 => 16:48:28.357506
[0m16:48:28.358244 [debug] [Thread-2 (]: On model.northwind.dim_customer: Close
[0m16:48:28.486270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781d730>]}
[0m16:48:28.487340 [info ] [Thread-2 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 1.45s]
[0m16:48:28.488010 [debug] [Thread-2 (]: Finished running node model.northwind.dim_customer
[0m16:48:28.488457 [debug] [Thread-2 (]: Began running node model.northwind.fact_sales
[0m16:48:28.489247 [info ] [Thread-2 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:48:28.490486 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:48:28.490897 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_sales
[0m16:48:28.498069 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:48:28.499088 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (compile): 16:48:28.491131 => 16:48:28.498886
[0m16:48:28.499419 [debug] [Thread-2 (]: Began executing node model.northwind.fact_sales
[0m16:48:28.502073 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:48:28.503852 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:48:28.504256 [debug] [Thread-2 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_order_details as 
(
    select
        od.OrderID,
        od.ProductID,
        od.Quantity,
        od.UnitPrice,
        od.Discount,
        (od.UnitPrice * od.Quantity) - (od.Discount * od.UnitPrice * od.Quantity) as soldamount
    from raw.northwind.Order_Details od
),
stg_sales as 
(
    select
        o.OrderID,
        md5(cast(coalesce(cast(o.EmployeeID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(o.CustomerID as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        od.ProductID as productid, -- Assuming ProductID comes from the stg_order_details
        replace(to_date(o.OrderDate)::varchar, '-', '')::int as orderdate,
        od.Quantity,
        od.UnitPrice as extendedpriceamount,
        od.Discount * od.UnitPrice * od.Quantity as discountamount,
        od.soldamount
    from raw.northwind.Orders o
    join stg_order_details od on o.OrderID = od.OrderID
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.ProductID
    join stg_employees e on s.employeeid = e.EmployeeID
    join stg_customers c on s.customerid = c.CustomerID
        );
[0m16:48:28.504626 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:28.894527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:48:28.901402 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:48:27.056231 => 16:48:28.901125
[0m16:48:28.902267 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:48:29.023223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870f500>]}
[0m16:48:29.024141 [info ] [Thread-1 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 1.98s]
[0m16:48:29.024777 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:48:29.025336 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:29.026349 [info ] [Thread-1 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:48:29.027206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:48:29.027553 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:29.035520 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:29.036256 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:48:29.027747 => 16:48:29.036073
[0m16:48:29.036577 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:29.038836 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:29.039574 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:29.039861 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:48:29.040139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:29.165791 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.168705 [debug] [Thread-3 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:48:27.674465 => 16:48:29.168527
[0m16:48:29.169141 [debug] [Thread-3 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:48:29.214884 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:48:29.217627 [debug] [Thread-4 (]: Timing info for model.northwind.dim_employee (execute): 16:48:27.077295 => 16:48:29.217397
[0m16:48:29.218105 [debug] [Thread-4 (]: On model.northwind.dim_employee: Close
[0m16:48:29.281449 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10772b7a0>]}
[0m16:48:29.282295 [info ] [Thread-3 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 1.62s]
[0m16:48:29.283096 [debug] [Thread-3 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:48:29.283654 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:29.284329 [info ] [Thread-3 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:48:29.285331 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:48:29.285817 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:29.291195 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:29.292125 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:48:29.286055 => 16:48:29.291930
[0m16:48:29.292452 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:29.295032 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:29.295907 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:29.296247 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:48:29.296568 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:29.394790 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107893da0>]}
[0m16:48:29.395900 [info ] [Thread-4 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 2.35s]
[0m16:48:29.396924 [debug] [Thread-4 (]: Finished running node model.northwind.dim_employee
[0m16:48:29.397466 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:29.398570 [info ] [Thread-4 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:48:29.399553 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:48:29.399947 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:29.404876 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:29.405583 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:48:29.400188 => 16:48:29.405388
[0m16:48:29.405895 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:29.408516 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:29.409454 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:29.409789 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:29.410104 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:29.912172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.918368 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:48:29.036744 => 16:48:29.917734
[0m16:48:29.919126 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:48:29.931516 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.934220 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:48:29.406075 => 16:48:29.933947
[0m16:48:29.934660 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:48:29.954317 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:29.956464 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:48:29.292646 => 16:48:29.956233
[0m16:48:29.956839 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:48:30.020717 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m16:48:30.025938 [debug] [Thread-2 (]: Timing info for model.northwind.fact_sales (execute): 16:48:28.499604 => 16:48:30.025676
[0m16:48:30.027465 [debug] [Thread-2 (]: On model.northwind.fact_sales: Close
[0m16:48:30.030084 [info ] [Thread-1 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 1.00s]
[0m16:48:30.031259 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:30.031814 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.032294 [info ] [Thread-1 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:48:30.033066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:48:30.033516 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.038696 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:30.039950 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:48:30.033937 => 16:48:30.039742
[0m16:48:30.040291 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.042856 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:30.044296 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:30.044664 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.044969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:30.045633 [info ] [Thread-4 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.65s]
[0m16:48:30.046584 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:30.047133 [debug] [Thread-4 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.047515 [info ] [Thread-4 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:48:30.048086 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:48:30.048436 [debug] [Thread-4 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.052496 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:30.053085 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:48:30.049020 => 16:48:30.052917
[0m16:48:30.053332 [debug] [Thread-4 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.056573 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:30.057209 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:30.057472 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:48:30.057713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:30.088201 [info ] [Thread-3 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.80s]
[0m16:48:30.088761 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:30.089077 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.089408 [info ] [Thread-3 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:48:30.089951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:48:30.090219 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.093533 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:30.094158 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:48:30.090370 => 16:48:30.094003
[0m16:48:30.094419 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.096307 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:30.097203 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:30.097457 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:48:30.097679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:30.157554 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078568a0>]}
[0m16:48:30.158081 [info ] [Thread-2 (]: 14 of 31 OK created sql table model analytics.northwind_northwind.fact_sales ... [[32mSUCCESS 1[0m in 1.67s]
[0m16:48:30.158456 [debug] [Thread-2 (]: Finished running node model.northwind.fact_sales
[0m16:48:30.158715 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.159275 [info ] [Thread-2 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:48:30.159944 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:48:30.160241 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.163125 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:30.163678 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:48:30.160387 => 16:48:30.163548
[0m16:48:30.163885 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.165455 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:30.166071 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:30.166288 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.166484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:30.440825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.447055 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:48:30.040475 => 16:48:30.446627
[0m16:48:30.448691 [debug] [Thread-1 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:48:30.449808 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.453282 [debug] [Thread-4 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:48:30.053476 => 16:48:30.452987
[0m16:48:30.454152 [debug] [Thread-4 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:48:30.561137 [info ] [Thread-4 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.51s]
[0m16:48:30.562720 [info ] [Thread-1 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.53s]
[0m16:48:30.563801 [debug] [Thread-4 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:30.564423 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:30.564947 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:30.565535 [debug] [Thread-1 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:30.566020 [info ] [Thread-4 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:48:30.566433 [info ] [Thread-1 (]: 23 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:48:30.567130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:48:30.567756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:48:30.568122 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:30.568559 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:30.575007 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:30.577886 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:30.579102 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.579610 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.581396 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:48:30.094567 => 16:48:30.581188
[0m16:48:30.583154 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:48:30.164001 => 16:48:30.582949
[0m16:48:30.583496 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:48:30.568808 => 16:48:30.583331
[0m16:48:30.583800 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:48:30.570865 => 16:48:30.583647
[0m16:48:30.584106 [debug] [Thread-3 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:48:30.584371 [debug] [Thread-2 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:48:30.584638 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:30.584922 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:30.589050 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:30.591025 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:30.592503 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:30.592873 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.593164 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:30.593640 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:30.594319 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:48:30.594764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:30.701106 [info ] [Thread-2 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.54s]
[0m16:48:30.701628 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:30.701945 [debug] [Thread-2 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:30.702314 [info ] [Thread-2 (]: 24 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:48:30.702898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:48:30.703199 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:30.707994 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:30.708893 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:48:30.703364 => 16:48:30.708721
[0m16:48:30.709161 [debug] [Thread-2 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:30.711258 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:30.711799 [info ] [Thread-3 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.62s]
[0m16:48:30.712499 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:30.712940 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:30.713361 [info ] [Thread-3 (]: 25 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:48:30.713972 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:30.714473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:48:30.714787 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:30.715058 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:30.715285 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:30.718515 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:30.719680 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:48:30.715433 => 16:48:30.719512
[0m16:48:30.719978 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:30.721787 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:30.722703 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:30.722965 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:48:30.723203 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:30.984925 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.987655 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:48:30.587005 => 16:48:30.987423
[0m16:48:30.988299 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:48:30.988869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:30.991556 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:48:30.589317 => 16:48:30.991319
[0m16:48:30.992193 [debug] [Thread-1 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:48:31.109060 [info ] [Thread-1 (]: 23 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.54s]
[0m16:48:31.110163 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:31.111272 [info ] [Thread-4 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.54s]
[0m16:48:31.111997 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.112736 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:31.113224 [info ] [Thread-1 (]: 26 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:48:31.113691 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.114424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:48:31.115380 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.114844 [info ] [Thread-4 (]: 27 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:48:31.118262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:48:31.121652 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:31.122050 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.126204 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:31.126874 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:48:31.115704 => 16:48:31.126653
[0m16:48:31.127218 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.127607 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:48:31.122368 => 16:48:31.127401
[0m16:48:31.129936 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:31.130241 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.132360 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:31.133098 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:31.133489 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:48:31.134118 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:31.134409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:31.134730 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:31.135731 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:31.190597 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.192251 [debug] [Thread-2 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:48:30.709320 => 16:48:31.192069
[0m16:48:31.192687 [debug] [Thread-2 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:48:31.212137 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.213570 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:48:30.720142 => 16:48:31.213390
[0m16:48:31.213847 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:48:31.299054 [info ] [Thread-2 (]: 24 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.60s]
[0m16:48:31.299728 [debug] [Thread-2 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:31.300158 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.300652 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:48:31.301424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:48:31.301831 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.306351 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:31.307121 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:48:31.302062 => 16:48:31.306926
[0m16:48:31.307444 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.309883 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:31.310823 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:31.311210 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:31.312018 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:31.325855 [info ] [Thread-3 (]: 25 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.61s]
[0m16:48:31.326344 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:31.326645 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:31.326956 [info ] [Thread-3 (]: 29 of 31 START test not_null_fact_sales_saleskey ............................... [RUN]
[0m16:48:31.327480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.not_null_fact_sales_saleskey.0bc31ce210)
[0m16:48:31.327741 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:31.332363 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m16:48:31.332996 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_sales_saleskey.0bc31ce210 (compile): 16:48:31.327893 => 16:48:31.332842
[0m16:48:31.333238 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:31.334989 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m16:48:31.335671 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"
[0m16:48:31.335903 [debug] [Thread-3 (]: On test.northwind.not_null_fact_sales_saleskey.0bc31ce210: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_sales_saleskey.0bc31ce210"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select saleskey
from analytics.northwind_northwind.fact_sales
where saleskey is null



      
    ) dbt_internal_test
[0m16:48:31.336135 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:31.607660 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.611877 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:48:31.130476 => 16:48:31.611368
[0m16:48:31.612568 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:48:31.618770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.622410 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:48:31.127845 => 16:48:31.622158
[0m16:48:31.622866 [debug] [Thread-1 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:48:31.738909 [info ] [Thread-4 (]: 27 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.62s]
[0m16:48:31.740071 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:31.740631 [debug] [Thread-4 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:31.741300 [info ] [Thread-4 (]: 30 of 31 START test unique_fact_sales_saleskey ................................. [RUN]
[0m16:48:31.742255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now test.northwind.unique_fact_sales_saleskey.c07ec0958d)
[0m16:48:31.743007 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:31.743737 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:31.748264 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m16:48:31.750874 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:48:31.307629 => 16:48:31.750582
[0m16:48:31.751770 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:48:31.753258 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_sales_saleskey.c07ec0958d (compile): 16:48:31.743993 => 16:48:31.753065
[0m16:48:31.754235 [debug] [Thread-4 (]: Began executing node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:31.758344 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m16:48:31.759375 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_fact_sales_saleskey.c07ec0958d"
[0m16:48:31.759695 [debug] [Thread-4 (]: On test.northwind.unique_fact_sales_saleskey.c07ec0958d: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_sales_saleskey.c07ec0958d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    saleskey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_sales
where saleskey is not null
group by saleskey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:31.760006 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:31.762173 [info ] [Thread-1 (]: 26 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.65s]
[0m16:48:31.762494 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:31.784805 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b2c55c-0000-17a6-0009-ec83000212be
[0m16:48:31.785094 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 7
invalid identifier 'SALESKEY'
[0m16:48:31.785335 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_sales_saleskey.0bc31ce210 (execute): 16:48:31.333378 => 16:48:31.785238
[0m16:48:31.785508 [debug] [Thread-3 (]: On test.northwind.not_null_fact_sales_saleskey.0bc31ce210: Close
[0m16:48:31.881522 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 0.58s]
[0m16:48:31.882138 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:31.882695 [debug] [Thread-1 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:48:31.883168 [info ] [Thread-1 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:48:31.883784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now model.northwind.obt_order_fulfillment)
[0m16:48:31.884104 [debug] [Thread-1 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:48:31.887853 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:48:31.888523 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:48:31.884295 => 16:48:31.888328
[0m16:48:31.888964 [debug] [Thread-1 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:48:31.891268 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:48:31.892734 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:48:31.893117 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:48:31.893447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:31.900148 [debug] [Thread-3 (]: Database Error in test not_null_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/not_null_fact_sales_saleskey.sql
[0m16:48:31.900529 [error] [Thread-3 (]: 29 of 31 ERROR not_null_fact_sales_saleskey .................................... [[31mERROR[0m in 0.57s]
[0m16:48:31.900938 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:32.190025 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c55c-0000-17a6-0009-ec83000212c2
[0m16:48:32.191261 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'SALESKEY'
[0m16:48:32.192005 [debug] [Thread-4 (]: Timing info for test.northwind.unique_fact_sales_saleskey.c07ec0958d (execute): 16:48:31.754613 => 16:48:32.191712
[0m16:48:32.192509 [debug] [Thread-4 (]: On test.northwind.unique_fact_sales_saleskey.c07ec0958d: Close
[0m16:48:32.349384 [debug] [Thread-4 (]: Database Error in test unique_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/unique_fact_sales_saleskey.sql
[0m16:48:32.350360 [error] [Thread-4 (]: 30 of 31 ERROR unique_fact_sales_saleskey ...................................... [[31mERROR[0m in 0.61s]
[0m16:48:32.351044 [debug] [Thread-4 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:32.834223 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:32.840410 [debug] [Thread-1 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:48:31.889164 => 16:48:32.840068
[0m16:48:32.841088 [debug] [Thread-1 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:48:32.965415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7443b2f-8709-4486-ae8b-a379519fab73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019fb90>]}
[0m16:48:32.966660 [info ] [Thread-1 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.08s]
[0m16:48:32.967507 [debug] [Thread-1 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:48:32.970598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:32.971255 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:48:32.971621 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:48:32.971947 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_sales_saleskey.0bc31ce210' was properly closed.
[0m16:48:32.972265 [debug] [MainThread]: Connection 'test.northwind.unique_fact_sales_saleskey.c07ec0958d' was properly closed.
[0m16:48:32.972701 [info ] [MainThread]: 
[0m16:48:32.973042 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m16:48:32.977061 [debug] [MainThread]: Command end result
[0m16:48:32.989899 [info ] [MainThread]: 
[0m16:48:32.990282 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m16:48:32.990531 [info ] [MainThread]: 
[0m16:48:32.990763 [error] [MainThread]:   Database Error in test not_null_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 12 at position 7
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/not_null_fact_sales_saleskey.sql
[0m16:48:32.990987 [info ] [MainThread]: 
[0m16:48:32.991195 [error] [MainThread]:   Database Error in test unique_fact_sales_saleskey (models/fact_sales.yml)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'SALESKEY'
  compiled Code at target/run/northwind/models/fact_sales.yml/unique_fact_sales_saleskey.sql
[0m16:48:32.991425 [info ] [MainThread]: 
[0m16:48:32.991650 [info ] [MainThread]: Done. PASS=29 WARN=0 ERROR=2 SKIP=0 TOTAL=31
[0m16:48:32.993820 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 9.627314, "process_user_time": 2.854724, "process_kernel_time": 0.306528, "process_mem_max_rss": "145211392", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:48:32.994260 [debug] [MainThread]: Command `dbt build` failed at 16:48:32.994161 after 9.63 seconds
[0m16:48:32.994558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106857620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076b6990>]}
[0m16:48:32.994849 [debug] [MainThread]: Flushing usage events
[0m16:48:52.057304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110206480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110206150>]}


============================== 16:48:52.059809 | 1036dd45-7259-4494-9ddd-f08fd95109fa ==============================
[0m16:48:52.059809 [info ] [MainThread]: Running with dbt=1.7.9
[0m16:48:52.060117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/nataliehuang/Desktop/ist722dbt/northwind', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/nataliehuang/Desktop/ist722dbt/northwind/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:52.251482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf63f0>]}
[0m16:48:52.284494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110280500>]}
[0m16:48:52.284944 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m16:48:52.296351 [debug] [MainThread]: checksum: 6ff0d83c3b46f350064523b4e08d9241403ad71d606ba49c4e670afba3668b39, vars: {}, profile: , target: , version: 1.7.9
[0m16:48:52.331151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:52.331549 [debug] [MainThread]: Partial parsing: updated file: northwind://models/fact_sales.sql
[0m16:48:52.451348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111cc6b0>]}
[0m16:48:52.458388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11126bcb0>]}
[0m16:48:52.458610 [info ] [MainThread]: Found 25 tests, 7 models, 9 sources, 0 exposures, 0 metrics, 544 macros, 0 groups, 0 semantic models
[0m16:48:52.460018 [info ] [MainThread]: 
[0m16:48:52.460415 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:48:52.461015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_analytics'
[0m16:48:52.467198 [debug] [ThreadPool]: Using snowflake connection "list_analytics"
[0m16:48:52.467404 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics"} */
show terse schemas in database analytics
    limit 10000
[0m16:48:52.467555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:53.182858 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m16:48:53.186025 [debug] [ThreadPool]: On list_analytics: Close
[0m16:48:53.322869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now list_analytics_northwind_northwind)
[0m16:48:53.333851 [debug] [ThreadPool]: Using snowflake connection "list_analytics_northwind_northwind"
[0m16:48:53.334297 [debug] [ThreadPool]: On list_analytics_northwind_northwind: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "connection_name": "list_analytics_northwind_northwind"} */
show terse objects in analytics.northwind_northwind limit 10000
[0m16:48:53.334620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:53.907251 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m16:48:53.911717 [debug] [ThreadPool]: On list_analytics_northwind_northwind: Close
[0m16:48:54.089123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c554c0>]}
[0m16:48:54.090838 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:54.091381 [info ] [MainThread]: 
[0m16:48:54.095220 [debug] [Thread-1 (]: Began running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.095698 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.096126 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.096516 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.097025 [info ] [Thread-1 (]: 1 of 31 START test dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [RUN]
[0m16:48:54.097590 [info ] [Thread-2 (]: 2 of 31 START test source_unique_conformed_DateDimension_DateKey ............... [RUN]
[0m16:48:54.098013 [info ] [Thread-3 (]: 3 of 31 START test source_unique_northwind_Categories_CategoryId ............... [RUN]
[0m16:48:54.098454 [info ] [Thread-4 (]: 4 of 31 START test source_unique_northwind_Customers_CustomerId ................ [RUN]
[0m16:48:54.099629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_northwind_northwind, now test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8)
[0m16:48:54.100370 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b'
[0m16:48:54.101104 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab'
[0m16:48:54.101716 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8'
[0m16:48:54.102042 [debug] [Thread-1 (]: Began compiling node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.102353 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.102647 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.102941 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.118245 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:54.124753 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:54.127839 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:54.131903 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:54.135253 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (compile): 16:48:54.103146 => 16:48:54.135069
[0m16:48:54.135572 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (compile): 16:48:54.120471 => 16:48:54.135404
[0m16:48:54.135904 [debug] [Thread-1 (]: Began executing node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.136224 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (compile): 16:48:54.125165 => 16:48:54.136076
[0m16:48:54.136503 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.136787 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (compile): 16:48:54.129405 => 16:48:54.136646
[0m16:48:54.151460 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:54.151737 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.153280 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:54.153511 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.155125 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:54.156884 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:54.157387 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"
[0m16:48:54.157867 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"
[0m16:48:54.158149 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        OrderId, ProductId
    from raw.northwind.Order_Details
    group by OrderId, ProductId
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m16:48:54.158489 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    DateKey as unique_field,
    count(*) as n_records

from raw.conformed.DateDimension
where DateKey is not null
group by DateKey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.158926 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"
[0m16:48:54.159300 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"
[0m16:48:54.159493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:54.159672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:48:54.159876 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CustomerId as unique_field,
    count(*) as n_records

from raw.northwind.Customers
where CustomerId is not null
group by CustomerId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.160095 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    CategoryId as unique_field,
    count(*) as n_records

from raw.northwind.Categories
where CategoryId is not null
group by CategoryId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.161255 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:48:54.161463 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:48:54.551286 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.552617 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.553503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.554443 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:54.564859 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8 (execute): 16:48:54.155387 => 16:48:54.564461
[0m16:48:54.567212 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b (execute): 16:48:54.151882 => 16:48:54.566962
[0m16:48:54.569121 [debug] [Thread-1 (]: Timing info for test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8 (execute): 16:48:54.136946 => 16:48:54.568880
[0m16:48:54.570800 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab (execute): 16:48:54.153718 => 16:48:54.570602
[0m16:48:54.571159 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8: Close
[0m16:48:54.571475 [debug] [Thread-2 (]: On test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b: Close
[0m16:48:54.571794 [debug] [Thread-1 (]: On test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8: Close
[0m16:48:54.572099 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab: Close
[0m16:48:54.690443 [info ] [Thread-1 (]: 1 of 31 PASS dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId  [[32mPASS[0m in 0.59s]
[0m16:48:54.691532 [info ] [Thread-3 (]: 3 of 31 PASS source_unique_northwind_Categories_CategoryId ..................... [[32mPASS[0m in 0.59s]
[0m16:48:54.692940 [debug] [Thread-1 (]: Finished running node test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8
[0m16:48:54.695407 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab
[0m16:48:54.696148 [debug] [Thread-1 (]: Began running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:54.697121 [debug] [Thread-3 (]: Began running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:54.698379 [info ] [Thread-2 (]: 2 of 31 PASS source_unique_conformed_DateDimension_DateKey ..................... [[32mPASS[0m in 0.60s]
[0m16:48:54.699372 [info ] [Thread-4 (]: 4 of 31 PASS source_unique_northwind_Customers_CustomerId ...................... [[32mPASS[0m in 0.60s]
[0m16:48:54.700002 [info ] [Thread-1 (]: 5 of 31 START test source_unique_northwind_Employees_EmployeeId ................ [RUN]
[0m16:48:54.700495 [info ] [Thread-3 (]: 6 of 31 START test source_unique_northwind_Orders_OrderId ...................... [RUN]
[0m16:48:54.701062 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b
[0m16:48:54.701564 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8
[0m16:48:54.702288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.dbt_utils_source_unique_combination_of_columns_northwind_Order_Details_OrderId__ProductId.09cf2e75e8, now test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4)
[0m16:48:54.702959 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Categories_CategoryId.8dd5f2f7ab, now test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7)
[0m16:48:54.703393 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:54.704035 [debug] [Thread-4 (]: Began running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:54.704520 [debug] [Thread-1 (]: Began compiling node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:54.704855 [debug] [Thread-3 (]: Began compiling node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:54.705191 [info ] [Thread-2 (]: 7 of 31 START test source_unique_northwind_Products_ProductId .................. [RUN]
[0m16:48:54.705535 [info ] [Thread-4 (]: 8 of 31 START test source_unique_northwind_Shippers_ShipperID .................. [RUN]
[0m16:48:54.710017 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:54.713247 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:54.713772 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_conformed_DateDimension_DateKey.f058e65f6b, now test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45)
[0m16:48:54.714248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Customers_CustomerId.d9ace99ac8, now test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1)
[0m16:48:54.714809 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:54.715127 [debug] [Thread-4 (]: Began compiling node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:54.715456 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (compile): 16:48:54.705765 => 16:48:54.715285
[0m16:48:54.715778 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (compile): 16:48:54.710265 => 16:48:54.715626
[0m16:48:54.719027 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:54.722175 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:54.722491 [debug] [Thread-1 (]: Began executing node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:54.722764 [debug] [Thread-3 (]: Began executing node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:54.726224 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:54.728226 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:54.728565 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (compile): 16:48:54.715922 => 16:48:54.728375
[0m16:48:54.728862 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (compile): 16:48:54.719298 => 16:48:54.728715
[0m16:48:54.729270 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:54.729548 [debug] [Thread-4 (]: Began executing node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:54.730022 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"
[0m16:48:54.730487 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"
[0m16:48:54.732201 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:54.733972 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:54.734283 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    EmployeeId as unique_field,
    count(*) as n_records

from raw.northwind.Employees
where EmployeeId is not null
group by EmployeeId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.734561 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from raw.northwind.Orders
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.734920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:54.735176 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:54.735638 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"
[0m16:48:54.736079 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"
[0m16:48:54.737426 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ProductId as unique_field,
    count(*) as n_records

from raw.northwind.Products
where ProductId is not null
group by ProductId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.737706 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ShipperID as unique_field,
    count(*) as n_records

from raw.northwind.Shippers
where ShipperID is not null
group by ShipperID
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:54.737953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:54.738168 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:55.170259 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.171291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.172153 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.176088 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45 (execute): 16:48:54.730627 => 16:48:55.175620
[0m16:48:55.177230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.179324 [debug] [Thread-4 (]: Timing info for test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1 (execute): 16:48:54.732382 => 16:48:55.179086
[0m16:48:55.181330 [debug] [Thread-3 (]: Timing info for test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7 (execute): 16:48:54.726508 => 16:48:55.181109
[0m16:48:55.181766 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45: Close
[0m16:48:55.183591 [debug] [Thread-1 (]: Timing info for test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4 (execute): 16:48:54.723070 => 16:48:55.183366
[0m16:48:55.183967 [debug] [Thread-4 (]: On test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1: Close
[0m16:48:55.184319 [debug] [Thread-3 (]: On test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7: Close
[0m16:48:55.185703 [debug] [Thread-1 (]: On test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4: Close
[0m16:48:55.309821 [info ] [Thread-2 (]: 7 of 31 PASS source_unique_northwind_Products_ProductId ........................ [[32mPASS[0m in 0.60s]
[0m16:48:55.311347 [info ] [Thread-1 (]: 5 of 31 PASS source_unique_northwind_Employees_EmployeeId ...................... [[32mPASS[0m in 0.61s]
[0m16:48:55.313809 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45
[0m16:48:55.313063 [info ] [Thread-4 (]: 8 of 31 PASS source_unique_northwind_Shippers_ShipperID ........................ [[32mPASS[0m in 0.60s]
[0m16:48:55.314808 [info ] [Thread-3 (]: 6 of 31 PASS source_unique_northwind_Orders_OrderId ............................ [[32mPASS[0m in 0.61s]
[0m16:48:55.315584 [debug] [Thread-1 (]: Finished running node test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4
[0m16:48:55.316026 [debug] [Thread-2 (]: Began running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.316644 [debug] [Thread-4 (]: Finished running node test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1
[0m16:48:55.317185 [debug] [Thread-3 (]: Finished running node test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7
[0m16:48:55.317622 [debug] [Thread-1 (]: Began running node model.northwind.dim_date
[0m16:48:55.318032 [info ] [Thread-2 (]: 9 of 31 START test source_unique_northwind_Suppliers_SupplierId ................ [RUN]
[0m16:48:55.318467 [debug] [Thread-4 (]: Began running node model.northwind.dim_customer
[0m16:48:55.319073 [debug] [Thread-3 (]: Began running node model.northwind.dim_employee
[0m16:48:55.319659 [info ] [Thread-1 (]: 10 of 31 START sql table model analytics.northwind_northwind.dim_date .......... [RUN]
[0m16:48:55.320478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Products_ProductId.453bf9ba45, now test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b)
[0m16:48:55.321047 [info ] [Thread-4 (]: 11 of 31 START sql table model analytics.northwind_northwind.dim_customer ...... [RUN]
[0m16:48:55.321482 [info ] [Thread-3 (]: 12 of 31 START sql table model analytics.northwind_northwind.dim_employee ...... [RUN]
[0m16:48:55.322146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Employees_EmployeeId.e6ff0573b4, now model.northwind.dim_date)
[0m16:48:55.322497 [debug] [Thread-2 (]: Began compiling node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.323034 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Shippers_ShipperID.d248980dd1, now model.northwind.dim_customer)
[0m16:48:55.323589 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Orders_OrderId.913aa24ed7, now model.northwind.dim_employee)
[0m16:48:55.323912 [debug] [Thread-1 (]: Began compiling node model.northwind.dim_date
[0m16:48:55.325200 [debug] [Thread-4 (]: Began compiling node model.northwind.dim_customer
[0m16:48:55.325560 [debug] [Thread-3 (]: Began compiling node model.northwind.dim_employee
[0m16:48:55.328259 [debug] [Thread-1 (]: Writing injected SQL for node "model.northwind.dim_date"
[0m16:48:55.331295 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:55.334589 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.dim_customer"
[0m16:48:55.338035 [debug] [Thread-3 (]: Writing injected SQL for node "model.northwind.dim_employee"
[0m16:48:55.338801 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (compile): 16:48:55.325775 => 16:48:55.338605
[0m16:48:55.339137 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (compile): 16:48:55.324108 => 16:48:55.338979
[0m16:48:55.339439 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (compile): 16:48:55.331517 => 16:48:55.339288
[0m16:48:55.339723 [debug] [Thread-1 (]: Began executing node model.northwind.dim_date
[0m16:48:55.340017 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (compile): 16:48:55.334829 => 16:48:55.339873
[0m16:48:55.340278 [debug] [Thread-2 (]: Began executing node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.340525 [debug] [Thread-4 (]: Began executing node model.northwind.dim_customer
[0m16:48:55.358534 [debug] [Thread-1 (]: Writing runtime sql for node "model.northwind.dim_date"
[0m16:48:55.358859 [debug] [Thread-3 (]: Began executing node model.northwind.dim_employee
[0m16:48:55.360564 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:55.362056 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.dim_customer"
[0m16:48:55.363728 [debug] [Thread-3 (]: Writing runtime sql for node "model.northwind.dim_employee"
[0m16:48:55.364364 [debug] [Thread-1 (]: Using snowflake connection "model.northwind.dim_date"
[0m16:48:55.364713 [debug] [Thread-1 (]: On model.northwind.dim_date: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_date"} */
create or replace transient table analytics.northwind_northwind.dim_date
         as
        (select
    datekey::int as datekey,
    date,
    year,
    month,
    quarter,
    day,
    dayofweek,
    weekofyear,
    dayofyear,
    quartername,
    monthname,
    dayname,
    weekday
    from raw.conformed.DateDimension
        );
[0m16:48:55.365202 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"
[0m16:48:55.365604 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.dim_customer"
[0m16:48:55.365804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:55.366459 [debug] [Thread-3 (]: Using snowflake connection "model.northwind.dim_employee"
[0m16:48:55.366667 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    SupplierId as unique_field,
    count(*) as n_records

from raw.northwind.Suppliers
where SupplierId is not null
group by SupplierId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:55.366911 [debug] [Thread-4 (]: On model.northwind.dim_customer: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_customer"} */
create or replace transient table analytics.northwind_northwind.dim_customer
         as
        (with stg_customers as (
    select * from raw.northwind.Customers
)
select  md5(cast(coalesce(cast(stg_customers.customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey,
    stg_customers.*
from stg_customers
        );
[0m16:48:55.367552 [debug] [Thread-3 (]: On model.northwind.dim_employee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.dim_employee"} */
create or replace transient table analytics.northwind_northwind.dim_employee
         as
        (with stg_employees as (
    select * from raw.northwind.Employees
),
stg_supervisors as (
    select * from raw.northwind.Employees
)
select 
    md5(cast(coalesce(cast(e.employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) 
       as employeekey, 
    e.employeeid,
    concat(e.lastname ,', ' , e.firstname) as employeenamelastfirst,
    concat(e.firstname  , ' ' , e.lastname) as employeenamefirstlast,
    e.title as employeetitle,
    concat(s.lastname ,', ' , s.firstname) as supervisornamelastfirst,
    concat(s.firstname  , ' ' , s.lastname) as supervisornamefirstlast
from stg_employees e
    left join stg_supervisors s on e.reportsto = s.employeeid
        );
[0m16:48:55.367972 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:55.368185 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:55.368381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:55.794406 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:55.800233 [debug] [Thread-2 (]: Timing info for test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b (execute): 16:48:55.359028 => 16:48:55.799797
[0m16:48:55.800932 [debug] [Thread-2 (]: On test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b: Close
[0m16:48:55.967309 [info ] [Thread-2 (]: 9 of 31 PASS source_unique_northwind_Suppliers_SupplierId ...................... [[32mPASS[0m in 0.65s]
[0m16:48:55.967843 [debug] [Thread-2 (]: Finished running node test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b
[0m16:48:55.968163 [debug] [Thread-2 (]: Began running node model.northwind.fact_order_fulfillment
[0m16:48:55.968552 [info ] [Thread-2 (]: 13 of 31 START sql table model analytics.northwind_northwind.fact_order_fulfillment  [RUN]
[0m16:48:55.969092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.source_unique_northwind_Suppliers_SupplierId.0fb247b91b, now model.northwind.fact_order_fulfillment)
[0m16:48:55.969350 [debug] [Thread-2 (]: Began compiling node model.northwind.fact_order_fulfillment
[0m16:48:55.973572 [debug] [Thread-2 (]: Writing injected SQL for node "model.northwind.fact_order_fulfillment"
[0m16:48:55.974920 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (compile): 16:48:55.969498 => 16:48:55.974767
[0m16:48:55.975161 [debug] [Thread-2 (]: Began executing node model.northwind.fact_order_fulfillment
[0m16:48:55.977066 [debug] [Thread-2 (]: Writing runtime sql for node "model.northwind.fact_order_fulfillment"
[0m16:48:55.978668 [debug] [Thread-2 (]: Using snowflake connection "model.northwind.fact_order_fulfillment"
[0m16:48:55.978984 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.fact_order_fulfillment
         as
        (with stg_orders as 
(
    select
        OrderID,  
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeekey, 
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerkey, 
        replace(to_date(orderdate)::varchar,'-','')::int as orderdatekey,
        replace(to_date(shippeddate)::varchar,'-','')::int as shippeddatekey,
        replace(to_date(requireddate)::varchar,'-','')::int as requireddatekey,
        shipname,
        shipaddress,
        shipcity,
        shipregion,
        shippostalcode,
        shipcountry,
        freight,
        shipvia
    from raw.northwind.Orders
),
stg_order_details as
(
    select 
        orderid,
        sum(Quantity) as quantityonorder, 
        sum(Quantity*UnitPrice*(1-Discount)) as totalorderamount
    from raw.northwind.Order_Details
    group by orderid
),
stg_shippers as (
    select * from raw.northwind.Shippers
)
select  
    o.*,
    s.companyname as shippercompanyname,
    od.quantityonorder, od.totalorderamount,
    o.shippeddatekey - o.orderdatekey as daysfromordertoshipped,
    o.requireddatekey - o.orderdatekey as daysfromordertorequired,
    o.shippeddatekey - o.requireddatekey as shippedtorequireddelta,
    case when o.shippeddatekey - o.requireddatekey <=0 then 'Y' else 'N' end as shippedontime
from stg_orders o
    join stg_order_details od on o.orderid = od.orderid
    join stg_shippers s on s.shipperid = o.shipvia
        );
[0m16:48:55.979253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:56.122897 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.123937 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.124552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.140380 [debug] [Thread-4 (]: Timing info for model.northwind.dim_customer (execute): 16:48:55.360709 => 16:48:56.140200
[0m16:48:56.142201 [debug] [Thread-3 (]: Timing info for model.northwind.dim_employee (execute): 16:48:55.362270 => 16:48:56.142053
[0m16:48:56.143800 [debug] [Thread-1 (]: Timing info for model.northwind.dim_date (execute): 16:48:55.340672 => 16:48:56.143663
[0m16:48:56.144076 [debug] [Thread-4 (]: On model.northwind.dim_customer: Close
[0m16:48:56.144304 [debug] [Thread-3 (]: On model.northwind.dim_employee: Close
[0m16:48:56.144523 [debug] [Thread-1 (]: On model.northwind.dim_date: Close
[0m16:48:56.261921 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11121c560>]}
[0m16:48:56.263348 [info ] [Thread-4 (]: 11 of 31 OK created sql table model analytics.northwind_northwind.dim_customer . [[32mSUCCESS 1[0m in 0.94s]
[0m16:48:56.264102 [debug] [Thread-4 (]: Finished running node model.northwind.dim_customer
[0m16:48:56.264540 [debug] [Thread-4 (]: Began running node model.northwind.fact_sales
[0m16:48:56.265136 [info ] [Thread-4 (]: 14 of 31 START sql table model analytics.northwind_northwind.fact_sales ........ [RUN]
[0m16:48:56.265906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.dim_customer, now model.northwind.fact_sales)
[0m16:48:56.266298 [debug] [Thread-4 (]: Began compiling node model.northwind.fact_sales
[0m16:48:56.273224 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.fact_sales"
[0m16:48:56.274026 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (compile): 16:48:56.266521 => 16:48:56.273831
[0m16:48:56.274358 [debug] [Thread-4 (]: Began executing node model.northwind.fact_sales
[0m16:48:56.278397 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.fact_sales"
[0m16:48:56.279863 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.fact_sales"
[0m16:48:56.280793 [debug] [Thread-4 (]: On model.northwind.fact_sales: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.fact_sales"} */
create or replace transient table analytics.northwind_northwind.fact_sales
         as
        (with stg_sales as 
(
    select
        OrderID,
        md5(cast(coalesce(cast(employeeid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as employeeid,
        md5(cast(coalesce(cast(customerid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customerid,
        md5(cast(coalesce(cast(productid as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as productid,
        replace(to_date(OrderDate)::varchar, '-', '')::int as orderdate,
        quantity,
        UnitPrice as extendedpriceamount,
        Discount * UnitPrice * Quantity as discountamount,
        (UnitPrice * Quantity) - (Discount * UnitPrice * Quantity) as soldamount
    from raw.northwind.Orders
),
stg_products as
(
    select * from raw.northwind.Products
),
stg_employees as
(
    select * from raw.northwind.Employees
),
stg_customers as
(
    select * from raw.northwind.Customers
)
select
    s.*,
    p.productname,
    e.firstname as employeename,
    c.companyname as customername
from stg_sales s
    join stg_products p on s.productid = p.productid
    join stg_employees e on s.employeeid = e.employeeid
    join stg_customers c on s.customerid = c.customerid
        );
[0m16:48:56.281292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:56.282792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d09820>]}
[0m16:48:56.283383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d09430>]}
[0m16:48:56.283854 [info ] [Thread-1 (]: 10 of 31 OK created sql table model analytics.northwind_northwind.dim_date ..... [[32mSUCCESS 1[0m in 0.96s]
[0m16:48:56.284533 [info ] [Thread-3 (]: 12 of 31 OK created sql table model analytics.northwind_northwind.dim_employee . [[32mSUCCESS 1[0m in 0.96s]
[0m16:48:56.285159 [debug] [Thread-1 (]: Finished running node model.northwind.dim_date
[0m16:48:56.285534 [debug] [Thread-3 (]: Finished running node model.northwind.dim_employee
[0m16:48:56.285878 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.286296 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.286879 [info ] [Thread-1 (]: 15 of 31 START test not_null_dim_customer_customerid ........................... [RUN]
[0m16:48:56.287186 [info ] [Thread-3 (]: 16 of 31 START test not_null_dim_customer_customerkey .......................... [RUN]
[0m16:48:56.287673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.northwind.dim_date, now test.northwind.not_null_dim_customer_customerid.4d829c4322)
[0m16:48:56.288118 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.northwind.dim_employee, now test.northwind.not_null_dim_customer_customerkey.904a936983)
[0m16:48:56.288361 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.288594 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.293538 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:56.296220 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:56.296737 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (compile): 16:48:56.288752 => 16:48:56.296600
[0m16:48:56.297025 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (compile): 16:48:56.293749 => 16:48:56.296879
[0m16:48:56.297240 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.297464 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.299491 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:56.301564 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:56.302229 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerid.4d829c4322"
[0m16:48:56.302652 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_customer_customerkey.904a936983"
[0m16:48:56.302867 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerid.4d829c4322"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerid
from analytics.northwind_northwind.dim_customer
where customerid is null



      
    ) dbt_internal_test
[0m16:48:56.303102 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_customer_customerkey.904a936983"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customerkey
from analytics.northwind_northwind.dim_customer
where customerkey is null



      
    ) dbt_internal_test
[0m16:48:56.303324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:56.303517 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:56.738956 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b2c55c-0000-17a6-0009-ec83000212ee
[0m16:48:56.739713 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 31
invalid identifier 'PRODUCTID'
[0m16:48:56.740373 [debug] [Thread-4 (]: Timing info for model.northwind.fact_sales (execute): 16:48:56.274543 => 16:48:56.740104
[0m16:48:56.740821 [debug] [Thread-4 (]: On model.northwind.fact_sales: Close
[0m16:48:56.773867 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:56.778132 [debug] [Thread-2 (]: Timing info for model.northwind.fact_order_fulfillment (execute): 16:48:55.975305 => 16:48:56.777858
[0m16:48:56.778630 [debug] [Thread-2 (]: On model.northwind.fact_order_fulfillment: Close
[0m16:48:56.794934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:56.795865 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:56.798173 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_customer_customerid.4d829c4322 (execute): 16:48:56.297593 => 16:48:56.797923
[0m16:48:56.800125 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_customer_customerkey.904a936983 (execute): 16:48:56.299729 => 16:48:56.799898
[0m16:48:56.800680 [debug] [Thread-1 (]: On test.northwind.not_null_dim_customer_customerid.4d829c4322: Close
[0m16:48:56.801369 [debug] [Thread-3 (]: On test.northwind.not_null_dim_customer_customerkey.904a936983: Close
[0m16:48:56.863358 [debug] [Thread-4 (]: Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:48:56.863890 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d350d0>]}
[0m16:48:56.864462 [error] [Thread-4 (]: 14 of 31 ERROR creating sql table model analytics.northwind_northwind.fact_sales  [[31mERROR[0m in 0.60s]
[0m16:48:56.865057 [debug] [Thread-4 (]: Finished running node model.northwind.fact_sales
[0m16:48:56.865479 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:56.865980 [info ] [Thread-4 (]: 17 of 31 START test unique_dim_customer_customerid ............................. [RUN]
[0m16:48:56.866644 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.northwind.fact_sales, now test.northwind.unique_dim_customer_customerid.04913d3698)
[0m16:48:56.866987 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:56.871458 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:56.872250 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (compile): 16:48:56.867181 => 16:48:56.872045
[0m16:48:56.872568 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:56.874867 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:56.875735 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerid.04913d3698"
[0m16:48:56.876021 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerid.04913d3698"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerid is not null
group by customerid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:56.876291 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:56.915082 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d07fb0>]}
[0m16:48:56.914342 [info ] [Thread-3 (]: 16 of 31 PASS not_null_dim_customer_customerkey ................................ [[32mPASS[0m in 0.63s]
[0m16:48:56.915727 [info ] [Thread-2 (]: 13 of 31 OK created sql table model analytics.northwind_northwind.fact_order_fulfillment  [[32mSUCCESS 1[0m in 0.95s]
[0m16:48:56.916291 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_customer_customerkey.904a936983
[0m16:48:56.917106 [debug] [Thread-2 (]: Finished running node model.northwind.fact_order_fulfillment
[0m16:48:56.917603 [debug] [Thread-3 (]: Began running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:56.918080 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:56.918736 [info ] [Thread-3 (]: 18 of 31 START test unique_dim_customer_customerkey ............................ [RUN]
[0m16:48:56.919530 [info ] [Thread-1 (]: 15 of 31 PASS not_null_dim_customer_customerid ................................. [[32mPASS[0m in 0.63s]
[0m16:48:56.920109 [info ] [Thread-2 (]: 19 of 31 START test not_null_dim_date_date ..................................... [RUN]
[0m16:48:56.920872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerkey.904a936983, now test.northwind.unique_dim_customer_customerkey.183274e37c)
[0m16:48:56.921393 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_customer_customerid.4d829c4322
[0m16:48:56.921911 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.northwind.fact_order_fulfillment, now test.northwind.not_null_dim_date_date.78f11e7735)
[0m16:48:56.922194 [debug] [Thread-3 (]: Began compiling node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:56.922497 [debug] [Thread-1 (]: Began running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:56.922792 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:56.926455 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:56.926780 [info ] [Thread-1 (]: 20 of 31 START test not_null_dim_date_datekey .................................. [RUN]
[0m16:48:56.929631 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:56.930285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_customer_customerid.4d829c4322, now test.northwind.not_null_dim_date_datekey.1af65c721b)
[0m16:48:56.930785 [debug] [Thread-1 (]: Began compiling node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:56.935997 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:56.936390 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (compile): 16:48:56.922971 => 16:48:56.936219
[0m16:48:56.936838 [debug] [Thread-3 (]: Began executing node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:56.937100 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (compile): 16:48:56.926978 => 16:48:56.936976
[0m16:48:56.937346 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (compile): 16:48:56.931006 => 16:48:56.937238
[0m16:48:56.939201 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:56.939458 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:56.939735 [debug] [Thread-1 (]: Began executing node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:56.941699 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:56.943478 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:56.944112 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.unique_dim_customer_customerkey.183274e37c"
[0m16:48:56.944428 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_customer_customerkey.183274e37c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customerkey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_customer
where customerkey is not null
group by customerkey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:56.944689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:56.945068 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_date_date.78f11e7735"
[0m16:48:56.945660 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.not_null_dim_date_datekey.1af65c721b"
[0m16:48:56.946134 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_date.78f11e7735"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select date
from analytics.northwind_northwind.dim_date
where date is null



      
    ) dbt_internal_test
[0m16:48:56.946612 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_date_datekey.1af65c721b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select datekey
from analytics.northwind_northwind.dim_date
where datekey is null



      
    ) dbt_internal_test
[0m16:48:56.946871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:56.947083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:57.307984 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:57.312668 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_customer_customerid.04913d3698 (execute): 16:48:56.872751 => 16:48:57.312220
[0m16:48:57.313383 [debug] [Thread-4 (]: On test.northwind.unique_dim_customer_customerid.04913d3698: Close
[0m16:48:57.407323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:57.411107 [debug] [Thread-1 (]: Timing info for test.northwind.not_null_dim_date_datekey.1af65c721b (execute): 16:48:56.941908 => 16:48:57.410782
[0m16:48:57.412176 [debug] [Thread-1 (]: On test.northwind.not_null_dim_date_datekey.1af65c721b: Close
[0m16:48:57.418799 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:57.421630 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_date_date.78f11e7735 (execute): 16:48:56.939943 => 16:48:57.421322
[0m16:48:57.422140 [debug] [Thread-2 (]: On test.northwind.not_null_dim_date_date.78f11e7735: Close
[0m16:48:57.444818 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:57.448663 [debug] [Thread-3 (]: Timing info for test.northwind.unique_dim_customer_customerkey.183274e37c (execute): 16:48:56.937484 => 16:48:57.448381
[0m16:48:57.449102 [debug] [Thread-3 (]: On test.northwind.unique_dim_customer_customerkey.183274e37c: Close
[0m16:48:57.470459 [info ] [Thread-4 (]: 17 of 31 PASS unique_dim_customer_customerid ................................... [[32mPASS[0m in 0.60s]
[0m16:48:57.471654 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_customer_customerid.04913d3698
[0m16:48:57.472203 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:57.472681 [info ] [Thread-4 (]: 21 of 31 START test unique_dim_date_date ....................................... [RUN]
[0m16:48:57.474169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerid.04913d3698, now test.northwind.unique_dim_date_date.dd069a8d31)
[0m16:48:57.474596 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:57.480000 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:57.481287 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (compile): 16:48:57.474824 => 16:48:57.481084
[0m16:48:57.481605 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:57.484559 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:57.485670 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_date_date.dd069a8d31"
[0m16:48:57.486025 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_date.dd069a8d31"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    date as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where date is not null
group by date
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:57.486350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:57.532324 [info ] [Thread-1 (]: 20 of 31 PASS not_null_dim_date_datekey ........................................ [[32mPASS[0m in 0.60s]
[0m16:48:57.533103 [debug] [Thread-1 (]: Finished running node test.northwind.not_null_dim_date_datekey.1af65c721b
[0m16:48:57.533537 [debug] [Thread-1 (]: Began running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:57.533984 [info ] [Thread-1 (]: 22 of 31 START test unique_dim_date_datekey .................................... [RUN]
[0m16:48:57.534777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_datekey.1af65c721b, now test.northwind.unique_dim_date_datekey.d14b9b9f02)
[0m16:48:57.535198 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:57.539797 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:57.541168 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (compile): 16:48:57.535541 => 16:48:57.540975
[0m16:48:57.541471 [debug] [Thread-1 (]: Began executing node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:57.543775 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:57.544555 [info ] [Thread-2 (]: 19 of 31 PASS not_null_dim_date_date ........................................... [[32mPASS[0m in 0.62s]
[0m16:48:57.545343 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_date_date.78f11e7735
[0m16:48:57.545742 [debug] [Thread-2 (]: Began running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:57.546413 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_dim_date_datekey.d14b9b9f02"
[0m16:48:57.546792 [info ] [Thread-2 (]: 23 of 31 START test not_null_dim_employee_employeeid ........................... [RUN]
[0m16:48:57.547140 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_date_datekey.d14b9b9f02"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    datekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_date
where datekey is not null
group by datekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:57.547746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_date_date.78f11e7735, now test.northwind.not_null_dim_employee_employeeid.47069b1dff)
[0m16:48:57.548429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:57.548746 [debug] [Thread-2 (]: Began compiling node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:57.552883 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:57.553809 [info ] [Thread-3 (]: 18 of 31 PASS unique_dim_customer_customerkey .................................. [[32mPASS[0m in 0.63s]
[0m16:48:57.554372 [debug] [Thread-3 (]: Finished running node test.northwind.unique_dim_customer_customerkey.183274e37c
[0m16:48:57.554714 [debug] [Thread-3 (]: Began running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:57.555319 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (compile): 16:48:57.549448 => 16:48:57.555172
[0m16:48:57.555021 [info ] [Thread-3 (]: 24 of 31 START test not_null_dim_employee_employeekey .......................... [RUN]
[0m16:48:57.555834 [debug] [Thread-2 (]: Began executing node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:57.556490 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_customer_customerkey.183274e37c, now test.northwind.not_null_dim_employee_employeekey.59d58b8331)
[0m16:48:57.560178 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:57.560552 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:57.563390 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:57.563946 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeeid.47069b1dff"
[0m16:48:57.564230 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeeid.47069b1dff"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeeid
from analytics.northwind_northwind.dim_employee
where employeeid is null



      
    ) dbt_internal_test
[0m16:48:57.564465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:57.564756 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (compile): 16:48:57.560820 => 16:48:57.564591
[0m16:48:57.565334 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:57.567285 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:57.567863 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_dim_employee_employeekey.59d58b8331"
[0m16:48:57.568081 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_dim_employee_employeekey.59d58b8331"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select employeekey
from analytics.northwind_northwind.dim_employee
where employeekey is null



      
    ) dbt_internal_test
[0m16:48:57.568313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:58.283057 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.287329 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_date_date.dd069a8d31 (execute): 16:48:57.481786 => 16:48:58.286720
[0m16:48:58.288133 [debug] [Thread-4 (]: On test.northwind.unique_dim_date_date.dd069a8d31: Close
[0m16:48:58.290782 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.293501 [debug] [Thread-2 (]: Timing info for test.northwind.not_null_dim_employee_employeeid.47069b1dff (execute): 16:48:57.556661 => 16:48:58.293260
[0m16:48:58.294201 [debug] [Thread-2 (]: On test.northwind.not_null_dim_employee_employeeid.47069b1dff: Close
[0m16:48:58.395518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.400011 [debug] [Thread-1 (]: Timing info for test.northwind.unique_dim_date_datekey.d14b9b9f02 (execute): 16:48:57.541641 => 16:48:58.399633
[0m16:48:58.401707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:58.402170 [debug] [Thread-1 (]: On test.northwind.unique_dim_date_datekey.d14b9b9f02: Close
[0m16:48:58.404818 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_dim_employee_employeekey.59d58b8331 (execute): 16:48:57.565654 => 16:48:58.404241
[0m16:48:58.407534 [debug] [Thread-3 (]: On test.northwind.not_null_dim_employee_employeekey.59d58b8331: Close
[0m16:48:58.408693 [info ] [Thread-4 (]: 21 of 31 PASS unique_dim_date_date ............................................. [[32mPASS[0m in 0.93s]
[0m16:48:58.410929 [info ] [Thread-2 (]: 23 of 31 PASS not_null_dim_employee_employeeid ................................. [[32mPASS[0m in 0.86s]
[0m16:48:58.411948 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_date_date.dd069a8d31
[0m16:48:58.412460 [debug] [Thread-2 (]: Finished running node test.northwind.not_null_dim_employee_employeeid.47069b1dff
[0m16:48:58.412959 [debug] [Thread-4 (]: Began running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:58.413651 [debug] [Thread-2 (]: Began running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:58.414436 [info ] [Thread-4 (]: 25 of 31 START test unique_dim_employee_employeeid ............................. [RUN]
[0m16:48:58.415002 [info ] [Thread-2 (]: 26 of 31 START test unique_dim_employee_employeekey ............................ [RUN]
[0m16:48:58.416128 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_date.dd069a8d31, now test.northwind.unique_dim_employee_employeeid.a3468da3ee)
[0m16:48:58.416829 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeeid.47069b1dff, now test.northwind.unique_dim_employee_employeekey.e313069a83)
[0m16:48:58.417186 [debug] [Thread-4 (]: Began compiling node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:58.417500 [debug] [Thread-2 (]: Began compiling node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:58.422518 [debug] [Thread-2 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:58.425783 [debug] [Thread-4 (]: Writing injected SQL for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:58.426493 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (compile): 16:48:58.417702 => 16:48:58.426291
[0m16:48:58.426874 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (compile): 16:48:58.418509 => 16:48:58.426676
[0m16:48:58.427182 [debug] [Thread-4 (]: Began executing node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:58.427472 [debug] [Thread-2 (]: Began executing node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:58.429833 [debug] [Thread-4 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:58.431638 [debug] [Thread-2 (]: Writing runtime sql for node "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:58.432440 [debug] [Thread-4 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeeid.a3468da3ee"
[0m16:48:58.433007 [debug] [Thread-2 (]: Using snowflake connection "test.northwind.unique_dim_employee_employeekey.e313069a83"
[0m16:48:58.433306 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeeid.a3468da3ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeeid as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeeid is not null
group by employeeid
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:58.433615 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_dim_employee_employeekey.e313069a83"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    employeekey as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.dim_employee
where employeekey is not null
group by employeekey
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:58.433863 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:48:58.434077 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:48:58.528229 [info ] [Thread-3 (]: 24 of 31 PASS not_null_dim_employee_employeekey ................................ [[32mPASS[0m in 0.97s]
[0m16:48:58.528886 [info ] [Thread-1 (]: 22 of 31 PASS unique_dim_date_datekey .......................................... [[32mPASS[0m in 0.99s]
[0m16:48:58.529452 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_dim_employee_employeekey.59d58b8331
[0m16:48:58.529826 [debug] [Thread-1 (]: Finished running node test.northwind.unique_dim_date_datekey.d14b9b9f02
[0m16:48:58.530140 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:58.530488 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:58.530829 [info ] [Thread-3 (]: 27 of 31 SKIP test not_null_fact_sales_saleskey ................................ [[33mSKIP[0m]
[0m16:48:58.531141 [info ] [Thread-1 (]: 28 of 31 SKIP test unique_fact_sales_saleskey .................................. [[33mSKIP[0m]
[0m16:48:58.531447 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_sales_saleskey.0bc31ce210
[0m16:48:58.531712 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_sales_saleskey.c07ec0958d
[0m16:48:58.531989 [debug] [Thread-3 (]: Began running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:58.532305 [debug] [Thread-1 (]: Began running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:58.532608 [info ] [Thread-3 (]: 29 of 31 START test not_null_fact_order_fulfillment_OrderId .................... [RUN]
[0m16:48:58.532900 [info ] [Thread-1 (]: 30 of 31 START test unique_fact_order_fulfillment_OrderId ...................... [RUN]
[0m16:48:58.533616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.northwind.not_null_dim_employee_employeekey.59d58b8331, now test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb)
[0m16:48:58.534201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_date_datekey.d14b9b9f02, now test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa)
[0m16:48:58.534489 [debug] [Thread-3 (]: Began compiling node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:58.534731 [debug] [Thread-1 (]: Began compiling node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:58.538147 [debug] [Thread-3 (]: Writing injected SQL for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:58.540997 [debug] [Thread-1 (]: Writing injected SQL for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:58.541781 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (compile): 16:48:58.538346 => 16:48:58.541543
[0m16:48:58.542147 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (compile): 16:48:58.534883 => 16:48:58.541969
[0m16:48:58.542416 [debug] [Thread-1 (]: Began executing node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:58.542680 [debug] [Thread-3 (]: Began executing node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:58.544845 [debug] [Thread-1 (]: Writing runtime sql for node "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:58.547847 [debug] [Thread-3 (]: Writing runtime sql for node "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:58.548563 [debug] [Thread-1 (]: Using snowflake connection "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"
[0m16:48:58.548836 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    OrderId as unique_field,
    count(*) as n_records

from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is not null
group by OrderId
having count(*) > 1



      
    ) dbt_internal_test
[0m16:48:58.549096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:48:58.549917 [debug] [Thread-3 (]: Using snowflake connection "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"
[0m16:48:58.550382 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select OrderId
from analytics.northwind_northwind.fact_order_fulfillment
where OrderId is null



      
    ) dbt_internal_test
[0m16:48:58.550623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:48:58.868262 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m16:48:58.872660 [debug] [Thread-4 (]: Timing info for test.northwind.unique_dim_employee_employeeid.a3468da3ee (execute): 16:48:58.427636 => 16:48:58.872308
[0m16:48:58.873553 [debug] [Thread-4 (]: On test.northwind.unique_dim_employee_employeeid.a3468da3ee: Close
[0m16:48:58.995676 [info ] [Thread-4 (]: 25 of 31 PASS unique_dim_employee_employeeid ................................... [[32mPASS[0m in 0.58s]
[0m16:48:58.996642 [debug] [Thread-4 (]: Finished running node test.northwind.unique_dim_employee_employeeid.a3468da3ee
[0m16:48:59.269747 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:59.274210 [debug] [Thread-3 (]: Timing info for test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb (execute): 16:48:58.545019 => 16:48:59.273742
[0m16:48:59.274897 [debug] [Thread-3 (]: On test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb: Close
[0m16:48:59.347960 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:59.350418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:48:59.353484 [debug] [Thread-2 (]: Timing info for test.northwind.unique_dim_employee_employeekey.e313069a83 (execute): 16:48:58.430024 => 16:48:59.353203
[0m16:48:59.356704 [debug] [Thread-1 (]: Timing info for test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa (execute): 16:48:58.542832 => 16:48:59.356258
[0m16:48:59.357899 [debug] [Thread-2 (]: On test.northwind.unique_dim_employee_employeekey.e313069a83: Close
[0m16:48:59.358648 [debug] [Thread-1 (]: On test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa: Close
[0m16:48:59.426691 [info ] [Thread-3 (]: 29 of 31 PASS not_null_fact_order_fulfillment_OrderId .......................... [[32mPASS[0m in 0.89s]
[0m16:48:59.427676 [debug] [Thread-3 (]: Finished running node test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb
[0m16:48:59.481730 [info ] [Thread-1 (]: 30 of 31 PASS unique_fact_order_fulfillment_OrderId ............................ [[32mPASS[0m in 0.95s]
[0m16:48:59.482820 [info ] [Thread-2 (]: 26 of 31 PASS unique_dim_employee_employeekey .................................. [[32mPASS[0m in 1.07s]
[0m16:48:59.483812 [debug] [Thread-1 (]: Finished running node test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa
[0m16:48:59.484397 [debug] [Thread-2 (]: Finished running node test.northwind.unique_dim_employee_employeekey.e313069a83
[0m16:48:59.485388 [debug] [Thread-4 (]: Began running node model.northwind.obt_order_fulfillment
[0m16:48:59.485944 [info ] [Thread-4 (]: 31 of 31 START sql table model analytics.northwind_northwind.obt_order_fulfillment  [RUN]
[0m16:48:59.486761 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.northwind.unique_dim_employee_employeeid.a3468da3ee, now model.northwind.obt_order_fulfillment)
[0m16:48:59.487170 [debug] [Thread-4 (]: Began compiling node model.northwind.obt_order_fulfillment
[0m16:48:59.491573 [debug] [Thread-4 (]: Writing injected SQL for node "model.northwind.obt_order_fulfillment"
[0m16:48:59.492537 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (compile): 16:48:59.487417 => 16:48:59.492314
[0m16:48:59.492878 [debug] [Thread-4 (]: Began executing node model.northwind.obt_order_fulfillment
[0m16:48:59.495606 [debug] [Thread-4 (]: Writing runtime sql for node "model.northwind.obt_order_fulfillment"
[0m16:48:59.497065 [debug] [Thread-4 (]: Using snowflake connection "model.northwind.obt_order_fulfillment"
[0m16:48:59.497402 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: /* {"app": "dbt", "dbt_version": "1.7.9", "profile_name": "northwind", "target_name": "dev", "node_id": "model.northwind.obt_order_fulfillment"} */
create or replace transient table analytics.northwind_northwind.obt_order_fulfillment
         as
        (with f_order_fulfillment as (
    select * from analytics.northwind_northwind.fact_order_fulfillment
),
d_customer as (
    select * from analytics.northwind_northwind.dim_customer
),
d_employee as (
    select * from analytics.northwind_northwind.dim_employee
),
d_date as (
    select * from analytics.northwind_northwind.dim_date
)
select 
    d_customer.*, 
    d_employee.*, 
    d_date.*,
    f.orderid, f.orderdatekey, f.shippeddatekey, f.requireddatekey, f.shipname, f.shipaddress, f.shipcity, f.shipregion, f.shippostalcode, f.shipcountry,
    f.freight, f.shipvia, f.shippercompanyname, f.quantityonorder, f.totalorderamount, f.daysfromordertoshipped, f.daysfromordertorequired, f.shippedtorequireddelta, f.shippedontime
    from f_order_fulfillment as f
    left join d_customer on f.customerkey = d_customer.customerkey
    left join d_employee on f.employeekey = d_employee.employeekey
    left join d_date on f.orderdatekey = d_date.datekey
        );
[0m16:48:59.497725 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:49:00.685040 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m16:49:00.691742 [debug] [Thread-4 (]: Timing info for model.northwind.obt_order_fulfillment (execute): 16:48:59.493075 => 16:49:00.691392
[0m16:49:00.692338 [debug] [Thread-4 (]: On model.northwind.obt_order_fulfillment: Close
[0m16:49:00.844172 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036dd45-7259-4494-9ddd-f08fd95109fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111241b80>]}
[0m16:49:00.845324 [info ] [Thread-4 (]: 31 of 31 OK created sql table model analytics.northwind_northwind.obt_order_fulfillment  [[32mSUCCESS 1[0m in 1.36s]
[0m16:49:00.846116 [debug] [Thread-4 (]: Finished running node model.northwind.obt_order_fulfillment
[0m16:49:00.849462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:00.850099 [debug] [MainThread]: Connection 'test.northwind.unique_fact_order_fulfillment_OrderId.f55f1591fa' was properly closed.
[0m16:49:00.850464 [debug] [MainThread]: Connection 'test.northwind.unique_dim_employee_employeekey.e313069a83' was properly closed.
[0m16:49:00.850832 [debug] [MainThread]: Connection 'test.northwind.not_null_fact_order_fulfillment_OrderId.2f35bbbceb' was properly closed.
[0m16:49:00.851157 [debug] [MainThread]: Connection 'model.northwind.obt_order_fulfillment' was properly closed.
[0m16:49:00.851581 [info ] [MainThread]: 
[0m16:49:00.851954 [info ] [MainThread]: Finished running 25 tests, 6 table models in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m16:49:00.855758 [debug] [MainThread]: Command end result
[0m16:49:00.868122 [info ] [MainThread]: 
[0m16:49:00.868463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:49:00.868703 [info ] [MainThread]: 
[0m16:49:00.868939 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  000904 (42000): SQL compilation error: error line 9 at position 31
  invalid identifier 'PRODUCTID'
  compiled Code at target/run/northwind/models/fact_sales.sql
[0m16:49:00.869189 [info ] [MainThread]: 
[0m16:49:00.869421 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=1 SKIP=2 TOTAL=31
[0m16:49:00.871198 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 8.840415, "process_user_time": 2.729026, "process_kernel_time": 0.294948, "process_mem_max_rss": "146374656", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:00.871493 [debug] [MainThread]: Command `dbt build` failed at 16:49:00.871433 after 8.84 seconds
[0m16:49:00.871698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eefce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d023c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d03980>]}
[0m16:49:00.871883 [debug] [MainThread]: Flushing usage events
